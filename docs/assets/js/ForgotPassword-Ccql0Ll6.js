import{j as e}from"./utils-L0j39QIW.js";import{u as s,a,L as t}from"./vendor-DPJ7iNYg.js";import{B as r,b as l,L as i,a as o}from"./index-BlnpEVUf.js";import{C as n}from"./Card-DXlcOk_J.js";import{S as d}from"./SectionHeader-jpTrkMUD.js";import{I as c}from"./Input-DoNyYXSI.js";import{P as m}from"./PasswordInput-B67VXabr.js";function x(){const x=s(),[p,u]=a.useState("request"),[h,f]=a.useState({email:"",otp:"",newPassword:"",confirmPassword:""}),[w,g]=a.useState(!1),[j,y]=a.useState(""),[v,b]=a.useState(""),N=e=>{f(s=>({...s,[e.target.name]:e.target.value})),y(""),b("")};return e.jsxs(r,{variant:"gradientBlue",pattern:"dots",overlay:!0,floatingElements:!0,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 via-indigo-50/30 to-purple-50/20 pointer-events-none"}),e.jsx("main",{className:"flex h-screen items-center justify-center px-2 relative z-10 overflow-hidden",children:e.jsxs(n,{variant:"glass",className:"w-full max-w-3xl flex flex-col md:flex-row overflow-hidden p-0 animate-fadeIn rounded-2xl shadow-xl",children:[e.jsx("section",{className:"w-full md:w-1/2 flex flex-col justify-center items-center p-6 md:p-10 rounded-l-2xl bg-white/90 backdrop-blur-xl",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs(t,{to:"/",className:"text-gray-600 hover:text-gray-800 inline-flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to home"]}),e.jsx(t,{to:"/login",className:"text-blue-600 hover:underline",children:"Back to login"})]}),e.jsxs("div",{className:"space-y-2 text-center",children:[e.jsx(d,{variant:"primary",size:"lg",className:"text-center",children:"Forgot Password"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Enter your email to receive a one-time code, then set a new password."})]}),e.jsxs("form",{onSubmit:"request"===p?async e=>{if(e.preventDefault(),h.email){g(!0),y(""),b("");try{await o("/api/auth/forgot-password/check",{method:"POST",body:JSON.stringify({email:h.email})}),await o("/api/auth/forgot-password/request",{method:"POST",body:JSON.stringify({email:h.email})}),u("reset"),b("Reset code sent to your email.")}catch(s){y(s.message||"Failed to start password reset.")}finally{g(!1)}}else y("Please enter your email address.")}:async e=>{if(e.preventDefault(),!h.otp||h.otp.length<4)y("Enter the 4-character code sent to your email.");else if(h.newPassword)if(h.newPassword===h.confirmPassword){g(!0),y("");try{await o("/api/auth/forgot-password/reset",{method:"POST",body:JSON.stringify({email:h.email,otp:h.otp,newPassword:h.newPassword})}),b("Password updated. Redirecting to login..."),setTimeout(()=>x("/login"),1200)}catch(s){y(s.message||"Failed to reset password.")}finally{g(!1)}}else y("Passwords do not match.");else y("Please enter a new password.")},className:"w-full flex flex-col gap-4",noValidate:!0,children:[e.jsx(c,{name:"email",value:h.email,onChange:N,placeholder:"Email address",type:"email",required:!0}),"reset"===p&&e.jsxs(e.Fragment,{children:[e.jsx(c,{name:"otp",value:h.otp,onChange:e=>N({target:{name:"otp",value:e.target.value.slice(0,4)}}),placeholder:"4-character code",type:"text",maxLength:4,required:!0}),e.jsx(m,{name:"newPassword",value:h.newPassword,onChange:N,placeholder:"New password",required:!0}),e.jsx(m,{name:"confirmPassword",value:h.confirmPassword,onChange:N,placeholder:"Confirm new password",required:!0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Password must be at least 12 characters and include uppercase, lowercase, number, and special character."})]}),j&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-lg p-3 text-sm text-red-700",children:j}),v&&e.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 rounded-lg p-3 text-sm text-green-700",children:v}),e.jsxs(l,{type:"submit",variant:"primary",disabled:w,className:"w-full flex items-center justify-center h-12 mt-2 text-lg font-medium transition-all duration-300 hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]",children:[w&&e.jsx(i,{size:"sm",className:"mr-2"}),"request"===p?"Send Reset Code":"Reset Password"]})]}),"reset"===p&&e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsx("button",{type:"button",onClick:async()=>{if(h.email){g(!0),y("");try{await o("/otp/resend",{method:"POST",body:JSON.stringify({email:h.email,purpose:"password_reset"})}),b("A new code was sent (if the email exists).")}catch(e){y(e.message||"Failed to resend code.")}finally{g(!1)}}else y("Enter your email first to resend the code.")},disabled:w,className:"text-blue-600 hover:underline disabled:opacity-60",children:"Resend code"}),e.jsx("span",{children:"Didn't get the email? Check spam too."})]})]})}),e.jsxs("aside",{className:"hidden md:flex items-center rounded-r-2xl bg-gradient-to-br from-indigo-500 via-blue-400 to-sky-400 w-1/2 p-10 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-7 -z-10 pointer-events-none",children:e.jsx("div",{className:"w-full h-full bg-[radial-gradient(circle_at_1px_1px,rgba(255,255,255,0.25)_1px,transparent_0)] bg-[length:24px_24px]"})}),e.jsxs("div",{className:"relative z-10 flex flex-col justify-center items-start max-w-sm pl-6 space-y-3 text-white",children:[e.jsx("h2",{className:"text-3xl font-extrabold leading-tight",children:"Secure account recovery"}),e.jsx("p",{className:"text-white/90 text-base",children:"Use your email to receive a one-time code and safely choose a new password."}),e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white/15 text-white/90 px-3 py-1 text-xs backdrop-blur-sm ring-1 ring-white/20",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-emerald-300 animate-pulse"}),"OTP protected"]})]})]})]})})]})}export{x as default};
//# sourceMappingURL=ForgotPassword-Ccql0Ll6.js.map
