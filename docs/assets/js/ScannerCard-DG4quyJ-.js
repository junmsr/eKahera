import{j as e}from"./utils-BnCj7yKo.js";import{a as r}from"./vendor-BZrj58oz.js";import{b as t}from"./index-DLptuXQb.js";import{k as a}from"./qr-DN-bNBye.js";function s({paused:s,onResume:n,textMain:i="text-blue-800",className:o="",modalContext:l=!1,...c}){const[d,u]=r.useState("environment"),[m,h]=r.useState(""),[f,x]=r.useState(!l),[v,b]=r.useState(!1),[j,p]=r.useState(!1),[w,g]=r.useState(!1),[k,N]=r.useState(!1),[S,y]=r.useState(!1),M=r.useRef(null),C=r.useRef(0),L=r.useRef(null),z=r.useRef(!1);r.useEffect(()=>{p(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))},[]),r.useEffect(()=>{(async()=>{try{const e=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"videoinput"===e.kind);g(e.length>1),x(!1)}catch(e){console.error("Error checking cameras:",e),x(!1)}})()},[]),r.useEffect(()=>{if(S){const e=setTimeout(()=>y(!1),1e3);return()=>clearTimeout(e)}},[S]),r.useEffect(()=>()=>{L.current&&clearTimeout(L.current)},[]);const R=r.useCallback(e=>{if(!e||!e[0]||!e[0].rawValue)return;const r=e[0].rawValue,t=Date.now();r===M.current&&t-C.current<500||z.current||(L.current&&clearTimeout(L.current),z.current=!0,M.current=r,C.current=t,y(!0),c.onScan?L.current=setTimeout(async()=>{try{await c.onScan(e)}catch(r){console.error("Scan handler error:",r)}finally{setTimeout(()=>{z.current=!1},300)}},100):z.current=!1)},[c.onScan]);return e.jsx("div",{className:`flex-shrink-0 bg-white/80 backdrop-blur-md border border-white/60 shadow-xl hover:shadow-2xl transition-all duration-300 overflow-hidden ${o}`,children:e.jsxs("div",{className:"flex flex-col h-full p-1 sm:p-2",children:[e.jsxs("div",{className:`w-full text-center mb-1 font-bold text-xs tracking-wide ${i} flex items-center justify-center gap-1`,children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"CAMERA CONTROLS"]}),e.jsxs("div",{className:"w-full flex-1 bg-gradient-to-br from-blue-50/80 via-indigo-50/60 to-blue-100/80 rounded-xl flex items-center justify-center border-2 border-blue-200/50 shadow-inner overflow-hidden relative z-0 group",children:[f?e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"Initializing camera..."})]})}):m?e.jsx("div",{className:"flex items-center justify-center h-full text-red-500 p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Camera Error"}),e.jsx("p",{className:"text-xs",children:m})]})}):e.jsxs(e.Fragment,{children:[e.jsx(a,{onScan:R,onError:e=>{console.error("Camera error:",e),h("Camera access failed. Please check permissions.")},paused:s||z.current,constraints:{facingMode:d,width:{ideal:1920,min:640},height:{ideal:1080,min:480},frameRate:{ideal:30,min:15}},torch:v,formats:["qr_code","ean_13","ean_8","code_128","code_39","upc_a","upc_e","codabar","itf","code_93","databar","databar_expanded"],scanDelay:100,allowMultiple:!1,styles:{container:{width:"100%",height:"100%",borderRadius:"1rem",overflow:"visible"},video:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"1rem",backgroundColor:"black"}},classNames:{container:"w-full h-full"}}),S&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-green-500/20 backdrop-blur-sm rounded-xl z-20 pointer-events-none",children:e.jsx("div",{className:"bg-green-500 text-white rounded-full p-4 shadow-2xl animate-pulse",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})})]}),!m&&!f&&e.jsxs("div",{className:"absolute bottom-2 right-2 z-10 flex gap-2",children:[j&&w&&e.jsx(t,{label:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),size:"sm",variant:"secondary",onClick:()=>{u(e=>"user"===e?"environment":"user")},microinteraction:!0,title:"user"===d?"Switch to back camera":"Switch to front camera"}),j&&e.jsx(t,{label:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),size:"sm",variant:"secondary",onClick:()=>b(!v),microinteraction:!0,title:v?"Turn off flashlight":"Turn on flashlight"})]})]})]})})}export{s as S};
//# sourceMappingURL=ScannerCard-DG4quyJ-.js.map
