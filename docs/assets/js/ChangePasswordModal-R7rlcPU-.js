import{j as e}from"./utils-L0j39QIW.js";import{a as s}from"./vendor-DPJ7iNYg.js";import{b as r,a}from"./index-DaOEzN3b.js";import"./Input-DoNyYXSI.js";import{P as t}from"./PasswordInput-B67VXabr.js";import{B as n}from"./BaseModal-Cy73DE2S.js";const o=({isOpen:o,onClose:d})=>{const[l,c]=s.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[m,i]=s.useState(!1),[w,u]=s.useState(""),[x,h]=s.useState(""),[p,P]=s.useState({}),[g,j]=s.useState({}),b=s.useMemo(()=>{const e=l.newPassword;return{minLength:e.length>=12,hasUpperCase:/[A-Z]/.test(e),hasLowerCase:/[a-z]/.test(e),hasNumber:/\d/.test(e),hasSpecialChar:/[!@#$%^&*(),.?":{}|<>]/.test(e)}},[l.newPassword]),f=s.useMemo(()=>Object.values(b).every(e=>!0===e),[b]),N=s.useMemo(()=>""!==l.currentPassword.trim()&&f&&l.newPassword===l.confirmPassword&&""!==l.confirmPassword.trim(),[l,f]),y=e=>{const{name:s,value:r}=e.target;c(e=>({...e,[s]:r})),p[s]&&P(e=>({...e,[s]:""}))},C=e=>{const{name:s}=e.target;j(e=>({...e,[s]:!0}))};return e.jsx(n,{isOpen:o,onClose:d,title:"Change Password",maxWidth:"md",children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return l.currentPassword||(e.currentPassword="Current password is required"),l.newPassword?f||(e.newPassword="Password does not meet requirements"):e.newPassword="New password is required",l.confirmPassword?l.newPassword!==l.confirmPassword&&(e.confirmPassword="Passwords do not match"):e.confirmPassword="Please confirm your new password",P(e),0===Object.keys(e).length})()){i(!0),h(""),u("");try{const e=await a("/auth/password",{method:"PUT",body:JSON.stringify({currentPassword:l.currentPassword,newPassword:l.newPassword})});e?.message&&(u(e.message||"Password updated successfully"),c({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>{d()},1500))}catch(s){console.error("Error updating password:",s);let e="Failed to update password";s.response?.data?.error?e=s.response.data.error:s.data?.error?e=s.data.error:s.message&&(e=s.message.includes("Invalid request")?"Please check your current password and try again":s.message),h(e)}finally{i(!1)}}},className:"space-y-4",children:[x&&e.jsx("div",{className:"bg-red-50 text-red-700 p-3 rounded-md text-sm",children:x}),w&&e.jsx("div",{className:"bg-green-50 text-green-700 p-3 rounded-md text-sm",children:w}),e.jsxs("div",{className:"mb-5",children:[e.jsxs("label",{className:"block mb-1 font-medium text-blue-800",children:["Current Password",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(t,{name:"currentPassword",value:l.currentPassword,onChange:y,onBlur:C,error:g.currentPassword&&p.currentPassword,disabled:m,autoComplete:"current-password",placeholder:"Enter your current password"})]}),e.jsxs("div",{className:"mb-5",children:[e.jsxs("label",{className:"block mb-1 font-medium text-blue-800",children:["New Password",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(t,{name:"newPassword",value:l.newPassword,onChange:y,onBlur:C,error:g.newPassword&&p.newPassword,disabled:m,autoComplete:"new-password",placeholder:"Enter your new password"}),l.newPassword&&e.jsxs("div",{className:"mt-2 p-3 bg-gray-50 rounded-md border border-gray-200",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"Password Requirements:"}),e.jsxs("ul",{className:"space-y-1 text-xs",children:[e.jsxs("li",{className:"flex items-center "+(b.minLength?"text-green-600":"text-gray-500"),children:[e.jsx("span",{className:"mr-2 "+(b.minLength?"text-green-500":"text-gray-400"),children:b.minLength?"✓":"○"}),"At least 12 characters"]}),e.jsxs("li",{className:"flex items-center "+(b.hasUpperCase?"text-green-600":"text-gray-500"),children:[e.jsx("span",{className:"mr-2 "+(b.hasUpperCase?"text-green-500":"text-gray-400"),children:b.hasUpperCase?"✓":"○"}),"One uppercase letter"]}),e.jsxs("li",{className:"flex items-center "+(b.hasLowerCase?"text-green-600":"text-gray-500"),children:[e.jsx("span",{className:"mr-2 "+(b.hasLowerCase?"text-green-500":"text-gray-400"),children:b.hasLowerCase?"✓":"○"}),"One lowercase letter"]}),e.jsxs("li",{className:"flex items-center "+(b.hasNumber?"text-green-600":"text-gray-500"),children:[e.jsx("span",{className:"mr-2 "+(b.hasNumber?"text-green-500":"text-gray-400"),children:b.hasNumber?"✓":"○"}),"One number"]}),e.jsxs("li",{className:"flex items-center "+(b.hasSpecialChar?"text-green-600":"text-gray-500"),children:[e.jsx("span",{className:"mr-2 "+(b.hasSpecialChar?"text-green-500":"text-gray-400"),children:b.hasSpecialChar?"✓":"○"}),'One special character (!@#$%^&*(),.?":',"|<>)"]})]})]})]}),e.jsxs("div",{className:"mb-5",children:[e.jsxs("label",{className:"block mb-1 font-medium text-blue-800",children:["Confirm New Password",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(t,{name:"confirmPassword",value:l.confirmPassword,onChange:y,onBlur:C,error:g.confirmPassword&&p.confirmPassword,disabled:m,autoComplete:"new-password",placeholder:"Confirm your new password"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(r,{type:"button",variant:"outline",onClick:d,disabled:m,children:"Cancel"}),e.jsx(r,{type:"submit",loading:m,disabled:m||!N,children:"Update Password"})]})]})})};export{o as C};
//# sourceMappingURL=ChangePasswordModal-R7rlcPU-.js.map
