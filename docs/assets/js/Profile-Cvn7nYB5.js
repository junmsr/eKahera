import{j as e}from"./utils-L0j39QIW.js";import{a as s,R as a}from"./vendor-DPJ7iNYg.js";import{P as r}from"./PageLayout-BEcmMmC3.js";import{N as t}from"./Nav-Admin-CQ8wcOl4.js";import{C as n}from"./Card-DXlcOk_J.js";import{b as i,a as l,L as o}from"./index-DaOEzN3b.js";import{F as d}from"./FormField-NRg-OFLz.js";import{h as c,i as m,j as u,k as x}from"./index-D5t29eUG.js";import{B as g}from"./BaseModal-Cy73DE2S.js";import{u as h}from"./useKeyboardShortcuts-CivZ88Rl.js";import{g as b,a as p,b as f,c as y}from"./locationApi-D8IA0i6v.js";import{C as j}from"./ChangePasswordModal-R7rlcPU-.js";import"./Navbar-DkMd9j_-.js";import"./Logo-VxwwEM6B.js";import"./PrivacyPolicyModal-DhQ8er8u.js";import"./Input-DoNyYXSI.js";import"./PasswordInput-B67VXabr.js";function v({name:a,value:r,options:t=[],placeholder:n="Select an option",onChange:i,error:l,disabled:o=!1,searchable:d=!0,className:g="",required:h=!1}){const[b,p]=s.useState(!1),[f,y]=s.useState(""),[j,v]=s.useState(-1),N=s.useRef(null),w=s.useRef(null),k=t.filter(e=>e.label.toLowerCase().includes(f.toLowerCase()));s.useEffect(()=>{const e=e=>{N.current&&!N.current.contains(e.target)&&(p(!1),y(""),v(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),s.useEffect(()=>{const e=e=>{if(b)switch(e.key){case"ArrowDown":e.preventDefault(),v(e=>e<k.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),v(e=>e>0?e-1:k.length-1);break;case"Enter":e.preventDefault(),j>=0&&j<k.length&&_(k[j]);break;case"Escape":p(!1),y(""),v(-1)}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[b,j,k]);const _=e=>{i({target:{name:a,value:e.value}}),p(!1),y(""),v(-1)},C=t.find(e=>e.value===r);return e.jsxs("div",{className:`relative ${g}`,ref:N,children:[e.jsxs("button",{type:"button",onClick:()=>{o||(p(!b),b?(y(""),v(-1)):setTimeout(()=>w.current?.focus(),100))},disabled:o,className:`\n          w-full px-4 py-3 text-left bg-white border rounded-lg shadow-sm transition-all duration-200\n          flex items-center justify-between\n          ${l?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}\n          ${o?"bg-gray-50 text-gray-400 cursor-not-allowed":"hover:border-gray-400 focus:ring-2 focus:outline-none"}\n          ${b?"ring-2 ring-blue-500 border-blue-500":""}\n        `,children:[e.jsx("span",{className:"truncate "+(C?"text-gray-900":"text-gray-500"),children:C?C.label:n}),e.jsxs("div",{className:"flex items-center gap-2",children:[C&&e.jsx(c,{className:"w-4 h-4 text-blue-600 flex-shrink-0"}),b?e.jsx(m,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}):e.jsx(u,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]})]}),b&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg animate-in fade-in slide-in-from-top-2 duration-200",children:[d&&t.length>5&&e.jsx("div",{className:"p-3 border-b border-gray-100",children:e.jsxs("div",{className:"relative",children:[e.jsx(x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{ref:w,type:"text",placeholder:"Search options...",value:f,onChange:e=>{y(e.target.value),v(-1)},className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:outline-none text-sm"})]})}),e.jsx("div",{className:"max-h-60 overflow-y-auto",children:k.length>0?k.map((s,a)=>e.jsxs("button",{type:"button",onClick:()=>_(s),onMouseEnter:()=>v(a),className:`\n                    w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors duration-150\n                    flex items-center justify-between group\n                    ${j===a?"bg-blue-50":""}\n                    ${s.value===r?"bg-blue-50 text-blue-700":"text-gray-900"}\n                  `,children:[e.jsx("span",{className:"truncate",children:s.label}),s.value===r&&e.jsx(c,{className:"w-4 h-4 text-blue-600 flex-shrink-0 ml-2"})]},s.value)):e.jsx("div",{className:"px-4 py-8 text-center text-gray-500 text-sm",children:f?"No options found":"No options available"})}),C&&e.jsxs("div",{className:"px-4 py-2 border-t border-gray-100 bg-gray-50 text-xs text-gray-500",children:["Selected: ",C.label]})]}),l&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),l]})]})}const N=({isOpen:a,onClose:r,userData:t,businessData:n})=>{const[o,c]=s.useState({first_name:t?.first_name||"",last_name:t?.last_name||"",email:t?.email||"",contact_number:t?.contact_number||"",currentPassword:"",newPassword:"",confirmPassword:"",business_name:n?.business_name||"",business_email:n?.email||"",business_type:n?.business_type||"",region:n?.region||"",province:n?.province||"",city:n?.city||"",barangay:n?.barangay||"",house_street:n?.house_number||n?.business_address||n?.address_line||""}),[m,u]=s.useState(!1),[x,j]=s.useState(""),[N,w]=s.useState(""),[k,_]=s.useState({}),[C,P]=s.useState({}),[S,L]=s.useState("account"),[B,z]=s.useState({regions:[],provinces:[],cities:[],barangays:[]}),[A,M]=s.useState({regions:!1,provinces:!1,cities:!1,barangays:!1}),E=s.useRef({region:n?.region||"",province:n?.province||"",city:n?.city||"",barangay:n?.barangay||""});s.useEffect(()=>{(t||n)&&(c({first_name:t?.first_name||"",last_name:t?.last_name||"",email:t?.email||"",contact_number:t?.contact_number||"",currentPassword:"",newPassword:"",confirmPassword:"",business_name:n?.business_name||"",business_email:n?.email||"",business_type:n?.business_type||"",region:n?.region||"",province:n?.province||"",city:n?.city||"",barangay:n?.barangay||"",house_street:n?.house_number||n?.business_address||n?.address_line||""}),j(""),w(""),_({}),P({}),L("account"))},[t,n,a]);const R=(e,s)=>{if(!s)return null;const a=s.toLowerCase().trim();return e.find(e=>e.label.toLowerCase()===a)||null},F=(e,s,a)=>{const r=e.find(e=>e.value===s);return r?r.label:a||""};s.useEffect(()=>{a&&(async()=>{try{M(e=>({...e,regions:!0}));const e=(await b()).map(e=>({value:e.code,label:e.name}));z(s=>({...s,regions:e}))}catch(e){console.error("Failed to load regions",e)}finally{M(e=>({...e,regions:!1}))}})()},[a]),s.useEffect(()=>{if(B.regions.length&&E.current.region&&!o.region){const e=R(B.regions,E.current.region);e&&c(s=>({...s,region:e.value}))}},[B.regions,o.region]),s.useEffect(()=>{(async()=>{if(o.region)try{M(e=>({...e,provinces:!0}));const e=(await p(o.region)).map(e=>({value:e.code,label:e.name}));if(z(s=>({...s,provinces:e,cities:[],barangays:[]})),E.current.province){const s=R(e,E.current.province);s&&c(e=>({...e,province:s.value}))}}catch(e){console.error("Failed to load provinces",e)}finally{M(e=>({...e,provinces:!1}))}else z(e=>({...e,provinces:[],cities:[],barangays:[]}))})()},[o.region]),s.useEffect(()=>{(async()=>{if(o.province)try{M(e=>({...e,cities:!0}));const e=(await f(o.province)).map(e=>({value:e.code,label:e.name}));if(z(s=>({...s,cities:e,barangays:[]})),E.current.city){const s=R(e,E.current.city);s&&c(e=>({...e,city:s.value}))}}catch(e){console.error("Failed to load cities",e)}finally{M(e=>({...e,cities:!1}))}else z(e=>({...e,cities:[],barangays:[]}))})()},[o.province]),s.useEffect(()=>{(async()=>{if(o.city)try{M(e=>({...e,barangays:!0}));const e=(await y(o.city)).map(e=>({value:e.code,label:e.name}));if(z(s=>({...s,barangays:e})),E.current.barangay){const s=R(e,E.current.barangay);s&&c(e=>({...e,barangay:s.value}))}}catch(e){console.error("Failed to load barangays",e)}finally{M(e=>({...e,barangays:!1}))}else z(e=>({...e,barangays:[]}))})()},[o.city]);const I=(e,s)=>{const a={...k};switch(e){case"first_name":"account"!==S||s.trim()?s.trim().length<2?a.first_name="First name must be at least 2 characters":delete a.first_name:a.first_name="First name is required";break;case"last_name":"account"!==S||s.trim()?s.trim().length<2?a.last_name="Last name must be at least 2 characters":delete a.last_name:a.last_name="Last name is required";break;case"email":"account"!==S||s.trim()?s.trim()&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.trim())?a.email="Please enter a valid email":delete a.email:a.email="Email is required";break;case"contact_number":s&&s.trim().length<7?a.contact_number="Phone number must be at least 7 digits":delete a.contact_number;break;case"business_email":s.trim()&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.trim())?a.business_email="Please enter a valid email":delete a.business_email;break;case"currentPassword":o.newPassword&&!s?a.currentPassword="Current password is required to change password":delete a.currentPassword;break;case"newPassword":s&&s.length<6?a.newPassword="Password must be at least 6 characters":delete a.newPassword;break;case"confirmPassword":s&&s!==o.newPassword?a.confirmPassword="Passwords do not match":delete a.confirmPassword}_(a)},O=e=>{const{name:s,value:a}=e.target;c(e=>({...e,[s]:a})),C[s]&&I(s,a)},q=e=>{const{name:s,value:a}=e.target;P(e=>({...e,[s]:!0})),I(s,a)},D=async e=>{if(e.preventDefault(),u(!0),j(""),w(""),"security"===S){if(!o.currentPassword||!o.newPassword||!o.confirmPassword)return w("Please fill in all password fields."),void u(!1);if(o.newPassword!==o.confirmPassword)return w("New password and confirmation do not match."),void u(!1)}try{const e=sessionStorage.getItem("auth_token");if("account"===S||"security"===S){const s={first_name:o.first_name,last_name:o.last_name,email:o.email,contact_number:o.contact_number};o.newPassword&&(s.currentPassword=o.currentPassword,s.newPassword=o.newPassword),await l("/api/auth/update-profile",{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(s)})}else if("business"===S){const s=F(B.regions,o.region,n?.region),a=F(B.provinces,o.province,n?.province),r=F(B.cities,o.city,n?.city),t=F(B.barangays,o.barangay,n?.barangay),i={businessName:o.business_name||void 0,businessType:o.business_type||void 0,businessAddress:[o.house_street,t,r,a,s,o.region||""].filter(Boolean).join(", "),houseNumber:o.house_street||void 0,region:o.region||"",business_email:o.business_email||void 0};await l("/api/business/update-business",{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(i)})}j("Profile updated successfully!"),setTimeout(()=>{r(),window.location.reload()},2e3)}catch(s){console.error("Failed to update profile:",s),w(s.message||"Failed to update profile. Please try again.")}finally{u(!1)}};return s.useEffect(()=>{a&&(L("account"),c({first_name:t?.first_name||"",last_name:t?.last_name||"",email:t?.email||"",contact_number:t?.contact_number||"",currentPassword:"",newPassword:"",confirmPassword:"",business_name:n?.business_name||"",business_email:n?.email||"",business_type:n?.business_type||"",region:n?.region||"",province:n?.province||"",city:n?.city||"",barangay:n?.barangay||"",house_street:n?.house_number||n?.business_address||n?.address_line||""}),_({}),P({}),j(""),w(""))},[a,t,n]),h([{key:"escape",action:r,enabled:a,allowWhileTyping:!0},{key:"enter",action:e=>{a&&(e.preventDefault(),e.stopPropagation(),D(e))},enabled:a&&"security"!==S}],[a,r,D,S]),a?e.jsxs(g,{isOpen:a,onClose:r,title:"Update Password",subtitle:e.jsx("div",{className:"flex flex-col gap-2",children:e.jsx("p",{children:"Cashiers can only change their password here"})}),footer:e.jsxs("div",{className:"w-full flex gap-2 justify-end",children:[e.jsx(i,{label:"Cancel",variant:"secondary",onClick:r,disabled:m}),e.jsx(i,{label:m?"Saving...":"Save Password (Enter)",variant:"primary",onClick:D,disabled:m})]}),children:[x&&e.jsx("div",{className:"text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded-lg px-3 py-2 mb-3",children:x}),N&&e.jsx("div",{className:"text-sm text-red-700 bg-red-50 border border-red-200 rounded-lg px-3 py-2 mb-3",children:N}),e.jsxs("div",{className:"flex gap-1 border-b border-slate-200/10 -mx-6 px-6",children:[e.jsxs("button",{onClick:()=>L("account"),className:"px-4 py-2 rounded-t-xl font-medium transition-all duration-200 relative "+("account"===S?"text-blue-600 bg-blue-50/30":"text-slate-500 hover:text-slate-700"),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Account"]}),"account"===S&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full"})]}),e.jsxs("button",{onClick:()=>L("business"),className:"px-4 py-2 rounded-t-xl font-medium transition-all duration-200 relative "+("business"===S?"text-blue-600 bg-blue-50/30":"text-slate-500 hover:text-slate-700"),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Business"]}),"business"===S&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full"})]}),e.jsxs("button",{onClick:()=>L("security"),className:"px-4 py-2 rounded-t-xl font-medium transition-all duration-200 relative "+("security"===S?"text-blue-600 bg-blue-50/30":"text-slate-500 hover:text-slate-700"),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Security"]}),"security"===S&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full"})]})]}),e.jsxs("form",{onSubmit:D,className:"space-y-6",children:["account"===S&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Personal Information"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent"})]}),e.jsx(d,{label:"First Name",name:"first_name",value:o.first_name,onChange:O,onBlur:q,placeholder:"Enter first name",error:C.first_name&&k.first_name?k.first_name:null,required:!0}),e.jsx(d,{label:"Last Name",name:"last_name",value:o.last_name,onChange:O,onBlur:q,placeholder:"Enter last name",error:C.last_name&&k.last_name?k.last_name:null,required:!0}),e.jsx(d,{label:"Email Address",name:"email",type:"email",value:o.email,onChange:O,onBlur:q,placeholder:"Enter email address",error:C.email&&k.email?k.email:null,required:!0}),e.jsx(d,{label:"Contact Number",name:"contact_number",type:"tel",value:o.contact_number,onChange:O,onBlur:q,placeholder:"Enter phone number",error:C.contact_number&&k.contact_number?k.contact_number:null})]}),"business"===S&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Business Information"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent"})]}),e.jsx(d,{label:"Business Name",name:"business_name",value:o.business_name,onChange:O,onBlur:q,placeholder:"Enter business name",error:C.business_name&&k.business_name?k.business_name:null}),e.jsx(d,{label:"Business Email",name:"business_email",type:"email",value:o.business_email,onChange:O,onBlur:q,placeholder:"Enter business email",error:C.business_email&&k.business_email?k.business_email:null}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"block mb-1 font-medium text-blue-800",children:"Business Type"}),e.jsx(v,{name:"business_type",value:o.business_type,onChange:e=>O(e),options:[{value:"Grocery Store",label:"Grocery Store"},{value:"Retail",label:"Retail"},{value:"Restaurant",label:"Restaurant"},{value:"Cafe",label:"Cafe"},{value:"Pharmacy",label:"Pharmacy"},{value:"Services",label:"Services"},...o.business_type&&!["Grocery Store","Retail","Restaurant","Cafe","Pharmacy","Services"].includes(o.business_type)?[{value:o.business_type,label:o.business_type}]:[]],placeholder:"Select business type",error:C.business_type&&k.business_type?k.business_type:null})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 pt-2",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Business Location"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent"})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"block mb-1 font-medium text-blue-800",children:"Region"}),e.jsx(v,{name:"region",value:o.region,options:B.regions,onChange:e=>O({target:{name:"region",value:e.target.value}}),placeholder:A.regions?"Loading regions...":"Select Region",disabled:A.regions,error:C.region&&k.region?k.region:null})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"block mb-1 font-medium text-blue-800",children:"Province"}),e.jsx(v,{name:"province",value:o.province,options:B.provinces,onChange:e=>O({target:{name:"province",value:e.target.value}}),placeholder:A.provinces?"Loading provinces...":"Select Province",disabled:!o.region||A.provinces,error:C.province&&k.province?k.province:null})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"block mb-1 font-medium text-blue-800",children:"City/Municipality"}),e.jsx(v,{name:"city",value:o.city,options:B.cities,onChange:e=>O({target:{name:"city",value:e.target.value}}),placeholder:A.cities?"Loading cities...":"Select City/Municipality",disabled:!o.province||A.cities,error:C.city&&k.city?k.city:null})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"block mb-1 font-medium text-blue-800",children:"Barangay"}),e.jsx(v,{name:"barangay",value:o.barangay,options:B.barangays,onChange:e=>O({target:{name:"barangay",value:e.target.value}}),placeholder:A.barangays?"Loading barangays...":"Select Barangay",disabled:!o.city||A.barangays,error:C.barangay&&k.barangay?k.barangay:null})]}),e.jsx(d,{label:"House no./ Street Name / Landmark (optional)",name:"house_street",value:o.house_street,onChange:O,onBlur:q,placeholder:"Enter house number, street, or landmark",error:C.house_street&&k.house_street?k.house_street:null})]}),"security"===S&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Change Password"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent"})]}),e.jsx("p",{className:"text-xs text-slate-500 bg-amber-50 border border-amber-100/50 rounded-xl px-3 py-2",children:"Leave blank to keep your current password"}),e.jsx(d,{label:"Current Password",name:"currentPassword",type:"password",value:o.currentPassword,onChange:O,onBlur:q,placeholder:"Enter current password",error:C.currentPassword&&k.currentPassword?k.currentPassword:null}),o.newPassword&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"Password Strength"}),e.jsx("div",{className:"w-full h-1.5 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300 "+(o.newPassword.length>=12?"w-full bg-gradient-to-r from-green-500 to-emerald-500":o.newPassword.length>=8?"w-2/3 bg-gradient-to-r from-yellow-500 to-amber-500":"w-1/3 bg-gradient-to-r from-red-500 to-orange-500")})})]}),e.jsx(d,{label:"New Password",name:"newPassword",type:"password",value:o.newPassword,onChange:O,onBlur:q,placeholder:"Min. 6 characters",error:C.newPassword&&k.newPassword?k.newPassword:null}),e.jsx(d,{label:"Confirm Password",name:"confirmPassword",type:"password",value:o.confirmPassword,onChange:O,onBlur:q,placeholder:"Re-enter new password",error:C.confirmPassword&&k.confirmPassword?k.confirmPassword:null})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-gray-100 mt-6",children:[e.jsx(i,{label:"Cancel",variant:"secondary",onClick:r,disabled:m,type:"button"}),e.jsx(i,{label:m?"Saving...":"Save Changes",variant:"primary",type:"submit",disabled:m})]})]})]}):null},w=s=>e.jsx("svg",{className:`w-5 h-5 ${s.className||""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),k=s=>e.jsx("svg",{className:`w-5 h-5 ${s.className||""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),_=s=>e.jsx("svg",{className:`w-5 h-5 ${s.className||""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),C=s=>e.jsx("svg",{className:`w-5 h-5 ${s.className||""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),P=s=>e.jsx("svg",{className:`w-5 h-5 ${s.className||""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),S=s=>e.jsxs("svg",{className:`w-5 h-5 ${s.className||""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),L=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),B=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),z=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),A=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),M=e=>{const s=e?.business?.business_id||e?.user?.businessId||JSON.parse(sessionStorage.getItem("user")||"{}")?.businessId||JSON.parse(localStorage.getItem("user")||"{}")?.businessId;if(!s)return{url:"N/A",qrSrc:null,businessId:null};const a=new URL(window.location.origin+"/enter-store");a.searchParams.set("business_id",String(s));const r=a.toString(),t=encodeURIComponent(r);return{url:r,qrSrc:`https://api.qrserver.com/v1/create-qr-code/?size=260x260&data=${t}&qzone=2&format=png&_=${Date.now()}`,downloadSrc:`https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${t}&qzone=2&format=png&_=${Date.now()}`,businessId:s}},E=()=>{const[d,c]=s.useState(null),[m,u]=s.useState(!0),[x,h]=s.useState(""),[b,p]=s.useState(!1),[f,y]=s.useState(!1),[v,E]=s.useState({status:"none"}),[R,F]=s.useState(""),[I,O]=s.useState(""),[q,D]=s.useState(!1),[U,W]=s.useState(!1),[$,T]=s.useState(""),[H,V]=s.useState(!1),[J,Y]=s.useState(!1),[Q,G]=s.useState(!1),[K,X]=s.useState({first_name:"",last_name:"",email:"",contact_number:""}),[Z,ee]=s.useState(!1),[se,ae]=s.useState(!1),[re,te]=s.useState(""),[ne,ie]=s.useState(!1),[le,oe]=s.useState({business_name:"",business_type:"",email:"",region:"",province:"",city:"",barangay:"",house_number:""}),[de,ce]=s.useState(!1),[me,ue]=s.useState(!1),[xe,ge]=s.useState(""),he=e=>e?"cancelled"===e.status?{status:"none"}:e:{status:"none"};s.useEffect(()=>{pe(),(async()=>{try{D(!0);const e=await l("/api/business/delete-request"),s=he(e?.deletion);E(s),F("pending"===s.status&&e?.message||"")}catch(e){O(e?.message||"Could not load deletion status. Please try again.")}finally{D(!1)}})()},[]);const be=e=>{if(!e)return null;const s=(e.business_address||"").split(",").map(e=>e.trim()).filter(Boolean);for(;s.length&&/philippines?/i.test(s[s.length-1]);)s.pop();const a=s.length,r=a>=1?s[a-1]:"",t=a>=2?s[a-2]:"",n=a>=3?s[a-3]:"",i=a>3?s.slice(0,a-3).join(", "):s[0]||"";return{...e,address_line:e.address_line||e.business_address||"",region:e.region||e.regionName||e.region_name||e.region_name||"",province:e.province||e.provinceName||r||"",city:e.city||e.cityName||t||"",barangay:e.barangay||e.barangayName||n||"",house_number:e.house_number||e.houseNumber||i||""}},pe=async()=>{try{u(!0),h("");const s=sessionStorage.getItem("auth_token")||localStorage.getItem("auth_token")||localStorage.getItem("token");s&&!sessionStorage.getItem("auth_token")&&sessionStorage.setItem("auth_token",s),console.log("Fetching profile data from /auth/profile");const a=await l("/auth/profile"),r={...a,business:be(a.business)};if(r.business&&!r.business.region)try{if(!locationsCacheRef.current){const e=await l("/location/locations");locationsCacheRef.current=e}const e=fe(locationsCacheRef.current,r.business.province,r.business.city);e&&(r.business.region=e)}catch(e){console.warn("Failed to derive region from locations:",e)}console.log("Profile data received:",r),c(r)}catch(s){console.error("Failed to fetch profile data:",s),h("Failed to load profile information. Please check your connection and try again.")}finally{u(!1)}},fe=(e,s,a)=>{if(!e||!s&&!a)return"";const r=(s||"").toLowerCase().trim(),t=(a||"").toLowerCase().trim();for(const[n,i]of Object.entries(e))for(const e of Object.keys(i.provinces||{})){const s=e.toLowerCase();if(r&&s===r)return n;if(t&&s===t)return n}return""},ye=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",je=()=>{G(!1),X({first_name:"",last_name:"",email:"",contact_number:""}),te("")},ve=()=>{ie(!1),oe({business_name:"",business_type:"",email:"",region:"",province:"",city:"",barangay:"",house_number:""}),ge("")},Ne=e.jsxs("div",{className:"flex items-center justify-end gap-2 sm:gap-3",children:[e.jsx(i,{onClick:pe,variant:"secondary",size:"sm",icon:e.jsx(L,{}),iconPosition:"left",className:"whitespace-nowrap [&>span]:hidden sm:[&>span]:inline",children:e.jsx("span",{children:"Refresh"})}),e.jsx(i,{onClick:()=>Y(!0),variant:"secondary",size:"sm",icon:e.jsx(z,{}),iconPosition:"left",className:"whitespace-nowrap [&>span]:hidden sm:[&>span]:inline",children:e.jsx("span",{children:"Change Password"})})]});return m?e.jsx(r,{title:"PROFILE",subtitle:"Store and admin credentials",sidebar:e.jsx(t,{}),isSidebarOpen:b,setSidebarOpen:p,className:"bg-gray-50",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(o,{})})}):e.jsxs(r,{title:"PROFILE",subtitle:"",sidebar:e.jsx(t,{}),headerActions:Ne,isSidebarOpen:b,setSidebarOpen:p,className:"bg-gray-50",children:[e.jsx(N,{isOpen:f,onClose:()=>y(!1),userData:d?.user,businessData:d?.business}),e.jsx(j,{isOpen:J,onClose:()=>Y(!1)}),e.jsx(g,{isOpen:Z,onClose:()=>ee(!1),title:"Confirm Save Changes",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Warning: This action cannot be undone"}),e.jsx("p",{className:"text-sm text-gray-600",children:"You are about to save changes to your account information. This action cannot be undone. Are you sure you want to proceed?"})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-200",children:[e.jsx(i,{onClick:()=>ee(!1),variant:"secondary",size:"md",disabled:se,children:"Cancel"}),e.jsx(i,{onClick:async()=>{ae(!0),te("");try{await l("/auth/update-profile",{method:"PUT",body:JSON.stringify(K)}),await pe(),G(!1),ee(!1)}catch(e){console.error("Failed to update profile:",e),te(e.message||"Failed to update profile. Please try again.")}finally{ae(!1)}},variant:"primary",size:"md",disabled:se,children:se?"Saving...":"Yes, Save Changes"})]})]})}),e.jsx(g,{isOpen:de,onClose:()=>ce(!1),title:"Confirm Save Changes",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Warning: This action cannot be undone"}),e.jsx("p",{className:"text-sm text-gray-600",children:"You are about to save changes to your store information. This action cannot be undone. Are you sure you want to proceed?"})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-200",children:[e.jsx(i,{onClick:()=>ce(!1),variant:"secondary",size:"md",disabled:me,children:"Cancel"}),e.jsx(i,{onClick:async()=>{ue(!0),ge("");try{let e;if(le.house_number!==(d?.business?.house_number||"")||le.barangay!==(d?.business?.barangay||"")||le.city!==(d?.business?.city||"")||le.province!==(d?.business?.province||"")){e=[le.house_number,le.barangay,le.city,le.province].filter(Boolean).join(", ")}const s={businessName:le.business_name,businessType:le.business_type,email:le.email,region:le.region,houseNumber:le.house_number};void 0!==e&&(s.businessAddress=e),await l("/api/business/profile",{method:"PUT",body:JSON.stringify(s)}),await pe(),ie(!1),ce(!1)}catch(e){console.error("Failed to update store profile:",e),ge(e.message||"Failed to update store profile. Please try again.")}finally{ue(!1)}},variant:"primary",size:"md",disabled:me,children:me?"Saving...":"Yes, Save Changes"})]})]})}),(Q||ne)&&e.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm z-40",onClick:()=>{Q&&je(),ne&&ve()}}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6 "+(Q||ne?"relative z-50":""),children:[x&&e.jsx(n,{className:"bg-gradient-to-br from-red-50 to-orange-50 border-red-200/50",children:e.jsxs("div",{className:"flex items-start gap-4 p-4",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-red-900 mb-1",children:"Error Loading Profile"}),e.jsx("p",{className:"text-sm text-red-700",children:x})]})]})}),!m&&!x&&!d&&e.jsx(n,{className:"bg-gradient-to-br from-gray-50 to-blue-50/30 border-gray-200/50",children:e.jsxs("div",{className:"p-8 md:p-12 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-gray-200 to-gray-300 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx("svg",{className:"w-10 h-10 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No Profile Data Available"}),e.jsx("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:"Unable to load your profile information. Please try refreshing or check your connection."}),e.jsx(i,{onClick:pe,variant:"primary",size:"md",icon:e.jsx(L,{}),iconPosition:"left",children:"Try Again"})]})}),d&&e.jsxs(a.Fragment,{children:[e.jsx(n,{className:"bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border-blue-200/50 overflow-hidden",children:e.jsx("div",{className:"p-6 md:p-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center gap-6 lg:gap-8",children:[e.jsx("div",{className:"flex-shrink-0 w-full lg:w-auto",children:e.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-5 border border-white/50 shadow-lg hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-400 via-indigo-500 to-purple-500 rounded-2xl blur-xl opacity-30 group-hover:opacity-40 transition-opacity duration-300"}),e.jsx("div",{className:"relative bg-white p-3 rounded-xl shadow-md",children:e.jsx("img",{src:M(d).qrSrc,alt:"Store Entry QR Code",className:"w-[180px] h-[180px] md:w-[200px] md:h-[200px] rounded-lg"})})]}),e.jsx(i,{variant:"primary",size:"md",icon:e.jsx(A,{}),iconPosition:"left",onClick:async()=>{const{downloadSrc:e,businessId:s}=M(d);if(e)try{const a=await fetch(e);if(!a.ok)throw new Error("Failed to fetch QR code image");const r=await a.blob(),t=window.URL.createObjectURL(r),n=document.createElement("a");n.href=t,n.download=`store-${s||"qr"}.png`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(t)}catch(a){console.error("Error downloading QR code:",a),alert("Failed to download QR code. Please try again.")}else alert("Business ID not found to generate QR code.")},className:"w-full min-w-[200px] shadow-md hover:shadow-lg transition-all duration-200",children:"Download QR Code"})]})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-2",children:d?.business?.business_name||"Admin User"}),e.jsxs("p",{className:"text-gray-600 mb-4 flex items-center gap-2",children:[e.jsx(k,{}),e.jsx("span",{className:"truncate",children:d?.user?.email||"N/A"})]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:e.jsxs("span",{className:"inline-flex items-center gap-2 px-4 py-1.5 rounded-full text-sm font-semibold bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 border border-blue-200",children:[e.jsx("div",{className:"w-5 h-5 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(P,{className:"w-3 h-3 text-blue-600"})}),e.jsxs("span",{children:[d?.user?.role?.replace("_"," ").toUpperCase()||"ADMIN",d?.business?.business_type&&` â€¢ ${d.business.business_type}`]})]})})]})]})})}),e.jsx(n,{className:"bg-white shadow-sm "+(Q?"relative z-50 shadow-2xl":""),children:e.jsxs("div",{className:"p-6 md:p-8",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-xl flex items-center justify-center mr-3",children:e.jsx(w,{})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Account Information"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Personal details and credentials"})]})]}),!Q&&e.jsx("button",{onClick:()=>{d?.user&&(X({first_name:d.user.first_name||"",last_name:d.user.last_name||"",email:d.user.email||"",contact_number:d.user.contact_number||""}),G(!0),te(""))},className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit Account Information",children:e.jsx(B,{})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"First Name"}),Q?e.jsxs("div",{className:"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-blue-300",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(w,{className:"text-blue-600"})}),e.jsx("input",{type:"text",value:K.first_name,onChange:e=>X({...K,first_name:e.target.value}),className:"text-gray-900 font-medium flex-1 outline-none bg-transparent",placeholder:"First Name"})]}):e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(w,{className:"text-blue-600"})}),e.jsx("span",{className:"text-gray-900 font-medium flex-1",children:d?.user?.first_name||"N/A"})]})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Last Name"}),Q?e.jsxs("div",{className:"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-blue-300",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(w,{className:"text-blue-600"})}),e.jsx("input",{type:"text",value:K.last_name,onChange:e=>X({...K,last_name:e.target.value}),className:"text-gray-900 font-medium flex-1 outline-none bg-transparent",placeholder:"Last Name"})]}):e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(w,{className:"text-blue-600"})}),e.jsx("span",{className:"text-gray-900 font-medium flex-1",children:d?.user?.last_name||"N/A"})]})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Email Address"}),Q?e.jsxs("div",{className:"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-blue-300",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(k,{className:"text-blue-600"})}),e.jsx("input",{type:"email",value:K.email,onChange:e=>X({...K,email:e.target.value}),className:"text-gray-900 font-medium flex-1 outline-none bg-transparent",placeholder:"Email Address"})]}):e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(k,{className:"text-blue-600"})}),e.jsx("span",{className:"text-gray-900 font-medium flex-1 truncate",children:d?.user?.email||"N/A"})]})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Role"}),e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50",children:[e.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200 capitalize",children:d?.user?.role?.replace("_"," ")||"N/A"})]})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Contact Number"}),Q?e.jsxs("div",{className:"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-blue-300",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(_,{className:"text-green-600"})}),e.jsx("input",{type:"tel",value:K.contact_number,onChange:e=>X({...K,contact_number:e.target.value}),className:"text-gray-900 font-medium flex-1 outline-none bg-transparent",placeholder:"Contact Number"})]}):e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(_,{className:"text-green-600"})}),e.jsx("span",{className:"text-gray-900 font-medium flex-1",children:d?.user?.contact_number||"N/A"})]})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Account Created"}),e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(C,{className:"text-purple-600"})}),e.jsx("span",{className:"text-gray-900 font-medium flex-1",children:ye(d?.user?.created_at)})]})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Last Updated"}),e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(C,{className:"text-orange-600"})}),e.jsx("span",{className:"text-gray-900 font-medium flex-1",children:ye(d?.user?.updated_at)})]})]})]})]}),Q&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[re&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:re}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-end",children:[e.jsx(i,{onClick:je,variant:"secondary",size:"md",disabled:se,children:"Cancel"}),e.jsx(i,{onClick:()=>ee(!0),variant:"primary",size:"md",disabled:se,children:se?"Saving...":"Save Changes"})]})]})]})}),e.jsx(n,{className:"bg-white shadow-sm "+(ne?"relative z-50 shadow-2xl":""),children:e.jsxs("div",{className:"p-6 md:p-8",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 text-white rounded-xl flex items-center justify-center mr-3",children:e.jsx(P,{})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Store Information"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Business details and credentials"})]})]}),!ne&&e.jsx("button",{onClick:()=>{d?.business&&(oe({business_name:d.business.business_name||"",business_type:d.business.business_type||"",email:d.business.email||"",region:d.business.region||"",province:d.business.province||"",city:d.business.city||"",barangay:d.business.barangay||"",house_number:d.business.house_number||""}),ie(!0),ge(""))},className:"p-2 text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Edit Store Information",children:e.jsx(B,{})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Business Name"}),ne?e.jsxs("div",{className:"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-green-300",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(P,{className:"text-green-600"})}),e.jsx("input",{type:"text",value:le.business_name,onChange:e=>oe({...le,business_name:e.target.value}),className:"text-gray-900 font-medium flex-1 outline-none bg-transparent",placeholder:"Business Name"})]}):e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(P,{className:"text-green-600"})}),e.jsx("span",{className:"text-gray-900 font-medium flex-1",children:d?.business?.business_name||"N/A"})]})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Business Email"}),ne?e.jsxs("div",{className:"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-green-300",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(k,{className:"text-blue-600"})}),e.jsx("input",{type:"email",value:le.email,onChange:e=>oe({...le,email:e.target.value}),className:"text-gray-900 font-medium flex-1 outline-none bg-transparent",placeholder:"Business Email"})]}):e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(k,{className:"text-blue-600"})}),e.jsx("span",{className:"text-gray-900 font-medium flex-1 truncate",children:d?.business?.email||"N/A"})]})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Region"}),ne?e.jsxs("div",{className:"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-green-300",children:[e.jsx("div",{className:"w-8 h-8 bg-teal-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"text-teal-600"})}),e.jsx("input",{type:"text",value:le.region,onChange:e=>oe({...le,region:e.target.value}),className:"text-gray-900 font-medium flex-1 outline-none bg-transparent",placeholder:"Region"})]}):e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-teal-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"text-teal-600"})}),e.jsx("span",{className:"text-gray-900 font-medium flex-1",children:d?.business?.region||"N/A"})]})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Province"}),ne?e.jsxs("div",{className:"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-green-300",children:[e.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"text-emerald-600"})}),e.jsx("input",{type:"text",value:le.province,onChange:e=>oe({...le,province:e.target.value}),className:"text-gray-900 font-medium flex-1 outline-none bg-transparent",placeholder:"Province"})]}):e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"text-emerald-600"})}),e.jsx("span",{className:"text-gray-900 font-medium flex-1",children:d?.business?.province||"N/A"})]})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Business Type"}),e.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50",children:[e.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),e.jsx("span",{className:"text-gray-900 font-medium flex-1",children:d?.business?.business_type||"N/A"})]})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"Business Location"}),ne?e.jsx("div",{className:"bg-white px-4 py-3 rounded-xl border-2 border-green-300",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"City/Municipality"}),e.jsx("input",{type:"text",value:le.city,onChange:e=>oe({...le,city:e.target.value}),className:"text-gray-900 font-medium w-full outline-none bg-transparent border-b border-gray-300 focus:border-green-500",placeholder:"City/Municipality"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"text-indigo-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Barangay"}),e.jsx("input",{type:"text",value:le.barangay,onChange:e=>oe({...le,barangay:e.target.value}),className:"text-gray-900 font-medium w-full outline-none bg-transparent border-b border-gray-300 focus:border-green-500",placeholder:"Barangay"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx(S,{className:"text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"House no./ Street Name / Landmark (optional)"}),e.jsx("input",{type:"text",value:le.house_number,onChange:e=>oe({...le,house_number:e.target.value}),className:"text-gray-900 font-medium w-full outline-none bg-transparent border-b border-gray-300 focus:border-green-500",placeholder:"House no./ Street Name / Landmark"})]})]})]})}):e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"City/Municipality"}),e.jsx("div",{className:"text-gray-900 font-medium",children:d?.business?.city||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(S,{className:"text-indigo-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Barangay"}),e.jsx("div",{className:"text-gray-900 font-medium",children:d?.business?.barangay||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx(S,{className:"text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"House no./ Street Name / Landmark (optional)"}),e.jsx("div",{className:"text-gray-900 font-medium",children:d?.business?.house_number||"N/A"})]})]})]})})]})]})]}),ne&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[xe&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:xe}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-end",children:[e.jsx(i,{onClick:ve,variant:"secondary",size:"md",disabled:me,children:"Cancel"}),e.jsx(i,{onClick:()=>ce(!0),variant:"primary",size:"md",disabled:me,children:me?"Saving...":"Save Changes"})]})]})]})}),d?.business?.users&&d.business.users.length>0&&e.jsx(e.Fragment,{children:(()=>{const s=d.business.users.filter(e=>"admin"===e.user_type_name||"cashier"===e.user_type_name||"admin"===e.role||"cashier"===e.role||"business_owner"===e.role);return e.jsx(n,{className:"bg-white shadow-sm",children:e.jsxs("div",{className:"p-6 md:p-8",children:[e.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b border-gray-200",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br bg-blue-500 text-white rounded-xl flex items-center justify-center mr-3",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Business Team"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["All users associated with this business (",s.length," total)"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:s.map((s,a)=>e.jsxs("div",{className:"group bg-gradient-to-br from-white to-gray-50/50 rounded-2xl p-5 border border-gray-200/50 hover:border-purple-300 hover:shadow-lg transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br bg-blue-500 text-white rounded-xl flex items-center justify-center text-lg font-bold shadow-md ring-2 ring-white",children:s.first_name?.charAt(0)?.toUpperCase()||s.username?.charAt(0)?.toUpperCase()||"U"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[e.jsx("h4",{className:"font-bold text-gray-900 truncate",children:s.first_name&&s.last_name?`${s.first_name} ${s.last_name}`:s.first_name||s.last_name||s.username||"N/A"}),e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold mt-1 "+("admin"===s.user_type_name||"business_owner"===s.role?"bg-red-100 text-red-800 border border-red-200":"cashier"===s.user_type_name||"cashier"===s.role?"bg-green-100 text-green-800 border border-green-200":"bg-gray-100 text-gray-800 border border-gray-200"),children:s.user_type_name||s.role})]})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[s.username&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(w,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-0.5",children:"Username"}),e.jsx("div",{className:"font-medium text-gray-900 truncate",children:s.username})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(k,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-0.5",children:"Email"}),e.jsx("div",{className:"font-medium text-gray-900 truncate",children:s.email})]})]}),s.contact_number&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-0.5",children:"Contact"}),e.jsx("div",{className:"font-medium text-gray-900",children:s.contact_number})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(C,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-0.5",children:"Joined"}),e.jsx("div",{className:"font-medium text-gray-900",children:ye(s.created_at)})]})]})]})]},s.user_id))})]})})})()}),e.jsx(n,{className:"border-red-100 border-2 mt-6",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-red-900",children:"Delete Your Store"}),e.jsx("p",{className:"text-sm text-red-600",children:"This action cannot be undone after 30 days"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-700",children:"Download all transactions then schedule deletion with a 30-day recovery window."}),R&&e.jsx("div",{className:"text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded-lg px-3 py-2",children:R}),I&&e.jsx("div",{className:"text-sm text-red-700 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:I}),"pending"===v.status&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs text-gray-700 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Status:"}),e.jsx("span",{className:"px-2 py-1 rounded-full border text-xs",children:v.status||"none"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Scheduled:"})," ",ye(v.scheduledFor)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Requested:"})," ",ye(v.requestedAt)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Export ready:"})," ",ye(v.exportReadyAt)||"N/A"]})]}),e.jsxs("div",{className:"space-y-4",children:[H?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enter your password to confirm"}),e.jsx("input",{type:"password",className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"Your account password",value:$,onChange:e=>T(e.target.value),disabled:q})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(i,{label:"Cancel",variant:"secondary",onClick:()=>{V(!1),T(""),O("")},disabled:q}),e.jsx(i,{label:q?"Processing...":"Confirm Deletion",variant:"danger",onClick:async()=>{if(O(""),F(""),$){D(!0);try{const e=await l("/api/business/delete-request",{method:"POST",body:JSON.stringify({password:$})});E(e?.deletion||{status:"pending"}),F(e?.message||"Deletion request recorded with a 30-day grace period."),V(!1),T("")}catch(e){O(e?.message||"Could not request deletion. Please check your password and try again.")}finally{D(!1)}}else O("Please enter your password to confirm deletion.")},disabled:q||!$})]})]}):e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(i,{label:U?"Preparing...":"Download transactions",variant:"secondary",onClick:async()=>{O(""),W(!0);try{const e=await l("/api/business/delete-request/export",{method:"GET"},!0),s=await e.blob(),a=window.URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download="transactions-export."+(s.type.includes("gzip")?"gz":"json"),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(a)}catch(e){O(e?.message||"Failed to download export. Please try again.")}finally{W(!1)}},disabled:U,icon:e.jsx(A,{})}),e.jsx(i,{label:"Delete store",variant:"danger",onClick:()=>V(!0),disabled:q||"pending"===v.status})]}),"pending"===v.status&&e.jsx(i,{label:"Cancel Deletion",variant:"secondary",onClick:async()=>{O(""),F(""),D(!0);try{const e=await l("/api/business/delete-request/cancel",{method:"POST"}),s=he(e?.deletion);E(s),F("")}catch(e){O(e?.message||"Could not cancel deletion. Please try again.")}finally{D(!1)}},disabled:q,className:"mt-2"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"You can recover the account within 30 days. After that, the store is permanently removed."})]})]})]})})]})]})]})};export{E as default};
//# sourceMappingURL=Profile-Cvn7nYB5.js.map
