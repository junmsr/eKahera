{"version":3,"file":"Logs-2OfepBfA.js","sources":["../../../frontend/src/pages/Logs.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState, useRef } from \"react\";\r\nimport NavAdmin from \"../components/layout/Nav-Admin\";\r\nimport { BiRefresh, BiCalendarAlt } from \"react-icons/bi\";\r\nimport PageLayout from \"../components/layout/PageLayout\";\r\nimport Button from \"../components/common/Button\";\r\nimport { api, authHeaders } from \"../lib/api\";\r\nimport dayjs from \"dayjs\";\r\nimport DateRangeFilterModal from \"../components/modals/DateRangeFilterModal\";\r\n\r\nconst LogsPage = () => {\r\n  const [logs, setLogs] = useState([]);\r\n  const [error, setError] = useState(\"\");\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [clearing, setClearing] = useState(false);\r\n  const [dateRange, setDateRange] = useState({\r\n    startDate: dayjs().startOf('month'),\r\n    endDate: dayjs().endOf('day'),\r\n    rangeType: 'Month'\r\n  });\r\n  const [roleFilter, setRoleFilter] = useState(\"all\");\r\n  const [sortOrder, setSortOrder] = useState(\"desc\");\r\n  const [isDropdownOpen, setIsDropdownOpen] = useState(false);\r\n  const [isSidebarOpen, setSidebarOpen] = useState(false);\r\n  const [showFilterModal, setShowFilterModal] = useState(false);\r\n  const dropdownRef = useRef(null);\r\n  \r\n  const headerDateDisplay = useMemo(() => {\r\n    if (!dateRange.startDate || !dateRange.endDate) return \"Select Range\";\r\n    \r\n    const start = dayjs(dateRange.startDate);\r\n    const end = dayjs(dateRange.endDate);\r\n    const diff = end.diff(start, 'day') + 1;\r\n    \r\n    if (dateRange.rangeType === 'Day') {\r\n      return start.format('MMM D, YYYY');\r\n    } else if (dateRange.rangeType === 'Week') {\r\n      return `${start.format('MMM D')} - ${end.format('MMM D, YYYY')} (${diff} days)`;\r\n    } else if (dateRange.rangeType === 'Month') {\r\n      return `${start.format('MMM YYYY')} (${diff} days)`;\r\n    } else {\r\n      return `${start.format('MMM D, YYYY')} - ${end.format('MMM D, YYYY')} (${diff} days)`;\r\n    }\r\n  }, [dateRange]);\r\n\r\n  const fetchLogs = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(\"\");\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n      \r\n      // Format dates for the API\r\n      const params = {};\r\n      if (dateRange.startDate) {\r\n        params.startDate = dayjs(dateRange.startDate).format('YYYY-MM-DD');\r\n      }\r\n      if (dateRange.endDate) {\r\n        params.endDate = dayjs(dateRange.endDate).format('YYYY-MM-DD');\r\n      }\r\n      \r\n      const data = await api(\"/api/logs\", {\r\n        headers: authHeaders(token),\r\n        params,\r\n      });\r\n      const normalized = (data || []).map((l) => ({\r\n        id: l.log_id,\r\n        userId: l.user_id,\r\n        username: l.username || \"\",\r\n        action: l.action || `Action by ${l.username || l.user_id}`,\r\n        time: l.date_time\r\n          ? new Date(l.date_time).toLocaleString()\r\n          : \"Invalid date\",\r\n        dateTime: l.date_time,\r\n        role: (l.role === \"business_owner\"\r\n          ? \"admin\"\r\n          : l.role || \"\"\r\n        ).toLowerCase(),\r\n      }));\r\n      setLogs(normalized);\r\n    } catch (err) {\r\n      setError(\"Failed to load logs\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchLogs();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\r\n        setIsDropdownOpen(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener(\"mousedown\", handleClickOutside);\r\n    };\r\n  }, []);\r\n\r\n  const filteredLogs = useMemo(() => {\r\n    let filtered = logs;\r\n\r\n    if (roleFilter !== \"all\") {\r\n      filtered = filtered.filter((l) => {\r\n        if (roleFilter === 'customer') {\r\n          return l.role === 'user' || l.role === 'customer';\r\n        }\r\n        return l.role === roleFilter;\r\n      });\r\n    }\r\n\r\n    if (searchQuery) {\r\n      const query = searchQuery.toLowerCase();\r\n      filtered = filtered.filter(\r\n        (l) =>\r\n          (l.action || \"\").toLowerCase().includes(query) ||\r\n          (l.username || \"\").toLowerCase().includes(query)\r\n      );\r\n    }\r\n\r\n    // Apply date range filter\r\n    if (dateRange.startDate) {\r\n      const startDate = dayjs(dateRange.startDate).startOf('day');\r\n      const endDate = dateRange.endDate ? dayjs(dateRange.endDate).endOf('day') : dayjs().endOf('day');\r\n      \r\n      filtered = filtered.filter(log => {\r\n        const logDate = dayjs(log.dateTime);\r\n        return logDate.isBetween(startDate, endDate, null, '[]');\r\n      });\r\n    }\r\n\r\n    filtered.sort((a, b) => {\r\n      const dateA = new Date(a.dateTime);\r\n      const dateB = new Date(b.dateTime);\r\n      return sortOrder === \"asc\" ? dateA - dateB : dateB - dateA;\r\n    });\r\n\r\n    return filtered;\r\n  }, [logs, roleFilter, searchQuery, sortOrder, dateRange]);\r\n\r\n  const exportToCSV = () => {\r\n    try {\r\n      const headers = [\"Customer ID\", \"Customer Name\", \"Role\", \"Action\", \"Time\"];\r\n\r\n      const csvRows = [\r\n        headers.join(\",\"),\r\n        ...filteredLogs.map((log) => {\r\n          const row = [\r\n            log.userId || log.id || \"\",\r\n            `\"${(log.username || \"\").replace(/\"/g, '\"\"')}\"`,\r\n            log.role || \"\",\r\n            `\"${(log.action || \"\").replace(/\"/g, '\"\"')}\"`,\r\n            `\"${(log.time || \"\").replace(/\"/g, '\"\"')}\"`,\r\n          ];\r\n          return row.join(\",\");\r\n        }),\r\n      ];\r\n\r\n      const csvContent = csvRows.join(\"\\n\");\r\n\r\n      const blob = new Blob([csvContent], { type: \"text/csv;charset=utf-8;\" });\r\n      const link = document.createElement(\"a\");\r\n      const url = URL.createObjectURL(blob);\r\n      link.setAttribute(\"href\", url);\r\n      link.setAttribute(\r\n        \"download\",\r\n        `logs_export_${new Date().toISOString().split(\"T\")[0]}.csv`\r\n      );\r\n      link.style.visibility = \"hidden\";\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n    } catch (err) {\r\n      setError(\"Failed to export logs as CSV\");\r\n      console.error(\"CSV export error:\", err);\r\n    }\r\n  };\r\n\r\n  const clearLogs = async () => {\r\n    if (\r\n      !window.confirm(\r\n        \"Are you sure you want to clear all logs? This action cannot be undone.\"\r\n      )\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setClearing(true);\r\n      setError(\"\");\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n\r\n      try {\r\n        await api(\"/api/logs\", {\r\n          method: \"DELETE\",\r\n          headers: authHeaders(token),\r\n        });\r\n      } catch (deleteErr) {\r\n        if (\r\n          deleteErr.message.includes(\"404\") ||\r\n          deleteErr.message.includes(\"Not Found\")\r\n        ) {\r\n          setError(\r\n            \"Clear logs endpoint not available. Please contact administrator.\"\r\n          );\r\n          return;\r\n        }\r\n        throw deleteErr;\r\n      }\r\n\r\n      await fetchLogs();\r\n    } catch (err) {\r\n      setError(\"Failed to clear logs\");\r\n    } finally {\r\n      setClearing(false);\r\n    }\r\n  };\r\n\r\n  const roleOptions = [\r\n    { value: \"all\", label: \"All Roles\" },\r\n    { value: \"cashier\", label: \"Cashier\" },\r\n    { value: \"admin\", label: \"Admin\" },\r\n    { value: \"customer\", label: \"Customer\" },\r\n  ];\r\n\r\n  const selectedRole = roleOptions.find(\r\n    (option) => option.value === roleFilter\r\n  );\r\n\r\n  const headerActions = (\r\n    <div className=\"flex items-center gap-3\">\r\n      <button\r\n        onClick={fetchLogs}\r\n        disabled={loading}\r\n        title=\"Refresh Logs\"\r\n        className=\"bg-white/80 backdrop-blur-sm hover:bg-white text-gray-700 p-2 rounded-lg border border-gray-200/80 text-sm font-medium transition-all duration-200 hover:shadow-md\"\r\n      >\r\n        <BiRefresh className={`w-5 h-5 ${loading ? \"animate-spin\" : \"\"}`} />\r\n      </button>\r\n\r\n      <button\r\n        onClick={() => setShowFilterModal(true)}\r\n        disabled={loading}\r\n        title=\"Select Date Range\"\r\n        className={`flex items-center gap-1 sm:gap-2 ${\r\n          dateRange.rangeType !== 'Custom' ? 'bg-blue-50 border-blue-200' : 'bg-white/80 border-gray-200/80'\r\n        } backdrop-blur-sm hover:bg-white text-gray-700 px-2 sm:px-3 py-1.5 rounded-lg border text-xs sm:text-sm font-medium transition-all duration-200 hover:shadow-md`}\r\n      >\r\n        <BiCalendarAlt className=\"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0\" />\r\n        <span className=\"hidden sm:inline text-left truncate max-w-[180px]\">\r\n          {headerDateDisplay}\r\n        </span>\r\n      </button>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <PageLayout\r\n      title=\"LOGS\"\r\n      sidebar={<NavAdmin />}\r\n      isSidebarOpen={isSidebarOpen}\r\n      setSidebarOpen={setSidebarOpen}\r\n      className=\"overflow-hidden\"\r\n      headerActions={headerActions}\r\n    >\r\n      <div className=\"h-[calc(100vh-80px)] bg-transparent p-4 flex flex-col overflow-hidden\">\r\n        <div className=\"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between mb-4\">\r\n          <div className=\"relative flex-1 max-w-xl w-full flex-shrink-0\">\r\n            <div className=\"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none\">\r\n              <svg\r\n                className=\"h-5 w-5 text-gray-400\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search logs...\"\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"w-full pl-12 pr-4 py-3 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 placeholder-gray-400\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex flex-wrap gap-3 w-full sm:w-auto\">\r\n            <div className=\"relative\" ref={dropdownRef}>\r\n              <button\r\n                onClick={() => setIsDropdownOpen(!isDropdownOpen)}\r\n                className=\"w-full sm:w-auto pl-4 pr-10 py-3 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 flex items-center justify-between\"\r\n              >\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span>{selectedRole.icon}</span>\r\n                  <span>{selectedRole.label}</span>\r\n                </div>\r\n                <svg\r\n                  className={`w-4 h-4 transition-transform duration-200 ${\r\n                    isDropdownOpen ? \"rotate-180\" : \"\"\r\n                  }`}\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M19 9l-7 7-7-7\"\r\n                  />\r\n                </svg>\r\n              </button>\r\n              {isDropdownOpen && (\r\n                <div className=\"absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-xl shadow-lg max-h-60 overflow-auto\">\r\n                  {roleOptions.map((option) => (\r\n                    <button\r\n                      key={option.value}\r\n                      onClick={() => {\r\n                        setRoleFilter(option.value);\r\n                        setIsDropdownOpen(false);\r\n                      }}\r\n                      className={`w-full px-4 py-3 text-left text-sm hover:bg-gray-50 flex items-center gap-2 transition-colors duration-150 ${\r\n                        roleFilter === option.value\r\n                          ? \"bg-blue-50 text-blue-600\"\r\n                          : \"text-gray-700\"\r\n                      }`}\r\n                    >\r\n                      <span>{option.icon}</span>\r\n                      <span>{option.label}</span>\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n            <Button\r\n              onClick={() => setSortOrder(sortOrder === \"asc\" ? \"desc\" : \"asc\")}\r\n              variant=\"secondary\"\r\n              size=\"md\"\r\n              className=\"flex items-center gap-2\"\r\n            >\r\n              <svg\r\n                className=\"w-5 h-5\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12\"\r\n                />\r\n              </svg>\r\n              Sort ({sortOrder === \"asc\" ? \"Oldest\" : \"Newest\"})\r\n            </Button>\r\n            <Button\r\n              onClick={exportToCSV}\r\n              variant=\"secondary\"\r\n              size=\"md\"\r\n              className=\"flex items-center gap-2\"\r\n              disabled={filteredLogs.length === 0 || loading}\r\n            >\r\n              <svg\r\n                className=\"w-5 h-5\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\r\n                />\r\n              </svg>\r\n              Export as CSV\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Desktop Table View */}\r\n        <div className=\"hidden sm:block overflow-hidden rounded-xl border border-gray-200/50 h-[calc(100%-150px)] flex-1 min-h-0\">\r\n          <div className=\"h-full overflow-y-auto\">\r\n            <table className=\"w-full bg-white/80 backdrop-blur-md\">\r\n              <thead className=\"bg-gray-100/90 backdrop-blur-md sticky top-0 z-10\">\r\n                <tr>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Customer\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Role\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Action\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Timestamp\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"divide-y divide-gray-200/50\">\r\n                {loading ? (\r\n                  <tr>\r\n                    <td colSpan=\"4\" className=\"text-center py-8 text-gray-500\">\r\n                      Loading logs...\r\n                    </td>\r\n                  </tr>\r\n                ) : filteredLogs.length === 0 ? (\r\n                  <tr>\r\n                    <td colSpan=\"4\" className=\"text-center py-8 text-gray-500\">\r\n                      No logs found.\r\n                    </td>\r\n                  </tr>\r\n                ) : (\r\n                  filteredLogs.map((log) => (\r\n                    <tr key={log.id} className=\"hover:bg-gray-50/50 transition-colors\">\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className=\"text-sm font-medium text-gray-900\">\r\n                          {log.username}\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-500\">\r\n                          ID: {log.userId}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <span\r\n                          className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${\r\n                            log.role === \"admin\" || log.role === \"business_owner\"\r\n                              ? \"bg-purple-100 text-purple-800\"\r\n                              : log.role === \"cashier\"\r\n                              ? \"bg-blue-100 text-blue-800\"\r\n                              : \"bg-green-100 text-green-800\"\r\n                          }`}\r\n                        >\r\n                          {log.role}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-800\">\r\n                        {log.action}\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                        {log.time}\r\n                      </td>\r\n                    </tr>\r\n                  ))\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Mobile Card View */}\r\n        <div className=\"sm:hidden overflow-y-auto space-y-3 h-[calc(100%-150px)]\">\r\n          {loading ? (\r\n            Array.from({ length: 5 }).map((_, i) => (\r\n              <div\r\n                key={i}\r\n                className=\"bg-white/80 backdrop-blur-md rounded-xl p-4 border border-gray-200/50 animate-pulse\"\r\n              >\r\n                <div className=\"flex justify-between items-center mb-2\">\r\n                  <div className=\"h-4 bg-gray-200 rounded w-1/3\"></div>\r\n                  <div className=\"h-3 bg-gray-200 rounded w-1/4\"></div>\r\n                </div>\r\n                <div className=\"h-3 bg-gray-200 rounded w-full mb-3\"></div>\r\n                <div className=\"h-3 bg-gray-200 rounded w-1/2\"></div>\r\n              </div>\r\n            ))\r\n          ) : filteredLogs.length === 0 ? (\r\n            <div className=\"text-center py-8 text-gray-500 bg-white/80 backdrop-blur-md rounded-xl\">\r\n              No logs found.\r\n            </div>\r\n          ) : (\r\n            filteredLogs.map((log) => (\r\n              <div\r\n                key={log.id}\r\n                className=\"bg-white/80 backdrop-blur-md rounded-xl p-4 border border-gray-200/50 shadow-sm\"\r\n              >\r\n                <div className=\"flex justify-between items-start mb-2\">\r\n                  <div>\r\n                    <div className=\"text-sm font-semibold text-gray-900\">\r\n                      {log.username}\r\n                    </div>\r\n                    <div className=\"text-xs text-gray-500\">\r\n                      ID: {log.userId}\r\n                    </div>\r\n                  </div>\r\n                  <span\r\n                    className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize ${\r\n                      log.role === \"admin\" || log.role === \"business_owner\"\r\n                        ? \"bg-purple-100 text-purple-800\"\r\n                        : log.role === \"cashier\"\r\n                        ? \"bg-blue-100 text-blue-800\"\r\n                        : \"bg-green-100 text-green-800\"\r\n                    }`}\r\n                  >\r\n                    {log.role}\r\n                  </span>\r\n                </div>\r\n                <p className=\"text-sm text-gray-800 mb-2\">{log.action}</p>\r\n                <div className=\"text-xs text-gray-500 text-right border-t border-gray-200/50 pt-2 mt-2\">\r\n                  {log.time}\r\n                </div>\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n\r\n        {error && (\r\n          <div className=\"bg-red-50 border-l-4 border-red-500 rounded-lg p-3 flex items-start gap-2 mt-4\">\r\n            <svg\r\n              className=\"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\"\r\n              />\r\n            </svg>\r\n            <p className=\"text-sm font-medium text-red-700\">\r\n              {(() => {\r\n                try {\r\n                  const parsed = JSON.parse(error);\r\n                  return parsed.error || parsed.message || error;\r\n                } catch {\r\n                  return error;\r\n                }\r\n              })()}\r\n            </p>\r\n          </div>\r\n        )}\r\n        \r\n        {/* Date Range Filter Modal */}\r\n        <DateRangeFilterModal\r\n          isOpen={showFilterModal}\r\n          onClose={() => setShowFilterModal(false)}\r\n          onDateRangeApply={(newDateRange) => {\r\n            setDateRange({\r\n              startDate: newDateRange.startDate,\r\n              endDate: newDateRange.endDate,\r\n              rangeType: newDateRange.rangeType\r\n            });\r\n            // Trigger a refetch of logs with the new date range\r\n            fetchLogs();\r\n          }}\r\n        />\r\n      </div>\r\n    </PageLayout>\r\n  );\r\n};\r\n\r\nexport default LogsPage;\r\n"],"names":["LogsPage","logs","setLogs","useState","error","setError","searchQuery","setSearchQuery","loading","setLoading","clearing","setClearing","dateRange","setDateRange","startDate","dayjs","startOf","endDate","endOf","rangeType","roleFilter","setRoleFilter","sortOrder","setSortOrder","isDropdownOpen","setIsDropdownOpen","isSidebarOpen","setSidebarOpen","showFilterModal","setShowFilterModal","dropdownRef","useRef","headerDateDisplay","useMemo","start","end","diff","format","fetchLogs","async","token","sessionStorage","getItem","params","data","normalized","api","headers","authHeaders","map","l","id","log_id","userId","user_id","username","action","time","date_time","Date","toLocaleString","dateTime","role","toLowerCase","err","useEffect","handleClickOutside","event","current","contains","target","addEventListener","removeEventListener","filteredLogs","filtered","filter","query","includes","log","isBetween","sort","a","b","dateA","dateB","roleOptions","value","label","selectedRole","find","option","headerActions","jsxs","className","children","jsx","onClick","disabled","title","BiRefresh","BiCalendarAlt","PageLayout","sidebar","NavAdmin","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","type","placeholder","onChange","e","ref","icon","Button","variant","size","exportToCSV","csvContent","join","replace","blob","Blob","link","document","createElement","url","URL","createObjectURL","setAttribute","toISOString","split","style","visibility","body","appendChild","click","removeChild","length","colSpan","Array","from","_","i","parsed","JSON","parse","message","DateRangeFilterModal","isOpen","onClose","onDateRangeApply","newDateRange"],"mappings":"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"}