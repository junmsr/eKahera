import{j as e}from"./utils-CzS7jPpm.js";import{R as t,a as s}from"./vendor-DpjJfaBO.js";import{C as l}from"./Card-BlR7hDww.js";import"./Input-D0wlSige.js";import{b as r,a}from"./index-DXkpZ5oM.js";import{B as n,c as o,d as i,e as c,f as d}from"./BaseModal-BODUq_pt.js";import{S as x}from"./ScannerCard-BF2D7Jq6.js";const m=t.forwardRef(({sku:t,setSku:s,quantity:a,setQuantity:n,handleAddToCart:o,className:i="",...c},d)=>e.jsx(l,{className:`flex-shrink-0 bg-white/80 backdrop-blur-md border border-white/60 shadow-xl hover:shadow-2xl transition-all duration-300 ${i}`,variant:"glass",...c,children:e.jsxs("div",{className:"flex flex-col gap-1 p-1 sm:p-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 20l4-16m2 16l4-16M6 9h14M4 15h14"})})}),e.jsx("span",{className:"font-bold text-sm text-gray-900",children:"Enter SKU Code"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"SKU Code"}),e.jsx("div",{className:"relative",children:e.jsx("input",{ref:d,type:"text",name:"sku",value:t,onChange:e=>s(e.target.value),onKeyPress:e=>{"Enter"===e.key&&t.trim()&&o()},placeholder:"Scan or enter SKU code",className:"w-full pl-3 pr-3 py-2 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 placeholder-gray-400 font-medium"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 whitespace-nowrap",children:"Quantity:"}),e.jsxs("div",{className:"flex items-center gap-1 flex-1",children:[e.jsx("button",{onClick:()=>n(Math.max(1,a-1)),className:"w-8 h-8 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold transition-colors duration-200 flex items-center justify-center",children:"−"}),e.jsx("input",{type:"number",name:"quantity",value:a,min:1,onChange:e=>n(Math.max(1,Number(e.target.value)||1)),className:"w-16 px-2 py-1 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl text-center text-sm font-semibold focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"}),e.jsx("button",{onClick:()=>n(a+1),className:"w-8 h-8 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold transition-colors duration-200 flex items-center justify-center",children:"+"})]}),e.jsx(r,{label:"Add to Cart",onClick:o,variant:"primary",size:"sm",microinteraction:!0,icon:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),iconPosition:"left"})]})]})]})}));function u({cart:t,handleRemove:r,handleEditQuantity:a,total:n,className:o="",...i}){const[c,d]=s.useState(null),[x,m]=s.useState(1);s.useEffect(()=>{const e=e=>{if("F1"===e.key&&t.length>0){e.preventDefault();const s=0;d(s),m(t[s].quantity)}else if("F2"===e.key&&t.length>0){e.preventDefault();r(0)}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[t,r]);const u=()=>e.jsx("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M15.232 5.232l3.536 3.536M9 13l6.586-6.586a2 2 0 1 1 2.828 2.828L11.828 15.828a4 4 0 0 1-1.414.828l-4.243 1.414 1.414-4.243a4 4 0 0 1 .828-1.414z"})}),h=()=>e.jsx("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})});return e.jsx(l,{className:`flex-1 flex flex-col bg-white/80 backdrop-blur-md border border-white/60 shadow-xl transition-all duration-300 h-full min-h-0 overflow-hidden ${o}`,variant:"glass",...i,children:e.jsxs("div",{className:"flex-1 min-h-0 flex flex-col p-2 sm:p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 pb-2 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsx("h3",{className:"text-sm sm:text-base font-bold text-gray-900",children:"Shopping Cart"})]}),e.jsxs("span",{className:"text-xs font-semibold text-gray-600 bg-gray-100 px-2 py-0.5 rounded-full",children:[t.length," ",1===t.length?"item":"items"]})]}),e.jsx("div",{className:"flex-1 overflow-auto min-h-0 rounded-lg",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-gradient-to-r from-blue-50/90 to-indigo-50/90 backdrop-blur-sm border-b border-blue-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-1.5 px-2 text-left text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Product"}),e.jsx("th",{className:"py-1.5 px-2 text-center text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Qty"}),e.jsx("th",{className:"py-1.5 px-2 text-right text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"py-1.5 px-2 text-right text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"py-1.5 px-2 text-center text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:0===t.length?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-2",children:e.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsx("p",{className:"text-gray-500 text-sm font-semibold",children:"Cart is empty"}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Scan or enter products"})]})})}):t.map((t,s)=>e.jsxs("tr",{className:"hover:bg-blue-50/50 transition-colors duration-200 group",children:[e.jsx("td",{className:"py-1.5 px-2",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs sm:text-sm font-semibold text-gray-900 group-hover:text-blue-600 transition-colors truncate",children:t.name}),e.jsxs("span",{className:"text-[10px] text-gray-500 truncate",children:["SKU: ",t.sku||"N/A"]})]})}),e.jsx("td",{className:"py-1.5 px-2 text-center",children:c===s?e.jsx("input",{type:"number",min:"1",value:x,onChange:e=>m(Math.max(1,parseInt(e.target.value)||1)),onKeyDown:e=>{"Enter"===e.key?(a(s,x),d(null)):"Escape"===e.key&&d(null)},onBlur:()=>{a(s,x),d(null)},className:"w-12 h-7 text-center text-xs font-bold border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}):e.jsx("span",{className:"inline-flex items-center justify-center w-7 h-7 rounded-md bg-blue-100 text-blue-700 font-bold text-xs",children:t.quantity})}),e.jsx("td",{className:"py-1.5 px-2 text-right",children:e.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:["₱",t.price.toFixed(2)]})}),e.jsx("td",{className:"py-1.5 px-2 text-right",children:e.jsxs("span",{className:"text-xs sm:text-sm font-bold text-blue-600",children:["₱",(t.price*(c===s?x:t.quantity)).toFixed(2)]})}),e.jsx("td",{className:"py-1.5 px-2",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("button",{onClick:()=>{d(s),m(t.quantity)},className:"p-1.5 rounded-md bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200 transition-all duration-200",title:"Edit (F1)",children:e.jsx(u,{})}),e.jsx("button",{onClick:()=>r(s),className:"p-1.5 rounded-md bg-red-50 text-red-600 hover:bg-red-100 border border-red-200 transition-all duration-200",title:"Remove (F2)",children:e.jsx(h,{})})]})})]},s))})]})}),e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm sm:text-base font-semibold text-gray-700",children:"Total:"}),e.jsxs("span",{className:"text-lg sm:text-xl font-extrabold text-blue-600",children:["₱",t.reduce((e,t,s)=>e+t.price*(c===s?x:t.quantity),0).toFixed(2)]})]})})]})})}function h({isOpen:l,onClose:o,sku:i,setSku:c}){const[d,m]=s.useState(null);t.useEffect(()=>{if(!i)return void m(null);const e=setTimeout(()=>{(async()=>{if(i)try{const e=localStorage.getItem("business_id"),t=e?`?business_id=${encodeURIComponent(e)}`:"",s=await a(`/api/products/public/sku/${encodeURIComponent(i)}${t}`);m(s?{name:s.product_name,price:Number(s.selling_price||0),sku:s.sku}:null)}catch(e){m(null)}})()},200);return()=>clearTimeout(e)},[i]);const u=e.jsx(r,{label:"Close",variant:"secondary",onClick:o,className:"w-full"});return e.jsxs(n,{isOpen:l,onClose:o,title:"Price Check",subtitle:"Scan or enter SKU/barcode",icon:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),footer:u,size:"md",contentClassName:"space-y-4",children:[e.jsx("div",{className:"w-full",children:e.jsx(x,{onScan:e=>{const t=e?.[0]?.rawValue;t&&c(t)},paused:!1,onResume:()=>{},className:"w-full",textMain:"text-blue-700"})}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter SKU or Barcode"}),e.jsx("input",{type:"text",value:i,onChange:e=>c(e.target.value),className:"w-full border border-gray-300 rounded-lg px-4 py-2 text-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter SKU or scan barcode"})]}),d?e.jsxs("div",{className:"w-full bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200/50",children:[e.jsx("div",{className:"text-lg font-semibold text-blue-900 mb-1",children:d.name}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:["₱",d.price.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["SKU: ",d.sku]})]}):i?e.jsx("div",{className:"text-red-500 text-sm text-center py-4",children:"No product found."}):null]})}function b({isOpen:t,onClose:l,onApplyDiscount:a}){const[o,i]=s.useState("FIX"),[c,d]=s.useState(!1),[x,m]=s.useState("PERCENTAGE"),[u,h]=s.useState([{label:"PWD/Senior Citizen",value:"5%"}]),[b,p]=s.useState([]),[g,f]=s.useState(""),[j,y]=s.useState(""),[N,v]=s.useState(null),w=()=>{g&&j&&("PERCENTAGE"===x?h([...u,{label:g,value:j+"%"}]):p([...b,{label:g,value:parseFloat(j).toFixed(2)}]),f(""),y(""))},k=e.jsx(r,{label:"Save Settings",variant:"primary",onClick:()=>{d(!1)},className:"w-full"}),C=e.jsxs("div",{className:"w-full space-y-2",children:[e.jsx(r,{label:"Confirm Selection",variant:"primary",onClick:()=>{const e="PERCENTAGE"===o?u:b;null!==N&&e[N]&&(a(e[N]),v(null),l())},disabled:null===N,className:"w-full"}),e.jsx(r,{label:"Manage Discounts",variant:"secondary",onClick:()=>d(!0),className:"w-full"})]});return e.jsx(n,{isOpen:t,onClose:l,title:c?"Manage Discounts":"Select Discount",subtitle:c?"Add or remove discount options":"Choose a discount to apply",icon:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),footer:c?k:C,size:"md",contentClassName:"space-y-4",children:c?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"flex-1 px-4 py-2 rounded-lg font-semibold text-sm transition-all "+("PERCENTAGE"===x?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>m("PERCENTAGE"),children:"Percentage"}),e.jsx("button",{className:"flex-1 px-4 py-2 rounded-lg font-semibold text-sm transition-all "+("FIXED"===x?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>m("FIXED"),children:"Fixed Amount"})]}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:("PERCENTAGE"===x?u:b).map((t,s)=>e.jsxs("div",{className:"flex gap-2 items-center bg-gray-50 p-3 rounded-lg",children:[e.jsx("input",{className:"flex-1 bg-transparent outline-none text-sm font-medium",value:t.label,readOnly:!0}),e.jsx("input",{className:"w-20 bg-transparent text-center outline-none text-sm font-medium",value:t.value,readOnly:!0}),e.jsx("button",{className:"text-red-500 hover:text-red-700 transition-colors p-1",onClick:()=>(e=>{"PERCENTAGE"===x?h(u.filter((t,s)=>s!==e)):p(b.filter((t,s)=>s!==e))})(s),title:"Remove",type:"button",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},s))}),e.jsxs("div",{className:"space-y-2 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Add New Discount"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Description",value:g,onChange:e=>f(e.target.value)}),e.jsx("input",{className:"w-24 border border-gray-300 rounded-lg px-3 py-2 text-sm text-center focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"PERCENTAGE"===x?"0%":"0.00",value:j,onChange:e=>y(e.target.value),type:"number",min:"0"}),e.jsx("button",{className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-bold",onClick:w,title:"Add",type:"button",children:"+"})]})]})]}):(()=>{const t="PERCENTAGE"===o?u:b;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"flex-1 px-4 py-2 rounded-lg font-semibold text-sm transition-all "+("FIX"===o?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>{i("FIX"),v(null)},children:"Fixed Amount"}),e.jsx("button",{className:"flex-1 px-4 py-2 rounded-lg font-semibold text-sm transition-all "+("PERCENTAGE"===o?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),onClick:()=>{i("PERCENTAGE"),v(null)},children:"Percentage"})]}),e.jsx("div",{className:"space-y-2",children:0===t.length?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No discounts available yet."}),e.jsx("p",{className:"text-xs mt-1",children:"Set up discounts in settings."})]}):t.map((t,s)=>e.jsxs("button",{type:"button",className:"w-full border-2 rounded-lg px-4 py-3 text-sm transition-all flex items-center justify-between "+(N===s?"border-blue-600 bg-blue-50 ring-2 ring-blue-300":"border-gray-200 bg-white hover:border-gray-300"),onClick:()=>v(s),children:[e.jsx("span",{className:"font-medium",children:t.label}),e.jsx("span",{className:"font-bold "+(N===s?"text-blue-600":"text-gray-700"),children:t.value})]},s))})]})})()})}function p({isOpen:t,onClose:l}){const[r,x]=s.useState("SUMMARY"),[m,u]=s.useState(null),[h,b]=s.useState([]),[p,g]=s.useState([]),[f,j]=s.useState(!1),[y,N]=s.useState(!1),[v,w]=s.useState(""),k=async(e=null)=>{N(!0);try{w("");const t=e?`/stats/cash-transactions?payment_type=${encodeURIComponent(e)}&limit=100`:"/stats/cash-transactions?limit=100",s=await a(t);g(Array.isArray(s)?s:[])}catch(t){w(t.message||"Failed to load transactions")}finally{N(!1)}};s.useEffect(()=>{t&&((async()=>{j(!0);try{w("");const e=await a("/stats/cash-ledger");b(Array.isArray(e)?e:[])}catch(e){w(e.message||"Failed to load cash ledger")}finally{j(!1)}})(),k())},[t]);const C=e.jsxs("div",{className:"flex gap-2 border-t border-gray-200/50 pt-4 mt-4",children:[e.jsxs("button",{onClick:()=>{x("SUMMARY"),u(null)},className:"flex-1 flex items-center justify-center gap-2 py-3 rounded-xl font-semibold transition-all "+("SUMMARY"===r?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[e.jsx(c,{className:"w-5 h-5"}),e.jsx("span",{children:"Summary"})]}),e.jsxs("button",{onClick:()=>{x("TRANSACTIONS"),u(null)},className:"flex-1 flex items-center justify-center gap-2 py-3 rounded-xl font-semibold transition-all "+("TRANSACTIONS"===r?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[e.jsx(d,{className:"w-5 h-5"}),e.jsx("span",{children:"Transactions"})]})]});return e.jsx(n,{isOpen:t,onClose:l,title:"Cash Ledger",subtitle:"View cash balance and payment methods",icon:e.jsx(o,{className:"w-6 h-6 text-white"}),size:"lg",contentClassName:"space-y-4",children:e.jsxs("div",{className:"space-y-6",children:["SUMMARY"===r?(()=>{const t=h.reduce((e,t)=>e+(Number(t.balance)||0),0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 via-blue-600 to-indigo-700 text-white rounded-lg shadow-xl px-8 py-8 text-center",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-100 mb-2",children:"Total Cash on Hand"}),e.jsxs("div",{className:"text-5xl font-bold flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-4xl",children:"₱"}),t.toFixed(2)]}),e.jsx("p",{className:"text-blue-100 text-sm mt-3",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center",children:e.jsx(o,{className:"w-5 h-5 text-white"})}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Payment Methods"})]}),e.jsx("div",{className:"space-y-3",children:f?e.jsx("div",{className:"text-sm text-gray-500",children:"Loading..."}):0===h.length?e.jsx("div",{className:"text-sm text-gray-500",children:"No balances available"}):h.map(t=>e.jsx("button",{onClick:async()=>{u(t.name),x("TRANSACTIONS"),await k(t.name)},className:"w-full bg-gradient-to-r from-gray-50 to-gray-100/50 hover:from-blue-50 hover:to-indigo-50/50 rounded-2xl p-4 border border-gray-200/50 hover:border-blue-300 transition-all duration-200 group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center border border-gray-200 group-hover:border-blue-300 group-hover:bg-blue-50 transition-all",children:e.jsx("svg",{className:"w-5 h-5 text-gray-600 group-hover:text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-xs text-gray-500",children:"View transactions"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-lg font-bold text-blue-600",children:["₱",(Number(t.balance)||0).toFixed(2)]})}),e.jsx(i,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 transition-colors"})]})]})},t.name))})]}),v&&e.jsx("div",{className:"text-sm text-red-600",children:v.includes("Server returned an HTML error page")||v.includes("Cannot GET")?"Unable to reach backend API. Check backend server and proxy configuration.":v})]})})():e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{type:"button",onClick:()=>{u(null),x("SUMMARY")},className:"text-sm text-blue-600 hover:text-blue-800 font-semibold flex items-center gap-2 hover:gap-3 transition-all",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Summary"]}),e.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-blue-50 rounded-2xl p-4 border border-indigo-100/50",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900",children:m?`${m} Transactions`:"All Transactions"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:y?"Loading...":`${p.length} transaction${1!==p.length?"s":""} found`})]}),e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200/50 overflow-hidden",children:y?e.jsx("div",{className:"text-center py-12 text-sm text-gray-500",children:"Loading transactions..."}):0===p.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-12 h-12 text-gray-300 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No transactions found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200/50",children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Date & Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Amount"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:p.map(t=>e.jsxs("tr",{className:"hover:bg-blue-50/50 transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 font-medium",children:new Date(t.created_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 text-sm",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-800 border border-blue-200",children:t.payment_type})}),e.jsxs("td",{className:"px-6 py-4 text-sm text-right font-bold text-green-600",children:["₱",(Number(t.total)||0).toFixed(2)]})]},String(t.transaction_id)))})]})})})]}),C]})})}function g({isOpen:t,onClose:s,total:l,onSelectPayment:a}){const o=e.jsxs("div",{className:"w-full flex flex-col gap-3",children:[e.jsx(r,{label:"CASH",className:"w-full h-12 text-base font-bold",onClick:()=>a("cash")}),e.jsx(r,{label:"GCASH",className:"w-full h-12 text-base font-bold",onClick:()=>a("gcash")}),e.jsx(r,{label:"MAYA",className:"w-full h-12 text-base font-bold",onClick:()=>a("maya")})]});return e.jsxs(n,{isOpen:t,onClose:s,title:"Checkout",subtitle:"Select payment method",icon:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),footer:o,size:"sm",contentClassName:"text-center",children:[e.jsxs("div",{className:"bg-blue-500 text-white rounded-2xl py-6 px-4 text-center mb-4",children:[e.jsx("div",{className:"text-sm opacity-90 mb-2",children:"Total Amount"}),e.jsxs("div",{className:"text-4xl font-bold",children:["₱",l.toFixed(2)]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Choose your preferred payment method"})]})}function f({isOpen:t,onClose:s,change:l=0,payable:a=0,onReceipt:o,onNewEntry:i}){const c=e.jsx("div",{className:"w-full flex flex-col gap-3",children:e.jsx(r,{label:"RECEIPT",className:"w-full h-11 text-sm font-semibold bg-blue-700 hover:bg-blue-800 text-white",onClick:()=>{o?o():alert("Receipt")}})});return e.jsxs(n,{isOpen:t,onClose:s,title:"Payment Complete",icon:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),footer:c,size:"sm",contentClassName:"text-center space-y-4",children:[e.jsx("div",{className:"flex justify-center mb-2",children:e.jsx("div",{className:"w-14 h-14 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl p-5 text-white",children:[e.jsx("div",{className:"text-xs uppercase tracking-wide opacity-90 mb-2",children:"Change"}),e.jsxs("div",{className:"inline-flex items-baseline gap-2 bg-white text-blue-700 rounded-lg px-4 py-3 shadow-md",children:[e.jsx("span",{className:"text-lg font-bold",children:"₱"}),e.jsx("span",{className:"text-2xl font-bold",children:Number(l).toFixed(2)})]}),e.jsx("div",{className:"mt-4 text-sm opacity-90",children:"Payable"}),e.jsxs("div",{className:"text-sm font-semibold",children:["₱",Number(a).toFixed(2)]})]})]})}function j({isOpen:t,onClose:l,total:a,onConfirm:o}){const[i,c]=s.useState(""),[d,x]=s.useState(!1),[m,u]=s.useState(null);if(!t&&!d)return null;if(d)return e.jsx(f,{isOpen:d,onClose:()=>{x(!1),l&&l()},change:m?.change,payable:m?.payable,onNewEntry:()=>{x(!1),l&&l()},onReceipt:()=>{o&&null!=m?.received&&o(Number(m.received))}});const h=e.jsxs(e.Fragment,{children:[e.jsx(r,{label:"Cancel",variant:"secondary",onClick:l,type:"button",className:"flex-1"}),e.jsx(r,{label:"Proceed",variant:"primary",type:"button",onClick:()=>{if(!i||Number(i)<a)return void alert("Amount received must be greater than or equal to total.");const e=Number(i);u({change:e-a,payable:a,received:e}),x(!0)},className:"flex-1"})]});return e.jsxs(n,{isOpen:t,onClose:l,title:"Cash Payment",subtitle:"Enter amount received",icon:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),footer:h,size:"md",contentClassName:"space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 text-white rounded-2xl py-6 px-4 text-center",children:[e.jsx("div",{className:"text-sm opacity-90 mb-2",children:"Total Amount"}),e.jsxs("div",{className:"text-4xl font-bold",children:["₱",a.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount Received"}),e.jsx("input",{type:"number",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-center text-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"₱0.00",value:i,onChange:e=>c(e.target.value)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"Quick amounts:"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[100,200,300,400,500,600,700,800,900].map(t=>e.jsx("button",{className:"bg-blue-100 hover:bg-blue-200 text-blue-700 font-bold py-2 rounded-lg transition-colors text-sm",onClick:()=>(e=>c(e.toString()))(t),children:t},t))})]}),e.jsx(r,{label:"Use Exact Amount",className:"w-full h-10 text-sm font-bold bg-slate-600 hover:bg-slate-700 text-white",onClick:()=>c(a.toString())})]})}function y({isOpen:t,onClose:l,onImport:o}){const[i,c]=s.useState(!1),[d,m]=s.useState(""),u=sessionStorage.getItem("auth_token"),h=JSON.parse(sessionStorage.getItem("user")||"{}"),b=e.jsx(r,{label:"Close",variant:"secondary",onClick:l,className:"w-full"});return e.jsxs(n,{isOpen:t,onClose:l,title:"Scan Customer Cart",subtitle:"Ask customer to show their QR",icon:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),footer:b,size:"lg",contentClassName:"space-y-3",children:[e.jsx("div",{className:"text-blue-800 text-sm font-medium",children:"Ask the customer to show their cart QR code"}),e.jsx("div",{className:"h-[50vh]",children:e.jsx(x,{onScan:async e=>{const t=e?.[0]?.rawValue;if(t){c(!0),m("");try{let e;try{e=JSON.parse(t)}catch(s){throw new Error("Invalid QR payload")}if(!e||"cart"!==e.t||!Array.isArray(e.items))throw new Error("Unsupported QR");const{b:r,items:n}=e,i=h?.businessId||h?.business_id;if(r&&i&&Number(r)!==Number(i))throw new Error("This QR code is not valid for this store.");const c=[];for(const t of n){if(!t?.p||!t?.q)continue;const e=await a(`/api/products/${encodeURIComponent(t.p)}`,{headers:{Authorization:`Bearer ${u}`}});c.push({product_id:e.product_id,sku:e.sku,name:e.product_name,quantity:Number(t.q),price:Number(e.selling_price||0)})}if(0===c.length)throw new Error("No items to import");o(c),l()}catch(s){m(s.message||"Failed to import")}finally{c(!1)}}},paused:i,onResume:()=>c(!1),className:"w-full h-full"})}),d&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:d})]})}export{u as C,b as D,h as P,m as S,p as a,g as b,j as c,y as d};
//# sourceMappingURL=ScanCustomerCartModal-wsg6DQMq.js.map
