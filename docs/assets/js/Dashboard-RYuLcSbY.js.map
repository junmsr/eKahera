{"version":3,"file":"Dashboard-RYuLcSbY.js","sources":["../../../frontend/src/components/ui/Dashboard/ChartCard.jsx","../../../frontend/src/components/ui/Dashboard/DashboardStatsCard.jsx","../../../frontend/src/components/ui/Dashboard/DashboardBusinessReport.jsx","../../../frontend/src/pages/Dashboard.jsx"],"sourcesContent":["import React from \"react\";\r\nimport Card from \"../../common/Card\";\r\nimport SectionHeader from \"../../layout/SectionHeader\";\r\n\r\n/**\r\n * ChartCard Component\r\n * Provides a consistent layout for dashboard chart sections\r\n */\r\nfunction ChartCard({ title, children, className = \"\", ...props }) {\r\n  return (\r\n    <Card\r\n      className={`bg-white/80 backdrop-blur-md border border-white/60 shadow-xl group ${className}`}\r\n      {...props}\r\n    >\r\n      {title && (\r\n        <SectionHeader\r\n          size=\"md\"\r\n          align=\"left\"\r\n          className=\"text-gray-900 mb-6 font-bold group-hover:text-blue-600 transition-colors duration-300\"\r\n        >\r\n          {title}\r\n        </SectionHeader>\r\n      )}\r\n      <div className=\"relative\">\r\n        {children}\r\n        {/* Subtle gradient overlay for depth */}\r\n        <div className=\"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-blue-50/20 rounded-lg pointer-events-none\"></div>\r\n      </div>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default ChartCard;\r\n","import React from \"react\";\r\nimport Card from \"../../common/Card\";\r\n\r\nfunction DashboardStatsCard({ stats, className = \"\", ...props }) {\r\n  return (\r\n    <Card\r\n      className={`bg-white backdrop-blur-sm border border-gray-100 shadow-sm rounded-2xl ${className}`}\r\n      {...props}\r\n    >\r\n      <div className=\"grid grid-cols-1 divide-y divide-gray-200/60 p-6 md:p-8 space-y-4\">\r\n        {/* Sales Metric */}\r\n        <div className=\"flex items-start gap-4 py-4\">\r\n          <div className=\"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 text-xl font-bold\">\r\n            ₱\r\n          </div>\r\n          <div className=\"flex flex-col\">\r\n            <span className=\"text-xs font-semibold text-gray-500 tracking-wide uppercase\">\r\n              Today's Sales\r\n            </span>\r\n            <span className=\"text-2xl md:text-xl font-bold text-gray-900 mt-0.5\">\r\n              ₱{Number(stats.sales || 0).toLocaleString()}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Transactions Metric */}\r\n        <div className=\"flex items-start gap-4 py-4\">\r\n          <div className=\"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 text-xl font-bold\">\r\n            ↻\r\n          </div>\r\n          <div className=\"flex flex-col\">\r\n            <span className=\"text-xs font-semibold text-gray-500 tracking-wide uppercase\">\r\n              Transactions\r\n            </span>\r\n            <span className=\"text-2xl md:text-xl font-bold text-gray-900 mt-0.5\">\r\n              {Number(stats.transactions || 0).toLocaleString()}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Top Product Metric */}\r\n        <div className=\"flex items-start gap-4 py-4\">\r\n          <div className=\"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 text-xl font-bold\">\r\n            ★\r\n          </div>\r\n          <div className=\"flex flex-col\">\r\n            <span className=\"text-xs font-semibold text-gray-500 tracking-wide uppercase\">\r\n              Top Product\r\n            </span>\r\n            <span className=\"text-xl md:text-lg font-bold text-gray-900 mt-0.5 leading-tight line-clamp-2\">\r\n              {stats.topProduct || \"-\"}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Total Items Sold Metric */}\r\n        <div className=\"flex items-start gap-4 py-4\">\r\n          <div className=\"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 text-xl font-bold\">\r\n            #\r\n          </div>\r\n          <div className=\"flex flex-col\">\r\n            <span className=\"text-xs font-semibold text-gray-500 tracking-wide uppercase\">\r\n              Total Items Sold\r\n            </span>\r\n            <span className=\"text-2xl md:text-xl font-bold text-gray-900 mt-0.5\">\r\n              {Number(stats.totalItemsSold || 0).toLocaleString()}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Avg TX Value Metric */}\r\n        <div className=\"flex items-start gap-4 py-4\">\r\n          <div className=\"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 text-xl font-bold\">\r\n            ~\r\n          </div>\r\n          <div className=\"flex flex-col\">\r\n            <span className=\"text-xs font-semibold text-gray-500 tracking-wide uppercase\">\r\n              Avg TX Value\r\n            </span>\r\n            <span className=\"text-2xl md:text-xl font-bold text-gray-900 mt-0.5\">\r\n              ₱{Number(stats.averageTransactionValue || 0).toLocaleString()}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default DashboardStatsCard;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n  LineChart,\r\n  Line,\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n} from \"recharts\";\r\nimport { api } from \"../../../lib/api\";\r\n\r\nconst TrendIcon = ({ trend }) => {\r\n  if (trend === \"up\")\r\n    return <span className=\"text-blue-600 font-semibold text-xl\">↗</span>;\r\n  if (trend === \"down\")\r\n    return <span className=\"text-blue-400 font-semibold text-xl\">↘</span>;\r\n  return <span className=\"text-gray-400 font-semibold text-xl\">→</span>;\r\n};\r\n\r\nexport default function DashboardBusinessReport() {\r\n  const [salesByLocation, setSalesByLocation] = useState([]);\r\n  const [revenueVsExpenses, setRevenueVsExpenses] = useState([]);\r\n  const [profitTrend, setProfitTrend] = useState([]);\r\n  const [paymentMethods, setPaymentMethods] = useState([]);\r\n  const [productPerformance, setProductPerformance] = useState([]);\r\n  const [keyMetrics, setKeyMetrics] = useState({});\r\n  const [businessStats, setBusinessStats] = useState({\r\n    cashFlow: 0,\r\n    operatingCosts: 0,\r\n    profitGrowth: 0,\r\n  });\r\n\r\n  const blueShades = [\r\n    \"#3b82f6\",\r\n    \"#1d4ed8\",\r\n    \"#1e40af\",\r\n    \"#2563eb\",\r\n    \"#60a5fa\",\r\n    \"#93c5fd\",\r\n    \"#bfdbfe\",\r\n  ];\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const [\r\n          keyMetricsRes,\r\n          salesByLocationRes,\r\n          revenueVsExpensesRes,\r\n          profitTrendRes,\r\n          paymentMethodsRes,\r\n          productPerformanceRes,\r\n          businessStatsRes,\r\n        ] = await Promise.all([\r\n          api(\"/api/stats/key-metrics\"),\r\n          api(\"/api/stats/sales-by-location\"),\r\n          api(\"/api/stats/revenue-vs-expenses\"),\r\n          api(\"/api/stats/profit-trend\"),\r\n          api(\"/api/stats/payment-methods\"),\r\n          api(\"/api/stats/product-performance\"),\r\n          api(\"/api/stats/business-stats\"),\r\n        ]);\r\n\r\n        setKeyMetrics(keyMetricsRes || {});\r\n        setSalesByLocation(salesByLocationRes || []);\r\n        setRevenueVsExpenses(revenueVsExpensesRes || []);\r\n        setProfitTrend(profitTrendRes || []);\r\n        setPaymentMethods(paymentMethodsRes || []);\r\n        setProductPerformance(productPerformanceRes || []);\r\n        setBusinessStats(businessStatsRes || {});\r\n      } catch (error) {\r\n        console.error(\"Error fetching business report data:\", error);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  return (\r\n    <section className=\"w-full px-5 md:px-8 py-6 bg-gray-50\">\r\n      {/* Key Metrics */}\r\n      {/* Charts Row 1: Sales by Location and Revenue vs Expenses */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8 w-full min-h-[350px]\">\r\n        {/* Sales by Location */}\r\n        <div className=\"bg-white rounded-lg p-6 border border-blue-300 shadow-lg\">\r\n          <h3 className=\"text-xl font-extrabold text-blue-700 mb-5 select-none\">\r\n            Sales by Location\r\n          </h3>\r\n          <ResponsiveContainer width=\"100%\" height={280}>\r\n            <BarChart\r\n              data={salesByLocation}\r\n              margin={{ top: 10, right: 10, left: 0, bottom: 10 }}\r\n            >\r\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#cbd5e1\" />\r\n              <XAxis\r\n                dataKey=\"location\"\r\n                tick={{ fontSize: 13, fill: \"#1e40af\" }}\r\n                padding={{ left: 10, right: 10 }}\r\n              />\r\n              <YAxis tick={{ fontSize: 13, fill: \"#1e40af\" }} />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  background: \"#f0f9ff\",\r\n                  borderColor: \"#3b82f6\",\r\n                  borderRadius: 10,\r\n                  fontWeight: \"600\",\r\n                }}\r\n                labelStyle={{ fontWeight: \"700\", color: \"#1e3a8a\" }}\r\n              />\r\n              <Bar\r\n                dataKey=\"sales\"\r\n                fill=\"#3b82f6\"\r\n                radius={[10, 10, 0, 0]}\r\n                barSize={40}\r\n                background={{ fill: \"#c7d2fe\" }}\r\n              />\r\n            </BarChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n\r\n        {/* Revenue vs Expenses */}\r\n        <div className=\"bg-white rounded-lg p-6 border border-blue-300 shadow-lg\">\r\n          <h3 className=\"text-xl font-extrabold text-blue-700 mb-5 select-none\">\r\n            Revenue vs Expenses\r\n          </h3>\r\n          <ResponsiveContainer width=\"100%\" height={280}>\r\n            <BarChart\r\n              data={revenueVsExpenses}\r\n              margin={{ top: 10, right: 10, left: 0, bottom: 10 }}\r\n            >\r\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#cbd5e1\" />\r\n              <XAxis\r\n                dataKey=\"month\"\r\n                tick={{ fontSize: 13, fill: \"#1e40af\" }}\r\n                padding={{ left: 10, right: 10 }}\r\n              />\r\n              <YAxis tick={{ fontSize: 13, fill: \"#1e40af\" }} />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  background: \"#f0f9ff\",\r\n                  borderColor: \"#3b82f6\",\r\n                  borderRadius: 10,\r\n                  fontWeight: \"600\",\r\n                }}\r\n                labelStyle={{ fontWeight: \"700\", color: \"#1e3a8a\" }}\r\n              />\r\n              <Legend\r\n                verticalAlign=\"top\"\r\n                wrapperStyle={{ paddingBottom: 10 }}\r\n              />\r\n              <Bar\r\n                dataKey=\"revenue\"\r\n                fill=\"#2563eb\"\r\n                radius={[10, 10, 0, 0]}\r\n                barSize={32}\r\n                background={{ fill: \"#bfdbfe\" }}\r\n              />\r\n              <Bar\r\n                dataKey=\"expenses\"\r\n                fill=\"#93c5fd\"\r\n                radius={[10, 10, 0, 0]}\r\n                barSize={32}\r\n                background={{ fill: \"#dbeafe\" }}\r\n              />\r\n            </BarChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Charts Row 2: Profit Trend and Payment Methods */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8 w-full min-h-[350px]\">\r\n        {/* Profit Trends */}\r\n        <div className=\"bg-white rounded-lg p-6 border border-blue-300 shadow-lg\">\r\n          <h3 className=\"text-xl font-extrabold text-blue-700 mb-5 select-none\">\r\n            Profit Trends\r\n          </h3>\r\n          <ResponsiveContainer width=\"100%\" height={280}>\r\n            <LineChart\r\n              data={profitTrend}\r\n              margin={{ top: 10, right: 10, left: 0, bottom: 10 }}\r\n            >\r\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#cbd5e1\" />\r\n              <XAxis\r\n                dataKey=\"month\"\r\n                tick={{ fontSize: 13, fill: \"#1e40af\" }}\r\n                padding={{ left: 10, right: 10 }}\r\n              />\r\n              <YAxis tick={{ fontSize: 13, fill: \"#1e40af\" }} />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  background: \"#f0f9ff\",\r\n                  borderColor: \"#3b82f6\",\r\n                  borderRadius: 10,\r\n                  fontWeight: \"600\",\r\n                }}\r\n                labelStyle={{ fontWeight: \"700\", color: \"#1e3a8a\" }}\r\n              />\r\n              <Line\r\n                type=\"monotone\"\r\n                dataKey=\"profit\"\r\n                stroke=\"#2563eb\"\r\n                strokeWidth={3}\r\n                dot={{ fill: \"#2563eb\", r: 6 }}\r\n              />\r\n            </LineChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n\r\n        {/* Payment Methods */}\r\n        <div className=\"bg-white rounded-lg p-6 border border-blue-300 shadow-lg\">\r\n          <h3 className=\"text-xl font-extrabold text-blue-700 mb-5 select-none\">\r\n            Payment Methods\r\n          </h3>\r\n          <ResponsiveContainer width=\"100%\" height={280}>\r\n            <PieChart margin={{ top: 20, right: 20, left: 20, bottom: 20 }}>\r\n              <Pie\r\n                data={paymentMethods}\r\n                cx=\"50%\"\r\n                cy=\"50%\"\r\n                labelLine={false}\r\n                label={({ name, value }) => `${name} ${value}%`}\r\n                outerRadius={90}\r\n                dataKey=\"value\"\r\n              >\r\n                {paymentMethods.map((entry, index) => (\r\n                  <Cell\r\n                    key={`cell-${index}`}\r\n                    fill={blueShades[index % blueShades.length]}\r\n                  />\r\n                ))}\r\n              </Pie>\r\n              <Tooltip\r\n                formatter={(value, name, props) => [\r\n                  `${Number(value).toFixed(0)}%`,\r\n                  props?.payload?.name,\r\n                ]}\r\n                contentStyle={{\r\n                  background: \"#eff6ff\",\r\n                  borderColor: \"#3b82f6\",\r\n                  borderRadius: 10,\r\n                  fontWeight: \"600\",\r\n                }}\r\n                labelStyle={{ fontWeight: \"700\", color: \"#1e40af\" }}\r\n              />\r\n              <Legend verticalAlign=\"bottom\" height={36} />\r\n            </PieChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Product Performance */}\r\n      <div className=\"bg-white rounded-lg p-6 border border-gray-200 shadow-md mb-8 w-full\">\r\n        <h3 className=\"text-xl font-bold text-gray-800 mb-6 select-none\">\r\n          Product Performance\r\n        </h3>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n          {(() => {\r\n            const maxSales = Math.max(\r\n              ...productPerformance.map((p) => p.sales || 0)\r\n            );\r\n            return productPerformance.map((product) => {\r\n              const progressPercent = maxSales\r\n                ? Math.round((product.sales / maxSales) * 100)\r\n                : 0;\r\n              return (\r\n                <div\r\n                  key={product.name}\r\n                  className=\"bg-gray-50 rounded-lg p-4 border border-gray-150\"\r\n                >\r\n                  <div className=\"flex items-center justify-between mb-3\">\r\n                    <span className=\"font-semibold text-gray-800 text-sm\">\r\n                      {product.name}\r\n                    </span>\r\n                    <TrendIcon trend={product.trend} />\r\n                  </div>\r\n                  <div className=\"w-full bg-gray-200 rounded-full h-2 mb-2\">\r\n                    <div\r\n                      className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"\r\n                      role=\"progressbar\"\r\n                      aria-valuenow={progressPercent}\r\n                      aria-valuemin={0}\r\n                      aria-valuemax={100}\r\n                      aria-label={`Sales progress for ${product.name}`}\r\n                      style={{ width: `${progressPercent}%` }}\r\n                    ></div>\r\n                  </div>\r\n                  <p className=\"text-sm text-gray-600 font-semibold\">\r\n                    ₱{product.sales.toLocaleString()}\r\n                  </p>\r\n                </div>\r\n              );\r\n            });\r\n          })()}\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n}\r\n","import React, { useState, useEffect, useMemo } from \"react\";\r\nimport { api, authHeaders } from \"../lib/api\";\r\nimport {\r\n  LineChart,\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  Legend,\r\n} from \"recharts\";\r\n\r\nimport { useAuth } from \"../hooks/useAuth\";\r\n\r\n// Components\r\nimport PageLayout from \"../components/layout/PageLayout\";\r\nimport NavAdmin from \"../components/layout/Nav-Admin\";\r\nimport StatsCard from \"../components/ui/Dashboard/StatsCard\";\r\nimport ChartCard from \"../components/ui/Dashboard/ChartCard\";\r\nimport DashboardStatsCard from \"../components/ui/Dashboard/DashboardStatsCard\";\r\nimport DashboardBusinessReport from \"../components/ui/Dashboard/DashboardBusinessReport\";\r\nimport Button from \"../components/common/Button\";\r\nimport { BiBell, BiUser, BiRefresh } from \"react-icons/bi\";\r\nimport ProfileModal from \"../components/modals/ProfileModal\";\r\nimport NotificationDropdown from \"../components/common/NotificationDropdown\";\r\n\r\n// Constants\r\nconst BLUE_COLORS = [\"#2563eb\", \"#60a5fa\", \"#93c5fd\", \"#dbeafe\"];\r\n\r\nconst SOFT_BLUE = \"#93c5fd\";\r\nconst SOFT_GREEN = \"#1e2cecff\";\r\nconst SOFT_PURPLE = \"#3e209bff\";\r\n\r\nfunction VisitorsChart({ data, className = \"\", range = \"month\" }) {\r\n  const rangeLabels = {\r\n    week: \"last 7 days\",\r\n    month: \"last 30 days\",\r\n    year: \"last 365 days\",\r\n  };\r\n\r\n  return (\r\n    <ChartCard\r\n      title={\r\n        <span className=\"text-blue-700\">Visitors for the {rangeLabels[range] || \"last 6 months\"}</span>\r\n      }\r\n      className={`bg-white/80 backdrop-blur-md border border-white/60 shadow-xl ${className}`}\r\n    >\r\n      <div className=\"h-72\">\r\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n          <LineChart\r\n            data={data}\r\n            margin={{ top: 20, right: 20, left: 0, bottom: 5 }}\r\n          >\r\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\r\n            <XAxis dataKey=\"name\" tick={{ fill: \"#374151\", fontSize: 14 }} />\r\n            <YAxis tick={{ fill: \"#374151\", fontSize: 14 }} />\r\n            <Tooltip\r\n              contentStyle={{\r\n                background: \"#fff\",\r\n                borderColor: \"#e5e7eb\",\r\n                borderRadius: 8,\r\n              }}\r\n            />\r\n            <Line\r\n              type=\"monotone\"\r\n              dataKey=\"value\"\r\n              stroke={SOFT_BLUE}\r\n              strokeWidth={3}\r\n              dot={{ r: 5, fill: SOFT_BLUE }}\r\n            />\r\n          </LineChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n    </ChartCard>\r\n  );\r\n}\r\n\r\nfunction SalesPieChart({ data, className = \"\" }) {\r\n  return (\r\n    <ChartCard\r\n      title={<span className=\"text-blue-700\">Sales by Product Category</span>}\r\n      className={`bg-white/80 backdrop-blur-md border border-white/60 shadow-xl ${className}`}\r\n    >\r\n      <div className=\"h-72\">\r\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n          <PieChart>\r\n            <Pie\r\n              data={data}\r\n              dataKey=\"percent\"\r\n              nameKey=\"name\"\r\n              cx=\"50%\"\r\n              cy=\"50%\"\r\n              outerRadius={80}\r\n              label={(entry) =>\r\n                `${entry.name} (${Number(entry.percent || 0).toFixed(1)}%)`\r\n              }\r\n              fill={SOFT_PURPLE}\r\n            >\r\n              {data.map((entry, idx) => {\r\n                const colors = [SOFT_BLUE, SOFT_GREEN, SOFT_PURPLE];\r\n                return (\r\n                  <Cell\r\n                    key={`cell-${idx}`}\r\n                    fill={colors[idx % colors.length]}\r\n                  />\r\n                );\r\n              })}\r\n            </Pie>\r\n            <Legend />\r\n            <Tooltip\r\n              formatter={(value, name, props) => [\r\n                `${Number(value).toFixed(1)}%`,\r\n                props?.payload?.name,\r\n              ]}\r\n              contentStyle={{\r\n                background: \"#fafafa\",\r\n                borderColor: SOFT_PURPLE,\r\n                borderRadius: 8,\r\n              }}\r\n            />\r\n          </PieChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n    </ChartCard>\r\n  );\r\n}\r\n\r\n// Main Dashboard Component\r\nexport default function Dashboard() {\r\n\r\n  const [keyMetrics, setKeyMetrics] = useState({\r\n    revenue: { value: 0, change: 0 },\r\n    expenses: { value: 0, change: 0 },\r\n    netProfit: { value: 0, change: 0 },\r\n    grossMargin: { value: 0, change: 0 },\r\n  });\r\n\r\n  // State\r\n  const [stats, setStats] = useState([]);\r\n  const [range, setRange] = useState(\"month\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [chartData, setChartData] = useState([]);\r\n  const [pieData, setPieData] = useState([]);\r\n  const [highlight, setHighlight] = useState({\r\n    sales: 0,\r\n    transactions: 0,\r\n    topProduct: \"-\",\r\n  });\r\n  const [lowStockProducts, setLowStockProducts] = useState([]);\r\n  const [showProfileModal, setShowProfileModal] = useState(false);\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const [showNotifications, setShowNotifications] = useState(false);\r\n  const notificationRef = React.useRef(null);\r\n  const { logout } = useAuth();\r\n  const [isSidebarOpen, setSidebarOpen] = useState(false);\r\n\r\n  const user = useMemo(() => {\r\n    try {\r\n      return JSON.parse(sessionStorage.getItem(\"user\") || \"{}\");\r\n    } catch (e) {\r\n      return {};\r\n    }\r\n  }, []);\r\n\r\n  // Close notification dropdown on outside click\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (\r\n        notificationRef.current &&\r\n        !notificationRef.current.contains(event.target)\r\n      ) {\r\n        setShowNotifications(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n  }, []);\r\n\r\n  // Data fetching\r\n  const fetchData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n      // Prefer the view-backed dashboard endpoints we added\r\n      const [overview, timeseries, pie, inventoryMovement, oldLowStock] =\r\n        await Promise.all([\r\n          api(\"/api/dashboard/overview\", { headers: authHeaders(token) }),\r\n          api(\r\n            `/api/stats/customers-timeseries?days=${\r\n              range === \"week\"\r\n                ? 7\r\n                : range === \"month\"\r\n                ? 30\r\n                : range === \"year\"\r\n                ? 365\r\n                : 180\r\n            }`,\r\n            { headers: authHeaders(token) }\r\n          ),\r\n          api(\"/api/stats/sales-by-category\", { headers: authHeaders(token) }),\r\n          api(\"/api/dashboard/inventory-movement\", {\r\n            headers: authHeaders(token),\r\n          }),\r\n          api(\"/api/products/low-stock\", { headers: authHeaders(token) }),\r\n        ]);\r\n\r\n      const derived = (timeseries || []).map((d) => ({\r\n        ...d,\r\n        value: Number(d.customers || d.total || d.value || 0),\r\n      }));\r\n\r\n      // Build pie data (categories) based on existing stats endpoint or overview\r\n      const pieTotal =\r\n        (pie || []).reduce((s, p) => s + Number(p.value || 0), 0) || 1;\r\n      const piePercent = (pie || []).map((p) => ({\r\n        ...p,\r\n        percent: (Number(p.value || 0) / pieTotal) * 100,\r\n      }));\r\n\r\n      // If overview is available use it for KPIs\r\n      if (overview && overview.totalSales !== undefined) {\r\n        setStats([\r\n          { label: \"Total Revenue\", value: overview.totalSales, change: 0 },\r\n          {\r\n            label: \"Total Transactions\",\r\n            value: overview.totalTransactions,\r\n            change: 0,\r\n          },\r\n          {\r\n            label: \"Total Items Sold\",\r\n            value: overview.totalItemsSold,\r\n            change: 0,\r\n          },\r\n          {\r\n            label: \"Avg TX Value\",\r\n            value: overview.averageTransactionValue,\r\n            change: 0,\r\n          },\r\n        ]);\r\n        setHighlight({\r\n          sales: Number(overview.totalSales || 0),\r\n          transactions: Number(overview.totalTransactions || 0),\r\n          totalItemsSold: Number(overview.totalItemsSold || 0),\r\n          averageTransactionValue: Number(overview.averageTransactionValue || 0),\r\n          topProduct:\r\n            (overview.topProducts && overview.topProducts[0]?.product_name) ||\r\n            piePercent[0]?.name ||\r\n            \"-\",\r\n        });\r\n        \r\n        const revenue = Number(overview.totalSales || 0);\r\n        const expenses = Number(overview.totalExpenses ?? 0); // add this to overview if available\r\n        const netProfit = revenue - expenses;\r\n        const grossMargin = revenue ? Math.round((netProfit / revenue) * 10000) / 100 : 0;\r\n        const revenueChange = typeof overview.prevTotalSales !== \"undefined\"\r\n          ? Math.round(((revenue - Number(overview.prevTotalSales || 0)) / (Number(overview.prevTotalSales || 1))) * 10000) / 100\r\n          : 0;\r\n\r\n        setKeyMetrics({\r\n          revenue: { value: revenue, change: revenueChange },\r\n          expenses: { value: expenses, change: 0 },\r\n          netProfit: { value: netProfit, change: 0 },\r\n          grossMargin: { value: grossMargin, change: 0 },\r\n        });\r\n      }\r\n\r\n      setChartData(derived);\r\n      setPieData(piePercent);\r\n\r\n      // Prefer inventoryMovement for low stock list (fallback to old endpoint)\r\n      const low = (inventoryMovement || []).filter(\r\n        (p) => Number(p.quantity_in_stock || 0) <= 10\r\n      );\r\n      setLowStockProducts(low.length ? low : oldLowStock || []);\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch dashboard data\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchNotifications = async () => {\r\n    try {\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n      const resp = await api(\"/api/logs\", { headers: authHeaders(token) });\r\n      const readIds = new Set(\r\n        JSON.parse(sessionStorage.getItem(\"read_notif_ids\") || \"[]\")\r\n      );\r\n      const deletedIds = new Set(\r\n        JSON.parse(sessionStorage.getItem(\"deleted_notif_ids\") || \"[]\")\r\n      );\r\n      const mapped = (resp || [])\r\n        .filter((log) => !deletedIds.has(log.log_id))\r\n        .map((log) => ({\r\n          id: log.log_id,\r\n          title: log.action,\r\n          message: `${log.username} (${log.role}) did an action: ${log.action}`,\r\n          time: new Date(log.date_time).toLocaleString(),\r\n          isRead: readIds.has(log.log_id),\r\n        }));\r\n      setNotifications(mapped);\r\n      setUnreadCount(mapped.filter((n) => !n.isRead).length);\r\n    } catch (e) {\r\n      console.error(\"Failed to fetch notifications\", e);\r\n    }\r\n  };\r\n\r\n  const handleMarkAsRead = (id) => {\r\n    const readIds = JSON.parse(\r\n      sessionStorage.getItem(\"read_notif_ids\") || \"[]\"\r\n    );\r\n    if (!readIds.includes(id)) {\r\n      sessionStorage.setItem(\r\n        \"read_notif_ids\",\r\n        JSON.stringify([...readIds, id])\r\n      );\r\n    }\r\n    setNotifications((notifs) =>\r\n      notifs.map((n) => (n.id === id ? { ...n, isRead: true } : n))\r\n    );\r\n    setUnreadCount((c) => Math.max(0, c - 1));\r\n  };\r\n\r\n  const handleMarkAsUnread = (id) => {\r\n    const readIds = JSON.parse(\r\n      sessionStorage.getItem(\"read_notif_ids\") || \"[]\"\r\n    );\r\n    const filtered = readIds.filter((rid) => rid !== id);\r\n    sessionStorage.setItem(\"read_notif_ids\", JSON.stringify(filtered));\r\n    setNotifications((notifs) =>\r\n      notifs.map((n) => (n.id === id ? { ...n, isRead: false } : n))\r\n    );\r\n    setUnreadCount((c) => c + 1);\r\n  };\r\n\r\n  const handleDeleteNotification = (id) => {\r\n    const deletedIds = JSON.parse(\r\n      sessionStorage.getItem(\"deleted_notif_ids\") || \"[]\"\r\n    );\r\n    sessionStorage.setItem(\r\n      \"deleted_notif_ids\",\r\n      JSON.stringify([...deletedIds, id])\r\n    );\r\n    setNotifications((notifs) => notifs.filter((n) => n.id !== id));\r\n    // Update unread count if deleted notification was unread\r\n    const notif = notifications.find((n) => n.id === id);\r\n    if (notif && !notif.isRead) {\r\n      setUnreadCount((c) => Math.max(0, c - 1));\r\n    }\r\n  };\r\n\r\n  // Export to CSV\r\n  const exportToCSV = () => {\r\n    const headers = [\"Label\", \"Value\", \"Change\"];\r\n    const rows = stats.map((s) => [s.label, s.value, s.change]);\r\n    // Add low stock products\r\n    if (lowStockProducts.length > 0) {\r\n      rows.push([\"\", \"\", \"\"]); // separator\r\n      rows.push([\"Low Stock Products\", \"\", \"\"]);\r\n      rows.push([\"Product Name\", \"Quantity Left\", \"\"]);\r\n      lowStockProducts.forEach((p) =>\r\n        rows.push([p.product_name, p.quantity_in_stock, \"\"])\r\n      );\r\n    }\r\n    const csvContent = [headers, ...rows]\r\n      .map((row) => row.join(\",\"))\r\n      .join(\"\\n\");\r\n    const blob = new Blob([csvContent], { type: \"text/csv;charset=utf-8;\" });\r\n    const link = document.createElement(\"a\");\r\n    link.href = URL.createObjectURL(blob);\r\n    link.download = \"dashboard-data.csv\";\r\n    link.click();\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n    fetchNotifications();\r\n  }, [range]);\r\n\r\n  const headerActions = (\r\n    <div className=\"flex flex-wrap items-center gap-1 sm:gap-2\">\r\n      <button\r\n        onClick={fetchData}\r\n        disabled={loading}\r\n        title=\"Refresh Data\"\r\n        className=\"bg-white/80 backdrop-blur-sm hover:bg-white text-gray-700 p-1.5 sm:p-2 rounded-lg border border-gray-200/80 text-sm font-medium transition-all duration-200 hover:shadow-md hover:scale-[1.02]\"\r\n      >\r\n        <BiRefresh\r\n          className={`w-4 h-4 sm:w-5 sm:h-5 ${loading ? \"animate-spin\" : \"\"}`}\r\n        />\r\n      </button>\r\n\r\n      <select\r\n        className=\"bg-white/80 backdrop-blur-sm hover:bg-white text-gray-700 px-1.5 sm:px-3 py-1.5 sm:py-2 rounded-lg border border-gray-200/80 text-xs sm:text-sm font-medium transition-all duration-200 outline-none cursor-pointer hover:shadow-md\"\r\n        value={range}\r\n        onChange={(e) => setRange(e.target.value)}\r\n        disabled={loading}\r\n      >\r\n        <option value=\"week\">Week</option>\r\n        <option value=\"month\">Month</option>\r\n        <option value=\"year\">Year</option>\r\n      </select>\r\n\r\n      <div className=\"-mt-2 -mb-3 py-8 px-8 pr-12 flex justify-end\">\r\n        <Button\r\n          onClick={exportToCSV}\r\n          size=\"sm\"\r\n          variant=\"secondary\"\r\n          className=\"flex items-center gap-2 w-full sm:w-auto shrink-0\"\r\n        >\r\n          <svg\r\n            className=\"w-5 h-5\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\r\n            />\r\n          </svg>\r\n          <span className=\"hidden sm:inline\">Export</span>\r\n          <span className=\"sm:hidden\">Export</span>\r\n        </Button>\r\n      </div>\r\n\r\n      <div className=\"relative\" ref={notificationRef}>\r\n        <NotificationDropdown\r\n          notifications={notifications}\r\n          unreadCount={unreadCount}\r\n          onMarkAsRead={handleMarkAsRead}\r\n          onMarkAsUnread={handleMarkAsUnread}\r\n          onDelete={handleDeleteNotification}\r\n          isOpen={showNotifications}\r\n          onToggle={() => setShowNotifications(!showNotifications)}\r\n          containerRef={notificationRef}\r\n        />\r\n      </div>\r\n\r\n      <button\r\n        onClick={() => setShowProfileModal(true)}\r\n        className=\"flex items-center gap-1 sm:gap-2 bg-white/80 backdrop-blur-sm p-1 sm:p-1.5 sm:px-2 sm:py-2 rounded-lg border border-gray-200/80 hover:bg-white transition-all duration-200 hover:shadow-md hover:scale-[1.02] shrink-0\"\r\n      >\r\n        <div className=\"w-7 h-7 sm:w-8 sm:h-8 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-full flex items-center justify-center text-sm font-medium shadow-lg\">\r\n          {user.username?.[0]?.toUpperCase() || \"A\"}\r\n        </div>\r\n        <span className=\"text-sm font-medium text-gray-700 hidden sm:inline\">\r\n          {user.username || \"Admin\"}\r\n        </span>\r\n      </button>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <PageLayout\r\n      title=\"DASHBOARD\"\r\n      subtitle=\"\"\r\n      sidebar={<NavAdmin />}\r\n      headerActions={headerActions}\r\n      isSidebarOpen={isSidebarOpen}\r\n      setSidebarOpen={setSidebarOpen}\r\n      className=\"bg-gray-50 min-h-screen\"\r\n    >\r\n      {/* Stats Cards - Mobile View */}\r\n      {/* <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 lg:hidden\">\r\n        {loading\r\n          ? Array.from({ length: 4 }).map((_, i) => (\r\n              <div\r\n                key={i}\r\n                className=\"bg-white p-4 rounded-xl shadow-sm border border-gray-200 animate-pulse\"\r\n              >\r\n                <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-2\"></div>\r\n                <div className=\"h-8 bg-gray-300 rounded w-1/2\"></div>\r\n              </div>\r\n            ))\r\n          : stats.map((stat, index) => (\r\n              <div\r\n                key={index}\r\n                className=\"bg-white p-4 rounded-xl shadow-sm border border-gray-200\"\r\n              >\r\n                <h4 className=\"text-sm font-medium text-gray-500\">\r\n                  {stat.label}\r\n                </h4>\r\n                <p className=\"text-2xl font-bold text-gray-900 mt-1\">\r\n                  {typeof stat.value === \"number\"\r\n                    ? stat.value.toLocaleString()\r\n                    : stat.value}\r\n                </p>\r\n                {stat.change ? (\r\n                  <p\r\n                    className={`text-xs font-medium mt-1 ${\r\n                      stat.change > 0 ? \"text-green-600\" : \"text-red-600\"\r\n                    }`}\r\n                  >\r\n                    {stat.change > 0 ? \"+\" : \"\"}\r\n                    {stat.change.toFixed(2)}%\r\n                  </p>\r\n                ) : null}\r\n              </div>\r\n            ))}\r\n      </div> */}\r\n\r\n      {/* Low Stock Products - Mobile View */}\r\n      <div className=\"p-4 lg:hidden\">\r\n        {loading ? (\r\n          <div className=\"bg-white p-6 rounded-xl shadow-md border border-gray-200 animate-pulse\">\r\n            <div className=\"h-6 bg-gray-200 rounded w-1/2 mb-6\"></div>\r\n            <div className=\"h-4 bg-gray-200 rounded w-full mb-3\"></div>\r\n            <div className=\"h-4 bg-gray-200 rounded w-full mb-3\"></div>\r\n            <div className=\"h-4 bg-gray-200 rounded w-4/5\"></div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"bg-white p-6 rounded-xl shadow-md\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n              <h3 className=\"text-lg font-bold text-gray-800\">\r\n                Low Stock Products\r\n              </h3>\r\n            </div>\r\n            <LowStockList lowStockProducts={lowStockProducts} />\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 w-full p-3\">\r\n        <div className=\"bg-white rounded-lg p-5 border border-gray-200 shadow-sm\">\r\n          <p className=\"text-xs font-medium text-gray-500 uppercase mb-1\">\r\n            Total Revenue\r\n          </p>\r\n          <p className=\"text-2xl font-bold text-gray-900\">\r\n            ₱{keyMetrics.revenue.value.toLocaleString()}\r\n          </p>\r\n          <p className={`text-xs mt-2 ${keyMetrics.revenue.change >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n            {keyMetrics.revenue.change >= 0 ? '↗' : '↘'} {keyMetrics.revenue.change}%\r\n          </p>\r\n        </div>\r\n        <div className=\"bg-white rounded-lg p-5 border border-gray-200 shadow-sm\">\r\n          <p className=\"text-xs font-medium text-gray-500 uppercase mb-1\">\r\n            Operating Expenses\r\n          </p>\r\n          <p className=\"text-2xl font-bold text-gray-900\">\r\n            ₱{keyMetrics.expenses.value.toLocaleString()}\r\n          </p>\r\n          <p className={`text-xs mt-2 ${keyMetrics.expenses.change >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n            {keyMetrics.expenses.change >= 0 ? '↗' : '↘'} {keyMetrics.expenses.change}%\r\n          </p>\r\n        </div>\r\n        <div className=\"bg-white rounded-lg p-5 border border-gray-200 shadow-sm\">\r\n          <p className=\"text-xs font-medium text-gray-500 uppercase mb-1\">\r\n            Net Profit\r\n          </p>\r\n          <p className=\"text-2xl font-bold text-gray-900\">\r\n            ₱{keyMetrics.netProfit.value.toLocaleString()}\r\n          </p>\r\n          <p className={`text-xs mt-2 ${keyMetrics.netProfit.change >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n            {keyMetrics.netProfit.change >= 0 ? '↗' : '↘'} {keyMetrics.netProfit.change}%\r\n          </p>\r\n        </div>\r\n        <div className=\"bg-white rounded-lg p-5 border border-gray-200 shadow-sm\">\r\n          <p className=\"text-xs font-medium text-gray-500 uppercase mb-1\">\r\n            Gross Margin\r\n          </p>\r\n          <p className=\"text-2xl font-bold text-gray-900\">\r\n            {keyMetrics.grossMargin.value}%\r\n          </p>\r\n          <p className={`text-xs mt-2 ${keyMetrics.grossMargin.change >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n            {keyMetrics.grossMargin.change >= 0 ? '↗' : '↘'} {keyMetrics.grossMargin.change}%\r\n          </p>\r\n        </div>\r\n      </div>\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-6 p-6 pb-10 lg:pb-6 pt-0\">\r\n        {/* Main Chart Area */}\r\n        <div className=\"lg:col-span-8 flex flex-col gap-6\">\r\n          {loading ? (\r\n            <>\r\n              <div className=\"bg-white p-6 rounded-xl shadow-md border border-gray-200 h-[336px] animate-pulse flex items-center justify-center\">\r\n                <div className=\"w-full h-64 bg-gray-200 rounded-lg\"></div>\r\n              </div>\r\n              <div className=\"bg-white p-6 rounded-xl shadow-md border border-gray-200 h-[336px] animate-pulse flex items-center justify-center\">\r\n                <div className=\"w-64 h-64 bg-gray-200 rounded-full\"></div>\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <VisitorsChart data={chartData} range={range} />\r\n              <SalesPieChart data={pieData} />\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {/* Sidebar with Stats and Low Stock */}\r\n        <div className=\"lg:col-span-4 flex flex-col gap-6\">\r\n          {loading ? (\r\n            <div className=\"bg-white p-6 rounded-xl shadow-md border border-gray-200 animate-pulse\">\r\n              <div className=\"h-6 bg-gray-200 rounded w-1/3 mb-4\"></div>\r\n              <div className=\"h-8 bg-gray-300 rounded w-1/2 mb-6\"></div>\r\n              <div className=\"h-6 bg-gray-200 rounded w-1/3 mb-4\"></div>\r\n              <div className=\"h-8 bg-gray-300 rounded w-1/2 mb-6\"></div>\r\n              <div className=\"h-6 bg-gray-200 rounded w-1/3 mb-4\"></div>\r\n              <div className=\"h-8 bg-gray-300 rounded w-1/2\"></div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"hidden lg:block\">\r\n              <DashboardStatsCard stats={highlight} />\r\n            </div>\r\n          )}\r\n          {loading ? (\r\n            <div className=\"bg-white p-6 rounded-xl shadow-md border border-gray-200 animate-pulse hidden lg:block\">\r\n              <div className=\"h-6 bg-gray-200 rounded w-1/2 mb-6\"></div>\r\n              <div className=\"h-4 bg-gray-200 rounded w-full mb-3\"></div>\r\n              <div className=\"h-4 bg-gray-200 rounded w-full mb-3\"></div>\r\n              <div className=\"h-4 bg-gray-200 rounded w-4/5\"></div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"bg-white p-6 rounded-lg shadow-md hidden lg:block\">\r\n              <div className=\"flex justify-between items-center mb-4\">\r\n                <h3 className=\"text-lg font-bold text-gray-800\">\r\n                  Low Stock Products\r\n                </h3>\r\n              </div>\r\n              {lowStockProducts.length > 0 ? (\r\n                <ul className=\"divide-y divide-gray-200\">\r\n                  {lowStockProducts.map((product) => (\r\n                    <li\r\n                      key={product.product_id}\r\n                      className=\"py-3 flex justify-between items-center\"\r\n                    >\r\n                      <span className=\"text-sm font-medium text-gray-800\">\r\n                        {product.product_name}\r\n                      </span>\r\n                      <span className=\"text-sm font-bold text-red-600\">\r\n                        {product.quantity_in_stock} left\r\n                      </span>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              ) : (\r\n                <p className=\"text-sm text-gray-500\">\r\n                  No products with low stock.\r\n                </p>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n      <div className=\"max-w-10lx mx-auto w-full\">\r\n        <DashboardBusinessReport />\r\n      </div>\r\n      <ProfileModal\r\n        isOpen={showProfileModal}\r\n        onClose={() => setShowProfileModal(false)}\r\n        userData={user}\r\n      />\r\n    </PageLayout>\r\n  );\r\n}\r\n\r\nfunction LowStockList({ lowStockProducts }) {\r\n  if (lowStockProducts.length === 0) {\r\n    return <p className=\"text-sm text-gray-500\">No products with low stock.</p>;\r\n  }\r\n\r\n  return (\r\n    <ul className=\"divide-y divide-gray-200\">\r\n      {lowStockProducts.map((product) => (\r\n        <li\r\n          key={product.product_id}\r\n          className=\"py-3 flex justify-between items-center\"\r\n        >\r\n          <span className=\"text-sm font-medium text-gray-800\">\r\n            {product.product_name}\r\n          </span>\r\n          <span className=\"text-sm font-bold text-red-600\">\r\n            {product.quantity_in_stock} left\r\n          </span>\r\n        </li>\r\n      ))}\r\n    </ul>\r\n  );\r\n}\r\n"],"names":["ChartCard","title","children","className","props","Card","jsx","SectionHeader","size","align","jsxs","DashboardStatsCard","stats","Number","sales","toLocaleString","transactions","topProduct","totalItemsSold","averageTransactionValue","TrendIcon","trend","DashboardBusinessReport","salesByLocation","setSalesByLocation","useState","revenueVsExpenses","setRevenueVsExpenses","profitTrend","setProfitTrend","paymentMethods","setPaymentMethods","productPerformance","setProductPerformance","keyMetrics","setKeyMetrics","businessStats","setBusinessStats","cashFlow","operatingCosts","profitGrowth","blueShades","useEffect","async","keyMetricsRes","salesByLocationRes","revenueVsExpensesRes","profitTrendRes","paymentMethodsRes","productPerformanceRes","businessStatsRes","Promise","all","api","error","fetchData","ResponsiveContainer","width","height","BarChart","data","margin","top","right","left","bottom","CartesianGrid","strokeDasharray","stroke","XAxis","dataKey","tick","fontSize","fill","padding","YAxis","Tooltip","contentStyle","background","borderColor","borderRadius","fontWeight","labelStyle","color","Bar","radius","barSize","Legend","verticalAlign","wrapperStyle","paddingBottom","LineChart","Line","type","strokeWidth","dot","r","PieChart","Pie","cx","cy","labelLine","label","name","value","outerRadius","map","entry","index","Cell","length","formatter","toFixed","payload","maxSales","Math","max","p","product","progressPercent","round","role","style","SOFT_BLUE","SOFT_PURPLE","VisitorsChart","range","week","month","year","SalesPieChart","nameKey","percent","idx","colors","Dashboard","revenue","change","expenses","netProfit","grossMargin","setStats","setRange","loading","setLoading","chartData","setChartData","pieData","setPieData","highlight","setHighlight","lowStockProducts","setLowStockProducts","showProfileModal","setShowProfileModal","notifications","setNotifications","unreadCount","setUnreadCount","showNotifications","setShowNotifications","notificationRef","React","useRef","useAuth","isSidebarOpen","setSidebarOpen","user","useMemo","JSON","parse","sessionStorage","getItem","e","handleClickOutside","event","current","contains","target","addEventListener","document","removeEventListener","token","overview","timeseries","pie","inventoryMovement","oldLowStock","headers","authHeaders","derived","d","customers","total","pieTotal","reduce","s","piePercent","undefined","totalSales","totalTransactions","topProducts","product_name","totalExpenses","revenueChange","prevTotalSales","low","filter","quantity_in_stock","err","resp","readIds","Set","deletedIds","mapped","log","has","log_id","id","action","message","username","time","Date","date_time","isRead","n","fetchNotifications","headerActions","onClick","disabled","BiRefresh","onChange","Button","exportToCSV","rows","push","forEach","csvContent","row","join","blob","Blob","link","createElement","href","URL","createObjectURL","download","click","variant","viewBox","strokeLinecap","strokeLinejoin","ref","NotificationDropdown","onMarkAsRead","includes","setItem","stringify","notifs","c","onMarkAsUnread","filtered","rid","onDelete","notif","find","isOpen","onToggle","containerRef","toUpperCase","PageLayout","subtitle","sidebar","NavAdmin","LowStockList","Fragment","product_id","ProfileModal","onClose","userData"],"mappings":"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"}