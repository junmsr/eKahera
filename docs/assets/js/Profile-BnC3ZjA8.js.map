{"version":3,"file":"Profile-BnC3ZjA8.js","sources":["../../../frontend/src/components/common/SelectDropdown.jsx","../../../frontend/src/components/modals/ProfileModal.jsx","../../../frontend/src/pages/Profile.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\r\nimport { BiChevronDown, BiChevronUp, BiSearch, BiCheck } from \"react-icons/bi\";\r\n\r\n/**\r\n * Modern SelectDropdown Component with enhanced UI/UX\r\n * Features:\r\n * - Custom styling with animations\r\n * - Search/filter functionality\r\n * - Keyboard navigation\r\n * - Error state handling\r\n * - Accessibility support\r\n */\r\nexport default function SelectDropdown({\r\n  name,\r\n  value,\r\n  options = [],\r\n  placeholder = \"Select an option\",\r\n  onChange,\r\n  error,\r\n  disabled = false,\r\n  searchable = true,\r\n  className = \"\",\r\n  required = false,\r\n}) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\r\n  const dropdownRef = useRef(null);\r\n  const inputRef = useRef(null);\r\n\r\n  // Filter options based on search term\r\n  const filteredOptions = options.filter((option) =>\r\n    option.label.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  // Handle click outside to close dropdown\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\r\n        setIsOpen(false);\r\n        setSearchTerm(\"\");\r\n        setHighlightedIndex(-1);\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n  }, []);\r\n\r\n  // Handle keyboard navigation\r\n  useEffect(() => {\r\n    const handleKeyDown = (event) => {\r\n      if (!isOpen) return;\r\n\r\n      switch (event.key) {\r\n        case \"ArrowDown\":\r\n          event.preventDefault();\r\n          setHighlightedIndex((prev) =>\r\n            prev < filteredOptions.length - 1 ? prev + 1 : 0\r\n          );\r\n          break;\r\n        case \"ArrowUp\":\r\n          event.preventDefault();\r\n          setHighlightedIndex((prev) =>\r\n            prev > 0 ? prev - 1 : filteredOptions.length - 1\r\n          );\r\n          break;\r\n        case \"Enter\":\r\n          event.preventDefault();\r\n          if (\r\n            highlightedIndex >= 0 &&\r\n            highlightedIndex < filteredOptions.length\r\n          ) {\r\n            handleSelect(filteredOptions[highlightedIndex]);\r\n          }\r\n          break;\r\n        case \"Escape\":\r\n          setIsOpen(false);\r\n          setSearchTerm(\"\");\r\n          setHighlightedIndex(-1);\r\n          break;\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"keydown\", handleKeyDown);\r\n    return () => document.removeEventListener(\"keydown\", handleKeyDown);\r\n  }, [isOpen, highlightedIndex, filteredOptions]);\r\n\r\n  const handleSelect = (option) => {\r\n    onChange({ target: { name, value: option.value } });\r\n    setIsOpen(false);\r\n    setSearchTerm(\"\");\r\n    setHighlightedIndex(-1);\r\n  };\r\n\r\n  const handleToggle = () => {\r\n    if (disabled) return;\r\n    setIsOpen(!isOpen);\r\n    if (!isOpen) {\r\n      setTimeout(() => inputRef.current?.focus(), 100);\r\n    } else {\r\n      setSearchTerm(\"\");\r\n      setHighlightedIndex(-1);\r\n    }\r\n  };\r\n\r\n  const selectedOption = options.find((option) => option.value === value);\r\n\r\n  return (\r\n    <div className={`relative ${className}`} ref={dropdownRef}>\r\n      {/* Trigger Button */}\r\n      <button\r\n        type=\"button\"\r\n        onClick={handleToggle}\r\n        disabled={disabled}\r\n        className={`\r\n          w-full px-4 py-3 text-left bg-white border rounded-lg shadow-sm transition-all duration-200\r\n          flex items-center justify-between\r\n          ${\r\n            error\r\n              ? \"border-red-300 focus:ring-red-500 focus:border-red-500\"\r\n              : \"border-gray-300 focus:ring-blue-500 focus:border-blue-500\"\r\n          }\r\n          ${\r\n            disabled\r\n              ? \"bg-gray-50 text-gray-400 cursor-not-allowed\"\r\n              : \"hover:border-gray-400 focus:ring-2 focus:outline-none\"\r\n          }\r\n          ${isOpen ? \"ring-2 ring-blue-500 border-blue-500\" : \"\"}\r\n        `}\r\n      >\r\n        <span\r\n          className={`truncate ${\r\n            selectedOption ? \"text-gray-900\" : \"text-gray-500\"\r\n          }`}\r\n        >\r\n          {selectedOption ? selectedOption.label : placeholder}\r\n        </span>\r\n        <div className=\"flex items-center gap-2\">\r\n          {selectedOption && (\r\n            <BiCheck className=\"w-4 h-4 text-blue-600 flex-shrink-0\" />\r\n          )}\r\n          {isOpen ? (\r\n            <BiChevronUp className=\"w-5 h-5 text-gray-400 flex-shrink-0\" />\r\n          ) : (\r\n            <BiChevronDown className=\"w-5 h-5 text-gray-400 flex-shrink-0\" />\r\n          )}\r\n        </div>\r\n      </button>\r\n\r\n      {/* Dropdown Menu */}\r\n      {isOpen && (\r\n        <div className=\"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg animate-in fade-in slide-in-from-top-2 duration-200\">\r\n          {/* Search Input */}\r\n          {searchable && options.length > 5 && (\r\n            <div className=\"p-3 border-b border-gray-100\">\r\n              <div className=\"relative\">\r\n                <BiSearch className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\r\n                <input\r\n                  ref={inputRef}\r\n                  type=\"text\"\r\n                  placeholder=\"Search options...\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => {\r\n                    setSearchTerm(e.target.value);\r\n                    setHighlightedIndex(-1);\r\n                  }}\r\n                  className=\"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:outline-none text-sm\"\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Options List */}\r\n          <div className=\"max-h-60 overflow-y-auto\">\r\n            {filteredOptions.length > 0 ? (\r\n              filteredOptions.map((option, index) => (\r\n                <button\r\n                  key={option.value}\r\n                  type=\"button\"\r\n                  onClick={() => handleSelect(option)}\r\n                  onMouseEnter={() => setHighlightedIndex(index)}\r\n                  className={`\r\n                    w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors duration-150\r\n                    flex items-center justify-between group\r\n                    ${highlightedIndex === index ? \"bg-blue-50\" : \"\"}\r\n                    ${\r\n                      option.value === value\r\n                        ? \"bg-blue-50 text-blue-700\"\r\n                        : \"text-gray-900\"\r\n                    }\r\n                  `}\r\n                >\r\n                  <span className=\"truncate\">{option.label}</span>\r\n                  {option.value === value && (\r\n                    <BiCheck className=\"w-4 h-4 text-blue-600 flex-shrink-0 ml-2\" />\r\n                  )}\r\n                </button>\r\n              ))\r\n            ) : (\r\n              <div className=\"px-4 py-8 text-center text-gray-500 text-sm\">\r\n                {searchTerm ? \"No options found\" : \"No options available\"}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer with selected count */}\r\n          {selectedOption && (\r\n            <div className=\"px-4 py-2 border-t border-gray-100 bg-gray-50 text-xs text-gray-500\">\r\n              Selected: {selectedOption.label}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Error Message */}\r\n      {error && (\r\n        <p className=\"mt-1 text-sm text-red-600 flex items-center\">\r\n          <svg\r\n            className=\"w-4 h-4 mr-1 flex-shrink-0\"\r\n            fill=\"currentColor\"\r\n            viewBox=\"0 0 20 20\"\r\n          >\r\n            <path\r\n              fillRule=\"evenodd\"\r\n              d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\"\r\n              clipRule=\"evenodd\"\r\n            />\r\n          </svg>\r\n          {error}\r\n        </p>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport Button from \"../common/Button\";\r\nimport FormField from \"../common/FormField\";\r\nimport SelectDropdown from \"../common/SelectDropdown\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport { useKeyboardShortcuts } from \"../../hooks/useKeyboardShortcuts\";\r\nimport { api } from \"../../lib/api\";\r\nimport {\r\n  getRegions,\r\n  getProvinces,\r\n  getCities,\r\n  getBarangays,\r\n} from \"../../lib/locationApi\";\r\n\r\n/**\r\n * ProfileModal Component\r\n * Modern, trending UI/UX design with glassmorphism and animations\r\n */\r\nconst ProfileModal = ({ isOpen, onClose, userData, businessData }) => {\r\n  const [profileData, setProfileData] = useState({\r\n    first_name: userData?.first_name || \"\",\r\n    last_name: userData?.last_name || \"\",\r\n    email: userData?.email || \"\",\r\n    contact_number: userData?.contact_number || \"\",\r\n    currentPassword: \"\",\r\n    newPassword: \"\",\r\n    confirmPassword: \"\",\r\n    // Business fields\r\n    business_name: businessData?.business_name || \"\",\r\n    business_email: businessData?.email || \"\",\r\n    business_type: businessData?.business_type || \"\",\r\n    region: businessData?.region || \"\",\r\n    province: businessData?.province || \"\",\r\n    city: businessData?.city || \"\",\r\n    barangay: businessData?.barangay || \"\",\r\n    house_street:\r\n      businessData?.house_number ||\r\n      businessData?.business_address ||\r\n      businessData?.address_line ||\r\n      \"\",\r\n    country: businessData?.country || \"Philippines\",\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [errors, setErrors] = useState({});\r\n  const [touched, setTouched] = useState({});\r\n  const [activeTab, setActiveTab] = useState(\"account\");\r\n  const [locationOptions, setLocationOptions] = useState({\r\n    regions: [],\r\n    provinces: [],\r\n    cities: [],\r\n    barangays: [],\r\n  });\r\n  const [locationLoading, setLocationLoading] = useState({\r\n    regions: false,\r\n    provinces: false,\r\n    cities: false,\r\n    barangays: false,\r\n  });\r\n  const initialLocationRef = useRef({\r\n    region: businessData?.region || \"\",\r\n    province: businessData?.province || \"\",\r\n    city: businessData?.city || \"\",\r\n    barangay: businessData?.barangay || \"\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (userData || businessData) {\r\n      setProfileData({\r\n        first_name: userData?.first_name || \"\",\r\n        last_name: userData?.last_name || \"\",\r\n        email: userData?.email || \"\",\r\n        contact_number: userData?.contact_number || \"\",\r\n        currentPassword: \"\",\r\n        newPassword: \"\",\r\n        confirmPassword: \"\",\r\n        // Business fields\r\n        business_name: businessData?.business_name || \"\",\r\n        business_email: businessData?.email || \"\",\r\n        business_type: businessData?.business_type || \"\",\r\n        region: businessData?.region || \"\",\r\n        province: businessData?.province || \"\",\r\n        city: businessData?.city || \"\",\r\n        barangay: businessData?.barangay || \"\",\r\n        house_street:\r\n          businessData?.house_number ||\r\n          businessData?.business_address ||\r\n          businessData?.address_line ||\r\n          \"\",\r\n        country: businessData?.country || \"Philippines\",\r\n      });\r\n      setMessage(\"\");\r\n      setError(\"\");\r\n      setErrors({});\r\n      setTouched({});\r\n      setActiveTab(\"account\");\r\n    }\r\n  }, [userData, businessData, isOpen]);\r\n\r\n  // Helpers\r\n  const findOptionByLabel = (options, label) => {\r\n    if (!label) return null;\r\n    const target = label.toLowerCase().trim();\r\n    return options.find((o) => o.label.toLowerCase() === target) || null;\r\n  };\r\n\r\n  const getLabel = (options, value, fallback) => {\r\n    const match = options.find((o) => o.value === value);\r\n    return match ? match.label : fallback || \"\";\r\n  };\r\n\r\n  // Fetch regions on open\r\n  useEffect(() => {\r\n    const fetchRegions = async () => {\r\n      try {\r\n        setLocationLoading((l) => ({ ...l, regions: true }));\r\n        const data = await getRegions();\r\n        const options = data.map((r) => ({ value: r.code, label: r.name }));\r\n        setLocationOptions((o) => ({ ...o, regions: options }));\r\n      } catch (err) {\r\n        console.error(\"Failed to load regions\", err);\r\n      } finally {\r\n        setLocationLoading((l) => ({ ...l, regions: false }));\r\n      }\r\n    };\r\n    if (isOpen) {\r\n      fetchRegions();\r\n    }\r\n  }, [isOpen]);\r\n\r\n  // When regions loaded, map existing region name to code\r\n  useEffect(() => {\r\n    if (\r\n      locationOptions.regions.length &&\r\n      initialLocationRef.current.region &&\r\n      !profileData.region\r\n    ) {\r\n      const match = findOptionByLabel(\r\n        locationOptions.regions,\r\n        initialLocationRef.current.region\r\n      );\r\n      if (match) {\r\n        setProfileData((p) => ({ ...p, region: match.value }));\r\n      }\r\n    }\r\n  }, [locationOptions.regions, profileData.region]);\r\n\r\n  // Fetch provinces when region changes\r\n  useEffect(() => {\r\n    const loadProvinces = async () => {\r\n      if (!profileData.region) {\r\n        setLocationOptions((o) => ({\r\n          ...o,\r\n          provinces: [],\r\n          cities: [],\r\n          barangays: [],\r\n        }));\r\n        return;\r\n      }\r\n      try {\r\n        setLocationLoading((l) => ({ ...l, provinces: true }));\r\n        const data = await getProvinces(profileData.region);\r\n        const options = data.map((p) => ({ value: p.code, label: p.name }));\r\n        setLocationOptions((o) => ({\r\n          ...o,\r\n          provinces: options,\r\n          cities: [],\r\n          barangays: [],\r\n        }));\r\n\r\n        // Preselect province if we have a name from initial data\r\n        if (initialLocationRef.current.province) {\r\n          const match = findOptionByLabel(\r\n            options,\r\n            initialLocationRef.current.province\r\n          );\r\n          if (match) {\r\n            setProfileData((p) => ({ ...p, province: match.value }));\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Failed to load provinces\", err);\r\n      } finally {\r\n        setLocationLoading((l) => ({ ...l, provinces: false }));\r\n      }\r\n    };\r\n    loadProvinces();\r\n  }, [profileData.region]);\r\n\r\n  // Fetch cities when province changes\r\n  useEffect(() => {\r\n    const loadCities = async () => {\r\n      if (!profileData.province) {\r\n        setLocationOptions((o) => ({ ...o, cities: [], barangays: [] }));\r\n        return;\r\n      }\r\n      try {\r\n        setLocationLoading((l) => ({ ...l, cities: true }));\r\n        const data = await getCities(profileData.province);\r\n        const options = data.map((c) => ({ value: c.code, label: c.name }));\r\n        setLocationOptions((o) => ({ ...o, cities: options, barangays: [] }));\r\n\r\n        // Preselect city\r\n        if (initialLocationRef.current.city) {\r\n          const match = findOptionByLabel(\r\n            options,\r\n            initialLocationRef.current.city\r\n          );\r\n          if (match) {\r\n            setProfileData((p) => ({ ...p, city: match.value }));\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Failed to load cities\", err);\r\n      } finally {\r\n        setLocationLoading((l) => ({ ...l, cities: false }));\r\n      }\r\n    };\r\n    loadCities();\r\n  }, [profileData.province]);\r\n\r\n  // Fetch barangays when city changes\r\n  useEffect(() => {\r\n    const loadBarangays = async () => {\r\n      if (!profileData.city) {\r\n        setLocationOptions((o) => ({ ...o, barangays: [] }));\r\n        return;\r\n      }\r\n      try {\r\n        setLocationLoading((l) => ({ ...l, barangays: true }));\r\n        const data = await getBarangays(profileData.city);\r\n        const options = data.map((b) => ({ value: b.code, label: b.name }));\r\n        setLocationOptions((o) => ({ ...o, barangays: options }));\r\n\r\n        // Preselect barangay\r\n        if (initialLocationRef.current.barangay) {\r\n          const match = findOptionByLabel(\r\n            options,\r\n            initialLocationRef.current.barangay\r\n          );\r\n          if (match) {\r\n            setProfileData((p) => ({ ...p, barangay: match.value }));\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Failed to load barangays\", err);\r\n      } finally {\r\n        setLocationLoading((l) => ({ ...l, barangays: false }));\r\n      }\r\n    };\r\n    loadBarangays();\r\n  }, [profileData.city]);\r\n\r\n  const validateField = (name, value) => {\r\n    const newErrors = { ...errors };\r\n\r\n    switch (name) {\r\n      case \"first_name\":\r\n        if (activeTab === \"account\" && !value.trim()) {\r\n          newErrors.first_name = \"First name is required\";\r\n        } else if (value.trim().length < 2) {\r\n          newErrors.first_name = \"First name must be at least 2 characters\";\r\n        } else {\r\n          delete newErrors.first_name;\r\n        }\r\n        break;\r\n\r\n      case \"last_name\":\r\n        if (activeTab === \"account\" && !value.trim()) {\r\n          newErrors.last_name = \"Last name is required\";\r\n        } else if (value.trim().length < 2) {\r\n          newErrors.last_name = \"Last name must be at least 2 characters\";\r\n        } else {\r\n          delete newErrors.last_name;\r\n        }\r\n        break;\r\n\r\n      case \"email\":\r\n        if (activeTab === \"account\" && !value.trim()) {\r\n          newErrors.email = \"Email is required\";\r\n        } else if (\r\n          value.trim() &&\r\n          !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value.trim())\r\n        ) {\r\n          newErrors.email = \"Please enter a valid email\";\r\n        } else {\r\n          delete newErrors.email;\r\n        }\r\n        break;\r\n\r\n      case \"contact_number\":\r\n        if (value && value.trim().length < 7) {\r\n          newErrors.contact_number = \"Phone number must be at least 7 digits\";\r\n        } else {\r\n          delete newErrors.contact_number;\r\n        }\r\n        break;\r\n\r\n      case \"business_email\":\r\n        if (value.trim() && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value.trim())) {\r\n          newErrors.business_email = \"Please enter a valid email\";\r\n        } else {\r\n          delete newErrors.business_email;\r\n        }\r\n        break;\r\n\r\n      case \"currentPassword\":\r\n        if (profileData.newPassword && !value) {\r\n          newErrors.currentPassword =\r\n            \"Current password is required to change password\";\r\n        } else {\r\n          delete newErrors.currentPassword;\r\n        }\r\n        break;\r\n\r\n      case \"newPassword\":\r\n        if (value && value.length < 6) {\r\n          newErrors.newPassword = \"Password must be at least 6 characters\";\r\n        } else {\r\n          delete newErrors.newPassword;\r\n        }\r\n        break;\r\n\r\n      case \"confirmPassword\":\r\n        if (value && value !== profileData.newPassword) {\r\n          newErrors.confirmPassword = \"Passwords do not match\";\r\n        } else {\r\n          delete newErrors.confirmPassword;\r\n        }\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n\r\n    setErrors(newErrors);\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setProfileData((prev) => ({\r\n      ...prev,\r\n      [name]: value,\r\n    }));\r\n    if (touched[name]) {\r\n      validateField(name, value);\r\n    }\r\n  };\r\n\r\n  const handleBlur = (e) => {\r\n    const { name, value } = e.target;\r\n    setTouched((prev) => ({ ...prev, [name]: true }));\r\n    validateField(name, value);\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setMessage(\"\");\r\n    setError(\"\");\r\n\r\n    if (activeTab === \"security\") {\r\n      if (!profileData.currentPassword || !profileData.newPassword || !profileData.confirmPassword) {\r\n        setError(\"Please fill in all password fields.\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      if (profileData.newPassword !== profileData.confirmPassword) {\r\n        setError(\"New password and confirmation do not match.\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n    }\r\n\r\n    try {\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n\r\n      if (activeTab === \"account\" || activeTab === \"security\") {\r\n        const updateData = {\r\n          first_name: profileData.first_name,\r\n          last_name: profileData.last_name,\r\n          email: profileData.email,\r\n          contact_number: profileData.contact_number,\r\n        };\r\n\r\n        // Add password fields if user is changing password\r\n        if (profileData.newPassword) {\r\n          updateData.currentPassword = profileData.currentPassword;\r\n          updateData.newPassword = profileData.newPassword;\r\n        }\r\n\r\n        await api(\"/api/auth/update-profile\", {\r\n          method: \"PUT\",\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          body: JSON.stringify(updateData),\r\n        });\r\n      } else if (activeTab === \"business\") {\r\n        const regionLabel = getLabel(\r\n          locationOptions.regions,\r\n          profileData.region,\r\n          businessData?.region\r\n        );\r\n        const provinceLabel = getLabel(\r\n          locationOptions.provinces,\r\n          profileData.province,\r\n          businessData?.province\r\n        );\r\n        const cityLabel = getLabel(\r\n          locationOptions.cities,\r\n          profileData.city,\r\n          businessData?.city\r\n        );\r\n        const barangayLabel = getLabel(\r\n          locationOptions.barangays,\r\n          profileData.barangay,\r\n          businessData?.barangay\r\n        );\r\n\r\n        const businessUpdateData = {\r\n          businessName: profileData.business_name || undefined,\r\n          businessType: profileData.business_type || undefined,\r\n          businessAddress: [\r\n            profileData.house_street,\r\n            barangayLabel,\r\n            cityLabel,\r\n            provinceLabel,\r\n            regionLabel,\r\n            profileData.country || \"Philippines\",\r\n          ]\r\n            .filter(Boolean)\r\n            .join(\", \"),\r\n          houseNumber: profileData.house_street || undefined,\r\n          country: profileData.country || \"Philippines\",\r\n          business_email: profileData.business_email || undefined,\r\n        };\r\n\r\n        await api(\"/api/business/update-business\", {\r\n          method: \"PUT\",\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          body: JSON.stringify(businessUpdateData),\r\n        });\r\n      }\r\n\r\n      setMessage(\"Profile updated successfully!\");\r\n      setTimeout(() => {\r\n        onClose();\r\n        window.location.reload();\r\n      }, 2000);\r\n    } catch (err) {\r\n      console.error(\"Failed to update profile:\", err);\r\n      setError(err.message || \"Failed to update profile. Please try again.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Reset form when modal opens/closes\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setActiveTab(\"account\");\r\n      setProfileData({\r\n        first_name: userData?.first_name || \"\",\r\n        last_name: userData?.last_name || \"\",\r\n        email: userData?.email || \"\",\r\n        contact_number: userData?.contact_number || \"\",\r\n        currentPassword: \"\",\r\n        newPassword: \"\",\r\n        confirmPassword: \"\",\r\n        business_name: businessData?.business_name || \"\",\r\n        business_email: businessData?.email || \"\",\r\n        business_type: businessData?.business_type || \"\",\r\n        region: businessData?.region || \"\",\r\n        province: businessData?.province || \"\",\r\n        city: businessData?.city || \"\",\r\n        barangay: businessData?.barangay || \"\",\r\n        house_street:\r\n          businessData?.house_number ||\r\n          businessData?.business_address ||\r\n          businessData?.address_line ||\r\n          \"\",\r\n        country: businessData?.country || \"Philippines\",\r\n      });\r\n      setErrors({});\r\n      setTouched({});\r\n      setMessage(\"\");\r\n      setError(\"\");\r\n    }\r\n  }, [isOpen, userData, businessData]);\r\n\r\n  // Set up keyboard shortcuts\r\n  useKeyboardShortcuts(\r\n    [\r\n      {\r\n        key: \"escape\",\r\n        action: onClose,\r\n        enabled: isOpen,\r\n        allowWhileTyping: true,\r\n      },\r\n      {\r\n        key: \"enter\",\r\n        action: (e) => {\r\n          if (isOpen) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            handleSubmit(e);\r\n          }\r\n        },\r\n        enabled: isOpen && activeTab !== \"security\",\r\n      },\r\n    ],\r\n    [isOpen, onClose, handleSubmit, activeTab]\r\n  );\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const storeLabel =\r\n    userData?.store_name ||\r\n    userData?.storeName ||\r\n    userData?.businessName ||\r\n    \"your store\";\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Update Password\"\r\n      subtitle={\r\n        <div className=\"flex flex-col gap-2\">\r\n          <p>Cashiers can only change their password here</p>\r\n        </div>\r\n      }\r\n      footer={\r\n        <div className=\"w-full flex gap-2 justify-end\">\r\n          <Button\r\n            label=\"Cancel\"\r\n            variant=\"secondary\"\r\n            onClick={onClose}\r\n            disabled={loading}\r\n          />\r\n          <Button\r\n            label={\r\n              loading ? \"Saving...\" : \"Save Password (Enter)\"\r\n            }\r\n            variant=\"primary\"\r\n            onClick={handleSubmit}\r\n            disabled={loading}\r\n          />\r\n        </div>\r\n      }\r\n    >\r\n      {message && (\r\n        <div className=\"text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded-lg px-3 py-2 mb-3\">\r\n          {message}\r\n        </div>\r\n      )}\r\n      {error && (\r\n        <div className=\"text-sm text-red-700 bg-red-50 border border-red-200 rounded-lg px-3 py-2 mb-3\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {/* Tab Navigation */}\r\n      <div className=\"flex gap-1 border-b border-slate-200/10 -mx-6 px-6\">\r\n        <button\r\n          onClick={() => setActiveTab(\"account\")}\r\n          className={`px-4 py-2 rounded-t-xl font-medium transition-all duration-200 relative ${\r\n            activeTab === \"account\"\r\n              ? \"text-blue-600 bg-blue-50/30\"\r\n              : \"text-slate-500 hover:text-slate-700\"\r\n          }`}\r\n        >\r\n          <span className=\"flex items-center gap-2\">\r\n            <svg\r\n              className=\"w-4 h-4\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"\r\n              />\r\n            </svg>\r\n            Account\r\n          </span>\r\n          {activeTab === \"account\" && (\r\n            <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full\"></div>\r\n          )}\r\n        </button>\r\n        <button\r\n          onClick={() => setActiveTab(\"business\")}\r\n          className={`px-4 py-2 rounded-t-xl font-medium transition-all duration-200 relative ${\r\n            activeTab === \"business\"\r\n              ? \"text-blue-600 bg-blue-50/30\"\r\n              : \"text-slate-500 hover:text-slate-700\"\r\n          }`}\r\n        >\r\n          <span className=\"flex items-center gap-2\">\r\n            <svg\r\n              className=\"w-4 h-4\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\"\r\n              />\r\n            </svg>\r\n            Business\r\n          </span>\r\n          {activeTab === \"business\" && (\r\n            <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full\"></div>\r\n          )}\r\n        </button>\r\n        <button\r\n          onClick={() => setActiveTab(\"security\")}\r\n          className={`px-4 py-2 rounded-t-xl font-medium transition-all duration-200 relative ${\r\n            activeTab === \"security\"\r\n              ? \"text-blue-600 bg-blue-50/30\"\r\n              : \"text-slate-500 hover:text-slate-700\"\r\n          }`}\r\n        >\r\n          <span className=\"flex items-center gap-2\">\r\n            <svg\r\n              className=\"w-4 h-4\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"\r\n              />\r\n            </svg>\r\n            Security\r\n          </span>\r\n          {activeTab === \"security\" && (\r\n            <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full\"></div>\r\n          )}\r\n        </button>\r\n      </div>\r\n\r\n      {/* Form Content */}\r\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n        {/* Account Tab */}\r\n        {activeTab === \"account\" && (\r\n          <div className=\"space-y-4 animate-in fade-in duration-300\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <h3 className=\"text-sm font-bold text-slate-900\">\r\n                Personal Information\r\n              </h3>\r\n              <div className=\"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent\"></div>\r\n            </div>\r\n\r\n            {/* First Name Field */}\r\n            <FormField\r\n              label=\"First Name\"\r\n              name=\"first_name\"\r\n              value={profileData.first_name}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter first name\"\r\n              error={\r\n                touched.first_name && errors.first_name\r\n                  ? errors.first_name\r\n                  : null\r\n              }\r\n              required\r\n            />\r\n\r\n            {/* Last Name Field */}\r\n            <FormField\r\n              label=\"Last Name\"\r\n              name=\"last_name\"\r\n              value={profileData.last_name}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter last name\"\r\n              error={\r\n                touched.last_name && errors.last_name ? errors.last_name : null\r\n              }\r\n              required\r\n            />\r\n\r\n            {/* Email Field */}\r\n            <FormField\r\n              label=\"Email Address\"\r\n              name=\"email\"\r\n              type=\"email\"\r\n              value={profileData.email}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter email address\"\r\n              error={touched.email && errors.email ? errors.email : null}\r\n              required\r\n            />\r\n\r\n            {/* Contact Number Field */}\r\n            <FormField\r\n              label=\"Contact Number\"\r\n              name=\"contact_number\"\r\n              type=\"tel\"\r\n              value={profileData.contact_number}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter phone number\"\r\n              error={\r\n                touched.contact_number && errors.contact_number\r\n                  ? errors.contact_number\r\n                  : null\r\n              }\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {/* Business Tab */}\r\n        {activeTab === \"business\" && (\r\n          <div className=\"space-y-4 animate-in fade-in duration-300\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <h3 className=\"text-sm font-bold text-slate-900\">\r\n                Business Information\r\n              </h3>\r\n              <div className=\"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent\"></div>\r\n            </div>\r\n\r\n            {/* Business Name */}\r\n            <FormField\r\n              label=\"Business Name\"\r\n              name=\"business_name\"\r\n              value={profileData.business_name}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter business name\"\r\n              error={\r\n                touched.business_name && errors.business_name\r\n                  ? errors.business_name\r\n                  : null\r\n              }\r\n            />\r\n\r\n            {/* Business Email Field */}\r\n            <FormField\r\n              label=\"Business Email\"\r\n              name=\"business_email\"\r\n              type=\"email\"\r\n              value={profileData.business_email}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter business email\"\r\n              error={\r\n                touched.business_email && errors.business_email\r\n                  ? errors.business_email\r\n                  : null\r\n              }\r\n            />\r\n\r\n            {/* Business Type */}\r\n            <div className=\"mb-5\">\r\n              <label className=\"block mb-1 font-medium text-blue-800\">\r\n                Business Type\r\n              </label>\r\n              <SelectDropdown\r\n                name=\"business_type\"\r\n                value={profileData.business_type}\r\n                onChange={(e) => handleInputChange(e)}\r\n                options={[\r\n                  { value: \"Grocery Store\", label: \"Grocery Store\" },\r\n                  { value: \"Retail\", label: \"Retail\" },\r\n                  { value: \"Restaurant\", label: \"Restaurant\" },\r\n                  { value: \"Cafe\", label: \"Cafe\" },\r\n                  { value: \"Pharmacy\", label: \"Pharmacy\" },\r\n                  { value: \"Services\", label: \"Services\" },\r\n                  ...(profileData.business_type &&\r\n                  ![\r\n                    \"Grocery Store\",\r\n                    \"Retail\",\r\n                    \"Restaurant\",\r\n                    \"Cafe\",\r\n                    \"Pharmacy\",\r\n                    \"Services\",\r\n                  ].includes(profileData.business_type)\r\n                    ? [\r\n                        {\r\n                          value: profileData.business_type,\r\n                          label: profileData.business_type,\r\n                        },\r\n                      ]\r\n                    : []),\r\n                ]}\r\n                placeholder=\"Select business type\"\r\n                error={\r\n                  touched.business_type && errors.business_type\r\n                    ? errors.business_type\r\n                    : null\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-2 mb-2 pt-2\">\r\n              <h3 className=\"text-sm font-bold text-slate-900\">\r\n                Business Location\r\n              </h3>\r\n              <div className=\"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent\"></div>\r\n            </div>\r\n\r\n            {/* Region */}\r\n            <div className=\"mb-5\">\r\n              <label className=\"block mb-1 font-medium text-blue-800\">\r\n                Region\r\n              </label>\r\n              <SelectDropdown\r\n                name=\"region\"\r\n                value={profileData.region}\r\n                options={locationOptions.regions}\r\n                onChange={(e) =>\r\n                  handleInputChange({\r\n                    target: { name: \"region\", value: e.target.value },\r\n                  })\r\n                }\r\n                placeholder={\r\n                  locationLoading.regions\r\n                    ? \"Loading regions...\"\r\n                    : \"Select Region\"\r\n                }\r\n                disabled={locationLoading.regions}\r\n                error={touched.region && errors.region ? errors.region : null}\r\n              />\r\n            </div>\r\n\r\n            {/* Province */}\r\n            <div className=\"mb-5\">\r\n              <label className=\"block mb-1 font-medium text-blue-800\">\r\n                Province\r\n              </label>\r\n              <SelectDropdown\r\n                name=\"province\"\r\n                value={profileData.province}\r\n                options={locationOptions.provinces}\r\n                onChange={(e) =>\r\n                  handleInputChange({\r\n                    target: { name: \"province\", value: e.target.value },\r\n                  })\r\n                }\r\n                placeholder={\r\n                  locationLoading.provinces\r\n                    ? \"Loading provinces...\"\r\n                    : \"Select Province\"\r\n                }\r\n                disabled={!profileData.region || locationLoading.provinces}\r\n                error={\r\n                  touched.province && errors.province ? errors.province : null\r\n                }\r\n              />\r\n            </div>\r\n\r\n            {/* City/Municipality */}\r\n            <div className=\"mb-5\">\r\n              <label className=\"block mb-1 font-medium text-blue-800\">\r\n                City/Municipality\r\n              </label>\r\n              <SelectDropdown\r\n                name=\"city\"\r\n                value={profileData.city}\r\n                options={locationOptions.cities}\r\n                onChange={(e) =>\r\n                  handleInputChange({\r\n                    target: { name: \"city\", value: e.target.value },\r\n                  })\r\n                }\r\n                placeholder={\r\n                  locationLoading.cities\r\n                    ? \"Loading cities...\"\r\n                    : \"Select City/Municipality\"\r\n                }\r\n                disabled={!profileData.province || locationLoading.cities}\r\n                error={touched.city && errors.city ? errors.city : null}\r\n              />\r\n            </div>\r\n\r\n            {/* Barangay */}\r\n            <div className=\"mb-5\">\r\n              <label className=\"block mb-1 font-medium text-blue-800\">\r\n                Barangay\r\n              </label>\r\n              <SelectDropdown\r\n                name=\"barangay\"\r\n                value={profileData.barangay}\r\n                options={locationOptions.barangays}\r\n                onChange={(e) =>\r\n                  handleInputChange({\r\n                    target: { name: \"barangay\", value: e.target.value },\r\n                  })\r\n                }\r\n                placeholder={\r\n                  locationLoading.barangays\r\n                    ? \"Loading barangays...\"\r\n                    : \"Select Barangay\"\r\n                }\r\n                disabled={!profileData.city || locationLoading.barangays}\r\n                error={\r\n                  touched.barangay && errors.barangay ? errors.barangay : null\r\n                }\r\n              />\r\n            </div>\r\n\r\n            {/* House / Street / Landmark */}\r\n            <FormField\r\n              label=\"House no./ Street Name / Landmark (optional)\"\r\n              name=\"house_street\"\r\n              value={profileData.house_street}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter house number, street, or landmark\"\r\n              error={\r\n                touched.house_street && errors.house_street\r\n                  ? errors.house_street\r\n                  : null\r\n              }\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {/* Security Tab */}\r\n        {activeTab === \"security\" && (\r\n          <div className=\"space-y-4 animate-in fade-in duration-300\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <h3 className=\"text-sm font-bold text-slate-900\">\r\n                Change Password\r\n              </h3>\r\n              <div className=\"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent\"></div>\r\n            </div>\r\n            <p className=\"text-xs text-slate-500 bg-amber-50 border border-amber-100/50 rounded-xl px-3 py-2\">\r\n              Leave blank to keep your current password\r\n            </p>\r\n\r\n            {/* Current Password Field */}\r\n            <FormField\r\n              label=\"Current Password\"\r\n              name=\"currentPassword\"\r\n              type=\"password\"\r\n              value={profileData.currentPassword}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter current password\"\r\n              error={\r\n                touched.currentPassword && errors.currentPassword\r\n                  ? errors.currentPassword\r\n                  : null\r\n              }\r\n            />\r\n\r\n            {/* Password Strength Indicator */}\r\n            {profileData.newPassword && (\r\n              <div className=\"space-y-2\">\r\n                <div className=\"text-xs font-semibold text-slate-700\">\r\n                  Password Strength\r\n                </div>\r\n                <div className=\"w-full h-1.5 bg-slate-200 rounded-full overflow-hidden\">\r\n                  <div\r\n                    className={`h-full rounded-full transition-all duration-300 ${\r\n                      profileData.newPassword.length >= 12\r\n                        ? \"w-full bg-gradient-to-r from-green-500 to-emerald-500\"\r\n                        : profileData.newPassword.length >= 8\r\n                        ? \"w-2/3 bg-gradient-to-r from-yellow-500 to-amber-500\"\r\n                        : \"w-1/3 bg-gradient-to-r from-red-500 to-orange-500\"\r\n                    }`}\r\n                  ></div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* New Password Field */}\r\n            <FormField\r\n              label=\"New Password\"\r\n              name=\"newPassword\"\r\n              type=\"password\"\r\n              value={profileData.newPassword}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Min. 6 characters\"\r\n              error={\r\n                touched.newPassword && errors.newPassword\r\n                  ? errors.newPassword\r\n                  : null\r\n              }\r\n            />\r\n\r\n            {/* Confirm Password Field */}\r\n            <FormField\r\n              label=\"Confirm Password\"\r\n              name=\"confirmPassword\"\r\n              type=\"password\"\r\n              value={profileData.confirmPassword}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Re-enter new password\"\r\n              error={\r\n                touched.confirmPassword && errors.confirmPassword\r\n                  ? errors.confirmPassword\r\n                  : null\r\n              }\r\n            />\r\n          </div>\r\n        )}\r\n        <div className=\"flex justify-end gap-2 pt-4 border-t border-gray-100 mt-6\">\r\n          <Button\r\n            label=\"Cancel\"\r\n            variant=\"secondary\"\r\n            onClick={onClose}\r\n            disabled={loading}\r\n            type=\"button\"\r\n          />\r\n          <Button\r\n            label={loading ? \"Saving...\" : \"Save Changes\"}\r\n            variant=\"primary\"\r\n            type=\"submit\"\r\n            disabled={loading}\r\n          />\r\n        </div>\r\n      </form>\r\n    </BaseModal>\r\n  );\r\n};\r\n\r\nexport default ProfileModal;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport PageLayout from \"../components/layout/PageLayout\";\r\nimport NavAdmin from \"../components/layout/Nav-Admin\";\r\nimport Card from \"../components/common/Card\";\r\nimport Loader from \"../components/common/Loader\";\r\nimport { api } from \"../lib/api\";\r\nimport Button from \"../components/common/Button\";\r\nimport ProfileModal from \"../components/modals/ProfileModal\";\r\nimport BaseModal from \"../components/modals/BaseModal\";\r\n\r\n// Icon Components\r\nconst UserIcon = (props) => (\r\n  <svg\r\n    className={`w-5 h-5 ${props.className || \"\"}`}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst EmailIcon = (props) => (\r\n  <svg\r\n    className={`w-5 h-5 ${props.className || \"\"}`}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst PhoneIcon = (props) => (\r\n  <svg\r\n    className={`w-5 h-5 ${props.className || \"\"}`}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst CalendarIcon = (props) => (\r\n  <svg\r\n    className={`w-5 h-5 ${props.className || \"\"}`}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst StoreIcon = (props) => (\r\n  <svg\r\n    className={`w-5 h-5 ${props.className || \"\"}`}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst LocationIcon = (props) => (\r\n  <svg\r\n    className={`w-5 h-5 ${props.className || \"\"}`}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\"\r\n    />\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M15 11a3 3 0 11-6 0 3 3 0 016 0z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst RefreshIcon = () => (\r\n  <svg\r\n    className=\"w-4 h-4\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst EditIcon = () => (\r\n  <svg\r\n    className=\"w-4 h-4\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst LockIcon = () => (\r\n  <svg\r\n    className=\"w-4 h-4\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst DownloadIcon = () => (\r\n  <svg\r\n    className=\"w-4 h-4\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"\r\n    />\r\n  </svg>\r\n);\r\n\r\n// New QR Icon from the 'new-nigga-dave' branch\r\nconst QRIcon = () => (\r\n  <svg\r\n    className=\"w-5 h-5\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h4a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\n// ---\r\n\r\n// QR Code Logic Utility (Consolidated)\r\nconst getQrCodeData = (profileData) => {\r\n  // 1. Get businessId, prioritizing profileData, then sessionStorage, then localStorage\r\n  const businessId =\r\n    profileData?.business?.business_id ||\r\n    profileData?.user?.businessId ||\r\n    JSON.parse(sessionStorage.getItem(\"user\") || \"{}\")?.businessId ||\r\n    JSON.parse(localStorage.getItem(\"user\") || \"{}\")?.businessId;\r\n\r\n  if (!businessId) return { url: \"N/A\", qrSrc: null, businessId: null };\r\n\r\n  const url = new URL(window.location.origin + \"/enter-store\");\r\n  url.searchParams.set(\"business_id\", String(businessId));\r\n  const urlString = url.toString();\r\n  const data = encodeURIComponent(urlString);\r\n\r\n  // Use a slightly larger size for better download quality, but display size remains 260x260\r\n  const qrSrc = `https://api.qrserver.com/v1/create-qr-code/?size=260x260&data=${data}&qzone=2&format=png&_=${Date.now()}`;\r\n  const downloadSrc = `https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${data}&qzone=2&format=png&_=${Date.now()}`;\r\n\r\n  return { url: urlString, qrSrc, downloadSrc, businessId };\r\n};\r\n\r\n// ---\r\n\r\n/**\r\n * Profile Page Component\r\n * Displays store and admin credentials information\r\n */\r\nconst Profile = () => {\r\n  const [profileData, setProfileData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n  const [isSidebarOpen, setSidebarOpen] = useState(false);\r\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\r\n  const [deleteState, setDeleteState] = useState({ status: \"none\" });\r\n  const [deleteMessage, setDeleteMessage] = useState(\"\");\r\n  const [deleteError, setDeleteError] = useState(\"\");\r\n  const [deleteLoading, setDeleteLoading] = useState(false);\r\n  const [downloadLoading, setDownloadLoading] = useState(false);\r\n  const [confirmText, setConfirmText] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n\r\n  const normalizeDeletion = (del) => {\r\n    if (!del) return { status: \"none\" };\r\n    if (del.status === \"cancelled\") return { status: \"none\" };\r\n    return del;\r\n  };\r\n\r\n  const fetchDeletionStatus = async () => {\r\n    try {\r\n      setDeleteLoading(true);\r\n      const res = await api(\"/api/business/delete-request\");\r\n      const normalized = normalizeDeletion(res?.deletion);\r\n      setDeleteState(normalized);\r\n      setDeleteMessage(\r\n        normalized.status === \"pending\" ? res?.message || \"\" : \"\"\r\n      );\r\n    } catch (e) {\r\n      setDeleteError(\r\n        e?.message || \"Could not load deletion status. Please try again.\"\r\n      );\r\n    } finally {\r\n      setDeleteLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchProfileData();\r\n    fetchDeletionStatus();\r\n  }, []);\r\n\r\n  const normalizeBusiness = (business) => {\r\n    if (!business) return null;\r\n\r\n    const parts = (business.business_address || \"\")\r\n      .split(\",\")\r\n      .map((p) => p.trim())\r\n      .filter(Boolean);\r\n\r\n    // Remove trailing country if present\r\n    while (parts.length && /philippines?/i.test(parts[parts.length - 1])) {\r\n      parts.pop();\r\n    }\r\n\r\n    // Stored format (after trimming country): \"<house>, <barangay>, <city>, <province>\"\r\n    const len = parts.length;\r\n    const province = len >= 1 ? parts[len - 1] : \"\";\r\n    const city = len >= 2 ? parts[len - 2] : \"\";\r\n    const barangay = len >= 3 ? parts[len - 3] : \"\";\r\n    const houseOrStreet =\r\n      len > 3 ? parts.slice(0, len - 3).join(\", \") : parts[0] || \"\";\r\n\r\n    return {\r\n      ...business,\r\n      address_line: business.address_line || business.business_address || \"\",\r\n      region:\r\n        business.region ||\r\n        business.regionName ||\r\n        business.region_name ||\r\n        business.region_name ||\r\n        \"\",\r\n      province: business.province || business.provinceName || province || \"\",\r\n      city: business.city || business.cityName || city || \"\",\r\n      barangay: business.barangay || business.barangayName || barangay || \"\",\r\n      house_number:\r\n        business.house_number || business.houseNumber || houseOrStreet || \"\",\r\n    };\r\n  };\r\n\r\n  const fetchProfileData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(\"\");\r\n\r\n      const token =\r\n        sessionStorage.getItem(\"auth_token\") ||\r\n        localStorage.getItem(\"auth_token\") ||\r\n        localStorage.getItem(\"token\");\r\n\r\n      // Sync token to sessionStorage so future requests stay authenticated\r\n      if (token && !sessionStorage.getItem(\"auth_token\")) {\r\n        sessionStorage.setItem(\"auth_token\", token);\r\n      }\r\n\r\n      console.log(\"Fetching profile data from /auth/profile\");\r\n\r\n      // Fetch user profile data\r\n      const response = await api(\"/auth/profile\");\r\n\r\n      const normalized = {\r\n        ...response,\r\n        business: normalizeBusiness(response.business),\r\n      };\r\n\r\n      // Derive region if missing using locations endpoint (province -> region)\r\n      if (normalized.business && !normalized.business.region) {\r\n        try {\r\n          if (!locationsCacheRef.current) {\r\n            const locations = await api(\"/location/locations\");\r\n            locationsCacheRef.current = locations;\r\n          }\r\n          const derivedRegion = deriveRegionFromLocations(\r\n            locationsCacheRef.current,\r\n            normalized.business.province,\r\n            normalized.business.city\r\n          );\r\n          if (derivedRegion) {\r\n            normalized.business.region = derivedRegion;\r\n          }\r\n        } catch (locErr) {\r\n          console.warn(\"Failed to derive region from locations:\", locErr);\r\n        }\r\n      }\r\n\r\n      console.log(\"Profile data received:\", normalized);\r\n      setProfileData(normalized);\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch profile data:\", err);\r\n      setError(\r\n        \"Failed to load profile information. Please check your connection and try again.\"\r\n      );\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const deriveRegionFromLocations = (locationsData, provinceName, cityName) => {\r\n    if (!locationsData || (!provinceName && !cityName)) return \"\";\r\n    // locationsData structure: { [regionName]: { code, provinces: { [provinceName]: { ... } } } }\r\n    const provinceLower = (provinceName || \"\").toLowerCase().trim();\r\n    const cityLower = (cityName || \"\").toLowerCase().trim();\r\n\r\n    for (const [regionName, regionData] of Object.entries(locationsData)) {\r\n      for (const provinceKey of Object.keys(regionData.provinces || {})) {\r\n        const provLower = provinceKey.toLowerCase();\r\n        if (provinceLower && provLower === provinceLower) {\r\n          return regionName;\r\n        }\r\n        // Some addresses might have city stored as \"Province\" due to parsing issues; try matching city against province names\r\n        if (cityLower && provLower === cityLower) {\r\n          return regionName;\r\n        }\r\n      }\r\n    }\r\n    return \"\";\r\n  };\r\n\r\n  const formatDate = (dateString) => {\r\n    if (!dateString) return \"N/A\";\r\n    return new Date(dateString).toLocaleDateString(\"en-US\", {\r\n      year: \"numeric\",\r\n      month: \"long\",\r\n      day: \"numeric\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n    });\r\n  };\r\n\r\n  const handleDownloadExport = async () => {\r\n    setDeleteError(\"\");\r\n    setDownloadLoading(true);\r\n    try {\r\n      const res = await api(\r\n        \"/api/business/delete-request/export\",\r\n        { method: \"GET\" },\r\n        true\r\n      );\r\n      const blob = await res.blob();\r\n      const url = window.URL.createObjectURL(blob);\r\n      const link = document.createElement(\"a\");\r\n      link.href = url;\r\n      link.download = `transactions-export.${blob.type.includes(\"gzip\") ? \"gz\" : \"json\"}`;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      link.remove();\r\n      window.URL.revokeObjectURL(url);\r\n    } catch (e) {\r\n      setDeleteError(\r\n        e?.message || \"Failed to download export. Please try again.\"\r\n      );\r\n    } finally {\r\n      setDownloadLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRequestDeletion = async () => {\r\n    setDeleteError(\"\");\r\n    setDeleteMessage(\"\");\r\n    if (confirmText.trim().toLowerCase() !== \"delete\") {\r\n      setDeleteError('Type \"DELETE\" to confirm.');\r\n      return;\r\n    }\r\n    if (!password) {\r\n      setDeleteError('Please enter your password to confirm deletion.');\r\n      return;\r\n    }\r\n    setDeleteLoading(true);\r\n    try {\r\n      const res = await api(\"/api/business/delete-request\", { \r\n        method: \"POST\",\r\n        body: JSON.stringify({ password })\r\n      });\r\n      setDeleteState(res?.deletion || { status: \"pending\" });\r\n      setDeleteMessage(\r\n        res?.message || \"Deletion request recorded with a 30-day grace period.\"\r\n      );\r\n      setShowDeleteConfirm(false);\r\n      setPassword(\"\");\r\n      setConfirmText(\"\");\r\n    } catch (e) {\r\n      setDeleteError(\r\n        e?.message || \"Could not request deletion. Please check your password and try again.\"\r\n      );\r\n    } finally {\r\n      setDeleteLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleCancelDeletion = async () => {\r\n    setDeleteError(\"\");\r\n    setDeleteMessage(\"\");\r\n    setDeleteLoading(true);\r\n    try {\r\n      const res = await api(\"/api/business/delete-request/cancel\", {\r\n        method: \"POST\",\r\n      });\r\n      const normalized = normalizeDeletion(res?.deletion);\r\n      setDeleteState(normalized);\r\n      setDeleteMessage(\"\");\r\n      setConfirmText(\"\");\r\n    } catch (e) {\r\n      setDeleteError(\r\n        e?.message || \"Could not cancel deletion. Please try again.\"\r\n      );\r\n    } finally {\r\n      setDeleteLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDownloadQr = async () => {\r\n    const { downloadSrc, businessId } = getQrCodeData(profileData);\r\n    if (!downloadSrc) {\r\n      alert(\"Business ID not found to generate QR code.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Fetch the image as a blob to handle CORS\r\n      const response = await fetch(downloadSrc);\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch QR code image');\r\n      }\r\n      const blob = await response.blob();\r\n      const url = window.URL.createObjectURL(blob);\r\n      \r\n      const a = document.createElement(\"a\");\r\n      a.href = url;\r\n      a.download = `store-${businessId || \"qr\"}.png`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      \r\n      // Clean up the object URL\r\n      window.URL.revokeObjectURL(url);\r\n    } catch (error) {\r\n      console.error('Error downloading QR code:', error);\r\n      alert('Failed to download QR code. Please try again.');\r\n    }\r\n  };\r\n\r\n  // Header actions with modern styling\r\n  const headerActions = (\r\n    <div className=\"flex items-center justify-end gap-2 sm:gap-3\">\r\n      <Button\r\n        onClick={fetchProfileData}\r\n        variant=\"secondary\"\r\n        size=\"sm\"\r\n        icon={<RefreshIcon />}\r\n        iconPosition=\"left\"\r\n        className=\"whitespace-nowrap [&>span]:hidden sm:[&>span]:inline\"\r\n      >\r\n        <span>Refresh</span>\r\n      </Button>\r\n      <Button\r\n        variant=\"primary\"\r\n        size=\"sm\"\r\n        icon={<EditIcon />}\r\n        iconPosition=\"left\"\r\n        onClick={() => setIsEditModalOpen(true)}\r\n        className=\"whitespace-nowrap [&>span]:hidden sm:[&>span]:inline\"\r\n      >\r\n        <span>Edit Profile</span>\r\n      </Button>\r\n    </div>\r\n  );\r\n\r\n  if (loading) {\r\n    return (\r\n      <PageLayout\r\n        title=\"PROFILE\"\r\n        subtitle=\"Store and admin credentials\"\r\n        sidebar={<NavAdmin />}\r\n        isSidebarOpen={isSidebarOpen}\r\n        setSidebarOpen={setSidebarOpen}\r\n        className=\"bg-gray-50\"\r\n      >\r\n        <div className=\"flex justify-center items-center h-64\">\r\n          <Loader />\r\n        </div>\r\n      </PageLayout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <PageLayout\r\n      title=\"PROFILE\"\r\n      subtitle=\"\"\r\n      sidebar={<NavAdmin />}\r\n      headerActions={headerActions}\r\n      isSidebarOpen={isSidebarOpen}\r\n      setSidebarOpen={setSidebarOpen}\r\n      className=\"bg-gray-50\"\r\n    >\r\n      <ProfileModal\r\n        isOpen={isEditModalOpen}\r\n        onClose={() => setIsEditModalOpen(false)}\r\n        userData={profileData?.user}\r\n        businessData={profileData?.business}\r\n      />\r\n      <div className=\"p-4 sm:p-6 space-y-4 sm:space-y-6\">\r\n        {error && (\r\n          <Card className=\"bg-gradient-to-br from-red-50 to-orange-50 border-red-200/50\">\r\n            <div className=\"flex items-start gap-4 p-4\">\r\n              <div className=\"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0\">\r\n                <svg\r\n                  className=\"w-5 h-5 text-red-600\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n                  />\r\n                </svg>\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <h3 className=\"text-sm font-semibold text-red-900 mb-1\">\r\n                  Error Loading Profile\r\n                </h3>\r\n                <p className=\"text-sm text-red-700\">{error}</p>\r\n              </div>\r\n            </div>\r\n          </Card>\r\n        )}\r\n\r\n        {!loading && !error && !profileData && (\r\n          <Card className=\"bg-gradient-to-br from-gray-50 to-blue-50/30 border-gray-200/50\">\r\n            <div className=\"p-8 md:p-12 text-center\">\r\n              <div className=\"w-20 h-20 bg-gradient-to-br from-gray-200 to-gray-300 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg\">\r\n                <svg\r\n                  className=\"w-10 h-10 text-gray-500\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"\r\n                  />\r\n                </svg>\r\n              </div>\r\n              <h3 className=\"text-xl font-bold text-gray-900 mb-2\">\r\n                No Profile Data Available\r\n              </h3>\r\n              <p className=\"text-gray-600 mb-6 max-w-md mx-auto\">\r\n                Unable to load your profile information. Please try refreshing\r\n                or check your connection.\r\n              </p>\r\n              <Button\r\n                onClick={fetchProfileData}\r\n                variant=\"primary\"\r\n                size=\"md\"\r\n                icon={<RefreshIcon />}\r\n                iconPosition=\"left\"\r\n              >\r\n                Try Again\r\n              </Button>\r\n            </div>\r\n          </Card>\r\n        )}\r\n\r\n        {/* Profile Content - Only show when data is available */}\r\n        {profileData && (\r\n          <React.Fragment>\r\n            {/* Modern Profile Header */}\r\n            <Card className=\"bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border-blue-200/50 overflow-hidden\">\r\n              <div className=\"p-6 md:p-8\">\r\n                <div className=\"flex flex-col md:flex-row items-start md:items-center gap-6\">\r\n                  <div className=\"relative\">\r\n                    <div className=\"w-24 h-24 md:w-32 md:h-32 bg-gradient-to-br from-blue-500 to-indigo-600 text-white rounded-2xl flex items-center justify-center text-3xl md:text-4xl font-bold shadow-lg ring-4 ring-white/50\">\r\n                      {profileData?.user?.first_name\r\n                        ?.charAt(0)\r\n                        ?.toUpperCase() || \"A\"}\r\n                    </div>\r\n                    <div className=\"absolute -bottom-1 -right-1 w-8 h-8 bg-green-500 rounded-full border-4 border-white flex items-center justify-center\">\r\n                      <div className=\"w-3 h-3 bg-white rounded-full\"></div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <h1 className=\"text-2xl md:text-3xl font-bold text-gray-900 mb-2\">\r\n                      {profileData?.business?.business_name || \"Admin User\"}\r\n                    </h1>\r\n                    <p className=\"text-gray-600 mb-4 flex items-center gap-2\">\r\n                      <EmailIcon />\r\n                      <span className=\"truncate\">\r\n                        {profileData?.user?.email || \"N/A\"}\r\n                      </span>\r\n                    </p>\r\n                    <div className=\"flex flex-wrap gap-3\">\r\n                      <span className=\"inline-flex items-center gap-2 px-4 py-1.5 rounded-full text-sm font-semibold bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 border border-blue-200\">\r\n                        <div className=\"w-5 h-5 bg-blue-100 rounded-full flex items-center justify-center\">\r\n                          <StoreIcon className=\"w-3 h-3 text-blue-600\" />\r\n                        </div>\r\n                        <span>\r\n                          {profileData?.user?.role?.replace(\"_\", \" \").toUpperCase() || \"ADMIN\"}\r\n                          {profileData?.business?.business_type && `  ${profileData.business.business_type}`}\r\n                        </span>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n\r\n            {/* Admin Information */}\r\n            <Card className=\"bg-white shadow-sm\">\r\n              <div className=\"p-6 md:p-8\">\r\n                <div className=\"flex items-center mb-6 pb-4 border-b border-gray-200\">\r\n                  <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-xl flex items-center justify-center mr-3\">\r\n                    <UserIcon />\r\n                  </div>\r\n                  <div>\r\n                    <h2 className=\"text-xl font-bold text-gray-900\">\r\n                      Account Information\r\n                    </h2>\r\n                    <p className=\"text-sm text-gray-500\">\r\n                      Personal details and credentials\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  <div className=\"space-y-5\">\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        First Name\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <UserIcon className=\"text-blue-600\" />\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1\">\r\n                          {profileData?.user?.first_name || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Last Name\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <UserIcon className=\"text-blue-600\" />\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1\">\r\n                          {profileData?.user?.last_name || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Email Address\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <EmailIcon className=\"text-blue-600\" />\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1 truncate\">\r\n                          {profileData?.user?.email || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Role\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50\">\r\n                        <div className=\"w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <svg\r\n                            className=\"w-5 h-5 text-indigo-600\"\r\n                            fill=\"none\"\r\n                            stroke=\"currentColor\"\r\n                            viewBox=\"0 0 24 24\"\r\n                          >\r\n                            <path\r\n                              strokeLinecap=\"round\"\r\n                              strokeLinejoin=\"round\"\r\n                              strokeWidth={2}\r\n                              d=\"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z\"\r\n                            />\r\n                          </svg>\r\n                        </div>\r\n                        <span className=\"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200 capitalize\">\r\n                          {profileData?.user?.role?.replace(\"_\", \" \") || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-5\">\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Contact Number\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <PhoneIcon className=\"text-green-600\" />\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1\">\r\n                          {profileData?.user?.contact_number || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Account Created\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <CalendarIcon className=\"text-purple-600\" />\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1\">\r\n                          {formatDate(profileData?.user?.created_at)}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Last Updated\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <CalendarIcon className=\"text-orange-600\" />\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1\">\r\n                          {formatDate(profileData?.user?.updated_at)}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Store Entry QR for Customers (Adopted styling from new-nigga-dave) */}\r\n                <div className=\"mt-8 pt-8 border-t border-gray-200\">\r\n                  <div className=\"flex items-center gap-3 mb-4\">\r\n                    <div className=\"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 text-white rounded-xl flex items-center justify-center\">\r\n                      <QRIcon />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg font-bold text-gray-900\">\r\n                        Store Entry QR Code\r\n                      </h3>\r\n                      <p className=\"text-sm text-gray-500\">\r\n                        Share this QR code for customer self-checkout\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"bg-gradient-to-br from-gray-50 to-blue-50/30 rounded-2xl p-6 border border-gray-200/50\">\r\n                    <div className=\"flex flex-col md:flex-row items-start md:items-center gap-6\">\r\n                      <div className=\"relative\">\r\n                        <div className=\"absolute inset-0 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl blur-xl opacity-20\"></div>\r\n                        <img\r\n                          src={getQrCodeData(profileData).qrSrc}\r\n                          alt=\"Store Entry QR\"\r\n                          className=\"relative w-[260px] h-[260px] border-4 border-white rounded-2xl bg-white shadow-xl\"\r\n                        />\r\n                      </div>\r\n                      <div className=\"flex-1 space-y-4 min-w-0\">\r\n                        <div>\r\n                          <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                            QR Code URL\r\n                          </label>\r\n                          <div className=\"bg-white px-4 py-3 rounded-xl border border-gray-200 break-all text-sm text-gray-700 font-mono\">\r\n                            {getQrCodeData(profileData).url}\r\n                          </div>\r\n                        </div>\r\n                        <Button\r\n                          variant=\"primary\"\r\n                          size=\"md\"\r\n                          icon={<DownloadIcon />}\r\n                          iconPosition=\"left\"\r\n                          onClick={handleDownloadQr}\r\n                          className=\"w-full md:w-auto\"\r\n                        >\r\n                          Download QR Code\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n\r\n            {/* Store Information */}\r\n            <Card className=\"bg-white shadow-sm\">\r\n              <div className=\"p-6 md:p-8\">\r\n                <div className=\"flex items-center mb-6 pb-4 border-b border-gray-200\">\r\n                  <div className=\"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 text-white rounded-xl flex items-center justify-center mr-3\">\r\n                    <StoreIcon />\r\n                  </div>\r\n                  <div>\r\n                    <h2 className=\"text-xl font-bold text-gray-900\">\r\n                      Store Information\r\n                    </h2>\r\n                    <p className=\"text-sm text-gray-500\">\r\n                      Business details and credentials\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  <div className=\"space-y-5\">\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Business Name\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <StoreIcon className=\"text-green-600\" />\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1\">\r\n                          {profileData?.business?.business_name || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Business Email\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <EmailIcon className=\"text-blue-600\" />\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1 truncate\">\r\n                          {profileData?.business?.email || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Region\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-teal-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <LocationIcon className=\"text-teal-600\" />\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1\">\r\n                          {profileData?.business?.region || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Province\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <LocationIcon className=\"text-emerald-600\" />\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1\">\r\n                          {profileData?.business?.province || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-5\">\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Business Type\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <svg\r\n                            className=\"w-5 h-5 text-emerald-600\"\r\n                            fill=\"none\"\r\n                            stroke=\"currentColor\"\r\n                            viewBox=\"0 0 24 24\"\r\n                          >\r\n                            <path\r\n                              strokeLinecap=\"round\"\r\n                              strokeLinejoin=\"round\"\r\n                              strokeWidth={2}\r\n                              d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\"\r\n                            />\r\n                          </svg>\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1\">\r\n                          {profileData?.business?.business_type || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Business Location\r\n                      </label>\r\n                      <div className=\"bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50\">\r\n                        <div className=\"grid grid-cols-1 gap-4\">\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                              <LocationIcon className=\"text-blue-600\" />\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                              <div className=\"text-xs text-gray-500 uppercase tracking-wide\">\r\n                                City/Municipality\r\n                              </div>\r\n                              <div className=\"text-gray-900 font-medium\">\r\n                                {profileData?.business?.city || \"N/A\"}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-3\">\r\n                            <div className=\"w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                              <LocationIcon className=\"text-indigo-600\" />\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                              <div className=\"text-xs text-gray-500 uppercase tracking-wide\">\r\n                                Barangay\r\n                              </div>\r\n                              <div className=\"text-gray-900 font-medium\">\r\n                                {profileData?.business?.barangay || \"N/A\"}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex items-start gap-3\">\r\n                            <div className=\"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5\">\r\n                              <LocationIcon className=\"text-purple-600\" />\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                              <div className=\"text-xs text-gray-500 uppercase tracking-wide\">\r\n                                House no./ Street Name / Landmark (optional)\r\n                              </div>\r\n                              <div className=\"text-gray-900 font-medium\">\r\n                                {[profileData?.business?.house_number, profileData?.business?.business_address, profileData?.business?.landmark]\r\n                                  .filter(Boolean)\r\n                                  .join(\", \") || \"N/A\"}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n\r\n            {/* Business Users */}\r\n            {profileData?.business?.users &&\r\n              profileData.business.users.length > 0 && (\r\n                <>\r\n                  {(() => {\r\n                    const filteredBusinessUsers =\r\n                      profileData.business.users.filter(\r\n                        (user) =>\r\n                          user.user_type_name === \"admin\" ||\r\n                          user.user_type_name === \"cashier\" ||\r\n                          user.role === \"admin\" ||\r\n                          user.role === \"cashier\" ||\r\n                          user.role === \"business_owner\"\r\n                      );\r\n                    return (\r\n                      <Card className=\"bg-white shadow-sm\">\r\n                        <div className=\"p-6 md:p-8\">\r\n                          <div className=\"flex items-center mb-6 pb-4 border-b border-gray-200\">\r\n                            <div className=\"w-10 h-10 bg-gradient-to-br bg-blue-500 text-white rounded-xl flex items-center justify-center mr-3\">\r\n                              <svg\r\n                                className=\"w-5 h-5\"\r\n                                fill=\"none\"\r\n                                stroke=\"currentColor\"\r\n                                viewBox=\"0 0 24 24\"\r\n                              >\r\n                                <path\r\n                                  strokeLinecap=\"round\"\r\n                                  strokeLinejoin=\"round\"\r\n                                  strokeWidth={2}\r\n                                  d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\"\r\n                                />\r\n                              </svg>\r\n                            </div>\r\n                            <div>\r\n                              <h2 className=\"text-xl font-bold text-gray-900\">\r\n                                Business Team\r\n                              </h2>\r\n                              <p className=\"text-sm text-gray-500\">\r\n                                All users associated with this business (\r\n                                {filteredBusinessUsers.length} total)\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6\">\r\n                            {filteredBusinessUsers.map((user, index) => (\r\n                              <div\r\n                                key={user.user_id}\r\n                                className=\"group bg-gradient-to-br from-white to-gray-50/50 rounded-2xl p-5 border border-gray-200/50 hover:border-purple-300 hover:shadow-lg transition-all duration-300\"\r\n                              >\r\n                                <div className=\"flex items-center mb-4\">\r\n                                  <div className=\"relative\">\r\n                                    <div className=\"w-12 h-12 bg-gradient-to-br bg-blue-500 text-white rounded-xl flex items-center justify-center text-lg font-bold shadow-md ring-2 ring-white\">\r\n                                      {user.username\r\n                                        ?.charAt(0)\r\n                                        ?.toUpperCase() || \"U\"}\r\n                                    </div>\r\n                                    <div className=\"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white\"></div>\r\n                                  </div>\r\n                                  <div className=\"ml-3 flex-1 min-w-0\">\r\n                                    <h4 className=\"font-bold text-gray-900 truncate\">\r\n                                      {user.username}\r\n                                    </h4>\r\n                                    <span\r\n                                      className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold mt-1 ${\r\n                                        user.user_type_name === \"admin\" ||\r\n                                        user.role === \"business_owner\"\r\n                                          ? \"bg-red-100 text-red-800 border border-red-200\"\r\n                                          : user.user_type_name === \"cashier\" ||\r\n                                            user.role === \"cashier\"\r\n                                          ? \"bg-green-100 text-green-800 border border-green-200\"\r\n                                          : \"bg-gray-100 text-gray-800 border border-gray-200\"\r\n                                      }`}\r\n                                    >\r\n                                      {user.user_type_name || user.role}\r\n                                    </span>\r\n                                  </div>\r\n                                </div>\r\n\r\n                                <div className=\"space-y-3 text-sm\">\r\n                                  <div className=\"flex items-start gap-2\">\r\n                                    <EmailIcon className=\"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0\" />\r\n                                    <div className=\"min-w-0 flex-1\">\r\n                                      <div className=\"text-xs text-gray-500 mb-0.5\">\r\n                                        Email\r\n                                      </div>\r\n                                      <div className=\"font-medium text-gray-900 truncate\">\r\n                                        {user.email}\r\n                                      </div>\r\n                                    </div>\r\n                                  </div>\r\n                                  {user.contact_number && (\r\n                                    <div className=\"flex items-start gap-2\">\r\n                                      <PhoneIcon className=\"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0\" />\r\n                                      <div className=\"min-w-0 flex-1\">\r\n                                        <div className=\"text-xs text-gray-500 mb-0.5\">\r\n                                          Contact\r\n                                        </div>\r\n                                        <div className=\"font-medium text-gray-900\">\r\n                                          {user.contact_number}\r\n                                        </div>\r\n                                      </div>\r\n                                    </div>\r\n                                  )}\r\n                                  <div className=\"flex items-start gap-2\">\r\n                                    <CalendarIcon className=\"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0\" />\r\n                                    <div className=\"min-w-0 flex-1\">\r\n                                      <div className=\"text-xs text-gray-500 mb-0.5\">\r\n                                        Joined\r\n                                      </div>\r\n                                      <div className=\"font-medium text-gray-900\">\r\n                                        {formatDate(user.created_at)}\r\n                                      </div>\r\n                                    </div>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n                      </Card>\r\n                    );\r\n                  })()}\r\n                </>\r\n              )}\r\n\r\n              {/* Store Deletion Section */}\r\n              <Card className=\"border-red-100 border-2 mt-6\">\r\n                <div className=\"p-6\">\r\n                  <div className=\"flex items-center mb-4\">\r\n                    <div className=\"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3\">\r\n                      <svg className=\"w-6 h-6 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                      </svg>\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg font-bold text-red-900\">Delete Your Store</h3>\r\n                      <p className=\"text-sm text-red-600\">This action cannot be undone after 30 days</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-4\">\r\n                    <p className=\"text-gray-700\">\r\n                      Download all transactions then schedule deletion with a 30-day recovery window.\r\n                    </p>\r\n\r\n                    {deleteMessage && (\r\n                      <div className=\"text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded-lg px-3 py-2\">\r\n                        {deleteMessage}\r\n                      </div>\r\n                    )}\r\n                    {deleteError && (\r\n                      <div className=\"text-sm text-red-700 bg-red-50 border border-red-200 rounded-lg px-3 py-2\">\r\n                        {deleteError}\r\n                      </div>\r\n                    )}\r\n\r\n                    {deleteState.status === \"pending\" && (\r\n                      <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs text-gray-700 p-4 bg-gray-50 rounded-lg\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <span className=\"font-semibold text-gray-800\">Status:</span>\r\n                          <span className=\"px-2 py-1 rounded-full border text-xs\">\r\n                            {deleteState.status || \"none\"}\r\n                          </span>\r\n                        </div>\r\n                        <div>\r\n                          <span className=\"font-semibold text-gray-800\">Scheduled:</span>{\" \"}\r\n                          {formatDate(deleteState.scheduledFor)}\r\n                        </div>\r\n                        <div>\r\n                          <span className=\"font-semibold text-gray-800\">Requested:</span>{\" \"}\r\n                          {formatDate(deleteState.requestedAt)}\r\n                        </div>\r\n                        <div>\r\n                          <span className=\"font-semibold text-gray-800\">Export ready:</span>{\" \"}\r\n                          {formatDate(deleteState.exportReadyAt) || \"N/A\"}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n\r\n                    <div className=\"space-y-4\">\r\n                      {!showDeleteConfirm ? (\r\n                        <div className=\"flex flex-wrap gap-3\">\r\n                          <Button\r\n                            label={\r\n                              downloadLoading ? \"Preparing...\" : \"Download transactions\"\r\n                            }\r\n                            variant=\"secondary\"\r\n                            onClick={handleDownloadExport}\r\n                            disabled={downloadLoading}\r\n                            icon={<DownloadIcon />}\r\n                          />\r\n                          <Button\r\n                            label=\"Delete store\"\r\n                            variant=\"danger\"\r\n                            onClick={() => setShowDeleteConfirm(true)}\r\n                            disabled={deleteLoading || deleteState.status === \"pending\"}\r\n                          />\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"space-y-4\">\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                              Type \"DELETE\" to confirm\r\n                            </label>\r\n                            <input\r\n                              type=\"text\"\r\n                              className=\"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-red-500 focus:border-red-500\"\r\n                              placeholder=\"DELETE\"\r\n                              value={confirmText}\r\n                              onChange={(e) => setConfirmText(e.target.value)}\r\n                            />\r\n                          </div>\r\n                          <div className=\"flex flex-wrap gap-3\">\r\n                            <div className=\"space-y-4 w-full\">\r\n                              <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                                  Enter your password to confirm\r\n                                </label>\r\n                                <input\r\n                                  type=\"password\"\r\n                                  className=\"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-red-500 focus:border-red-500\"\r\n                                  placeholder=\"Your account password\"\r\n                                  value={password}\r\n                                  onChange={(e) => setPassword(e.target.value)}\r\n                                  disabled={deleteLoading}\r\n                                />\r\n                              </div>\r\n                              <div className=\"flex flex-wrap gap-3\">\r\n                                <Button\r\n                                  label=\"Cancel\"\r\n                                  variant=\"secondary\"\r\n                                  onClick={() => {\r\n                                    setShowDeleteConfirm(false);\r\n                                    setConfirmText(\"\");\r\n                                    setPassword(\"\");\r\n                                    setDeleteError(\"\");\r\n                                  }}\r\n                                  disabled={deleteLoading}\r\n                                />\r\n                            <Button\r\n                              label={\r\n                                deleteLoading ? \"Processing...\" : \"Confirm Deletion\"\r\n                              }\r\n                              variant=\"danger\"\r\n                              onClick={handleRequestDeletion}\r\n                              disabled={deleteLoading || confirmText.trim().toLowerCase() !== \"delete\" || !password}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n\r\n                      {deleteState.status === \"pending\" && (\r\n                        <Button\r\n                          label=\"Cancel Deletion\"\r\n                          variant=\"secondary\"\r\n                          onClick={handleCancelDeletion}\r\n                          disabled={deleteLoading}\r\n                          className=\"mt-2\"\r\n                        />\r\n                      )}\r\n\r\n                      <p className=\"text-sm text-gray-500 mt-2\">\r\n                        You can recover the account within 30 days. After that, the store is permanently removed.\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n            </React.Fragment>\r\n          )}\r\n        </div>\r\n    </PageLayout>\r\n  );\r\n};\r\n\r\nexport default Profile;\r\n"],"names":["SelectDropdown","name","value","options","placeholder","onChange","error","disabled","searchable","className","required","isOpen","setIsOpen","useState","searchTerm","setSearchTerm","highlightedIndex","setHighlightedIndex","dropdownRef","useRef","inputRef","filteredOptions","filter","option","label","toLowerCase","includes","useEffect","handleClickOutside","event","current","contains","target","addEventListener","document","removeEventListener","handleKeyDown","key","preventDefault","prev","length","handleSelect","selectedOption","find","ref","children","jsxs","type","onClick","handleToggle","setTimeout","focus","jsx","BiCheck","BiChevronUp","BiChevronDown","BiSearch","e","map","index","onMouseEnter","fill","viewBox","fillRule","d","clipRule","ProfileModal","onClose","userData","businessData","profileData","setProfileData","first_name","last_name","email","contact_number","currentPassword","newPassword","confirmPassword","business_name","business_email","business_type","region","province","city","barangay","house_street","house_number","business_address","address_line","country","loading","setLoading","message","setMessage","setError","errors","setErrors","touched","setTouched","activeTab","setActiveTab","locationOptions","setLocationOptions","regions","provinces","cities","barangays","locationLoading","setLocationLoading","initialLocationRef","findOptionByLabel","trim","o","getLabel","fallback","match","async","l","data","getRegions","r","code","err","fetchRegions","p","getProvinces","loadProvinces","getCities","c","loadCities","getBarangays","b","loadBarangays","validateField","newErrors","test","handleInputChange","handleBlur","handleSubmit","token","sessionStorage","getItem","updateData","api","method","headers","Authorization","body","JSON","stringify","regionLabel","provinceLabel","cityLabel","barangayLabel","businessUpdateData","businessName","undefined","businessType","businessAddress","Boolean","join","houseNumber","window","location","reload","useKeyboardShortcuts","action","enabled","allowWhileTyping","stopPropagation","BaseModal","title","subtitle","footer","Button","variant","stroke","strokeLinecap","strokeLinejoin","strokeWidth","onSubmit","FormField","onBlur","UserIcon","props","EmailIcon","PhoneIcon","CalendarIcon","StoreIcon","LocationIcon","RefreshIcon","EditIcon","DownloadIcon","QRIcon","getQrCodeData","businessId","business","business_id","user","parse","localStorage","url","qrSrc","URL","origin","searchParams","set","String","urlString","toString","encodeURIComponent","Date","now","downloadSrc","Profile","isSidebarOpen","setSidebarOpen","isEditModalOpen","setIsEditModalOpen","deleteState","setDeleteState","status","deleteMessage","setDeleteMessage","deleteError","setDeleteError","deleteLoading","setDeleteLoading","downloadLoading","setDownloadLoading","confirmText","setConfirmText","password","setPassword","showDeleteConfirm","setShowDeleteConfirm","normalizeDeletion","del","fetchProfileData","res","normalized","deletion","fetchDeletionStatus","normalizeBusiness","parts","split","pop","len","houseOrStreet","slice","regionName","region_name","provinceName","cityName","barangayName","setItem","console","log","response","locationsCacheRef","locations","derivedRegion","deriveRegionFromLocations","locErr","warn","locationsData","provinceLower","cityLower","regionData","Object","entries","provinceKey","keys","provLower","formatDate","dateString","toLocaleDateString","year","month","day","hour","minute","headerActions","size","icon","iconPosition","PageLayout","sidebar","NavAdmin","Loader","Card","React","Fragment","charAt","toUpperCase","role","replace","created_at","updated_at","src","alt","fetch","ok","Error","blob","createObjectURL","a","createElement","href","download","appendChild","click","removeChild","revokeObjectURL","alert","landmark","users","filteredBusinessUsers","user_type_name","username","user_id","scheduledFor","requestedAt","exportReadyAt","link","remove"],"mappings":"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"}