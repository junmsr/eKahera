import{j as e}from"./utils-L0j39QIW.js";import{j as s,u as t,a}from"./vendor-DPJ7iNYg.js";import{a as l,L as i,b as r}from"./index-DDmWiPZn.js";const d=()=>{const[d]=s();t();const[n,c]=a.useState(""),[o,m]=a.useState([]),[u,x]=a.useState(!0),[p,h]=a.useState(!1),[f,j]=a.useState(""),[b,y]=a.useState({}),[g,v]=a.useState({}),[N,w]=a.useState(!1),[_,S]=a.useState(!0);a.useEffect(()=>{const e=d.get("email");e&&(c(e),P({preventDefault:()=>{}},e))},[d]);const P=async(e,s=null)=>{e?.preventDefault();const t=s||n;if(t)try{h(!0),j("");const e=await l(`/documents/rejected?email=${encodeURIComponent(t)}`);if(!e.documents||0===e.documents.length)return void j("No rejected documents found for this email address.");m(e.documents),w(!0),S(!1);const s=new URL(window.location);s.searchParams.set("email",t),window.history.pushState({},"",s)}catch(a){console.error("Verification error:",a),j(a.response?.data?.error||"Failed to verify email. Please try again.")}finally{h(!1)}else j("Please enter your email address")},R=e=>{switch(e){case"approved":return"text-green-600 bg-green-100";case"rejected":return"text-red-600 bg-red-100";default:return"text-yellow-600 bg-yellow-100"}};return u?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(i,{size:"lg"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading document information..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Document Resubmission"}),e.jsx("p",{className:"mt-2 text-lg text-gray-600",children:"Please verify your email to view and resubmit rejected documents"})]}),f&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border-l-4 border-red-500 text-red-700",children:e.jsx("p",{children:f})}),_&&e.jsxs("div",{className:"bg-white shadow overflow-hidden rounded-lg p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-medium text-gray-900 mb-4",children:"Verify Your Email"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Please enter the email address associated with your rejected documents."}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",value:n,onChange:e=>c(e.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"your.email@example.com",disabled:p})]}),e.jsx("div",{className:"pt-2",children:e.jsx(r,{type:"submit",disabled:p||!n,className:"w-full justify-center",children:p?"Verifying...":"Continue"})})]})]}),N&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h2a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-blue-700",children:"Please upload new versions of your rejected documents. Make sure all documents are clear and up to date."})})]})}),o.map(s=>e.jsxs("div",{className:"bg-white shadow overflow-hidden rounded-lg",children:[e.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:s.document_type}),e.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:s.document_name})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${R(s.verification_status)}`,children:s.verification_status})]})}),e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[s.verification_notes&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Rejection Reason:"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:s.verification_notes})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload New Version"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"file",id:`file-${s.document_id}`,onChange:e=>{return t=s.document_id,a=e.target.files[0],void y(e=>({...e,[t]:a}));var t,a},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",accept:".pdf,.jpg,.jpeg,.png"}),e.jsx(r,{type:"button",onClick:()=>(async e=>{if(!b[e])return void j("Please select a file to upload");const s=new FormData;s.append("document",b[e]),s.append("document_id",e),s.append("user_email",n);try{v(s=>({...s,[e]:!0})),await l("/documents/resubmit",{method:"POST",body:s}),m(s=>s.map(s=>s.document_id===e?{...s,verification_status:"pending",verification_notes:""}:s)),y(s=>{const t={...s};return delete t[e],t}),toast.success("Document resubmitted successfully!")}catch(t){console.error("Failed to resubmit document:",t),j(t.response?.data?.error||"Failed to resubmit document. Please try again.")}finally{v(s=>({...s,[e]:!1}))}})(s.document_id),disabled:!b[s.document_id]||g[s.document_id],className:"ml-2 whitespace-nowrap",children:g[s.document_id]?"Uploading...":"Upload"})]}),b[s.document_id]&&e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",b[s.document_id].name]})]})]})]},s.document_id))]})]})})};export{d as default};
//# sourceMappingURL=PublicDocumentResubmit-aOLoQ2xM.js.map
