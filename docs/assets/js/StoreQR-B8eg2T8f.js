import{j as e}from"./utils-L0j39QIW.js";import{a as s}from"./vendor-DPJ7iNYg.js";import{B as r,b as t}from"./index-DsuN1F1p.js";import{N as a}from"./Navbar-CzfKXDmw.js";import{C as o}from"./Card-DXlcOk_J.js";import"./Logo-00feJA_K.js";function n(){const n=s.useMemo(()=>{try{return JSON.parse(sessionStorage.getItem("user")||"{}")}catch{return{}}},[]),i=n?.businessId||n?.business_id,[l,d]=s.useState(()=>String(Date.now())),c=s.useRef(null),m=s.useMemo(()=>{const e=new URL(window.location.origin+"/enter-store");return i&&e.searchParams.set("business_id",String(i)),e.toString()},[i]),x=s.useMemo(()=>`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(m)}&qzone=2&format=png&_=${l}`,[m,l]);return e.jsx(r,{variant:"gradientBlue",pattern:"dots",overlay:!0,floatingElements:!0,children:e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"pt-20 px-4",children:e.jsx(a,{})}),e.jsxs("div",{className:"px-4 mt-6 grid gap-4",children:[e.jsxs(o,{className:"p-6",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:"Store QR"}),e.jsx("div",{className:"text-blue-700 mt-1",children:"Customers scan this once when they enter your store."})]}),e.jsx(o,{className:"p-6 flex flex-col items-center gap-4",children:i?e.jsxs(e.Fragment,{children:[e.jsx("img",{ref:c,src:x,alt:"Store QR",className:"w-[300px] h-[300px] border rounded-xl bg-white"}),e.jsx("div",{className:"text-blue-800 break-all text-sm",children:m}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(t,{label:"Download PNG",variant:"primary",onClick:async()=>{if(x)try{const e=await fetch(x);if(!e.ok)throw new Error("Failed to fetch QR code image");const s=await e.blob(),r=window.URL.createObjectURL(s),t=document.createElement("a");t.href=r,t.download=`store-${i||"qr"}.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(r)}catch(e){console.error("Error downloading QR code:",e),alert("Failed to download QR code. Please try again.")}else alert("QR code not available for download.")}}),e.jsx(t,{label:"Regenerate",variant:"secondary",onClick:()=>d(String(Date.now()))})]})]}):e.jsx("div",{className:"text-red-700",children:"Business ID not found. Please ensure you're logged in as an admin."})})]})]})})}export{n as default};
//# sourceMappingURL=StoreQR-B8eg2T8f.js.map
