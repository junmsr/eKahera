import{j as e}from"./utils-L0j39QIW.js";import{a as t}from"./vendor-DPJ7iNYg.js";import{P as s}from"./PageLayout-iRHGR3MD.js";import{N as r}from"./Nav-Admin-DQA6xFyi.js";import{b as a,a as o,c as i}from"./index-CSk1Jv56.js";import{C as l}from"./Card-DXlcOk_J.js";import{M as n}from"./Modal-CUPj3pCs.js";import"./BaseModal-Cy73DE2S.js";import"./Input-DoNyYXSI.js";import"./qr-52H9kDsU.js";import{u as c}from"./useDebounce-D9-0CPlj.js";import"./Navbar-Cdf61c5h.js";import"./Logo-BNMZ1XGv.js";import"./PrivacyPolicyModal-DZ2Pao8T.js";import"./FormField-NRg-OFLz.js";import"./ScannerCard-CRpLm7ay.js";function d({products:t,allProducts:s,page:r,entriesPerPage:o,totalPages:i,onPageChange:n,onEntriesChange:c,search:d,onSearchChange:m,onEdit:x,onDelete:u,onStockEntry:p,categories:g=[],selectedCategory:h,onCategoryFilter:b,stockFilter:y,onStockFilter:f,sortBy:j,sortOrder:v,onSort:k}){const N=()=>e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M15.232 5.232l3.536 3.536M9 13l6.586-6.586a2 2 0 1 1 2.828 2.828L11.828 15.828a4 4 0 0 1-1.414.828l-4.243 1.414 1.414-4.243a4 4 0 0 1 .828-1.414z"})}),w=()=>e.jsxs("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),e.jsx("path",{d:"M10 11v6M14 11v6"})]}),C=()=>e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 4v16m8-8H4"})}),S=(e,t=10)=>{const s=Number(t??10);return 0===e?{label:"Out of Stock",color:"bg-red-100 text-red-700 border-red-200"}:e<s?{label:"Low Stock",color:"bg-orange-100 text-orange-700 border-orange-200"}:{label:"In Stock",color:"bg-green-100 text-green-700 border-green-200"}},_=({direction:t})=>e.jsx("svg",{className:"w-4 h-4 "+(t?"text-blue-600":"text-gray-400"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:"asc"===t?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"}):"desc"===t?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}),L=e=>{k(e,j===e&&"asc"===v?"desc":"asc")};return e.jsxs(e.Fragment,{children:[e.jsx(l,{className:"mb-4 sm:mb-6 p-3 sm:p-4 md:p-6 w-full overflow-hidden",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4 w-full",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3 sm:gap-4 w-full",children:[e.jsx("div",{className:"flex-1 w-full min-w-0",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 sm:pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",value:d,onChange:m,className:"w-full pl-9 sm:pl-12 pr-3 sm:pr-4 py-2 sm:py-3 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl text-xs sm:text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 placeholder-gray-400",placeholder:"Search products, categories..."})]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e.jsx("label",{className:"text-xs font-semibold text-gray-600 hidden md:block",children:"Sort:"}),e.jsxs("select",{value:`${j}-${v}`,onChange:e=>{const[t,s]=e.target.value.split("-");k(t,s)},className:"bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl px-2 sm:px-3 py-1.5 sm:py-2 text-xs font-medium text-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer",children:[e.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),e.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),e.jsx("option",{value:"quantity-asc",children:"Stock (Low to High)"}),e.jsx("option",{value:"quantity-desc",children:"Stock (High to Low)"}),e.jsx("option",{value:"selling_price-asc",children:"Price (Low to High)"}),e.jsx("option",{value:"selling_price-desc",children:"Price (High to Low)"}),e.jsx("option",{value:"category-asc",children:"Category (A-Z)"})]})]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e.jsx("label",{className:"text-xs font-semibold text-gray-600 hidden md:block",children:"Show:"}),e.jsx("select",{value:o,onChange:c,className:"bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl px-2 sm:px-3 py-1.5 sm:py-2 text-xs font-medium text-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer",children:[5,10,25,50,100].map(t=>e.jsx("option",{value:t,children:t},t))})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 pt-2 sm:pt-3 border-t border-gray-100 w-full",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-600 shrink-0",children:"Filters:"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("select",{value:h||"",onChange:e=>b(e.target.value||null),className:"bg-white/80 backdrop-blur-sm border border-gray-200 rounded-full px-3 sm:px-4 py-1 sm:py-1.5 text-xs font-medium text-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer",children:[e.jsx("option",{value:"",children:"All Categories"}),g.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id||t.name))]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("select",{value:y||"",onChange:e=>f(e.target.value||null),className:"bg-white/80 backdrop-blur-sm border border-gray-200 rounded-full px-3 sm:px-4 py-1 sm:py-1.5 text-xs font-medium text-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer",children:[e.jsx("option",{value:"",children:"All Stock Status"}),e.jsx("option",{value:"in_stock",children:"In Stock"}),e.jsx("option",{value:"low_stock",children:"Low Stock"}),e.jsx("option",{value:"out_of_stock",children:"Out of Stock"})]})}),(h||y)&&e.jsxs("button",{onClick:()=>{b(null),f(null)},className:"px-2 sm:px-3 py-1 sm:py-1.5 rounded-full text-xs font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-all duration-200 flex items-center gap-1 shrink-0",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear"]})]})]})}),e.jsxs(l,{className:"overflow-hidden w-full",children:[e.jsxs("div",{className:"overflow-x-auto w-full relative hidden sm:block",children:[" ",e.jsxs("table",{className:"w-full min-w-[800px]",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gradient-to-r from-blue-50/80 to-indigo-50/80 border-b-2 border-blue-100",children:[e.jsx("th",{className:"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"#"}),e.jsx("th",{className:"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100/50 transition-colors group",onClick:()=>L("name"),children:e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:["Product",e.jsx(_,{direction:"name"===j?v:null})]})}),e.jsx("th",{className:"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider hidden sm:table-cell cursor-pointer hover:bg-blue-100/50 transition-colors group",onClick:()=>L("category"),children:e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:["Category",e.jsx(_,{direction:"category"===j?v:null})]})}),e.jsx("th",{className:"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider hidden md:table-cell",children:"Description"}),e.jsx("th",{className:"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider hidden lg:table-cell",children:"Cost Price"}),e.jsx("th",{className:"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100/50 transition-colors group",onClick:()=>L("selling_price"),children:e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:["Selling Price",e.jsx(_,{direction:"selling_price"===j?v:null})]})}),e.jsx("th",{className:"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100/50 transition-colors group",onClick:()=>L("quantity"),children:e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:["Stock",e.jsx(_,{direction:"quantity"===j?v:null})]})}),e.jsx("th",{className:"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:0===t.length?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center py-16",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})}),e.jsx("p",{className:"text-gray-500 text-lg font-semibold",children:"No products found"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:d?"Try adjusting your search terms":"Start by adding your first product"})]})})}):t.map((t,s)=>{const a=S(t.quantity,t.low_stock_level);return e.jsxs("tr",{className:"hover:bg-blue-50/50 transition-all duration-200 group",children:[e.jsx("td",{className:"py-3 px-2 sm:py-4 sm:px-4 text-xs sm:text-sm text-gray-600 font-medium",children:(r-1)*o+s+1}),e.jsx("td",{className:"py-3 px-2 sm:py-4 sm:px-4",children:e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsxs("span",{className:"text-xs sm:text-sm font-semibold text-gray-900 group-hover:text-blue-600 transition-colors truncate",children:[t.name||"N/A"," "]}),e.jsxs("span",{className:"text-[10px] sm:text-xs text-gray-500 mt-0.5 truncate",children:["SKU: ",t.sku||"N/A"]})]})}),e.jsxs("td",{className:"py-3 px-2 sm:py-4 sm:px-4 hidden sm:table-cell",children:[e.jsx("span",{className:"inline-flex items-center px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-xs font-medium bg-indigo-50 text-indigo-700 border border-indigo-200",children:t.category})," "]}),e.jsx("td",{className:"py-3 px-2 sm:py-4 sm:px-4 max-w-xs truncate hidden md:table-cell text-xs sm:text-sm text-gray-600",title:t.description,children:t.description||"-"}),e.jsx("td",{className:"py-3 px-2 sm:py-4 sm:px-4 hidden lg:table-cell",children:e.jsxs("span",{className:"text-xs sm:text-sm font-medium text-gray-700",children:["₱",Number(t.cost_price||0).toFixed(2)," "]})}),e.jsx("td",{className:"py-3 px-2 sm:py-4 sm:px-4",children:e.jsxs("span",{className:"text-xs sm:text-sm font-bold text-blue-600",children:["₱",Number(t.selling_price||0).toFixed(2)," "]})}),e.jsx("td",{className:"py-3 px-2 sm:py-4 sm:px-4",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-xs sm:text-sm font-semibold text-gray-900",children:t.quantity}),e.jsx("span",{className:`inline-flex items-center px-1.5 sm:px-2 py-0.5 rounded-full text-[10px] sm:text-xs font-medium border ${a.color}`,children:a.label})]})}),e.jsx("td",{className:"py-3 px-2 sm:py-4 sm:px-4",children:e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e.jsx("button",{onClick:()=>p&&p(t),className:"p-2 rounded-lg bg-green-50 text-green-600 hover:bg-green-100 border border-green-200 transition-all duration-200 hover:scale-110",title:"Add Stock",children:e.jsx(C,{})}),e.jsx("button",{onClick:()=>x(t),className:"p-2 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200 transition-all duration-200 hover:scale-110",title:"Edit Product",children:e.jsx(N,{})}),e.jsx("button",{onClick:()=>u(t.id),className:"p-2 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 border border-red-200 transition-all duration-200 hover:scale-110",title:"Delete Product",children:e.jsx(w,{})})]})})]},t.id)})})]})]}),e.jsx("div",{className:"sm:hidden divide-y divide-gray-100",children:0===t.length?e.jsx("div",{className:"text-center py-16 px-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})}),e.jsx("p",{className:"text-gray-500 text-lg font-semibold",children:"No products found"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:d?"Try adjusting your search terms":"Start by adding your first product"})]})}):t.map((t,s)=>{const r=S(t.quantity,t.low_stock_level);return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-bold text-gray-900 truncate",children:t.name||"N/A"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["SKU: ",t.sku||"N/A"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-medium bg-indigo-50 text-indigo-700 border border-indigo-200",children:t.category||"N/A"})}),t.description&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2 italic truncate",title:t.description,children:['"',t.description,'"']})]}),e.jsxs("div",{className:"flex-shrink-0 text-right",children:[e.jsxs("p",{className:"text-sm font-bold text-blue-600",children:["₱",Number(t.selling_price||0).toFixed(2)]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Cost: ₱",Number(t.cost_price||0).toFixed(2)]}),e.jsxs("p",{className:`text-xs font-semibold mt-1 ${r.color.replace("bg-","text-").split(" ")[0]}`,children:[t.quantity," in stock"]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2 border-t border-gray-100 pt-3",children:[e.jsx("button",{onClick:()=>p&&p(t),className:"p-2 rounded-lg bg-green-50 text-green-600 hover:bg-green-100 border border-green-200 transition-all duration-200",title:"Add Stock",children:e.jsx(C,{})}),e.jsx("button",{onClick:()=>x(t),className:"p-2 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200 transition-all duration-200",title:"Edit Product",children:e.jsx(N,{})}),e.jsx("button",{onClick:()=>u(t.id),className:"p-2 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 border border-red-200 transition-all duration-200",title:"Delete Product",children:e.jsx(w,{})})]})]},t.id)})}),e.jsx("div",{className:"bg-gray-50/50 border-t border-gray-200 px-3 sm:px-4 md:px-6 py-3 sm:py-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 sm:gap-4 w-full",children:[e.jsxs("div",{className:"text-xs sm:text-sm text-gray-600 whitespace-nowrap",children:["Showing"," ",e.jsx("span",{className:"font-semibold text-gray-900",children:0===t.length?0:(r-1)*o+1})," ","to"," ",e.jsx("span",{className:"font-semibold text-gray-900",children:Math.min(r*o,t.length)})," ","of"," ",e.jsx("span",{className:"font-semibold text-gray-900",children:t.length})," ","entries"]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-1 sm:gap-2 w-full sm:w-auto",children:[e.jsx(a,{label:"Previous",size:"sm",variant:"secondary",onClick:()=>n(r-1),disabled:1===r,className:"min-w-[80px] sm:min-w-[100px] text-xs sm:text-sm"}),e.jsx("div",{className:"flex items-center gap-1 flex-wrap justify-center",children:Array.from({length:Math.min(i,5)},(t,s)=>{let o;return o=i<=5||r<=3?s+1:r>=i-2?i-4+s:r-2+s,e.jsx(a,{variant:r===o?"paginationActive":"paginationInactive",onClick:()=>n(o),disabled:r===o,className:"min-w-[36px] sm:min-w-[40px] text-xs sm:text-sm",children:o},o)})}),e.jsx(a,{label:"Next",size:"sm",variant:"secondary",onClick:()=>n(r+1),disabled:r===i,className:"min-w-[80px] sm:min-w-[100px] text-xs sm:text-sm"})]})]})})]})]})}function m({products:t,allProducts:s=t,stats:r,page:a,entriesPerPage:o,totalPages:i,onPageChange:n,onEntriesChange:c,search:m,onSearchChange:x,onEdit:u,onDelete:p,onStockEntry:g,categories:h=[],selectedCategory:b,onCategoryFilter:y,stockFilter:f,onStockFilter:j,sortBy:v,sortOrder:k,onSort:N,className:w=""}){const C=s.reduce((e,t)=>e+Number(t.selling_price||0)*Number(t.quantity||0),0),S=s.filter(e=>{const t=Number(e.low_stock_level??10);return Number(e.quantity||0)<t}).length;return e.jsxs("div",{className:`w-full max-w-full overflow-x-hidden py-4 sm:py-6 px-4 md:px-6 ${w}`,children:[e.jsx(l,{className:"mb-4 sm:mb-6 p-3 sm:p-4 md:p-6 bg-gradient-to-r from-blue-50/80 to-indigo-50/80 border-blue-100 w-full overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4 w-full",children:[" ",e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-xl flex items-center justify-center shrink-0",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide truncate",children:"Total Products"}),e.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-gray-900 truncate",children:[s.length||0," "]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-orange-100 rounded-xl flex items-center justify-center shrink-0",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide truncate",children:"Low Stock Items"}),e.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-gray-900 truncate",children:[S||0," "]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 min-w-0 sm:col-span-2 lg:col-span-1",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-green-100 rounded-xl flex items-center justify-center shrink-0",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide truncate",children:"Total Inventory Value"}),e.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-gray-900 truncate",children:["₱ ",C.toLocaleString(void 0,{minimumFractionDigits:2})]})]})]})]})}),e.jsx(d,{products:t,page:a,entriesPerPage:o,totalPages:i,onPageChange:n,onEntriesChange:c,search:m,onSearchChange:x,onEdit:u,onDelete:p,onStockEntry:g,categories:h,selectedCategory:b,onCategoryFilter:y,stockFilter:f,onStockFilter:j,sortBy:v,sortOrder:k,onSort:N})]})}const x=[],u=[],p=10;function g(e){const t={"Grocery Store":["Fresh Produce","Meat & Poultry","Seafood","Dairy & Eggs","Bread & Bakery","Snacks & Chips","Beverages","Canned & Packaged Goods","Frozen Food","Rice, Pasta & Grains","Condiments & Spices","Cleaning Supplies","Household Essentials","Baby Products","Pet Supplies"],Pharmacy:["Prescription Medicines","OTC Medicines","Vitamins & Supplements","First Aid Supplies","Medical Devices","Personal Care","Hygiene Products","Beauty & Cosmetics","Baby Care","Adult Care","PPE & Sanitizers"],"Clothing Store":["Men’s Clothing","Women’s Clothing","Kids’ Clothing","Baby Clothing","Footwear","Bags & Accessories","Underwear & Socks"],"Electronics Store":["Mobile Devices","Computers & Laptops","Computer Accessories","Phone Accessories","Audio Devices","Cameras & Photography","Home Appliances","Personal Appliances","Gaming Consoles & Accessories","Cables, Adapters & Chargers"],Bookstore:["Fiction Books","Non-Fiction Books","Educational Books","Children’s Books","Comics & Manga","School Supplies","Art Materials","Office Supplies","Stationery & Gifts"],"Convenience Store":["Snacks","Beverages","Ready-to-Eat Food","Instant Noodles / Cup Meals","Frozen Food","Basic Grocery Items","Toiletries","Basic OTC Medicines","Household Essentials","Phone Load","Ice Cream & Desserts","Tobacco & Lighters"],Others:["General"]};return t[e]||t.Others}function h(){const[l,d]=t.useState(x),[h,b]=t.useState(()=>{try{let t=null;try{t="undefined"!=typeof window&&sessionStorage.getItem("business_type")||null}catch(e){t=null}if(!t&&"undefined"!=typeof window)try{const s=sessionStorage.getItem("user")||localStorage.getItem("user");if(s){const r=JSON.parse(s);if(t=r?.business?.business_type||r?.business_type||null,t)try{sessionStorage.setItem("business_type",t)}catch(e){}}}catch(e){t=null}t=t||"Others";return(g(t)||[]).map((e,t)=>({id:t+1,name:e}))}catch{return u}}),[y,f]=t.useState(!1),[j,v]=t.useState(!1),[k,N]=t.useState(null),[w,C]=t.useState({sku:"",name:"",category:"",customCategory:"",description:"",quantity:"",cost_price:"",selling_price:"",low_stock_level:p}),[S,_]=t.useState({sku:"",quantity:""}),[L,P]=t.useState(!1),[M,E]=t.useState(""),A=c(M,400),[B,F]=t.useState(10),[O,q]=t.useState(1),[T,D]=t.useState(""),[I,W]=t.useState(!1),[H,z]=t.useState(null),[U,$]=t.useState(!1),[V,K]=t.useState(null);t.useEffect(()=>{(async()=>{try{P(!0),D("");const t=sessionStorage.getItem("auth_token"),s=await o("/api/auth/profile",{headers:i(t)}),r=s?.business?.business_type||"Others";try{"undefined"!=typeof window&&sessionStorage.setItem("business_type",r)}catch(e){console.debug("Could not persist business_type",e)}const a=g(r);b(a.map((e,t)=>({id:t+1,name:e})));const l=await o("/api/inventory",{headers:i(t),params:{limit:1e3,offset:0}}),n=(l?.products||l||[]||[]).map(e=>({id:String(e.id||""),name:e.name||"-",category:e.category||"-",quantity:Number(e.quantity||0),cost_price:Number(e.cost_price||0),selling_price:Number(e.selling_price||0),sku:e.sku||"",description:e.description||"",low_stock_level:Number(e.low_stock_level??p)}));d(n)}catch(t){D("Failed to load inventory"),d([])}finally{P(!1)}})()},[]);const G=l.reduce((e,t)=>e+Number(t.selling_price||0)*Number(t.quantity||0),0),R=l.filter(e=>{const t=Number(e.low_stock_level??p);return Number(e.quantity||0)<t}).length,J=[{label:"TOTAL ITEMS",value:l.length,icon:e.jsx("svg",{width:"32",height:"32",fill:"none",stroke:"#2563eb",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),color:"text-blue-800",sub:"Total products in inventory"},{label:"INVENTORY VALUE",value:G,icon:e.jsx("svg",{width:"32",height:"32",fill:"none",stroke:"#2563eb",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"text-green-700",formatValue:e=>`₱${e.toLocaleString(void 0,{minimumFractionDigits:2})}`,sub:"Total value of all stock"},{label:"AVAILABLE CATEGORIES",value:h.length,icon:e.jsx("svg",{width:"32",height:"32",fill:"none",stroke:"#2563eb",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M4 7h16M4 12h16M4 17h16"})}),color:"text-blue-500",sub:"Product categories"},{label:"LOW STOCK ALERTS",value:R,icon:e.jsx("svg",{width:"32",height:"32",fill:"none",stroke:"#2563eb",strokeWidth:"2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),color:"text-orange-600",sub:"Items needing restock"}],[Y,Z]=t.useState("name"),[Q,X]=t.useState("asc"),[ee,te]=t.useState(null),[se,re]=t.useState(null),ae=t.useMemo(()=>{let e=l.filter(e=>e.name.toLowerCase().includes(A.toLowerCase())||e.category.toLowerCase().includes(A.toLowerCase())||e.description.toLowerCase().includes(A.toLowerCase()));return ee&&(e=e.filter(e=>e.category===ee)),se&&("out_of_stock"===se?e=e.filter(e=>0===Number(e.quantity||0)):"low_stock"===se?e=e.filter(e=>{const t=Number(e.quantity||0),s=Number(e.low_stock_level??p);return t>0&&t<s}):"in_stock"===se&&(e=e.filter(e=>{const t=Number(e.low_stock_level??p);return Number(e.quantity||0)>=t}))),e.sort((e,t)=>{let s,r;if("name"===Y)s=(e.name||"").toLowerCase(),r=(t.name||"").toLowerCase();else if("category"===Y)s=(e.category||"").toLowerCase(),r=(t.category||"").toLowerCase();else if("quantity"===Y)s=Number(e.quantity||0),r=Number(t.quantity||0);else{if("selling_price"!==Y)return 0;s=Number(e.selling_price||0),r=Number(t.selling_price||0)}return s<r?"asc"===Q?-1:1:s>r?"asc"===Q?1:-1:0}),e},[l,A,ee,se,Y,Q]),oe=Math.ceil(ae.length/B)||1,ie=ae.slice((O-1)*B,O*B),le=t.useCallback(()=>{N(null),C({sku:"",name:"",category:"",customCategory:"",description:"",quantity:"",cost_price:"",selling_price:"",low_stock_level:p}),f(!0)},[]),ne=t.useCallback(e=>{N(e),C({...e,low_stock_level:"number"==typeof e.low_stock_level?e.low_stock_level:p}),f(!0)},[]),ce=t.useCallback(e=>{_({sku:e?.sku||"",quantity:""}),v(!0)},[]),de=t.useCallback(e=>{const{name:t,value:s}=e.target;("clearError"===t||T&&"clearError"!==t)&&D(""),"clearError"!==t&&C(e=>({...e,[t]:s}))},[]),me=t.useCallback(async e=>{e.preventDefault();try{P(!0),D("");const e=sessionStorage.getItem("auth_token");k?await o(`/api/inventory/${k.id}`,{method:"PUT",headers:{"Content-Type":"application/json",...i(e)},body:JSON.stringify({product_name:(w.name||"").trim(),cost_price:Number(w.cost_price)||0,selling_price:Number(w.selling_price)||0,sku:(w.sku||"").trim(),low_stock_level:Number(w.low_stock_level)||p,category:"Others"===w.category?(w.customCategory||"").trim():(w.category||"").trim(),description:(w.description||"").trim()})}):await o("/api/products",{method:"POST",headers:{"Content-Type":"application/json",...i(e)},body:JSON.stringify({product_category_id:null,category:"Others"===w.category?(w.customCategory||"").trim():(w.category||"").trim(),product_name:(w.name||"").trim(),name:(w.name||"").trim(),description:(w.description||"").trim(),cost_price:Number(w.cost_price)||0,selling_price:Number(w.selling_price)||0,price:Number(w.selling_price)||0,sku:(w.sku||"").trim()||`SKU-${Date.now()}`,quantity:Number(w.quantity)||0,low_stock_level:Number(w.low_stock_level)||p})});const t=await o("/api/inventory",{headers:i(e),params:{limit:1e3,offset:0}}),s=(t?.products||t||[]||[]).map(e=>({id:String(e.id||""),name:e.name||"-",category:e.category||"-",quantity:Number(e.quantity||0),cost_price:Number(e.cost_price||0),selling_price:Number(e.selling_price||0),sku:e.sku||"",description:e.description||"",low_stock_level:Number(e.low_stock_level??p)}));d(s),f(!1)}catch(t){let e="Failed to save product";try{const s=t.response?.data||t.data||{},r=t.response?.status;409===r||"Product with this SKU already exists"===s.error?(e=s.message||`A product with SKU "${w.sku?.trim()||"this SKU"}" already exists. Please use a different SKU.`,s.existingProduct&&(e=`SKU "${w.sku?.trim()}" is already in use by "${s.existingProduct.product_name}". Please use a different SKU code.`)):s.error||s.message?e=s.message||s.error:t.message&&(e=t.message)}catch(s){e=t.message||"Failed to save product",console.error("Error parsing error response:",s)}D(e)}finally{P(!1)}},[k,w]),xe=t.useCallback(async e=>{e.preventDefault();try{P(!0),D("");const e=sessionStorage.getItem("auth_token");await o("/api/products/add-stock-by-sku",{method:"POST",headers:i(e),body:JSON.stringify({sku:S.sku,quantity:Number(S.quantity)})});const t=await o("/api/inventory",{headers:i(e),params:{limit:1e3,offset:0}}),s=(t?.products||t||[]||[]).map(e=>({id:String(e.id||""),name:e.name||"-",category:e.category||"-",quantity:Number(e.quantity||0),cost_price:Number(e.cost_price||0),selling_price:Number(e.selling_price||0),sku:e.sku||"",description:e.description||"",low_stock_level:Number(e.low_stock_level??p)}));d(s),v(!1)}catch(t){D("Failed to add stock")}finally{P(!1)}},[S]),ue=t.useCallback(e=>{const t=l.find(t=>String(t.id)===String(e));t&&(K(t),$(!0))},[l]),pe=t.useCallback(async()=>{if(V)try{P(!0),D("");const t=sessionStorage.getItem("auth_token");try{await o(`/api/products/${V.id}`,{method:"DELETE",headers:i(t)})}catch(e){console.log("Trying fallback delete endpoint..."),await o(`/api/inventory/${V.id}`,{method:"DELETE",headers:i(t)})}d(e=>e.filter(e=>e.id!==V.id)),$(!1),K(null)}catch(e){console.error("Error deleting product:",e),D(e.response?.data?.error||"Failed to delete product. Please try again.")}finally{P(!1)}},[V]),ge=t.useCallback(e=>{e<1||e>oe||q(e)},[oe]),he=t.useCallback(e=>{F(Number(e.target.value)),q(1)},[]),be=t.useCallback(e=>{E(e.target.value),q(1)},[]),ye=t.useCallback(()=>{((e,t)=>{const s=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");if(void 0!==r.download){const e=URL.createObjectURL(s);r.setAttribute("href",e),r.setAttribute("download",t),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}})((e=>{if(!e||0===e.length)return"";const t=[];return t.push(["Name","SKU","Category","Description","Cost Price","Selling Price","Stock"].join(",")),e.forEach(e=>{const s=[`"${e.name||""}"`,`"${e.sku||""}"`,`"${e.category||""}"`,`"${e.description||""}"`,e.cost_price||0,e.selling_price||0,e.quantity||0];t.push(s.join(","))}),t.join("\n")})(ae),`inventory_export_${(new Date).toISOString().split("T")[0]}.csv`)},[ae]),fe=e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-end gap-3 sm:gap-4 mb-4 sm:mb-0 w-full",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 sm:gap-3 w-auto",children:[e.jsxs(a,{onClick:le,variant:"primary",microinteraction:!0,className:"bg-blue-600 text-md text-white font-semibold rounded-lg shadow hover:bg-blue-700 transition gap-1 sm:gap-2 flex items-center justify-center sm:justify-start !py-2 !px-2 sm:!px-2 shrink-0 min-w-[40px] sm:min-w-[40px] lg:min-w-0",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{className:"hidden sm:block",children:"Add Product"}),e.jsx("span",{className:"sm:inline"})]}),e.jsxs(a,{onClick:ye,variant:"secondary",className:"text-sm flex items-center justify-center sm:justify-start gap-1 sm:gap-2 shrink-0 !py-2 !px-2 sm:!px-2 min-w-[40px] sm:min-w-[40px] lg:min-w-0",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{className:"hidden sm:inline",children:"Export"})]})]})});return e.jsxs(s,{title:"INVENTORY",sidebar:e.jsx(r,{}),isSidebarOpen:I,headerActions:fe,setSidebarOpen:W,showHeader:!0,showNavbar:!1,showFooter:!1,children:[e.jsx(m,{products:ie,allProducts:ae,stats:J,page:O,entriesPerPage:B,totalPages:oe,onPageChange:ge,onEntriesChange:he,search:M,onSearchChange:be,onEdit:ne,onDelete:ue,onAddProduct:le,onStockEntry:ce,categories:h,selectedCategory:ee,onCategoryFilter:e=>{te(e),q(1)},stockFilter:se,onStockFilter:e=>{re(e),q(1)},sortBy:Y,sortOrder:Q,onSort:(e,t)=>{Z(e),X(t),q(1)}}),T&&!y&&e.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-lg p-4 flex items-start gap-3 mt-4 shadow-sm",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-red-800 mb-1",children:T.includes("already exists")||T.includes("SKU")?"Duplicate Product":"Error"}),e.jsx("p",{className:"text-sm text-red-700",children:(()=>{try{const e=JSON.parse(T);return e.error||e.message||T}catch{return T}})()}),T.includes("already exists")&&e.jsx("p",{className:"text-xs text-red-600 mt-2 italic",children:"Please use a different SKU code or update the existing product instead."})]}),e.jsx("button",{onClick:()=>D(""),className:"flex-shrink-0 text-red-400 hover:text-red-600 transition-colors","aria-label":"Close error",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx(n,{isOpen:y,onClose:()=>{f(!1),D("")},variant:"product",title:k?"Edit Product":"Add New Product",editingProduct:k,productForm:w,onChange:de,categories:h,onSubmit:me,loading:L,error:T}),e.jsx(n,{isOpen:j,onClose:()=>v(!1),title:"Stock Entry",variant:"stock",editingProduct:null,stockForm:S,onChange:e=>_({...S,[e.target.name]:e.target.value}),onSubmit:xe,loading:L}),e.jsx(n,{isOpen:U,onClose:()=>$(!1),title:"",size:"sm",children:e.jsxs("div",{className:"p-0",children:[e.jsx("div",{className:"bg-gradient-to-r from-red-50 via-red-50/80 to-orange-50/50 border-b border-red-100 px-6 py-5 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-1",children:"Confirm Deletion"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Are you sure you want to delete this product?"})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:["You are about to delete:"," ",e.jsx("strong",{className:"text-red-700",children:V?.name})]}),e.jsx("p",{className:"text-sm text-gray-700 mb-6",children:"This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(a,{onClick:()=>$(!1),variant:"secondary",disabled:L,children:"Cancel"}),e.jsx(a,{onClick:pe,variant:"danger",loading:L,children:"Delete"})]})]})]})})]})}export{h as default};
//# sourceMappingURL=Inventory-DbJxZPxp.js.map
