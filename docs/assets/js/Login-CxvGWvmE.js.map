{"version":3,"file":"Login-CxvGWvmE.js","sources":["../../../frontend/src/pages/Login.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { api } from \"../lib/api\";\r\nimport Logo from '../components/common/Logo';\r\n\r\n// Components\r\nimport Background from \"../components/layout/Background\";\r\nimport Card from \"../components/common/Card\";\r\nimport SectionHeader from \"../components/layout/SectionHeader\";\r\n \r\nimport Input from \"../components/common/Input\";\r\nimport PasswordInput from \"../components/common/PasswordInput\";\r\nimport Button from \"../components/common/Button\";\r\nimport Loader from \"../components/common/Loader\";\r\n\r\n/**\r\n * Login Page Component\r\n * Handles user authentication with email and password\r\n */\r\nexport default function Login() {\r\n  // Navigation\r\n  const navigate = useNavigate();\r\n\r\n  // Form state\r\n  const [form, setForm] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n  });\r\n  const [errors, setErrors] = useState({});\r\n  const [loading, setLoading] = useState(false);\r\n  const [apiError, setApiError] = useState(\"\");\r\n\r\n  // Form handlers\r\n  const handleChange = (e) => {\r\n    setForm({ ...form, [e.target.name]: e.target.value });\r\n    // Clear error when user starts typing\r\n    if (errors[e.target.name]) {\r\n      setErrors({ ...errors, [e.target.name]: \"\" });\r\n    }\r\n  };\r\n\r\n  // Validation\r\n  const validateForm = () => {\r\n    const err = {};\r\n\r\n    if (!form.email) {\r\n      err.email = \"Email or username is required\";\r\n    }\r\n\r\n    if (!form.password) {\r\n      err.password = \"Password is required\";\r\n    }\r\n\r\n    setErrors(err);\r\n    return Object.keys(err).length === 0;\r\n  };\r\n\r\n  // Form submission\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!validateForm()) return;\r\n    setLoading(true);\r\n    setApiError(\"\");\r\n    try {\r\n      const { token, user } = await api(\"/api/auth/login\", {\r\n        method: \"POST\",\r\n        body: JSON.stringify({ email: form.email, password: form.password }),\r\n      });\r\n      sessionStorage.setItem('auth_token', token);\r\n      sessionStorage.setItem('user', JSON.stringify(user));\r\n      const role = (user?.role || '').toLowerCase();\r\n      if (role === 'cashier') {\r\n        navigate('/cashier-pos');\r\n      } else if (role === 'superadmin') {\r\n        navigate('/superadmin');\r\n      } else if (role === 'admin') {\r\n        navigate('/dashboard');\r\n      } else {\r\n        navigate(\"/\");\r\n      }\r\n    } catch (err) {\r\n      setApiError(\"Login Failed\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  return (\r\n    <Background variant=\"gradientBlue\" pattern=\"dots\" overlay floatingElements>\r\n      {/* Gradient overlay per request */}\r\n      <div className=\"absolute inset-0 bg-gradient-to-br from-blue-50 via-indigo-50/30 to-purple-50/20 pointer-events-none\" />\r\n      <main className=\"flex h-screen items-center justify-center px-2 relative z-10 overflow-hidden\">\r\n        <Card\r\n          variant=\"glass\"\r\n          className=\"w-full max-w-4xl flex flex-col md:flex-row overflow-hidden p-0 animate-fadeIn rounded-2xl shadow-xl\"\r\n        >\r\n          {/* left: Login Form Panel */}\r\n        <section className=\"w-full md:w-1/2 flex flex-col justify-center items-center p-6 md:p-12 rounded-l-2xl bg-white/90 backdrop-blur-xl\">\r\n          <div className=\"w-full max-w-md\">\r\n            {/* Back to home button */}\r\n            <div className=\"mb-4\">\r\n              <Link\r\n                to=\"/\"\r\n                className=\"inline-flex items-center gap-2 text-sm text-gray-600 hover:text-gray-800\"\r\n              >\r\n                <svg\r\n                  className=\"w-4 h-4\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M15 19l-7-7 7-7\"\r\n                  />\r\n                </svg>\r\n                Back to home\r\n              </Link>\r\n            </div>\r\n            <div className=\"flex flex-col items-center mb-6\">\r\n              <SectionHeader\r\n                variant=\"primary\"\r\n                size=\"lg\"\r\n                className=\"text-center\"\r\n              >\r\n                Log In\r\n              </SectionHeader>\r\n              <p className=\"text-gray-500 text-sm mt-2\">\r\n                Enter your credentials to access your account\r\n              </p>\r\n            </div>\r\n\r\n            <form\r\n              onSubmit={handleSubmit}\r\n              className=\"w-full flex flex-col gap-4\"\r\n              noValidate\r\n            >\r\n              <Input\r\n                name=\"email\"\r\n                value={form.email}\r\n                onChange={handleChange}\r\n                placeholder=\"Email or username\"\r\n                type=\"text\"\r\n                error={errors.email}\r\n                autoComplete=\"username\"\r\n                required\r\n              />\r\n\r\n              <div className=\"relative\">\r\n                <PasswordInput\r\n                  name=\"password\"\r\n                  value={form.password}\r\n                  onChange={handleChange}\r\n                  placeholder=\"Password\"\r\n                  error={errors.password}\r\n                  autoComplete=\"current-password\"\r\n                  required\r\n                  className=\"pr-12\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-between mt-1 text-sm text-gray-500\">\r\n                <Link to=\"/forgot-password\" className=\"text-blue-600 hover:underline\">\r\n                  Forgot password?\r\n                </Link>\r\n                <div>\r\n                  Need an account?{\" \"}\r\n                  <a\r\n                    href=\"/get-started\"\r\n                    className=\"text-blue-600 hover:underline\"\r\n                  >\r\n                    Get started\r\n                  </a>\r\n                </div>\r\n              </div>\r\n\r\n              {apiError && (\r\n                <div className=\"bg-red-50 border-l-4 border-red-500 rounded-lg p-3 flex items-start gap-2\">\r\n                  <svg className=\"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n                  </svg>\r\n                  <p className=\"text-sm font-medium text-red-700\">\r\n                    {(() => {\r\n                      try {\r\n                        const parsed = JSON.parse(apiError);\r\n                        return parsed.error || parsed.message || apiError;\r\n                      } catch {\r\n                        return apiError;\r\n                      }\r\n                    })()}\r\n                  </p>\r\n                </div>\r\n              )}\r\n\r\n              <Button\r\n                type=\"submit\"\r\n                variant=\"primary\"\r\n                disabled={loading}\r\n                className=\"w-full flex items-center justify-center h-12 mt-2 text-lg font-medium transition-all duration-300 hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]\"\r\n              >\r\n                {loading && <Loader size=\"sm\" className=\"mr-2\" />}\r\n                {loading ? \"Logging in...\" : \"Login\"}\r\n              </Button>\r\n            </form>\r\n\r\n            <div className=\"mt-6 text-center\">\r\n              <p className=\"mt-6 text-gray-400 text-xs\">\r\n                Secure login powered by eKahera\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </section>\r\n\r\n        {/* right: Illustration / Branding Panel (modernized) */}\r\n        <aside className=\"hidden md:flex items-center rounded-r-2xl bg-gradient-to-br from-indigo-500 via-blue-400 to-sky-400 w-1/2 p-10 relative overflow-hidden\">\r\n          <div className=\"absolute inset-0 opacity-7 -z-10 pointer-events-none\">\r\n            <div className=\"w-full h-full bg-[radial-gradient(circle_at_1px_1px,rgba(255,255,255,0.25)_1px,transparent_0)] bg-[length:24px_24px]\" />\r\n          </div>\r\n\r\n          <div className=\"relative z-10 flex flex-col justify-center items-start max-w-sm pl-6\">\r\n            {/* <Logo className=\"w-56 h-auto p-10 \"\r\n            /> */}\r\n            <h2 className=\"text-white font-extrabold text-3xl leading-tight mb-3\">\r\n              Welcome back!\r\n            </h2>\r\n            <p className=\"text-white/90 text-base max-w-xs mb-6\">\r\n              Sign in to continue managing transactions, inventory and sales\r\n              from anywhere.\r\n            </p>\r\n            <div className=\"inline-flex items-center gap-2 rounded-full bg-white/15 text-white/90 px-3 py-1 text-xs backdrop-blur-sm ring-1 ring-white/20\">\r\n              <span className=\"inline-block h-2 w-2 rounded-full bg-emerald-300 animate-pulse\" />\r\n              Secure area â€¢ eKahera\r\n            </div>\r\n            {/* Illustration removed per request */}\r\n          </div>\r\n        </aside>\r\n        </Card>\r\n      </main>\r\n\r\n      {/* Page lock style */}\r\n      <style>{`\r\n    html, body, #root {\r\n      height: 100%;\r\n      margin: 0;\r\n      padding: 0;\r\n      overflow: hidden; /* No scroll */\r\n    }\r\n  `}</style>\r\n    </Background>\r\n  );\r\n}\r\n"],"names":["Login","navigate","useNavigate","form","setForm","useState","email","password","errors","setErrors","loading","setLoading","apiError","setApiError","handleChange","e","target","name","value","jsxs","Background","variant","pattern","overlay","floatingElements","children","jsx","className","Card","Link","to","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","SectionHeader","size","onSubmit","async","preventDefault","validateForm","err","Object","keys","length","token","user","api","method","body","JSON","stringify","setItem","sessionStorage","role","toLowerCase","noValidate","Input","onChange","placeholder","type","error","autoComplete","required","PasswordInput","href","parsed","parse","message","Button","disabled","Loader"],"mappings":"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"}