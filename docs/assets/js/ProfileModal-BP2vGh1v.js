import{j as e}from"./utils-B2FtDWBX.js";import{a as s}from"./vendor-mHQTfcnf.js";import{b as a,a as r}from"./index-C9q1jg2T.js";import{F as t}from"./FormField-BokbHxN5.js";import{B as n}from"./BaseModal-DLQpfPIu.js";const o=({isOpen:o,onClose:l,userData:i,businessData:d})=>{const[m,u]=s.useState({first_name:i?.first_name||"",last_name:i?.last_name||"",email:i?.email||"",contact_number:i?.contact_number||"",currentPassword:"",newPassword:"",confirmPassword:"",country:d?.country||"",business_email:d?.email||"",business_address:d?.business_address||"",house_number:d?.house_number||"",mobile:d?.mobile||""}),[c,b]=s.useState(!1),[h,x]=s.useState(""),[f,p]=s.useState(""),[w,g]=s.useState({}),[_,j]=s.useState({}),[v,y]=s.useState("account");s.useEffect(()=>{(i||d)&&(u({first_name:i?.first_name||"",last_name:i?.last_name||"",email:i?.email||"",contact_number:i?.contact_number||"",currentPassword:"",newPassword:"",confirmPassword:"",country:d?.country||"",business_email:d?.email||"",business_address:d?.business_address||"",house_number:d?.house_number||"",mobile:d?.mobile||""}),x(""),p(""),g({}),j({}),y("account"))},[i,d,o]);const P=(e,s)=>{const a={...w};switch(e){case"first_name":"account"!==v||s.trim()?s.trim().length<2?a.first_name="First name must be at least 2 characters":delete a.first_name:a.first_name="First name is required";break;case"last_name":"account"!==v||s.trim()?s.trim().length<2?a.last_name="Last name must be at least 2 characters":delete a.last_name:a.last_name="Last name is required";break;case"email":"account"!==v||s.trim()?s.trim()&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.trim())?a.email="Please enter a valid email":delete a.email:a.email="Email is required";break;case"contact_number":s&&s.trim().length<7?a.contact_number="Phone number must be at least 7 digits":delete a.contact_number;break;case"business_email":s.trim()&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.trim())?a.business_email="Please enter a valid email":delete a.business_email;break;case"mobile":s&&s.trim().length<7?a.mobile="Mobile number must be at least 7 digits":delete a.mobile;break;case"currentPassword":m.newPassword&&!s?a.currentPassword="Current password is required to change password":delete a.currentPassword;break;case"newPassword":s&&s.length<6?a.newPassword="Password must be at least 6 characters":delete a.newPassword;break;case"confirmPassword":s&&s!==m.newPassword?a.confirmPassword="Passwords do not match":delete a.confirmPassword}g(a)},N=e=>{const{name:s,value:a}=e.target;u(e=>({...e,[s]:a})),_[s]&&P(s,a)},k=e=>{const{name:s,value:a}=e.target;j(e=>({...e,[s]:!0})),P(s,a)},C=async e=>{e.preventDefault(),b(!0),x(""),p(""),Object.keys(m).forEach(e=>{P(e,m[e])});if(Object.keys(w).length>0)b(!1);else try{const e=sessionStorage.getItem("auth_token");if("account"===v||"security"===v){const s={first_name:m.first_name,last_name:m.last_name,email:m.email,contact_number:m.contact_number};m.newPassword&&(s.currentPassword=m.currentPassword,s.newPassword=m.newPassword),await r("/api/auth/update-profile",{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(s)})}else if("business"===v){const s={country:m.country,business_email:m.business_email,business_address:m.business_address,house_number:m.house_number,mobile:m.mobile};await r("/api/business/update-business",{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(s)})}x("Profile updated successfully!"),setTimeout(()=>{B(),window.location.reload()},2e3)}catch(s){console.error("Failed to update profile:",s),p(s.message||"Failed to update profile. Please try again.")}finally{b(!1)}},B=()=>{u({first_name:i?.first_name||"",last_name:i?.last_name||"",email:i?.email||"",contact_number:i?.contact_number||"",currentPassword:"",newPassword:"",confirmPassword:"",country:d?.country||"",business_email:d?.email||"",business_address:d?.business_address||"",house_number:d?.house_number||"",mobile:d?.mobile||""}),g({}),j({}),x(""),p(""),y("account"),l()};if(!o)return null;const E=e.jsxs(e.Fragment,{children:[e.jsx(a,{label:"Cancel",variant:"secondary",onClick:B,type:"button",disabled:c,className:"px-6 py-2.5 rounded-xl font-medium transition-all duration-200"}),e.jsx(a,{label:c?"Saving...":"Save Changes",variant:"primary",type:"submit",onClick:C,disabled:!("account"===v?0===Object.keys(w).length&&m.first_name.trim()&&m.last_name.trim()&&m.email.trim():("business"===v||"security"===v)&&0===Object.keys(w).length)||c,className:"px-6 py-2.5 rounded-xl font-medium transition-all duration-200 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-lg hover:shadow-xl"})]});return e.jsxs(n,{isOpen:o,onClose:B,title:"Edit Profile",subtitle:"Update your account details",icon:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),footer:E,disabled:c,contentClassName:"space-y-5",children:[h&&e.jsxs("div",{className:"p-4 bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200/50 rounded-2xl flex items-start gap-3 animate-in slide-in-from-top duration-300",children:[e.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("svg",{className:"w-5 h-5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-emerald-900",children:h}),e.jsx("p",{className:"text-xs text-emerald-700 mt-0.5",children:"Your profile has been updated successfully"})]})]}),f&&e.jsxs("div",{className:"p-4 bg-gradient-to-r from-red-50 to-rose-50 border border-red-200/50 rounded-2xl flex items-start gap-3 animate-in slide-in-from-top duration-300",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-red-900",children:f}),e.jsx("p",{className:"text-xs text-red-700 mt-0.5",children:"Please check your information and try again"})]})]}),e.jsxs("div",{className:"flex gap-1 border-b border-slate-200/10 -mx-6 px-6",children:[e.jsxs("button",{onClick:()=>y("account"),className:"px-4 py-2 rounded-t-xl font-medium transition-all duration-200 relative "+("account"===v?"text-blue-600 bg-blue-50/30":"text-slate-500 hover:text-slate-700"),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Account"]}),"account"===v&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full"})]}),e.jsxs("button",{onClick:()=>y("business"),className:"px-4 py-2 rounded-t-xl font-medium transition-all duration-200 relative "+("business"===v?"text-blue-600 bg-blue-50/30":"text-slate-500 hover:text-slate-700"),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Business"]}),"business"===v&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full"})]}),e.jsxs("button",{onClick:()=>y("security"),className:"px-4 py-2 rounded-t-xl font-medium transition-all duration-200 relative "+("security"===v?"text-blue-600 bg-blue-50/30":"text-slate-500 hover:text-slate-700"),children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Security"]}),"security"===v&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full"})]})]}),e.jsxs("form",{onSubmit:C,children:["account"===v&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Personal Information"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent"})]}),e.jsx(t,{label:"First Name",name:"first_name",value:m.first_name,onChange:N,onBlur:k,placeholder:"Enter first name",error:_.first_name&&w.first_name?w.first_name:null,required:!0}),e.jsx(t,{label:"Last Name",name:"last_name",value:m.last_name,onChange:N,onBlur:k,placeholder:"Enter last name",error:_.last_name&&w.last_name?w.last_name:null,required:!0}),e.jsx(t,{label:"Email Address",name:"email",type:"email",value:m.email,onChange:N,onBlur:k,placeholder:"Enter email address",error:_.email&&w.email?w.email:null,required:!0}),e.jsx(t,{label:"Contact Number",name:"contact_number",type:"tel",value:m.contact_number,onChange:N,onBlur:k,placeholder:"Enter phone number",error:_.contact_number&&w.contact_number?w.contact_number:null})]}),"business"===v&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Business Information"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent"})]}),e.jsx(t,{label:"Country",name:"country",value:m.country,onChange:N,onBlur:k,placeholder:"Enter country",error:_.country&&w.country?w.country:null}),e.jsx(t,{label:"Business Email",name:"business_email",type:"email",value:m.business_email,onChange:N,onBlur:k,placeholder:"Enter business email",error:_.business_email&&w.business_email?w.business_email:null}),e.jsx(t,{label:"Business Address",name:"business_address",value:m.business_address,onChange:N,onBlur:k,placeholder:"Enter business address",error:_.business_address&&w.business_address?w.business_address:null}),e.jsx(t,{label:"House Number",name:"house_number",value:m.house_number,onChange:N,onBlur:k,placeholder:"Enter house number",error:_.house_number&&w.house_number?w.house_number:null}),e.jsx(t,{label:"Mobile Number",name:"mobile",type:"tel",value:m.mobile,onChange:N,onBlur:k,placeholder:"Enter mobile number",error:_.mobile&&w.mobile?w.mobile:null})]}),"security"===v&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Change Password"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent"})]}),e.jsx("p",{className:"text-xs text-slate-500 bg-amber-50 border border-amber-100/50 rounded-xl px-3 py-2",children:"Leave blank to keep your current password"}),e.jsx(t,{label:"Current Password",name:"currentPassword",type:"password",value:m.currentPassword,onChange:N,onBlur:k,placeholder:"Enter current password",error:_.currentPassword&&w.currentPassword?w.currentPassword:null}),m.newPassword&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"Password Strength"}),e.jsx("div",{className:"w-full h-1.5 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300 "+(m.newPassword.length>=12?"w-full bg-gradient-to-r from-green-500 to-emerald-500":m.newPassword.length>=8?"w-2/3 bg-gradient-to-r from-yellow-500 to-amber-500":"w-1/3 bg-gradient-to-r from-red-500 to-orange-500")})})]}),e.jsx(t,{label:"New Password",name:"newPassword",type:"password",value:m.newPassword,onChange:N,onBlur:k,placeholder:"Min. 6 characters",error:_.newPassword&&w.newPassword?w.newPassword:null}),e.jsx(t,{label:"Confirm Password",name:"confirmPassword",type:"password",value:m.confirmPassword,onChange:N,onBlur:k,placeholder:"Re-enter new password",error:_.confirmPassword&&w.confirmPassword?w.confirmPassword:null})]})]})]})};export{o as P};
//# sourceMappingURL=ProfileModal-BP2vGh1v.js.map
