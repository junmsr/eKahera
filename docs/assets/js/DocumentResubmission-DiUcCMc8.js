import{j as e}from"./utils-L0j39QIW.js";import{a as s,u as t}from"./vendor-DPJ7iNYg.js";import{P as a}from"./PageLayout-Dhnl7q0_.js";import{N as r}from"./Nav-Admin-BGKx2YsF.js";import{a as i,c as d,L as l,b as n}from"./index-ClhASDms.js";import"./Navbar-Ej4WYTg-.js";import"./Logo-DxHgPni2.js";import"./PrivacyPolicyModal-4S2_J5Uu.js";import"./BaseModal-Cy73DE2S.js";const o=()=>{const[o,c]=s.useState([]),[m,u]=s.useState(!0),[x,h]=s.useState(""),[j,p]=s.useState({}),[f,b]=s.useState({}),g=t();s.useEffect(()=>{v()},[]);const v=async()=>{try{u(!0);const e=sessionStorage.getItem("auth_token"),s=JSON.parse(sessionStorage.getItem("user")||"{}"),t=s.businessId||s.business_id;if(!e)throw new Error("No authentication token found");const a=await i(`/documents/business/${t}`,{headers:d(e)}),r=Array.isArray(a.documents)?a.documents.filter(e=>"rejected"===e.verification_status):[];c(r)}catch(e){console.error("Failed to fetch documents:",e),h("Failed to load documents. Please try again later.")}finally{u(!1)}},y=e=>{switch(e){case"approved":return"text-green-600 bg-green-100";case"rejected":return"text-red-600 bg-red-100";default:return"text-yellow-600 bg-yellow-100"}};return m?e.jsx(a,{title:"RESUBMIT DOCUMENTS",subtitle:"Resubmit your rejected documents",sidebar:e.jsx(r,{}),children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(l,{})})}):e.jsx(a,{title:"RESUBMIT DOCUMENTS",subtitle:"Resubmit your rejected documents",sidebar:e.jsx(r,{}),children:e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[x&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-red-800",children:x})}),0===o.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No documents require resubmission"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"All your documents are up to date."}),e.jsx(n,{onClick:()=>g("/documents"),children:"View All Documents"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h2a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-blue-700",children:"Please upload new versions of your rejected documents. Make sure all documents are clear and up to date."})})]})}),o.map(s=>e.jsxs("div",{className:"bg-white shadow overflow-hidden rounded-lg",children:[e.jsx("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:s.document_type}),e.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:s.document_name})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${y(s.verification_status)}`,children:s.verification_status})]})}),e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[s.verification_notes&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Rejection Reason:"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:s.verification_notes})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload new version"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"file",onChange:e=>{return t=s.document_id,a=e.target.files[0],void b(e=>({...e,[t]:a}));var t,a},className:"block w-full text-sm text-gray-500\r\n                          file:mr-4 file:py-2 file:px-4\r\n                          file:rounded-md file:border-0\r\n                          file:text-sm file:font-semibold\r\n                          file:bg-blue-50 file:text-blue-700\r\n                          hover:file:bg-blue-100",accept:".pdf,.jpg,.jpeg,.png"}),e.jsx(n,{onClick:()=>(async e=>{if(!f[e])return void h("Please select a file to upload");const s=new FormData;s.append("document",f[e]),s.append("document_id",e);try{p(s=>({...s,[e]:!0}));const t=sessionStorage.getItem("auth_token");await i("/documents/resubmit",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:s}),await v(),b(s=>{const t={...s};return delete t[e],t})}catch(t){console.error("Failed to resubmit document:",t),h(t.message||"Failed to resubmit document. Please try again.")}finally{p(s=>({...s,[e]:!1}))}})(s.document_id),disabled:!f[s.document_id]||j[s.document_id],className:"ml-4 whitespace-nowrap",loading:j[s.document_id],children:j[s.document_id]?"Uploading...":"Resubmit"})]}),f[s.document_id]&&e.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Selected: ",f[s.document_id].name]})]})]})]},s.document_id))]})]})})};export{o as default};
//# sourceMappingURL=DocumentResubmission-DiUcCMc8.js.map
