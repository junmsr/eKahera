{"version":3,"file":"Inventory-DkBXICHX.js","sources":["../../../frontend/src/components/inventory/Inventory.jsx","../../../frontend/src/pages/Inventory.jsx"],"sourcesContent":["import React from \"react\";\r\nimport Button from \"../common/Button\";\r\nimport StatsCard from \"../ui/Dashboard/StatsCard\";\r\nimport Card from \"../common/Card\";\r\n\r\nconst DEFAULT_LOW_STOCK_LEVEL = 10;\r\n\r\n// Utility function to convert array of objects to CSV\r\nconst convertToCSV = (data) => {\r\n  if (!data || data.length === 0) return \"\";\r\n\r\n  const headers = [\r\n    \"Name\",\r\n    \"SKU\",\r\n    \"Category\",\r\n    \"Description\",\r\n    \"Cost Price\",\r\n    \"Selling Price\",\r\n    \"Stock\",\r\n  ];\r\n  const csvRows = [];\r\n\r\n  // Add headers\r\n  csvRows.push(headers.join(\",\"));\r\n\r\n  // Add data rows\r\n  data.forEach((item) => {\r\n    const row = [\r\n      `\"${item.name || \"\"}\"`,\r\n      `\"${item.sku || \"\"}\"`,\r\n      `\"${item.category || \"\"}\"`,\r\n      `\"${item.description || \"\"}\"`,\r\n      item.cost_price || 0,\r\n      item.selling_price || 0,\r\n      item.quantity || 0,\r\n    ];\r\n    csvRows.push(row.join(\",\"));\r\n  });\r\n\r\n  return csvRows.join(\"\\n\");\r\n};\r\n\r\n// Utility function to download CSV\r\nconst downloadCSV = (csv, filename) => {\r\n  const blob = new Blob([csv], { type: \"text/csv;charset=utf-8;\" });\r\n  const link = document.createElement(\"a\");\r\n  if (link.download !== undefined) {\r\n    const url = URL.createObjectURL(blob);\r\n    link.setAttribute(\"href\", url);\r\n    link.setAttribute(\"download\", filename);\r\n    link.style.visibility = \"hidden\";\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  }\r\n};\r\n\r\n/**\r\n * Inventory Table Component\r\n * Internal component for displaying inventory data\r\n */\r\nfunction InventoryTable({\r\n  products,\r\n  allProducts,\r\n  page,\r\n  entriesPerPage,\r\n  totalPages,\r\n  onPageChange,\r\n  onEntriesChange,\r\n  search,\r\n  onSearchChange,\r\n  onEdit,\r\n  onDelete,\r\n  onStockEntry,\r\n  categories = [],\r\n  selectedCategory,\r\n  onCategoryFilter,\r\n  stockFilter,\r\n  onStockFilter,\r\n  sortBy,\r\n  sortOrder,\r\n  onSort,\r\n}) {\r\n  const EditIcon = () => (\r\n    <svg\r\n      className=\"w-4 h-4 sm:w-5 sm:h-5\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path d=\"M15.232 5.232l3.536 3.536M9 13l6.586-6.586a2 2 0 1 1 2.828 2.828L11.828 15.828a4 4 0 0 1-1.414.828l-4.243 1.414 1.414-4.243a4 4 0 0 1 .828-1.414z\" />\r\n    </svg>\r\n  );\r\n  const DeleteIcon = () => (\r\n    <svg\r\n      className=\"w-4 h-4 sm:w-5 sm:h-5\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path d=\"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\" />\r\n      <path d=\"M10 11v6M14 11v6\" />\r\n    </svg>\r\n  );\r\n  const StockIcon = () => (\r\n    <svg\r\n      className=\"w-4 h-4 sm:w-5 sm:h-5\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path d=\"M12 4v16m8-8H4\" />\r\n    </svg>\r\n  );\r\n\r\n  const getStockStatus = (\r\n    quantity,\r\n    lowStockLevel = DEFAULT_LOW_STOCK_LEVEL\r\n  ) => {\r\n    const threshold = Number(lowStockLevel ?? DEFAULT_LOW_STOCK_LEVEL);\r\n    if (quantity === 0)\r\n      return {\r\n        label: \"Out of Stock\",\r\n        color: \"bg-red-100 text-red-700 border-red-200\",\r\n      };\r\n    if (quantity < threshold)\r\n      return {\r\n        label: \"Low Stock\",\r\n        color: \"bg-orange-100 text-orange-700 border-orange-200\",\r\n      };\r\n    return {\r\n      label: \"In Stock\",\r\n      color: \"bg-green-100 text-green-700 border-green-200\",\r\n    };\r\n  };\r\n\r\n  const SortIcon = ({ direction }) => (\r\n    <svg\r\n      className={`w-4 h-4 ${direction ? \"text-blue-600\" : \"text-gray-400\"}`}\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      {direction === \"asc\" ? (\r\n        <path\r\n          strokeLinecap=\"round\"\r\n          strokeLinejoin=\"round\"\r\n          strokeWidth={2}\r\n          d=\"M5 15l7-7 7 7\"\r\n        />\r\n      ) : direction === \"desc\" ? (\r\n        <path\r\n          strokeLinecap=\"round\"\r\n          strokeLinejoin=\"round\"\r\n          strokeWidth={2}\r\n          d=\"M19 9l-7 7-7-7\"\r\n        />\r\n      ) : (\r\n        <path\r\n          strokeLinecap=\"round\"\r\n          strokeLinejoin=\"round\"\r\n          strokeWidth={2}\r\n          d=\"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4\"\r\n        />\r\n      )}\r\n    </svg>\r\n  );\r\n\r\n  const handleSort = (field) => {\r\n    if (sortBy === field) {\r\n      onSort(field, sortOrder === \"asc\" ? \"desc\" : \"asc\");\r\n    } else {\r\n      onSort(field, \"asc\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {/* Modern Search and Controls */}\r\n      <Card className=\"mb-4 sm:mb-6 p-3 sm:p-4 md:p-6 w-full overflow-hidden\">\r\n        <div className=\"flex flex-col gap-3 sm:gap-4 w-full\">\r\n          {/* Top Row: Search and Controls */}\r\n          <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3 sm:gap-4 w-full\">\r\n            {/* Search Bar */}\r\n            <div className=\"flex-1 w-full min-w-0\">\r\n              <div className=\"relative w-full\">\r\n                <div className=\"absolute inset-y-0 left-0 pl-3 sm:pl-4 flex items-center pointer-events-none\">\r\n                  <svg\r\n                    className=\"h-4 w-4 sm:h-5 sm:w-5 text-gray-400\"\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    viewBox=\"0 0 24 24\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"\r\n                    />\r\n                  </svg>\r\n                </div>\r\n                <input\r\n                  type=\"text\"\r\n                  value={search}\r\n                  onChange={onSearchChange}\r\n                  className=\"w-full pl-9 sm:pl-12 pr-3 sm:pr-4 py-2 sm:py-3 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl text-xs sm:text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 placeholder-gray-400\"\r\n                  placeholder=\"Search products, categories...\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Controls Row */}\r\n            <div className=\"flex flex-wrap items-center gap-2 sm:gap-3 shrink-0\">\r\n              {/* Sort Dropdown */}\r\n              <div className=\"flex items-center gap-1 sm:gap-2\">\r\n                <label className=\"text-xs font-semibold text-gray-600 hidden md:block\">\r\n                  Sort:\r\n                </label>\r\n                <select\r\n                  value={`${sortBy}-${sortOrder}`}\r\n                  onChange={(e) => {\r\n                    // Explicitly pass event object\r\n                    const [field, order] = e.target.value.split(\"-\");\r\n                    onSort(field, order);\r\n                  }}\r\n                  className=\"bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl px-2 sm:px-3 py-1.5 sm:py-2 text-xs font-medium text-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer\"\r\n                >\r\n                  <option value=\"name-asc\">Name (A-Z)</option>\r\n                  <option value=\"name-desc\">Name (Z-A)</option>\r\n                  <option value=\"quantity-asc\">Stock (Low to High)</option>\r\n                  <option value=\"quantity-desc\">Stock (High to Low)</option>\r\n                  <option value=\"selling_price-asc\">Price (Low to High)</option>\r\n                  <option value=\"selling_price-desc\">\r\n                    Price (High to Low)\r\n                  </option>\r\n                  <option value=\"category-asc\">Category (A-Z)</option>\r\n                </select>\r\n              </div>\r\n\r\n              {/* Entries Selector */}\r\n              <div className=\"flex items-center gap-1 sm:gap-2\">\r\n                <label className=\"text-xs font-semibold text-gray-600 hidden md:block\">\r\n                  Show:\r\n                </label>\r\n                <select\r\n                  value={entriesPerPage}\r\n                  onChange={onEntriesChange} // Explicitly pass event object\r\n                  className=\"bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl px-2 sm:px-3 py-1.5 sm:py-2 text-xs font-medium text-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer\"\r\n                >\r\n                  {[5, 10, 25, 50, 100].map((n) => (\r\n                    <option key={n} value={n}>\r\n                      {n}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Filter Chips */}\r\n          <div className=\"flex flex-wrap items-center gap-2 pt-2 sm:pt-3 border-t border-gray-100 w-full\">\r\n            <span className=\"text-xs font-semibold text-gray-600 shrink-0\">\r\n              Filters:\r\n            </span>\r\n\r\n            {/* Category Filter */}\r\n            <div className=\"flex items-center gap-2\">\r\n              <select\r\n                value={selectedCategory || \"\"} // Ensure value prop is set for controlled component\r\n                onChange={(e) => onCategoryFilter(e.target.value || null)}\r\n                className=\"bg-white/80 backdrop-blur-sm border border-gray-200 rounded-full px-3 sm:px-4 py-1 sm:py-1.5 text-xs font-medium text-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer\"\r\n              >\r\n                <option value=\"\">All Categories</option>\r\n                {categories.map((cat) => (\r\n                  <option key={cat.id || cat.name} value={cat.name}>\r\n                    {cat.name}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n\r\n            {/* Stock Status Filter */}\r\n            <div className=\"flex items-center gap-2\">\r\n              <select\r\n                value={stockFilter || \"\"} // Ensure value prop is set for controlled component\r\n                onChange={(e) => onStockFilter(e.target.value || null)}\r\n                className=\"bg-white/80 backdrop-blur-sm border border-gray-200 rounded-full px-3 sm:px-4 py-1 sm:py-1.5 text-xs font-medium text-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer\"\r\n              >\r\n                <option value=\"\">All Stock Status</option>\r\n                <option value=\"in_stock\">In Stock</option>\r\n                <option value=\"low_stock\">Low Stock</option>\r\n                <option value=\"out_of_stock\">Out of Stock</option>\r\n              </select>\r\n            </div>\r\n\r\n            {/* Clear Filters */}\r\n            {(selectedCategory || stockFilter) && (\r\n              <button\r\n                onClick={() => {\r\n                  onCategoryFilter(null);\r\n                  onStockFilter(null);\r\n                }}\r\n                className=\"px-2 sm:px-3 py-1 sm:py-1.5 rounded-full text-xs font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-all duration-200 flex items-center gap-1 shrink-0\"\r\n              >\r\n                <svg\r\n                  className=\"w-3 h-3\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M6 18L18 6M6 6l12 12\"\r\n                  />\r\n                </svg>\r\n                Clear\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </Card>\r\n\r\n      {/* Table Card */}\r\n      <Card className=\"overflow-hidden w-full\">\r\n        <div className=\"overflow-x-auto w-full relative hidden sm:block\">\r\n          {\" \"}\r\n          {/* Hide table on mobile */}\r\n          <table className=\"w-full min-w-[800px]\">\r\n            <thead>\r\n              <tr className=\"bg-gradient-to-r from-blue-50/80 to-indigo-50/80 border-b-2 border-blue-100\">\r\n                <th className=\"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider\">\r\n                  #\r\n                </th>\r\n                <th\r\n                  className=\"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100/50 transition-colors group\"\r\n                  onClick={() => handleSort(\"name\")} // Added onClick handler\r\n                >\r\n                  <div className=\"flex items-center gap-1 sm:gap-2\">\r\n                    Product\r\n                    <SortIcon\r\n                      direction={sortBy === \"name\" ? sortOrder : null}\r\n                    />\r\n                  </div>\r\n                </th>\r\n                <th\r\n                  className=\"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider hidden sm:table-cell cursor-pointer hover:bg-blue-100/50 transition-colors group\"\r\n                  onClick={() => handleSort(\"category\")} // Added onClick handler\r\n                >\r\n                  <div className=\"flex items-center gap-1 sm:gap-2\">\r\n                    Category\r\n                    <SortIcon\r\n                      direction={sortBy === \"category\" ? sortOrder : null}\r\n                    />\r\n                  </div>\r\n                </th>\r\n                <th className=\"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider hidden md:table-cell\">\r\n                  Description\r\n                </th>\r\n                <th className=\"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider hidden lg:table-cell\">\r\n                  Cost Price\r\n                </th>\r\n                <th\r\n                  className=\"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100/50 transition-colors group\"\r\n                  onClick={() => handleSort(\"selling_price\")} // Added onClick handler\r\n                >\r\n                  <div className=\"flex items-center gap-1 sm:gap-2\">\r\n                    Selling Price\r\n                    <SortIcon\r\n                      direction={sortBy === \"selling_price\" ? sortOrder : null}\r\n                    />\r\n                  </div>\r\n                </th>\r\n                <th\r\n                  className=\"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider cursor-pointer hover:bg-blue-100/50 transition-colors group\"\r\n                  onClick={() => handleSort(\"quantity\")} // Added onClick handler\r\n                >\r\n                  <div className=\"flex items-center gap-1 sm:gap-2\">\r\n                    Stock\r\n                    <SortIcon\r\n                      direction={sortBy === \"quantity\" ? sortOrder : null}\r\n                    />\r\n                  </div>\r\n                </th>\r\n                <th className=\"py-3 px-2 sm:py-4 sm:px-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider\">\r\n                  Actions\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"divide-y divide-gray-100\">\r\n              {products.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan={8} className=\"text-center py-16\">\r\n                    <div className=\"flex flex-col items-center justify-center\">\r\n                      <div className=\"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4\">\r\n                        <svg\r\n                          className=\"w-10 h-10 text-gray-400\"\r\n                          fill=\"none\"\r\n                          stroke=\"currentColor\"\r\n                          viewBox=\"0 0 24 24\"\r\n                        >\r\n                          <path\r\n                            strokeLinecap=\"round\"\r\n                            strokeLinejoin=\"round\"\r\n                            strokeWidth={2}\r\n                            d=\"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4\"\r\n                          />\r\n                        </svg>\r\n                      </div>\r\n                      <p className=\"text-gray-500 text-lg font-semibold\">\r\n                        No products found\r\n                      </p>\r\n                      <p className=\"text-gray-400 text-sm mt-2\">\r\n                        {search\r\n                          ? \"Try adjusting your search terms\"\r\n                          : \"Start by adding your first product\"}\r\n                      </p>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                products.map((product, idx) => {\r\n                  const stockStatus = getStockStatus(\r\n                    product.quantity,\r\n                    product.low_stock_level\r\n                  );\r\n                  return (\r\n                    <tr\r\n                      key={product.id}\r\n                      className=\"hover:bg-blue-50/50 transition-all duration-200 group\"\r\n                    >\r\n                      <td className=\"py-3 px-2 sm:py-4 sm:px-4 text-xs sm:text-sm text-gray-600 font-medium\">\r\n                        {(page - 1) * entriesPerPage + idx + 1}\r\n                      </td>\r\n                      <td className=\"py-3 px-2 sm:py-4 sm:px-4\">\r\n                        <div className=\"flex flex-col min-w-0\">\r\n                          <span className=\"text-xs sm:text-sm font-semibold text-gray-900 group-hover:text-blue-600 transition-colors truncate\">\r\n                            {product.name || \"N/A\"} {/* Added N/A fallback */}\r\n                          </span>\r\n                          <span className=\"text-[10px] sm:text-xs text-gray-500 mt-0.5 truncate\">\r\n                            SKU: {product.sku || \"N/A\"}\r\n                          </span>\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"py-3 px-2 sm:py-4 sm:px-4 hidden sm:table-cell\">\r\n                        <span className=\"inline-flex items-center px-2 sm:px-3 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-xs font-medium bg-indigo-50 text-indigo-700 border border-indigo-200\">\r\n                          {product.category}\r\n                        </span>{\" \"}\r\n                        {/* Added N/A fallback */}\r\n                      </td>\r\n                      <td\r\n                        className=\"py-3 px-2 sm:py-4 sm:px-4 max-w-xs truncate hidden md:table-cell text-xs sm:text-sm text-gray-600\"\r\n                        title={product.description}\r\n                      >\r\n                        {product.description || \"-\"}\r\n                      </td>\r\n                      <td className=\"py-3 px-2 sm:py-4 sm:px-4 hidden lg:table-cell\">\r\n                        <span className=\"text-xs sm:text-sm font-medium text-gray-700\">\r\n                          ₱{Number(product.cost_price || 0).toFixed(2)}{\" \"}\r\n                          {/* Added 0 fallback */}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"py-3 px-2 sm:py-4 sm:px-4\">\r\n                        <span className=\"text-xs sm:text-sm font-bold text-blue-600\">\r\n                          ₱{Number(product.selling_price || 0).toFixed(2)}{\" \"}\r\n                          {/* Added 0 fallback */}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"py-3 px-2 sm:py-4 sm:px-4\">\r\n                        <div className=\"flex flex-col gap-1\">\r\n                          <span className=\"text-xs sm:text-sm font-semibold text-gray-900\">\r\n                            {product.quantity}\r\n                          </span>\r\n                          <span\r\n                            className={`inline-flex items-center px-1.5 sm:px-2 py-0.5 rounded-full text-[10px] sm:text-xs font-medium border ${stockStatus.color}`}\r\n                          >\r\n                            {stockStatus.label}\r\n                          </span>\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"py-3 px-2 sm:py-4 sm:px-4\">\r\n                        <div className=\"flex items-center gap-1 sm:gap-2\">\r\n                          <button\r\n                            onClick={() =>\r\n                              onStockEntry && onStockEntry(product)\r\n                            }\r\n                            className=\"p-2 rounded-lg bg-green-50 text-green-600 hover:bg-green-100 border border-green-200 transition-all duration-200 hover:scale-110\"\r\n                            title=\"Add Stock\"\r\n                          >\r\n                            <StockIcon />\r\n                          </button>\r\n                          <button\r\n                            onClick={() => onEdit(product)}\r\n                            className=\"p-2 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200 transition-all duration-200 hover:scale-110\"\r\n                            title=\"Edit Product\"\r\n                          >\r\n                            <EditIcon />\r\n                          </button>\r\n                          <button\r\n                            onClick={() => onDelete(product.id)}\r\n                            className=\"p-2 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 border border-red-200 transition-all duration-200 hover:scale-110\"\r\n                            title=\"Delete Product\"\r\n                          >\r\n                            <DeleteIcon />\r\n                          </button>\r\n                        </div>\r\n                      </td>\r\n                    </tr>\r\n                  );\r\n                })\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        {/* Mobile Card View */}\r\n        <div className=\"sm:hidden divide-y divide-gray-100\">\r\n          {products.length === 0 ? (\r\n            <div className=\"text-center py-16 px-4\">\r\n              <div className=\"flex flex-col items-center justify-center\">\r\n                <div className=\"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4\">\r\n                  <svg\r\n                    className=\"w-10 h-10 text-gray-400\"\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    viewBox=\"0 0 24 24\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4\"\r\n                    />\r\n                  </svg>\r\n                </div>\r\n                <p className=\"text-gray-500 text-lg font-semibold\">\r\n                  No products found\r\n                </p>\r\n                <p className=\"text-gray-400 text-sm mt-2\">\r\n                  {search\r\n                    ? \"Try adjusting your search terms\"\r\n                    : \"Start by adding your first product\"}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            products.map((product, idx) => {\r\n              const stockStatus = getStockStatus(\r\n                product.quantity,\r\n                product.low_stock_level\r\n              );\r\n              return (\r\n                <div key={product.id} className=\"p-4\">\r\n                  <div className=\"flex justify-between items-start gap-4\">\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <p className=\"text-sm font-bold text-gray-900 truncate\">\r\n                        {product.name || \"N/A\"}\r\n                      </p>\r\n                      <p className=\"text-xs text-gray-500 mt-0.5\">\r\n                        SKU: {product.sku || \"N/A\"}\r\n                      </p>\r\n                      <p className=\"text-xs text-gray-500 mt-1\">\r\n                        <span className=\"inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-medium bg-indigo-50 text-indigo-700 border border-indigo-200\">\r\n                          {product.category || \"N/A\"}\r\n                        </span>\r\n                      </p>\r\n                      {product.description && (\r\n                        <p\r\n                          className=\"text-xs text-gray-500 mt-2 italic truncate\"\r\n                          title={product.description}\r\n                        >\r\n                          \"{product.description}\"\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"flex-shrink-0 text-right\">\r\n                      <p className=\"text-sm font-bold text-blue-600\">\r\n                        ₱{Number(product.selling_price || 0).toFixed(2)}\r\n                      </p>\r\n                      <p className=\"text-xs text-gray-500\">\r\n                        Cost: ₱{Number(product.cost_price || 0).toFixed(2)}\r\n                      </p>\r\n                      <p\r\n                        className={`text-xs font-semibold mt-1 ${\r\n                          stockStatus.color\r\n                            .replace(\"bg-\", \"text-\")\r\n                            .split(\" \")[0]\r\n                        }`}\r\n                      >\r\n                        {product.quantity} in stock\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"mt-4 flex items-center justify-end gap-2 border-t border-gray-100 pt-3\">\r\n                    <button\r\n                      onClick={() => onStockEntry && onStockEntry(product)}\r\n                      className=\"p-2 rounded-lg bg-green-50 text-green-600 hover:bg-green-100 border border-green-200 transition-all duration-200\"\r\n                      title=\"Add Stock\"\r\n                    >\r\n                      <StockIcon />\r\n                    </button>\r\n                    <button\r\n                      onClick={() => onEdit(product)}\r\n                      className=\"p-2 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200 transition-all duration-200\"\r\n                      title=\"Edit Product\"\r\n                    >\r\n                      <EditIcon />\r\n                    </button>\r\n                    <button\r\n                      onClick={() => onDelete(product.id)}\r\n                      className=\"p-2 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 border border-red-200 transition-all duration-200\"\r\n                      title=\"Delete Product\"\r\n                    >\r\n                      <DeleteIcon />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })\r\n          )}\r\n        </div>\r\n\r\n        {/* Enhanced Pagination */}\r\n        <div className=\"bg-gray-50/50 border-t border-gray-200 px-3 sm:px-4 md:px-6 py-3 sm:py-4 w-full\">\r\n          <div className=\"flex flex-col sm:flex-row items-center justify-between gap-3 sm:gap-4 w-full\">\r\n            <div className=\"text-xs sm:text-sm text-gray-600 whitespace-nowrap\">\r\n              Showing{\" \"}\r\n              <span className=\"font-semibold text-gray-900\">\r\n                {products.length === 0 ? 0 : (page - 1) * entriesPerPage + 1}\r\n              </span>{\" \"}\r\n              to{\" \"}\r\n              <span className=\"font-semibold text-gray-900\">\r\n                {Math.min(page * entriesPerPage, products.length)}\r\n              </span>{\" \"}\r\n              of{\" \"}\r\n              <span className=\"font-semibold text-gray-900\">\r\n                {products.length}\r\n              </span>{\" \"}\r\n              entries\r\n            </div>\r\n            <div className=\"flex flex-wrap items-center justify-center gap-1 sm:gap-2 w-full sm:w-auto\">\r\n              <Button\r\n                label=\"Previous\"\r\n                size=\"sm\"\r\n                variant=\"secondary\"\r\n                onClick={() => onPageChange(page - 1)}\r\n                disabled={page === 1}\r\n                className=\"min-w-[80px] sm:min-w-[100px] text-xs sm:text-sm\"\r\n              />\r\n              <div className=\"flex items-center gap-1 flex-wrap justify-center\">\r\n                {Array.from({ length: Math.min(totalPages, 5) }, (_, i) => {\r\n                  let pageNum;\r\n                  if (totalPages <= 5) {\r\n                    pageNum = i + 1;\r\n                  } else if (page <= 3) {\r\n                    pageNum = i + 1;\r\n                  } else if (page >= totalPages - 2) {\r\n                    pageNum = totalPages - 4 + i;\r\n                  } else {\r\n                    pageNum = page - 2 + i;\r\n                  }\r\n                  return (\r\n                    <Button\r\n                      key={pageNum}\r\n                      variant={\r\n                        page === pageNum\r\n                          ? \"paginationActive\"\r\n                          : \"paginationInactive\"\r\n                      }\r\n                      onClick={() => onPageChange(pageNum)}\r\n                      disabled={page === pageNum}\r\n                      className=\"min-w-[36px] sm:min-w-[40px] text-xs sm:text-sm\"\r\n                    >\r\n                      {pageNum}\r\n                    </Button>\r\n                  );\r\n                })}\r\n              </div>\r\n              <Button\r\n                label=\"Next\"\r\n                size=\"sm\"\r\n                variant=\"secondary\"\r\n                onClick={() => onPageChange(page + 1)}\r\n                disabled={page === totalPages}\r\n                className=\"min-w-[80px] sm:min-w-[100px] text-xs sm:text-sm\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    </>\r\n  );\r\n}\r\n\r\n/**\r\n * Inventory Stats Component\r\n * Internal component for displaying inventory statistics\r\n */\r\nfunction InventoryStats({ stats }) {\r\n  return (\r\n    // This component is not actually used in pages/Inventory.jsx, but keeping it for completeness if it were to be used elsewhere.\r\n    <div className=\"grid grid-cols-12 gap-3 sm:gap-4 md:gap-5 mb-4 sm:mb-6 md:mb-8 w-full\">\r\n      {stats.map((stat, i) => (\r\n        <StatsCard\r\n          key={stat.label}\r\n          label={stat.label}\r\n          value={stat.value}\r\n          icon={stat.icon}\r\n          color={stat.color}\r\n          change={0}\r\n          sub={stat.description || \"\"} // Changed 'sub' to 'description' as per previous refactor\r\n          formatValue={stat.formatValue}\r\n          className={`col-span-12 xs:col-span-6 sm:col-span-6 md:col-span-4 lg:col-span-3 xl:col-span-3 ${\r\n            // More consistent grid for 4 stats\r\n            i === 0 // This conditional class is now less relevant with a more uniform grid\r\n              ? \"sm:col-span-6 lg:col-span-6\"\r\n              : \"sm:col-span-6 lg:col-span-3 xl:col-span-2\"\r\n          }`}\r\n        />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n/**\r\n * Main Inventory Component\r\n * Combines stats and table into a single, cohesive component\r\n */\r\nfunction Inventory({\r\n  products,\r\n  allProducts = products, // For calculating stats from all products, not just paginated\r\n  stats,\r\n  page,\r\n  entriesPerPage,\r\n  totalPages,\r\n  onPageChange,\r\n  onEntriesChange,\r\n  search,\r\n  onSearchChange,\r\n  onEdit,\r\n  onDelete,\r\n  onStockEntry,\r\n  categories = [],\r\n  selectedCategory,\r\n  onCategoryFilter,\r\n  stockFilter,\r\n  onStockFilter,\r\n  sortBy,\r\n  sortOrder,\r\n  onSort,\r\n  className = \"\",\r\n}) {\r\n  const totalValue = allProducts.reduce(\r\n    (sum, p) => sum + Number(p.selling_price || 0) * Number(p.quantity || 0),\r\n    0\r\n  );\r\n  const lowStockCount = allProducts.filter((p) => {\r\n    const threshold = Number(p.low_stock_level ?? DEFAULT_LOW_STOCK_LEVEL);\r\n    return Number(p.quantity || 0) < threshold;\r\n  }).length;\r\n\r\n  return (\r\n    <div\r\n      className={`w-full max-w-full overflow-x-hidden py-4 sm:py-6 px-4 md:px-6 ${className}`}\r\n    >\r\n      {/* Quick Stats Bar */}\r\n      <Card className=\"mb-4 sm:mb-6 p-3 sm:p-4 md:p-6 bg-gradient-to-r from-blue-50/80 to-indigo-50/80 border-blue-100 w-full overflow-hidden\">\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4 w-full\">\r\n          {\" \"}\r\n          {/* Added xl:grid-cols-4 for wider screens */}\r\n          <div className=\"flex items-center gap-3 sm:gap-4 min-w-0\">\r\n            <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-blue-100 rounded-xl flex items-center justify-center shrink-0\">\r\n              <svg\r\n                className=\"w-5 h-5 sm:w-6 sm:h-6 text-blue-600\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <div className=\"min-w-0 flex-1\">\r\n              <p className=\"text-xs font-semibold text-gray-600 uppercase tracking-wide truncate\">\r\n                Total Products\r\n              </p>\r\n              <p className=\"text-xl sm:text-2xl font-bold text-gray-900 truncate\">\r\n                {allProducts.length || 0} {/* Added 0 fallback */}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex items-center gap-3 sm:gap-4 min-w-0\">\r\n            <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-orange-100 rounded-xl flex items-center justify-center shrink-0\">\r\n              <svg\r\n                className=\"w-5 h-5 sm:w-6 sm:h-6 text-orange-600\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <div className=\"min-w-0 flex-1\">\r\n              <p className=\"text-xs font-semibold text-gray-600 uppercase tracking-wide truncate\">\r\n                Low Stock Items\r\n              </p>\r\n              <p className=\"text-xl sm:text-2xl font-bold text-gray-900 truncate\">\r\n                {lowStockCount || 0} {/* Added 0 fallback */}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex items-center gap-3 sm:gap-4 min-w-0 sm:col-span-2 lg:col-span-1\">\r\n            <div className=\"w-10 h-10 sm:w-12 sm:h-12 bg-green-100 rounded-xl flex items-center justify-center shrink-0\">\r\n              <svg\r\n                className=\"w-5 h-5 sm:w-6 sm:h-6 text-green-600\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <div className=\"min-w-0 flex-1\">\r\n              <p className=\"text-xs font-semibold text-gray-600 uppercase tracking-wide truncate\">\r\n                Total Inventory Value\r\n              </p>\r\n              <p className=\"text-xl sm:text-2xl font-bold text-gray-900 truncate\">\r\n                ₱ {/* Added 0 fallback */}\r\n                {totalValue.toLocaleString(undefined, {\r\n                  minimumFractionDigits: 2,\r\n                })}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n\r\n      {/* Table */}\r\n      <InventoryTable\r\n        products={products}\r\n        page={page}\r\n        entriesPerPage={entriesPerPage}\r\n        totalPages={totalPages}\r\n        onPageChange={onPageChange}\r\n        onEntriesChange={onEntriesChange}\r\n        search={search}\r\n        onSearchChange={onSearchChange}\r\n        onEdit={onEdit}\r\n        onDelete={onDelete}\r\n        onStockEntry={onStockEntry}\r\n        categories={categories}\r\n        selectedCategory={selectedCategory}\r\n        onCategoryFilter={onCategoryFilter}\r\n        stockFilter={stockFilter}\r\n        onStockFilter={onStockFilter}\r\n        sortBy={sortBy}\r\n        sortOrder={sortOrder}\r\n        onSort={onSort}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Inventory;\r\n","import React, { useState, useMemo, useEffect, useCallback } from \"react\";\r\nimport PageLayout from \"../components/layout/PageLayout\";\r\nimport NavAdmin from \"../components/layout/Nav-Admin\";\r\nimport Inventory from \"../components/inventory/Inventory\";\r\nimport Modal from \"../components/modals/Modal\";\r\nimport Button from \"../components/common/Button\";\r\n\r\nimport ProductFormModal from \"../components/modals/ProductFormModal\";\r\nimport { api, authHeaders } from \"../lib/api\";\r\nimport { useDebounce } from \"../hooks/useDebounce\";\r\n\r\nconst initialProducts = [];\r\nconst initialCategories = [];\r\nconst DEFAULT_LOW_STOCK_LEVEL = 10;\r\n\r\n// Utility function to convert array of objects to CSV\r\nconst convertToCSV = (data) => {\r\n  if (!data || data.length === 0) return \"\";\r\n\r\n  const headers = [\r\n    \"Name\",\r\n    \"SKU\",\r\n    \"Category\",\r\n    \"Description\",\r\n    \"Cost Price\",\r\n    \"Selling Price\",\r\n    \"Stock\",\r\n  ];\r\n  const csvRows = [];\r\n\r\n  // Add headers\r\n  csvRows.push(headers.join(\",\"));\r\n\r\n  // Add data rows\r\n  data.forEach((item) => {\r\n    const row = [\r\n      `\"${item.name || \"\"}\"`,\r\n      `\"${item.sku || \"\"}\"`,\r\n      `\"${item.category || \"\"}\"`,\r\n      `\"${item.description || \"\"}\"`,\r\n      item.cost_price || 0,\r\n      item.selling_price || 0,\r\n      item.quantity || 0,\r\n    ];\r\n    csvRows.push(row.join(\",\"));\r\n  });\r\n\r\n  return csvRows.join(\"\\n\");\r\n};\r\n\r\n// Utility function to download CSV\r\nconst downloadCSV = (csv, filename) => {\r\n  const blob = new Blob([csv], { type: \"text/csv;charset=utf-8;\" });\r\n  const link = document.createElement(\"a\");\r\n  if (link.download !== undefined) {\r\n    const url = URL.createObjectURL(blob);\r\n    link.setAttribute(\"href\", url);\r\n    link.setAttribute(\"download\", filename);\r\n    link.style.visibility = \"hidden\";\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  }\r\n};\r\n\r\n// Function to get predefined categories based on business type\r\nfunction getCategoriesByBusinessType(businessType) {\r\n  const categoryMap = {\r\n    \"Grocery Store\": [\r\n      \"Fresh Produce\",\r\n      \"Meat & Poultry\",\r\n      \"Seafood\",\r\n      \"Dairy & Eggs\",\r\n      \"Bread & Bakery\",\r\n      \"Snacks & Chips\",\r\n      \"Beverages\",\r\n      \"Canned & Packaged Goods\",\r\n      \"Frozen Food\",\r\n      \"Rice, Pasta & Grains\",\r\n      \"Condiments & Spices\",\r\n      \"Cleaning Supplies\",\r\n      \"Household Essentials\",\r\n      \"Baby Products\",\r\n      \"Pet Supplies\",\r\n    ],\r\n    Pharmacy: [\r\n      \"Prescription Medicines\",\r\n      \"OTC Medicines\",\r\n      \"Vitamins & Supplements\",\r\n      \"First Aid Supplies\",\r\n      \"Medical Devices\",\r\n      \"Personal Care\",\r\n      \"Hygiene Products\",\r\n      \"Beauty & Cosmetics\",\r\n      \"Baby Care\",\r\n      \"Adult Care\",\r\n      \"PPE & Sanitizers\",\r\n    ],\r\n    \"Clothing Store\": [\r\n      \"Men’s Clothing\",\r\n      \"Women’s Clothing\",\r\n      \"Kids’ Clothing\",\r\n      \"Baby Clothing\",\r\n      \"Footwear\",\r\n      \"Bags & Accessories\",\r\n      \"Underwear & Socks\",\r\n    ],\r\n    \"Electronics Store\": [\r\n      \"Mobile Devices\",\r\n      \"Computers & Laptops\",\r\n      \"Computer Accessories\",\r\n      \"Phone Accessories\",\r\n      \"Audio Devices\",\r\n      \"Cameras & Photography\",\r\n      \"Home Appliances\",\r\n      \"Personal Appliances\",\r\n      \"Gaming Consoles & Accessories\",\r\n      \"Cables, Adapters & Chargers\",\r\n    ],\r\n    Bookstore: [\r\n      \"Fiction Books\",\r\n      \"Non-Fiction Books\",\r\n      \"Educational Books\",\r\n      \"Children’s Books\",\r\n      \"Comics & Manga\",\r\n      \"School Supplies\",\r\n      \"Art Materials\",\r\n      \"Office Supplies\",\r\n      \"Stationery & Gifts\",\r\n    ],\r\n    \"Convenience Store\": [\r\n      \"Snacks\",\r\n      \"Beverages\",\r\n      \"Ready-to-Eat Food\",\r\n      \"Instant Noodles / Cup Meals\",\r\n      \"Frozen Food\",\r\n      \"Basic Grocery Items\",\r\n      \"Toiletries\",\r\n      \"Basic OTC Medicines\",\r\n      \"Household Essentials\",\r\n      \"Phone Load\",\r\n      \"Ice Cream & Desserts\",\r\n      \"Tobacco & Lighters\",\r\n    ],\r\n    Others: [\"General\"],\r\n  };\r\n\r\n  return categoryMap[businessType] || categoryMap[\"Others\"];\r\n}\r\n\r\nexport default function InventoryPage() {\r\n  // State\r\n  const [products, setProducts] = useState(initialProducts);\r\n  const [categories, setCategories] = useState(() => {\r\n    try {\r\n      let storedType = null;\r\n      try {\r\n        storedType =\r\n          (typeof window !== \"undefined\" &&\r\n            sessionStorage.getItem(\"business_type\")) ||\r\n          null;\r\n      } catch (e) {\r\n        storedType = null;\r\n      }\r\n      // Fallback: try `user` object saved at login\r\n      if (!storedType && typeof window !== \"undefined\") {\r\n        try {\r\n          const raw =\r\n            sessionStorage.getItem(\"user\") || localStorage.getItem(\"user\");\r\n          if (raw) {\r\n            const parsed = JSON.parse(raw);\r\n            storedType =\r\n              parsed?.business?.business_type || parsed?.business_type || null;\r\n            if (storedType) {\r\n              try {\r\n                sessionStorage.setItem(\"business_type\", storedType);\r\n              } catch (e) {\r\n                /* ignore */\r\n              }\r\n            }\r\n          }\r\n        } catch (e) {\r\n          storedType = null;\r\n        }\r\n      }\r\n      storedType = storedType || \"Others\";\r\n      const list = getCategoriesByBusinessType(storedType) || [];\r\n      return list.map((name, index) => ({ id: index + 1, name }));\r\n    } catch {\r\n      return initialCategories;\r\n    }\r\n  });\r\n  const [showProductModal, setShowProductModal] = useState(false);\r\n  const [showStockModal, setShowStockModal] = useState(false);\r\n  const [editingProduct, setEditingProduct] = useState(null);\r\n  const [productForm, setProductForm] = useState({\r\n    sku: \"\",\r\n    name: \"\",\r\n    category: \"\",\r\n    customCategory: \"\",\r\n    description: \"\",\r\n    quantity: \"\",\r\n    cost_price: \"\",\r\n    selling_price: \"\",\r\n    low_stock_level: DEFAULT_LOW_STOCK_LEVEL,\r\n  });\r\n  const [stockForm, setStockForm] = useState({ sku: \"\", quantity: \"\" });\r\n  const [loading, setLoading] = useState(false);\r\n  const [search, setSearch] = useState(\"\");\r\n  const debouncedSearch = useDebounce(search, 400);\r\n  const [entriesPerPage, setEntriesPerPage] = useState(10);\r\n  const [page, setPage] = useState(1);\r\n  const [apiError, setApiError] = useState(\"\");\r\n  const [isSidebarOpen, setSidebarOpen] = useState(false);\r\n  const [deleteTarget, setDeleteTarget] = useState(null);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n  const [productToDelete, setProductToDelete] = useState(null);\r\n  // Load inventory and business type from API\r\n  useEffect(() => {\r\n    const fetchInventory = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setApiError(\"\");\r\n        const token = sessionStorage.getItem(\"auth_token\");\r\n\r\n        // Fetch business type\r\n        const userData = await api(\"/api/auth/profile\", {\r\n          headers: authHeaders(token),\r\n        });\r\n        const businessType = userData?.business?.business_type || \"Others\";\r\n        // persist business type so modals can use it before API completes\r\n        try {\r\n          if (typeof window !== \"undefined\")\r\n            sessionStorage.setItem(\"business_type\", businessType);\r\n        } catch (storageErr) {\r\n          // ignore storage errors (e.g. private mode)\r\n\r\n          console.debug(\"Could not persist business_type\", storageErr);\r\n        }\r\n\r\n        // Set predefined categories based on business type\r\n        const predefinedCategories = getCategoriesByBusinessType(businessType);\r\n        setCategories(\r\n          predefinedCategories.map((name, index) => ({\r\n            id: index + 1,\r\n            name: name,\r\n          }))\r\n        );\r\n\r\n        // Fetch inventory with pagination support\r\n        const data = await api(\"/api/inventory\", {\r\n          headers: authHeaders(token),\r\n          params: { limit: 1000, offset: 0 }, // Fetch all for now, can be optimized later\r\n        });\r\n\r\n        // Handle both old array format and new paginated format\r\n        const productsData = data?.products || data || [];\r\n\r\n        // Map backend rows to UI shape with correct column mapping\r\n        const mapped = (productsData || []).map((row) => ({\r\n          id: String(row.id || \"\"),\r\n          name: row.name || \"-\",\r\n          category: row.category || \"-\",\r\n          quantity: Number(row.quantity || 0),\r\n          cost_price: Number(row.cost_price || 0),\r\n          selling_price: Number(row.selling_price || 0),\r\n          sku: row.sku || \"\",\r\n          description: row.description || \"\",\r\n          low_stock_level: Number(\r\n            row.low_stock_level ?? DEFAULT_LOW_STOCK_LEVEL\r\n          ),\r\n        }));\r\n        setProducts(mapped);\r\n      } catch (err) {\r\n        setApiError(\"Failed to load inventory\");\r\n        setProducts([]);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchInventory();\r\n  }, []);\r\n\r\n  // Stats\r\n  const totalInventoryValue = products.reduce(\r\n    (sum, p) => sum + Number(p.selling_price || 0) * Number(p.quantity || 0),\r\n    0\r\n  );\r\n  const lowStockItems = products.filter((p) => {\r\n    const threshold = Number(p.low_stock_level ?? DEFAULT_LOW_STOCK_LEVEL);\r\n    return Number(p.quantity || 0) < threshold;\r\n  }).length;\r\n\r\n  const stats = [\r\n    {\r\n      label: \"TOTAL ITEMS\",\r\n      value: products.length,\r\n      icon: (\r\n        <svg\r\n          width=\"32\"\r\n          height=\"32\"\r\n          fill=\"none\"\r\n          stroke=\"#2563eb\"\r\n          strokeWidth=\"2\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path d=\"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4\" />\r\n        </svg>\r\n      ),\r\n      color: \"text-blue-800\",\r\n      sub: \"Total products in inventory\",\r\n    },\r\n    {\r\n      label: \"INVENTORY VALUE\",\r\n      value: totalInventoryValue,\r\n      icon: (\r\n        <svg\r\n          width=\"32\"\r\n          height=\"32\"\r\n          fill=\"none\"\r\n          stroke=\"#2563eb\"\r\n          strokeWidth=\"2\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n        </svg>\r\n      ),\r\n      color: \"text-green-700\",\r\n      formatValue: (val) =>\r\n        `₱${val.toLocaleString(undefined, { minimumFractionDigits: 2 })}`,\r\n      sub: \"Total value of all stock\",\r\n    },\r\n    {\r\n      label: \"AVAILABLE CATEGORIES\",\r\n      value: categories.length,\r\n      icon: (\r\n        <svg\r\n          width=\"32\"\r\n          height=\"32\"\r\n          fill=\"none\"\r\n          stroke=\"#2563eb\"\r\n          strokeWidth=\"2\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path d=\"M4 7h16M4 12h16M4 17h16\" />\r\n        </svg>\r\n      ),\r\n      color: \"text-blue-500\",\r\n      sub: \"Product categories\",\r\n    },\r\n    {\r\n      label: \"LOW STOCK ALERTS\",\r\n      value: lowStockItems,\r\n      icon: (\r\n        <svg\r\n          width=\"32\"\r\n          height=\"32\"\r\n          fill=\"none\"\r\n          stroke=\"#2563eb\"\r\n          strokeWidth=\"2\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\r\n        </svg>\r\n      ),\r\n      color: \"text-orange-600\",\r\n      sub: \"Items needing restock\",\r\n    },\r\n  ];\r\n\r\n  // Additional filter states (will be handled by Inventory component)\r\n  const [sortBy, setSortBy] = useState(\"name\");\r\n  const [sortOrder, setSortOrder] = useState(\"asc\");\r\n  const [selectedCategory, setSelectedCategory] = useState(null);\r\n  const [stockFilter, setStockFilter] = useState(null);\r\n\r\n  // Filtering, sorting and pagination - use debounced search\r\n  const filteredProducts = useMemo(() => {\r\n    let filtered = products.filter(\r\n      (p) =>\r\n        p.name.toLowerCase().includes(debouncedSearch.toLowerCase()) ||\r\n        p.category.toLowerCase().includes(debouncedSearch.toLowerCase()) ||\r\n        p.description.toLowerCase().includes(debouncedSearch.toLowerCase())\r\n    );\r\n\r\n    // Apply category filter\r\n    if (selectedCategory) {\r\n      filtered = filtered.filter((p) => p.category === selectedCategory);\r\n    }\r\n\r\n    // Apply stock filter\r\n    if (stockFilter) {\r\n      if (stockFilter === \"out_of_stock\") {\r\n        filtered = filtered.filter((p) => Number(p.quantity || 0) === 0);\r\n      } else if (stockFilter === \"low_stock\") {\r\n        filtered = filtered.filter((p) => {\r\n          const qty = Number(p.quantity || 0);\r\n          const threshold = Number(\r\n            p.low_stock_level ?? DEFAULT_LOW_STOCK_LEVEL\r\n          );\r\n          return qty > 0 && qty < threshold;\r\n        });\r\n      } else if (stockFilter === \"in_stock\") {\r\n        filtered = filtered.filter((p) => {\r\n          const threshold = Number(\r\n            p.low_stock_level ?? DEFAULT_LOW_STOCK_LEVEL\r\n          );\r\n          return Number(p.quantity || 0) >= threshold;\r\n        });\r\n      }\r\n    }\r\n\r\n    // Apply sorting\r\n    filtered.sort((a, b) => {\r\n      let aVal, bVal;\r\n      if (sortBy === \"name\") {\r\n        aVal = (a.name || \"\").toLowerCase();\r\n        bVal = (b.name || \"\").toLowerCase();\r\n      } else if (sortBy === \"category\") {\r\n        aVal = (a.category || \"\").toLowerCase();\r\n        bVal = (b.category || \"\").toLowerCase();\r\n      } else if (sortBy === \"quantity\") {\r\n        aVal = Number(a.quantity || 0);\r\n        bVal = Number(b.quantity || 0);\r\n      } else if (sortBy === \"selling_price\") {\r\n        aVal = Number(a.selling_price || 0);\r\n        bVal = Number(b.selling_price || 0);\r\n      } else {\r\n        return 0;\r\n      }\r\n\r\n      if (aVal < bVal) return sortOrder === \"asc\" ? -1 : 1;\r\n      if (aVal > bVal) return sortOrder === \"asc\" ? 1 : -1;\r\n      return 0;\r\n    });\r\n\r\n    return filtered;\r\n  }, [products, debouncedSearch, selectedCategory, stockFilter, sortBy, sortOrder]);\r\n\r\n  const totalPages = Math.ceil(filteredProducts.length / entriesPerPage) || 1;\r\n  const paginatedProducts = filteredProducts.slice(\r\n    (page - 1) * entriesPerPage,\r\n    page * entriesPerPage\r\n  );\r\n\r\n  // Handlers - memoized with useCallback\r\n  const openAddProduct = useCallback(() => {\r\n    setEditingProduct(null);\r\n    setProductForm({\r\n      sku: \"\",\r\n      name: \"\",\r\n      category: \"\",\r\n      customCategory: \"\",\r\n      description: \"\",\r\n      quantity: \"\",\r\n      cost_price: \"\",\r\n      selling_price: \"\",\r\n      low_stock_level: DEFAULT_LOW_STOCK_LEVEL,\r\n    });\r\n    setShowProductModal(true);\r\n  }, []);\r\n\r\n  const openEditProduct = useCallback((product) => {\r\n    setEditingProduct(product);\r\n    setProductForm({\r\n      ...product,\r\n      low_stock_level:\r\n        typeof product.low_stock_level === \"number\"\r\n          ? product.low_stock_level\r\n          : DEFAULT_LOW_STOCK_LEVEL,\r\n    });\r\n    setShowProductModal(true);\r\n  }, []);\r\n\r\n  const openStockEntry = useCallback((product) => {\r\n    setStockForm({ sku: product?.sku || \"\", quantity: \"\" });\r\n    setShowStockModal(true);\r\n  }, []);\r\n\r\n  const handleProductFormChange = useCallback((e) => {\r\n    const { name, value } = e.target;\r\n    // Clear error if user explicitly clears it or starts typing in form fields\r\n    if (name === 'clearError') {\r\n      setApiError(\"\");\r\n    } else if (apiError && name !== 'clearError') {\r\n      // Only clear error when user modifies form fields (not on initial render)\r\n      setApiError(\"\");\r\n    }\r\n    if (name !== 'clearError') {\r\n      setProductForm((prev) => ({ ...prev, [name]: value }));\r\n    }\r\n  }, []);\r\n\r\n  const handleProductSubmit = useCallback(async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      setLoading(true);\r\n      setApiError(\"\");\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n\r\n      if (editingProduct) {\r\n        // Update existing product\r\n        await api(`/api/inventory/${editingProduct.id}`, {\r\n          method: \"PUT\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            ...authHeaders(token),\r\n          },\r\n          body: JSON.stringify({\r\n            product_name: (productForm.name || \"\").trim(),\r\n            cost_price: Number(productForm.cost_price) || 0,\r\n            selling_price: Number(productForm.selling_price) || 0,\r\n            sku: (productForm.sku || \"\").trim(),\r\n            low_stock_level:\r\n              Number(productForm.low_stock_level) || DEFAULT_LOW_STOCK_LEVEL,\r\n            category:\r\n              productForm.category === \"Others\"\r\n                ? (productForm.customCategory || \"\").trim()\r\n                : (productForm.category || \"\").trim(),\r\n            description: (productForm.description || \"\").trim(),\r\n          }),\r\n        });\r\n      } else {\r\n        // Create new product\r\n        await api(\"/api/products\", {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            ...authHeaders(token),\r\n          },\r\n          body: JSON.stringify({\r\n            product_category_id: null,\r\n            category:\r\n              productForm.category === \"Others\"\r\n                ? (productForm.customCategory || \"\").trim()\r\n                : (productForm.category || \"\").trim(),\r\n            product_name: (productForm.name || \"\").trim(),\r\n            name: (productForm.name || \"\").trim(),\r\n            description: (productForm.description || \"\").trim(),\r\n            cost_price: Number(productForm.cost_price) || 0,\r\n            selling_price: Number(productForm.selling_price) || 0,\r\n            price: Number(productForm.selling_price) || 0,\r\n            sku: (productForm.sku || \"\").trim() || `SKU-${Date.now()}`,\r\n            quantity: Number(productForm.quantity) || 0,\r\n            low_stock_level:\r\n              Number(productForm.low_stock_level) || DEFAULT_LOW_STOCK_LEVEL,\r\n          }),\r\n        });\r\n      }\r\n\r\n      // Refresh inventory list after creation/update\r\n      const data = await api(\"/api/inventory\", { \r\n        headers: authHeaders(token),\r\n        params: { limit: 1000, offset: 0 }\r\n      });\r\n      const productsData = data?.products || data || [];\r\n      const mapped = (productsData || []).map((row) => ({\r\n        id: String(row.id || \"\"),\r\n        name: row.name || \"-\",\r\n        category: row.category || \"-\",\r\n        quantity: Number(row.quantity || 0),\r\n        cost_price: Number(row.cost_price || 0),\r\n        selling_price: Number(row.selling_price || 0),\r\n        sku: row.sku || \"\",\r\n        description: row.description || \"\",\r\n        low_stock_level: Number(row.low_stock_level ?? DEFAULT_LOW_STOCK_LEVEL),\r\n      }));\r\n      setProducts(mapped);\r\n      setShowProductModal(false);\r\n    } catch (err) {\r\n      // Handle duplicate SKU error and other errors\r\n      let errorMessage = \"Failed to save product\";\r\n      try {\r\n        // Check if error has response data (from api.js)\r\n        const errorData = err.response?.data || err.data || {};\r\n        const errorStatus = err.response?.status;\r\n        \r\n        if (errorStatus === 409 || errorData.error === 'Product with this SKU already exists') {\r\n          // Duplicate SKU error - provide clear message\r\n          errorMessage = errorData.message || `A product with SKU \"${productForm.sku?.trim() || 'this SKU'}\" already exists. Please use a different SKU.`;\r\n          if (errorData.existingProduct) {\r\n            errorMessage = `SKU \"${productForm.sku?.trim()}\" is already in use by \"${errorData.existingProduct.product_name}\". Please use a different SKU code.`;\r\n          }\r\n        } else if (errorData.error || errorData.message) {\r\n          // Other API errors\r\n          errorMessage = errorData.message || errorData.error;\r\n        } else if (err.message) {\r\n          // Error from api.js wrapper\r\n          errorMessage = err.message;\r\n        }\r\n      } catch (parseErr) {\r\n        // If parsing fails, use error message if available\r\n        errorMessage = err.message || \"Failed to save product\";\r\n        console.error(\"Error parsing error response:\", parseErr);\r\n      }\r\n      setApiError(errorMessage);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [editingProduct, productForm]);\r\n\r\n  const handleStockSubmit = useCallback(async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      setLoading(true);\r\n      setApiError(\"\");\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n      await api(\"/api/products/add-stock-by-sku\", {\r\n        method: \"POST\",\r\n        headers: authHeaders(token),\r\n        body: JSON.stringify({\r\n          sku: stockForm.sku,\r\n          quantity: Number(stockForm.quantity),\r\n        }),\r\n      });\r\n      const data = await api(\"/api/inventory\", { \r\n        headers: authHeaders(token),\r\n        params: { limit: 1000, offset: 0 }\r\n      });\r\n      const productsData = data?.products || data || [];\r\n      const mapped = (productsData || []).map((row) => ({\r\n        id: String(row.id || \"\"),\r\n        name: row.name || \"-\",\r\n        category: row.category || \"-\",\r\n        quantity: Number(row.quantity || 0),\r\n        cost_price: Number(row.cost_price || 0),\r\n        selling_price: Number(row.selling_price || 0),\r\n        sku: row.sku || \"\",\r\n        description: row.description || \"\",\r\n        low_stock_level: Number(row.low_stock_level ?? DEFAULT_LOW_STOCK_LEVEL),\r\n      }));\r\n      setProducts(mapped);\r\n      setShowStockModal(false);\r\n    } catch (err) {\r\n      setApiError(\"Failed to add stock\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [stockForm]);\r\n\r\n  const handleDeleteProduct = useCallback((id) => {\r\n    const product = products.find((p) => String(p.id) === String(id));\r\n    if (product) {\r\n      setProductToDelete(product);\r\n      setShowDeleteModal(true);\r\n    }\r\n  }, [products]);\r\n\r\n  const confirmDeleteProduct = useCallback(async () => {\r\n    if (!productToDelete) return;\r\n    try {\r\n      setLoading(true);\r\n      setApiError(\"\");\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n      \r\n      // First try the new API endpoint\r\n      try {\r\n        await api(`/api/products/${productToDelete.id}`, {\r\n          method: \"DELETE\",\r\n          headers: authHeaders(token),\r\n        });\r\n      } catch (err) {\r\n        // Fallback to the old endpoint if the first one fails\r\n        console.log('Trying fallback delete endpoint...');\r\n        await api(`/api/inventory/${productToDelete.id}`, {\r\n          method: \"DELETE\",\r\n          headers: authHeaders(token),\r\n        });\r\n      }\r\n\r\n      // Update the UI by removing the deleted product\r\n      setProducts(prev => prev.filter(p => p.id !== productToDelete.id));\r\n      setShowDeleteModal(false);\r\n      setProductToDelete(null);\r\n    } catch (err) {\r\n      console.error('Error deleting product:', err);\r\n      setApiError(err.response?.data?.error || \"Failed to delete product. Please try again.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [productToDelete]);\r\n\r\n  const handlePageChange = useCallback((newPage) => {\r\n    if (newPage < 1 || newPage > totalPages) return;\r\n    setPage(newPage);\r\n  }, [totalPages]);\r\n\r\n  const handleEntriesChange = useCallback((e) => {\r\n    setEntriesPerPage(Number(e.target.value));\r\n    setPage(1);\r\n  }, []);\r\n\r\n  const handleSearchChange = useCallback((e) => {\r\n    setSearch(e.target.value);\r\n    setPage(1);\r\n  }, []);\r\n\r\n  const handleExport = useCallback(() => {\r\n    const csv = convertToCSV(filteredProducts);\r\n    const timestamp = new Date().toISOString().split(\"T\")[0];\r\n    const filename = `inventory_export_${timestamp}.csv`;\r\n    downloadCSV(csv, filename);\r\n  }, [filteredProducts]);\r\n\r\n  const headerActions = (\r\n    <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-end gap-3 sm:gap-4 mb-4 sm:mb-0 w-full\">\r\n      <div className=\"flex items-center justify-end gap-2 sm:gap-3 w-auto\">\r\n        {/* ADD PRODUCT Button: 'Add' on Mobile, 'Add Product' on Desktop */}\r\n        <Button\r\n          onClick={openAddProduct}\r\n          variant=\"primary\"\r\n          microinteraction={true}\r\n          // Same width logic as Export button\r\n          className=\"bg-blue-600 text-md text-white font-semibold rounded-lg shadow hover:bg-blue-700 transition gap-1 sm:gap-2 flex items-center justify-center sm:justify-start !py-2 !px-2 sm:!px-2 shrink-0 min-w-[40px] sm:min-w-[40px] lg:min-w-0\"\r\n        >\r\n          <svg\r\n            className=\"w-4 h-4\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M12 4v16m8-8H4\"\r\n            />\r\n          </svg>\r\n          {/* Full text is hidden on mobile, short text shown on mobile */}\r\n          <span className=\"hidden sm:block\">Add Product</span>\r\n          <span className=\"sm:inline\"></span>\r\n        </Button>\r\n        \r\n        {/* EXPORT Button: ICON ONLY on Mobile, ICON + TEXT on Desktop */}\r\n        <Button\r\n          onClick={handleExport}\r\n          variant=\"secondary\"\r\n          // Ensure fixed width on mobile for icon, then auto width on desktop\r\n          className=\"text-sm flex items-center justify-center sm:justify-start gap-1 sm:gap-2 shrink-0 !py-2 !px-2 sm:!px-2 min-w-[40px] sm:min-w-[40px] lg:min-w-0\"\r\n        >\r\n          <svg\r\n            className=\"w-5 h-5\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\r\n            />\r\n          </svg>\r\n          {/* Text is hidden on mobile (default) and shown from 'sm' breakpoint up */}\r\n          <span className=\"hidden sm:inline\">Export</span> \r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <PageLayout\r\n      title=\"INVENTORY\"\r\n      sidebar={<NavAdmin />}\r\n      isSidebarOpen={isSidebarOpen}\r\n      headerActions={headerActions}\r\n      setSidebarOpen={setSidebarOpen}\r\n      showHeader={true}\r\n      showNavbar={false}\r\n      showFooter={false}\r\n    >\r\n      <Inventory\r\n        products={paginatedProducts}\r\n        allProducts={filteredProducts}\r\n        stats={stats}\r\n        page={page}\r\n        entriesPerPage={entriesPerPage}\r\n        totalPages={totalPages}\r\n        onPageChange={handlePageChange}\r\n        onEntriesChange={handleEntriesChange}\r\n        search={search}\r\n        onSearchChange={handleSearchChange}\r\n        onEdit={openEditProduct}\r\n        onDelete={handleDeleteProduct}\r\n        onAddProduct={openAddProduct}\r\n        onStockEntry={openStockEntry}\r\n        categories={categories}\r\n        selectedCategory={selectedCategory}\r\n        onCategoryFilter={(category) => {\r\n          setSelectedCategory(category);\r\n          setPage(1); // Reset to first page on filter change\r\n        }}\r\n        stockFilter={stockFilter}\r\n        onStockFilter={(filter) => {\r\n          setStockFilter(filter);\r\n          setPage(1); // Reset to first page on filter change\r\n        }}\r\n        sortBy={sortBy}\r\n        sortOrder={sortOrder}\r\n        onSort={(field, order) => {\r\n          setSortBy(field);\r\n          setSortOrder(order);\r\n          setPage(1); // Reset to first page on sort\r\n        }}\r\n      />\r\n      {apiError && !showProductModal && (\r\n        <div className=\"bg-red-50 border-l-4 border-red-500 rounded-lg p-4 flex items-start gap-3 mt-4 shadow-sm\">\r\n          <div className=\"flex-shrink-0\">\r\n            <svg\r\n              className=\"w-5 h-5 text-red-500\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\"\r\n              />\r\n            </svg>\r\n          </div>\r\n          <div className=\"flex-1\">\r\n            <h3 className=\"text-sm font-semibold text-red-800 mb-1\">\r\n              {apiError.includes(\"already exists\") || apiError.includes(\"SKU\") \r\n                ? \"Duplicate Product\" \r\n                : \"Error\"}\r\n            </h3>\r\n            <p className=\"text-sm text-red-700\">\r\n              {(() => {\r\n                try {\r\n                  const parsed = JSON.parse(apiError);\r\n                  return parsed.error || parsed.message || apiError;\r\n                } catch {\r\n                  return apiError;\r\n                }\r\n              })()}\r\n            </p>\r\n            {apiError.includes(\"already exists\") && (\r\n              <p className=\"text-xs text-red-600 mt-2 italic\">\r\n                Please use a different SKU code or update the existing product instead.\r\n              </p>\r\n            )}\r\n          </div>\r\n          <button\r\n            onClick={() => setApiError(\"\")}\r\n            className=\"flex-shrink-0 text-red-400 hover:text-red-600 transition-colors\"\r\n            aria-label=\"Close error\"\r\n          >\r\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n      )}\r\n      <Modal\r\n        isOpen={showProductModal}\r\n        onClose={() => {\r\n          setShowProductModal(false);\r\n          setApiError(\"\"); // Clear error when closing modal\r\n        }}\r\n        variant=\"product\"\r\n        title={editingProduct ? \"Edit Product\" : \"Add New Product\"}\r\n        editingProduct={editingProduct}\r\n        productForm={productForm}\r\n        onChange={handleProductFormChange}\r\n        categories={categories}\r\n        onSubmit={handleProductSubmit}\r\n        loading={loading}\r\n        error={apiError}\r\n      />\r\n      {/* Stock Entry Modal */}\r\n      <Modal\r\n        isOpen={showStockModal}\r\n        onClose={() => setShowStockModal(false)}\r\n        title={\"Stock Entry\"}\r\n        variant=\"stock\"\r\n        editingProduct={null}\r\n        stockForm={stockForm}\r\n        onChange={(e) =>\r\n          setStockForm({ ...stockForm, [e.target.name]: e.target.value })\r\n        }\r\n        onSubmit={handleStockSubmit}\r\n        loading={loading}\r\n      />\r\n      {/* Delete Confirmation Modal */}\r\n      <Modal\r\n        isOpen={showDeleteModal}\r\n        onClose={() => setShowDeleteModal(false)}\r\n        title=\"\"\r\n        size=\"sm\"\r\n      >\r\n        <div className=\"p-0\">\r\n          <div className=\"bg-gradient-to-r from-red-50 via-red-50/80 to-orange-50/50 border-b border-red-100 px-6 py-5 rounded-t-2xl\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-xl flex items-center justify-center shadow-lg\">\r\n                <svg\r\n                  className=\"w-6 h-6 text-white\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\"\r\n                  />\r\n                </svg>\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <h2 className=\"text-xl font-bold text-gray-900 mb-1\">\r\n                  Confirm Deletion\r\n                </h2>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  Are you sure you want to delete this product?\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"p-6\">\r\n            <p className=\"text-sm text-gray-700 mb-2\">\r\n              You are about to delete:{\" \"}\r\n              <strong className=\"text-red-700\">{productToDelete?.name}</strong>\r\n            </p>\r\n            <p className=\"text-sm text-gray-700 mb-6\">\r\n              This action cannot be undone.\r\n            </p>\r\n            <div className=\"flex justify-end gap-3\">\r\n              <Button\r\n                onClick={() => setShowDeleteModal(false)}\r\n                variant=\"secondary\"\r\n                disabled={loading}\r\n              >\r\n                Cancel\r\n              </Button>\r\n              <Button onClick={confirmDeleteProduct} variant=\"danger\" loading={loading}>\r\n                Delete\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n    </PageLayout>\r\n  );\r\n}\r\n"],"names":["InventoryTable","products","allProducts","page","entriesPerPage","totalPages","onPageChange","onEntriesChange","search","onSearchChange","onEdit","onDelete","onStockEntry","categories","selectedCategory","onCategoryFilter","stockFilter","onStockFilter","sortBy","sortOrder","onSort","EditIcon","jsx","className","fill","stroke","strokeWidth","viewBox","children","d","DeleteIcon","jsxs","StockIcon","getStockStatus","quantity","lowStockLevel","threshold","Number","label","color","SortIcon","direction","strokeLinecap","strokeLinejoin","handleSort","field","Fragment","Card","type","value","onChange","placeholder","e","order","target","split","map","n","cat","name","id","onClick","length","colSpan","product","idx","stockStatus","low_stock_level","sku","category","title","description","cost_price","toFixed","selling_price","replace","Math","min","Button","size","variant","disabled","Array","from","_","i","pageNum","Inventory","stats","totalValue","reduce","sum","p","lowStockCount","filter","toLocaleString","undefined","minimumFractionDigits","initialProducts","initialCategories","DEFAULT_LOW_STOCK_LEVEL","getCategoriesByBusinessType","businessType","categoryMap","Pharmacy","Bookstore","Others","InventoryPage","setProducts","useState","setCategories","storedType","window","sessionStorage","getItem","raw","localStorage","parsed","JSON","parse","business","business_type","setItem","index","showProductModal","setShowProductModal","showStockModal","setShowStockModal","editingProduct","setEditingProduct","productForm","setProductForm","customCategory","stockForm","setStockForm","loading","setLoading","setSearch","debouncedSearch","useDebounce","setEntriesPerPage","setPage","apiError","setApiError","isSidebarOpen","setSidebarOpen","deleteTarget","setDeleteTarget","showDeleteModal","setShowDeleteModal","productToDelete","setProductToDelete","useEffect","async","token","userData","api","headers","authHeaders","storageErr","debug","predefinedCategories","data","params","limit","offset","mapped","row","String","err","fetchInventory","totalInventoryValue","lowStockItems","icon","width","height","sub","formatValue","val","setSortBy","setSortOrder","setSelectedCategory","setStockFilter","filteredProducts","useMemo","filtered","toLowerCase","includes","qty","sort","a","b","aVal","bVal","ceil","paginatedProducts","slice","openAddProduct","useCallback","openEditProduct","openStockEntry","handleProductFormChange","prev","handleProductSubmit","preventDefault","method","body","stringify","product_name","trim","product_category_id","price","Date","now","errorMessage","errorData","response","errorStatus","status","error","message","existingProduct","parseErr","handleStockSubmit","handleDeleteProduct","find","confirmDeleteProduct","console","log","handlePageChange","newPage","handleEntriesChange","handleSearchChange","handleExport","downloadCSV","csv","filename","blob","Blob","link","document","createElement","download","url","URL","createObjectURL","setAttribute","style","visibility","appendChild","click","removeChild","csvRows","push","join","forEach","item","convertToCSV","timestamp","toISOString","headerActions","microinteraction","PageLayout","sidebar","NavAdmin","showHeader","showNavbar","showFooter","onAddProduct","Modal","isOpen","onClose","onSubmit"],"mappings":"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ERC,SAACN,EAAAA,IAAA,OAAA,CACCoB,cAAc,QACdC,eAAe,QACfjB,YAAa,EACbG,EAAE,oLAIRE,EAAAA,KAAC,MAAI,CAAAR,UAAU,iBACbK,SAAA,CAACN,EAAAA,IAAA,IAAA,CAAEC,UAAU,uEAAuEK,SAEpF,0BACAG,EAAAA,KAAC,IAAE,CAAAR,UAAU,uDAAuDK,SAAA,CAAA,KAEjE6D,EAAWM,oBAAeC,EAAW,CACpCC,sBAAuB,kBASnC3E,MAACtB,GACCC,WACAE,OACAC,iBACAC,aACAC,eACAC,kBACAC,SACAC,iBACAC,SACAC,WACAC,eACAC,aACAC,mBACAC,mBACAC,cACAC,gBACAC,SACAC,YACAC,aAIR,CCp2BA,MAAM8E,EAAkB,GAClBC,EAAoB,GACpBC,EAA0B,GAqDhC,SAASC,EAA4BC,GACnC,MAAMC,EAAc,CAClB,gBAAiB,CACf,gBACA,iBACA,UACA,eACA,iBACA,iBACA,YACA,0BACA,cACA,uBACA,sBACA,oBACA,uBACA,gBACA,gBAEFC,SAAU,CACR,yBACA,gBACA,yBACA,qBACA,kBACA,gBACA,mBACA,qBACA,YACA,aACA,oBAEF,iBAAkB,CAChB,iBACA,mBACA,iBACA,gBACA,WACA,qBACA,qBAEF,oBAAqB,CACnB,iBACA,sBACA,uBACA,oBACA,gBACA,wBACA,kBACA,sBACA,gCACA,+BAEFC,UAAW,CACT,gBACA,oBACA,oBACA,mBACA,iBACA,kBACA,gBACA,kBACA,sBAEF,oBAAqB,CACnB,SACA,YACA,oBACA,8BACA,cACA,sBACA,aACA,sBACA,uBACA,aACA,uBACA,sBAEFC,OAAQ,CAAC,YAGX,OAAOH,EAAYD,IAAiBC,EAAoB,MAC1D,CAEA,SAAwBI,IAEtB,MAAO1G,EAAU2G,GAAeC,EAAAA,SAASX,IAClCrF,EAAYiG,GAAiBD,WAAS,KACvC,IACF,IAAIE,EAAa,KACb,IACFA,EACqB,oBAAXC,QACNC,eAAeC,QAAQ,kBACzB,WACK9D,GACM2D,EAAA,IAAA,CAGf,IAAKA,GAAgC,oBAAXC,OACpB,IACF,MAAMG,EACJF,eAA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"}