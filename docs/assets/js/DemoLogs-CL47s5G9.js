import{j as e}from"./utils-BnCj7yKo.js";import{a as t}from"./vendor-BZrj58oz.js";import{u as r}from"./useDebounce-CoebmKoV.js";import{D as s}from"./DemoNav-31GQ2Q_Q.js";import{B as a,a as o}from"./index-4YedFPzh.js";import{P as n}from"./PageLayout-EdUvf13k.js";import{b as i}from"./index-DLptuXQb.js";import{d,D as l}from"./DateRangeFilterModal-LlFYLvIy.js";import"./Logo-DtUJIMK7.js";import"./BaseModal-C-8Qp-dk.js";import"./Navbar-C7s4jb7w.js";import"./PrivacyPolicyModal-B1qn0bgk.js";const m=()=>{const m=[{id:1,userId:101,username:"Admin",action:"Updated inventory stock for SKU 1001",time:"November 1, 2024 10:30:00 AM",dateTime:d().startOf("month").add(0,"day").hour(10).minute(30).toISOString(),role:"admin"},{id:2,userId:102,username:"cashier1",action:"Processed transaction #T-10023",time:"November 1, 2024 11:15:00 AM",dateTime:d().startOf("month").add(0,"day").hour(11).minute(15).toISOString(),role:"cashier"},{id:3,userId:103,username:"customer1",action:"Placed order for Product A",time:"November 2, 2024 02:00:00 PM",dateTime:d().startOf("month").add(1,"day").hour(14).minute(0).toISOString(),role:"customer"},{id:4,userId:104,username:"Admin",action:"Added new product 'Demo Cake'",time:"November 3, 2024 09:45:00 AM",dateTime:d().startOf("month").add(2,"day").hour(9).minute(45).toISOString(),role:"admin"},{id:5,userId:105,username:"cashier2",action:"Refunded transaction #T-10045",time:"November 4, 2024 03:20:00 PM",dateTime:d().startOf("month").add(3,"day").hour(15).minute(20).toISOString(),role:"cashier"},{id:6,userId:106,username:"customer2",action:"Viewed product catalog",time:"November 5, 2024 04:10:00 PM",dateTime:d().startOf("month").add(4,"day").hour(16).minute(10).toISOString(),role:"customer"},{id:7,userId:107,username:"cashier3",action:"Applied discount code SAVE20 to transaction #T-10067",time:"November 6, 2024 08:30:00 AM",dateTime:d().startOf("month").add(5,"day").hour(8).minute(30).toISOString(),role:"cashier"},{id:8,userId:108,username:"Admin",action:"Generated sales report for November 2024",time:"November 7, 2024 09:15:00 AM",dateTime:d().startOf("month").add(6,"day").hour(9).minute(15).toISOString(),role:"admin"},{id:9,userId:109,username:"customer3",action:"Updated account information",time:"November 8, 2024 11:45:00 AM",dateTime:d().startOf("month").add(7,"day").hour(11).minute(45).toISOString(),role:"customer"},{id:10,userId:110,username:"cashier1",action:"Voided transaction #T-10089 due to customer request",time:"November 9, 2024 02:20:00 PM",dateTime:d().startOf("month").add(8,"day").hour(14).minute(20).toISOString(),role:"cashier"},{id:11,userId:111,username:"Admin",action:"Modified user permissions for cashier2",time:"November 10, 2024 10:00:00 AM",dateTime:d().startOf("month").add(9,"day").hour(10).minute(0).toISOString(),role:"admin"},{id:12,userId:112,username:"customer4",action:"Added item to wishlist",time:"November 11, 2024 01:30:00 PM",dateTime:d().startOf("month").add(10,"day").hour(13).minute(30).toISOString(),role:"customer"},{id:13,userId:113,username:"cashier3",action:"Processed return for transaction #T-10101",time:"November 12, 2024 03:45:00 PM",dateTime:d().startOf("month").add(11,"day").hour(15).minute(45).toISOString(),role:"cashier"},{id:14,userId:114,username:"Admin",action:"Updated system settings",time:"November 13, 2024 09:30:00 AM",dateTime:d().startOf("month").add(12,"day").hour(9).minute(30).toISOString(),role:"admin"},{id:15,userId:115,username:"customer5",action:"Completed purchase of multiple items",time:"November 14, 2024 04:15:00 PM",dateTime:d().startOf("month").add(13,"day").hour(16).minute(15).toISOString(),role:"customer"}],[c,u]=t.useState(m),[x,h]=t.useState(""),[p,g]=t.useState(""),f=r(p,400),[b,y]=t.useState(!1),[j,v]=t.useState(!1),[N,w]=t.useState({startDate:d().startOf("month"),endDate:d().endOf("day"),rangeType:"Month"}),[S,M]=t.useState("all"),[k,O]=t.useState("desc"),[D,I]=t.useState(!1),[T,C]=t.useState(!1),[Y,A]=t.useState(!1),L=t.useRef(null),P=t.useMemo(()=>{if(!N.startDate||!N.endDate)return"Select Range";const e=d(N.startDate),t=d(N.endDate),r=t.diff(e,"day")+1;return"Day"===N.rangeType?e.format("MMM D, YYYY"):"Week"===N.rangeType?`${e.format("MMM D")} - ${t.format("MMM D, YYYY")} (${r} days)`:"Month"===N.rangeType?`${e.format("MMM YYYY")} (${r} days)`:`${e.format("MMM D, YYYY")} - ${t.format("MMM D, YYYY")} (${r} days)`},[N]),$=async()=>{y(!0),h(""),setTimeout(()=>{u(m),y(!1)},500)};t.useEffect(()=>{$()},[]),t.useEffect(()=>{const e=e=>{L.current&&!L.current.contains(e.target)&&I(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const R=t.useMemo(()=>{let e=c;if("all"!==S&&(e=e.filter(e=>"customer"===S?"user"===e.role||"customer"===e.role:e.role===S)),f){const t=f.toLowerCase();e=e.filter(e=>(e.action||"").toLowerCase().includes(t)||(e.username||"").toLowerCase().includes(t))}if(N.startDate){const t=d(N.startDate).startOf("day"),r=N.endDate?d(N.endDate).endOf("day"):d().endOf("day");e=e.filter(e=>d(e.dateTime).isBetween(t,r,null,"[]"))}return e.sort((e,t)=>{const r=new Date(e.dateTime),s=new Date(t.dateTime);return"asc"===k?r-s:s-r}),e},[c,S,f,k,N]),B=[{value:"all",label:"All Roles"},{value:"cashier",label:"Cashier"},{value:"admin",label:"Admin"},{value:"customer",label:"Customer"}],z=B.find(e=>e.value===S),E=e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:$,disabled:b,title:"Refresh Logs",className:"bg-white/80 backdrop-blur-sm hover:bg-white text-gray-700 p-2 rounded-lg border border-gray-200/80 text-sm font-medium transition-all duration-200 hover:shadow-md",children:e.jsx(a,{className:"w-5 h-5 "+(b?"animate-spin":"")})}),e.jsxs("button",{onClick:()=>A(!0),disabled:b,title:"Select Date Range",className:`flex items-center gap-1 sm:gap-2 ${"Custom"!==N.rangeType?"bg-blue-50 border-blue-200":"bg-white/80 border-gray-200/80"} backdrop-blur-sm hover:bg-white text-gray-700 px-2 sm:px-3 py-1.5 rounded-lg border text-xs sm:text-sm font-medium transition-all duration-200 hover:shadow-md`,children:[e.jsx(o,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline text-left truncate max-w-[180px]",children:P})]})]});return e.jsx(n,{title:"LOGS (DEMO)",sidebar:e.jsx(s,{}),isSidebarOpen:T,setSidebarOpen:C,className:"overflow-hidden",headerActions:E,children:e.jsxs("div",{className:"h-[calc(100vh-80px)] bg-transparent p-4 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between mb-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-xl w-full flex-shrink-0",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"Search logs...",value:p,onChange:e=>g(e.target.value),className:"w-full pl-12 pr-4 py-3 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 placeholder-gray-400"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 w-full sm:w-auto",children:[e.jsxs("div",{className:"relative",ref:L,children:[e.jsxs("button",{onClick:()=>I(!D),className:"w-full sm:w-auto pl-4 pr-10 py-3 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:z?.icon}),e.jsx("span",{children:z?.label})]}),e.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 "+(D?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),D&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-xl shadow-lg max-h-60 overflow-auto",children:B.map(t=>e.jsxs("button",{onClick:()=>{M(t.value),I(!1)},className:"w-full px-4 py-3 text-left text-sm hover:bg-gray-50 flex items-center gap-2 transition-colors duration-150 "+(S===t.value?"bg-blue-50 text-blue-600":"text-gray-700"),children:[e.jsx("span",{children:t?.icon}),e.jsx("span",{children:t.label})]},t.value))})]}),e.jsxs(i,{onClick:()=>O("asc"===k?"desc":"asc"),variant:"secondary",size:"md",className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"})}),"Sort (","asc"===k?"Oldest":"Newest",")"]}),e.jsxs(i,{onClick:()=>{try{const e=R;if(0===e.length)return void h("No logs to export for the selected date range");const t=[["Customer ID","Customer Name","Role","Action","Time"].join(","),...e.map(e=>[e.userId||e.id||"",`"${(e.username||"").replace(/"/g,'""')}"`,e.role||"",`"${(e.action||"").replace(/"/g,'""')}"`,`"${(e.time||"").replace(/"/g,'""')}"`].join(","))].join("\n");let r=`logs_export_${(new Date).toISOString().split("T")[0]}`;if(N.startDate&&N.endDate){const e=d(N.startDate).format("YYYY-MM-DD");r=`logs_export_${e}_to_${d(N.endDate).format("YYYY-MM-DD")}`}const s=new Blob([t],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),o=URL.createObjectURL(s);a.setAttribute("href",o),a.setAttribute("download",`${r}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}catch(e){h("Failed to export logs as CSV"),console.error("CSV export error:",e)}},variant:"secondary",size:"md",className:"flex items-center gap-2",disabled:0===R.length||b,children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export as CSV"]})]})]}),e.jsx("div",{className:"hidden sm:block overflow-hidden rounded-xl border border-gray-200/50 h-[calc(100%-150px)] flex-1 min-h-0",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("table",{className:"w-full bg-white/80 backdrop-blur-md",children:[e.jsx("thead",{className:"bg-gray-100/90 backdrop-blur-md sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timestamp"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200/50",children:b?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-8 text-gray-500",children:"Loading logs..."})}):0===R.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-8 text-gray-500",children:"No logs found."})}):R.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.username}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",t.userId]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+("admin"===t.role||"business_owner"===t.role?"bg-purple-100 text-purple-800":"cashier"===t.role?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:t.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.action}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.time})]},t.id))})]})})}),e.jsx("div",{className:"sm:hidden overflow-y-auto space-y-3 h-[calc(100%-150px)]",children:b?Array.from({length:5}).map((t,r)=>e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-xl p-4 border border-gray-200/50 animate-pulse",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full mb-3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},r)):0===R.length?e.jsx("div",{className:"text-center py-8 text-gray-500 bg-white/80 backdrop-blur-md rounded-xl",children:"No logs found."}):R.map(t=>e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-xl p-4 border border-gray-200/50 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:t.username}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",t.userId]})]}),e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize "+("admin"===t.role||"business_owner"===t.role?"bg-purple-100 text-purple-800":"cashier"===t.role?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:t.role})]}),e.jsx("p",{className:"text-sm text-gray-800 mb-2",children:t.action}),e.jsx("div",{className:"text-xs text-gray-500 text-right border-t border-gray-200/50 pt-2 mt-2",children:t.time})]},t.id))}),x&&e.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-lg p-3 flex items-start gap-2 mt-4",children:[e.jsx("svg",{className:"w-4 h-4 text-red-500 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("p",{className:"text-sm font-medium text-red-700",children:(()=>{try{const e=JSON.parse(x);return e.error||e.message||x}catch{return x}})()})]}),e.jsx(l,{isOpen:Y,onClose:()=>A(!1),onDateRangeApply:e=>{w({startDate:e.startDate,endDate:e.endDate,rangeType:e.rangeType}),$()}})]})})};export{m as default};
//# sourceMappingURL=DemoLogs-CL47s5G9.js.map
