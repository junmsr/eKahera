{"version":3,"file":"ScanCustomerCartModal-lZnYevyY.js","sources":["../../../frontend/src/components/ui/POS/SkuFormCard.jsx","../../../frontend/src/components/ui/POS/CartTableCard.jsx","../../../frontend/src/components/modals/PriceCheckModal.jsx","../../../frontend/src/components/modals/DiscountModal.jsx","../../../frontend/src/components/modals/CashLedgerModal.jsx","../../../frontend/src/components/modals/CheckoutModal.jsx","../../../frontend/src/components/modals/CashPaymentCompleteModal.jsx","../../../frontend/src/components/modals/CashPaymentModal.jsx","../../../frontend/src/components/modals/ScanCustomerCartModal.jsx"],"sourcesContent":["import React from \"react\";\r\nimport Card from \"../../common/Card\";\r\nimport FormField from \"../../common/FormField\";\r\nimport Input from \"../../common/Input\";\r\nimport Button from \"../../common/Button\";\r\n\r\n/**\r\n * SKU Form Card Component\r\n * Form for entering SKU codes and quantities\r\n */\r\nexport default React.forwardRef(\r\n  (\r\n    {\r\n      sku,\r\n      setSku,\r\n      quantity,\r\n      setQuantity,\r\n      handleAddToCart,\r\n      quantityInputRef,\r\n      className = \"\",\r\n    },\r\n    ref\r\n  ) => {\r\n    return (\r\n      <Card\r\n        className={`flex-shrink-0 bg-white/80 backdrop-blur-md border border-white/60 shadow-xl hover:shadow-2xl transition-all duration-300 ${className}`}\r\n        variant=\"glass\"\r\n      >\r\n        <div className=\"flex flex-col gap-1 p-1 sm:p-2\">\r\n          <div className=\"flex items-center gap-2 mb-0.5\">\r\n            <div className=\"w-6 h-6 bg-blue-100 rounded-xl flex items-center justify-center\">\r\n              <svg\r\n                className=\"w-3 h-3 text-blue-600\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <span className=\"font-bold text-sm text-gray-900\">\r\n              Enter SKU Code\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <div>\r\n              <label className=\"flex items-center gap-2 text-sm font-semibold text-gray-700 mb-1\">\r\n                <span>SKU Code</span>\r\n                <span className=\"hidden sm:inline-block text-xs font-bold px-1.5 py-0.5 rounded border bg-gray-100 border-gray-300 text-gray-600\">\r\n                  `\r\n                </span>\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  ref={ref}\r\n                  type=\"text\"\r\n                  name=\"sku\"\r\n                  value={sku}\r\n                  onChange={(e) => setSku(e.target.value)}\r\n                  onKeyPress={(e) => {\r\n                    if (e.key === \"Enter\" && sku.trim()) {\r\n                      handleAddToCart();\r\n                    }\r\n                  }}\r\n                  placeholder=\"Scan or enter SKU code (Press ` to focus)\"\r\n                  className=\"w-full pl-3 pr-3 py-2 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 placeholder-gray-400 font-medium\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-2\">\r\n              <label className=\"text-sm font-semibold text-gray-700 whitespace-nowrap\">\r\n                Quantity:\r\n              </label>\r\n              <div className=\"flex items-center gap-1 flex-1\">\r\n                <button\r\n                  onClick={() => setQuantity(Math.max(1, quantity - 1))}\r\n                  className=\"w-8 h-8 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold transition-colors duration-200 flex items-center justify-center\"\r\n                >\r\n                  −\r\n                </button>\r\n                <input\r\n                  type=\"number\"\r\n                  name=\"quantity\"\r\n                  value={quantity}\r\n                  min={1}\r\n                  ref={quantityInputRef}\r\n                  onChange={(e) =>\r\n                    setQuantity(Math.max(1, Number(e.target.value) || 1))\r\n                  }\r\n                  className=\"w-16 px-2 py-1 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl text-center text-sm font-semibold focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200\"\r\n                />\r\n                <button\r\n                  onClick={() => setQuantity(quantity + 1)}\r\n                  className=\"w-8 h-8 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold transition-colors duration-200 flex items-center justify-center\"\r\n                >\r\n                  +\r\n                </button>\r\n              </div>\r\n              <Button\r\n                label={\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <span>Add to Cart</span>\r\n                    <span className=\"hidden sm:inline-block text-xs font-bold px-1.5 py-0.5 rounded border bg-white/20 border-white/40 text-white\">\r\n                      F4\r\n                    </span>\r\n                  </div>\r\n                }\r\n                onClick={handleAddToCart}\r\n                variant=\"primary\"\r\n                size=\"sm\"\r\n                microinteraction\r\n                icon={\r\n                  <svg\r\n                    className=\"w-3 h-3\"\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    viewBox=\"0 0 24 24\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M12 4v16m8-8H4\"\r\n                    />\r\n                  </svg>\r\n                }\r\n                iconPosition=\"left\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    );\r\n  }\r\n);\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport Card from \"../../common/Card\";\r\nimport Button from \"../../common/Button\";\r\n\r\n/**\r\n * Cart Table Card Component\r\n * Displays cart items in a table format with totals\r\n */\r\nfunction CartTableCard({\r\n  cart,\r\n  handleRemove,\r\n  handleEditQuantity,\r\n  total,\r\n  className = \"\",\r\n  selectedIdx = -1,\r\n  onSelectRow,\r\n  appliedDiscount,\r\n  editingIdx = null,\r\n  editQty = 1,\r\n  onEditQtyChange,\r\n  onEditComplete,\r\n  onStartEdit,\r\n}) {\r\n\r\n  // Handle row click to select item\r\n  const handleRowClick = (idx, e) => {\r\n    if (e.target.tagName !== 'INPUT') { // Don't select row when clicking on input\r\n      onSelectRow?.(idx);\r\n    }\r\n  };\r\n  \r\n  // Handle quantity input change\r\n  const handleQtyChange = (e) => {\r\n    const value = e.target.value;\r\n    // Allow empty string (for backspace/delete) or positive numbers\r\n    if (value === '' || /^\\d+$/.test(value)) {\r\n      onEditQtyChange?.(value === '' ? '' : parseInt(value, 10));\r\n    }\r\n  };\r\n  \r\n  // Handle quantity save\r\n  const handleSaveQuantity = (idx) => {\r\n    const qty = editQty === '' ? 1 : Math.max(1, editQty);\r\n    handleEditQuantity(idx, qty);\r\n    onEditComplete?.();\r\n  };\r\n\r\n  const EditIcon = () => (\r\n    <svg\r\n      width=\"16\"\r\n      height=\"16\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path d=\"M15.232 5.232l3.536 3.536M9 13l6.586-6.586a2 2 0 1 1 2.828 2.828L11.828 15.828a4 4 0 0 1-1.414.828l-4.243 1.414 1.414-4.243a4 4 0 0 1 .828-1.414z\" />\r\n    </svg>\r\n  );\r\n\r\n  const DeleteIcon = () => (\r\n    <svg\r\n      width=\"16\"\r\n      height=\"16\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path d=\"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\" />\r\n    </svg>\r\n  );\r\n  \r\n  const CheckIcon = () => (\r\n    <svg\r\n      width=\"16\"\r\n      height=\"16\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path d=\"M5 13l4 4L19 7\" />\r\n    </svg>\r\n  );\r\n  \r\n  const XIcon = () => (\r\n    <svg\r\n      width=\"16\"\r\n      height=\"16\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path d=\"M18 6L6 18M6 6l12 12\" />\r\n    </svg>\r\n  );\r\n\r\n  return (\r\n    <Card\r\n      className={`flex-1 flex flex-col bg-white/80 backdrop-blur-md border border-white/60 shadow-xl transition-all duration-300 h-full min-h-0 overflow-hidden ${className}`}\r\n      variant=\"glass\"\r\n    >\r\n      <div className=\"flex-1 min-h-0 flex flex-col p-2 sm:p-3\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between mb-2 pb-2 border-b border-gray-200\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <div className=\"w-7 h-7 bg-blue-100 rounded-lg flex items-center justify-center\">\r\n              <svg\r\n                className=\"w-4 h-4 text-blue-600\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <h3 className=\"text-sm sm:text-base font-bold text-gray-900\">\r\n              Shopping Cart\r\n            </h3>\r\n          </div>\r\n          <span className=\"text-xs font-semibold text-gray-600 bg-gray-100 px-2 py-0.5 rounded-full\">\r\n            {cart.length} {cart.length === 1 ? \"item\" : \"items\"}\r\n          </span>\r\n        </div>\r\n\r\n        {/* Table Container */}\r\n        <div className=\"flex-1 overflow-auto min-h-0 rounded-lg\">\r\n          <table className=\"w-full\">\r\n            <thead className=\"sticky top-0 z-10 bg-gradient-to-r from-blue-50/90 to-indigo-50/90 backdrop-blur-sm border-b border-blue-100\">\r\n              <tr>\r\n                <th className=\"py-1.5 px-2 text-left text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider\">\r\n                  Product\r\n                </th>\r\n                <th className=\"py-1.5 px-2 text-center text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider\">\r\n                  Qty\r\n                </th>\r\n                <th className=\"py-1.5 px-2 text-right text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider\">\r\n                  Price\r\n                </th>\r\n                <th className=\"py-1.5 px-2 text-right text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider\">\r\n                  Total\r\n                </th>\r\n                <th className=\"py-1.5 px-2 text-center text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider\">\r\n                  Actions\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"divide-y divide-gray-100\">\r\n              {cart.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan={5} className=\"text-center py-8\">\r\n                    <div className=\"flex flex-col items-center justify-center\">\r\n                      <div className=\"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-2\">\r\n                        <svg\r\n                          className=\"w-6 h-6 text-gray-400\"\r\n                          fill=\"none\"\r\n                          stroke=\"currentColor\"\r\n                          viewBox=\"0 0 24 24\"\r\n                        >\r\n                          <path\r\n                            strokeLinecap=\"round\"\r\n                            strokeLinejoin=\"round\"\r\n                            strokeWidth={2}\r\n                            d=\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\"\r\n                          />\r\n                        </svg>\r\n                      </div>\r\n                      <p className=\"text-gray-500 text-sm font-semibold\">\r\n                        Cart is empty\r\n                      </p>\r\n                      <p className=\"text-gray-400 text-xs mt-1\">\r\n                        Scan or enter products\r\n                      </p>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                cart.map((item, idx) => (\r\n                  <tr\r\n                    key={idx}\r\n                    className={`hover:bg-blue-50/50 transition-colors duration-200 group ${selectedIdx === idx ? \"bg-blue-100/70 ring-2 ring-blue-300\" : \"\"}`}\r\n                    onClick={(e) => handleRowClick(idx, e)}\r\n                  >\r\n                    <td className=\"py-1.5 px-2\">\r\n                      <div className=\"flex flex-col\">\r\n                        <span className=\"text-xs sm:text-sm font-semibold text-gray-900 group-hover:text-blue-600 transition-colors truncate\">\r\n                          {item.name}\r\n                        </span>\r\n                        <span className=\"text-[10px] text-gray-500 truncate\">\r\n                          SKU: {item.sku || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"py-1.5 px-2 text-center\">\r\n                      {editingIdx === idx ? (\r\n                        <div className=\"flex items-center justify-center gap-1\">\r\n                          <input\r\n                            type=\"text\"\r\n                            inputMode=\"numeric\"\r\n                            pattern=\"[0-9]*\"\r\n                            value={editQty}\r\n                            onChange={handleQtyChange}\r\n                            onKeyDown={(e) => {\r\n                              if (e.key === \"Enter\") {\r\n                                handleSaveQuantity(idx);\r\n                              } else if (e.key === \"Escape\") {\r\n                                onEditComplete?.();\r\n                              }\r\n                            }}\r\n                            onBlur={() => handleSaveQuantity(idx)}\r\n                            className=\"w-12 h-7 text-center text-xs font-bold border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                            autoFocus\r\n                            onFocus={(e) => e.target.select()}\r\n                          />\r\n                          <button\r\n                            type=\"button\"\r\n                            onClick={() => handleSaveQuantity(idx)}\r\n                            className=\"p-1 text-green-600 hover:bg-green-100 rounded\"\r\n                            title=\"Save\"\r\n                          >\r\n                            <CheckIcon />\r\n                          </button>\r\n                          <button\r\n                            onClick={() => onEditComplete()}\r\n                            className=\"p-1 text-red-600 hover:bg-red-100 rounded\"\r\n                            title=\"Cancel\"\r\n                          >\r\n                            <XIcon />\r\n                          </button>\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"flex items-center justify-center gap-1\">\r\n                          <span className=\"inline-flex items-center justify-center w-7 h-7 rounded-md bg-blue-100 text-blue-700 font-bold text-xs\">\r\n                            {item.quantity}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n                    </td>\r\n                    <td className=\"py-1.5 px-2 text-right\">\r\n                      <span className=\"text-xs sm:text-sm font-medium text-gray-700\">\r\n                        ₱{item.price.toFixed(2)}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"py-1.5 px-2 text-right\">\r\n                      <span className=\"text-xs sm:text-sm font-bold text-blue-600\">\r\n                        ₱\r\n                        {(\r\n                          item.price *\r\n                          (editingIdx === idx ? editQty : item.quantity)\r\n                        ).toFixed(2)}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"py-1.5 px-2\">\r\n                      <div className=\"flex items-center justify-center gap-1\">\r\n                        <button\r\n                          onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            onSelectRow?.(idx);\r\n                            onEditQtyChange?.(item.quantity);\r\n                            onStartEdit?.(idx);\r\n                          }}\r\n                          className={`p-1.5 rounded-md transition-all duration-200 ${selectedIdx === idx ? 'bg-blue-100 text-blue-700 border-blue-200' : 'bg-blue-50 text-blue-600 hover:bg-blue-100 border-blue-200'} border`}\r\n                          title=\"Edit (F1)\"\r\n                          \r\n                        >\r\n                          <div className=\"flex items-center gap-1\">\r\n                            {(\r\n                              <span className=\"hidden sm:inline-block text-[10px] font-bold text-blue-700 bg-blue-100 border border-blue-200 px-1.5 py-0.5 rounded\">F1</span>\r\n                            )}\r\n                            <EditIcon />\r\n                          </div>\r\n                        </button>\r\n                        <button\r\n                          onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            onSelectRow?.(idx);\r\n                            handleRemove(idx);\r\n                          }}\r\n                          className={`p-1.5 rounded-md transition-all duration-200 ${selectedIdx === idx ? 'bg-red-100 text-red-700 border-red-200' : 'bg-red-50 text-red-600 hover:bg-red-100 border-red-200'} border`}\r\n                          title=\"Delete (F2)\"\r\n                        >\r\n                          <div className=\"flex items-center gap-1\">\r\n                            {(\r\n                              <span className=\"hidden sm:inline-block text-[10px] font-bold text-red-700 bg-red-100 border border-red-200 px-1.5 py-0.5 rounded\">F2</span>\r\n                            )}\r\n                            <DeleteIcon />\r\n                          </div>\r\n                        </button>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        {/* Total Footer */}\r\n        <div className=\"mt-2 pt-2 border-t border-gray-200\">\r\n          <div className=\"flex flex-col gap-1\">\r\n            {appliedDiscount && (\r\n              <div className=\"flex justify-between items-center text-xs text-gray-500\">\r\n                <span>Subtotal:</span>\r\n                <span className=\"line-through\">\r\n                  ₱\r\n                  {cart\r\n                    .reduce(\r\n                      (sum, item, idx) =>\r\n                        sum +\r\n                        item.price * (editingIdx === idx ? editQty : item.quantity),\r\n                      0\r\n                    )\r\n                    .toFixed(2)}\r\n                </span>\r\n              </div>\r\n            )}\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-sm sm:text-base font-semibold text-gray-700\">\r\n                Total:\r\n              </span>\r\n              <span className=\"text-lg sm:text-xl font-extrabold text-blue-600\">\r\n                ₱{total.toFixed(2)}\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default CartTableCard;\r\n","import React, { useState } from \"react\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport Button from \"../common/Button\";\r\nimport { api } from \"../../lib/api\";\r\nimport ScannerCard from \"../ui/POS/ScannerCard\";\r\nimport { useKeyboardShortcuts } from \"../../hooks/useKeyboardShortcuts\";\r\n\r\nfunction PriceCheckModal({ isOpen, onClose, sku, setSku }) {\r\n  const [product, setProduct] = useState(null);\r\n\r\n  const handleCheck = async () => {\r\n    if (!sku) return;\r\n    try {\r\n      const businessId = localStorage.getItem(\"business_id\");\r\n      const query = businessId\r\n        ? `?business_id=${encodeURIComponent(businessId)}`\r\n        : \"\";\r\n      const res = await api(\r\n        `/api/products/public/sku/${encodeURIComponent(sku)}${query}`\r\n      );\r\n      if (res) {\r\n        setProduct({\r\n          name: res.product_name,\r\n          price: Number(res.selling_price || 0),\r\n          sku: res.sku,\r\n        });\r\n      } else {\r\n        setProduct(null);\r\n      }\r\n    } catch (_) {\r\n      setProduct(null);\r\n    }\r\n  };\r\n\r\n  // Auto-fetch on SKU change\r\n  React.useEffect(() => {\r\n    if (!sku) {\r\n      setProduct(null);\r\n      return;\r\n    }\r\n    const t = setTimeout(() => {\r\n      handleCheck();\r\n    }, 200);\r\n    return () => clearTimeout(t);\r\n  }, [sku]);\r\n\r\n  const footerContent = (\r\n    <Button\r\n      label=\"Close (Esc)\"\r\n      variant=\"secondary\"\r\n      onClick={onClose}\r\n      className=\"w-full\"\r\n    />\r\n  );\r\n\r\n  useKeyboardShortcuts(\r\n    [\r\n      {\r\n        key: \"escape\",\r\n        action: onClose,\r\n        enabled: isOpen,\r\n        allowWhileTyping: true,\r\n      },\r\n      {\r\n        key: \"enter\",\r\n        action: handleCheck,\r\n        enabled: isOpen,\r\n        allowWhileTyping: true,\r\n      },\r\n    ],\r\n    [isOpen, sku]\r\n  );\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Price Check\"\r\n      subtitle=\"Scan or enter SKU/barcode\"\r\n      icon={\r\n        <svg\r\n          className=\"w-5 h-5 text-white\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n          />\r\n        </svg>\r\n      }\r\n      footer={footerContent}\r\n      size=\"md\"\r\n      contentClassName=\"space-y-4\"\r\n    >\r\n      {/* Scanner */}\r\n      <div className=\"w-full\">\r\n        <ScannerCard\r\n          onScan={(result) => {\r\n            const code = result?.[0]?.rawValue;\r\n            if (code) {\r\n              setSku(code);\r\n            }\r\n          }}\r\n          paused={false}\r\n          onResume={() => {}}\r\n          className=\"w-full\"\r\n          textMain=\"text-blue-700\"\r\n        />\r\n      </div>\r\n\r\n      {/* Manual Input */}\r\n      <div className=\"w-full\">\r\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n          Enter SKU or Barcode\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          value={sku}\r\n          onChange={(e) => setSku(e.target.value)}\r\n          className=\"w-full border border-gray-300 rounded-lg px-4 py-2 text-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n          placeholder=\"Enter SKU or scan barcode\"\r\n        />\r\n      </div>\r\n\r\n      <div className=\"text-xs text-gray-600 bg-gray-50 border border-gray-200 rounded-lg px-3 py-2\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <span>Check price:</span>\r\n          <span className=\"font-mono bg-white px-2 py-0.5 rounded\">Enter</span>\r\n        </div>\r\n        <div className=\"flex items-center justify-between\">\r\n          <span>Close:</span>\r\n          <span className=\"font-mono bg-white px-2 py-0.5 rounded\">Esc</span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Results */}\r\n      {product ? (\r\n        <div className=\"w-full bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200/50\">\r\n          <div className=\"text-lg font-semibold text-blue-900 mb-1\">\r\n            {product.name}\r\n          </div>\r\n          <div className=\"text-3xl font-bold text-blue-600 mb-2\">\r\n            ₱{product.price.toFixed(2)}\r\n          </div>\r\n          <div className=\"text-xs text-gray-500\">SKU: {product.sku}</div>\r\n        </div>\r\n      ) : sku ? (\r\n        <div className=\"text-red-500 text-sm text-center py-4\">\r\n          No product found.\r\n        </div>\r\n      ) : null}\r\n    </BaseModal>\r\n  );\r\n}\r\n\r\nexport default PriceCheckModal;\r\n","import React, { useEffect, useState, useCallback } from \"react\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport Button from \"../common/Button\";\r\nimport { api } from \"../../lib/api\";\r\nimport { useKeyboardShortcuts } from \"../../hooks/useKeyboardShortcuts\";\r\n\r\nfunction DiscountModal({ isOpen, onClose, onApplyDiscount }) {\r\n  const [showSettings, setShowSettings] = useState(false);\r\n  const [discounts, setDiscounts] = useState([]);\r\n\r\n  const [newDesc, setNewDesc] = useState(\"\");\r\n  const [newValue, setNewValue] = useState(\"\");\r\n  const [selectedIdx, setSelectedIdx] = useState(null);\r\n  const [settingsSelectedIdx, setSettingsSelectedIdx] = useState(0);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const [saving, setSaving] = useState(false);\r\n  const [settingsTab, setSettingsTab] = useState(\"PERCENTAGE\");\r\n  \r\n  // State for the custom delete confirmation modal\r\n  const [deleteConfirmation, setDeleteConfirmation] = useState({ \r\n    isOpen: false, \r\n    id: null, \r\n    label: '' \r\n  });\r\n  \r\n  const descInputRef = React.useRef(null);\r\n  const valueInputRef = React.useRef(null);\r\n  const discountListRef = React.useRef(null);\r\n\r\n  // Helper function to check if the event target is a form input\r\n  const isTypingTarget = (el) => {\r\n    if (!el) return false;\r\n    const tag = el.tagName?.toLowerCase();\r\n    return (\r\n      el.isContentEditable ||\r\n      tag === \"input\" ||\r\n      tag === \"textarea\" ||\r\n      el.getAttribute?.(\"role\") === \"textbox\"\r\n    );\r\n  };\r\n\r\n  const handleInputKeyDown = (e, field) => {\r\n    // Handle Escape key first so it always blurs without closing the modal\r\n    if (e.key === \"Escape\") {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      e.target.blur();\r\n      return;\r\n    }\r\n\r\n    // Handle Enter key - add discount if both fields have values\r\n    if (e.key === \"Enter\" && showSettings) {\r\n      if (newDesc && newValue) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        handleAddDiscount();\r\n        return;\r\n      }\r\n    }\r\n\r\n    // For the value field, only allow numbers and control keys\r\n    if (field === 'value') {\r\n      // Allow: backspace, delete, tab, escape, enter, arrows, home, end\r\n      if ([8, 9, 27, 13, 37, 38, 39, 40, 35, 36, 46].includes(e.keyCode) ||\r\n          // Allow: Ctrl+A, Ctrl+C, Ctrl+X, Ctrl+V, Ctrl+Z, Ctrl+Y\r\n          (e.ctrlKey && [65, 67, 88, 86, 90, 89].includes(e.keyCode)) ||\r\n          // Allow: numbers on top of keyboard and numpad\r\n          (e.keyCode >= 48 && e.keyCode <= 57) ||\r\n          (e.keyCode >= 96 && e.keyCode <= 105)) {\r\n        // Let it happen, don't do anything\r\n        return;\r\n      }\r\n      // Ensure that it is a number and stop the keypress\r\n      if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {\r\n        e.preventDefault();\r\n      }\r\n    }\r\n  };\r\n\r\n  // When switching to settings view, focus the name field for immediate typing\r\n  useEffect(() => {\r\n    if (isOpen && showSettings) {\r\n      requestAnimationFrame(() => {\r\n        descInputRef.current?.focus();\r\n        descInputRef.current?.select?.();\r\n      });\r\n    }\r\n  }, [isOpen, showSettings]);\r\n\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n    const fetchDiscounts = async () => {\r\n      setLoading(true);\r\n      setError(\"\");\r\n      try {\r\n        const token = sessionStorage.getItem(\"auth_token\");\r\n        const data = await api(\"/api/discounts\", {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        const discountList = (data || []).map(d => ({\r\n          label: d.discount_name || `${d.discount_percentage}% off`,\r\n          value: d.discount_percentage,\r\n          discount_id: d.discount_id,\r\n          type: \"percentage\"\r\n        }));\r\n        \r\n        setDiscounts(discountList);\r\n      } catch (e) {\r\n        setError(\"Failed to load discounts\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchDiscounts();\r\n  }, [isOpen]);\r\n\r\n  const handleAddDiscount = async () => {\r\n    if (!newDesc || !newValue) return;\r\n    setSaving(true);\r\n    try {\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n      const payload = { \r\n        discount_name: newDesc, \r\n        discount_percentage: Number(newValue) \r\n      };\r\n      \r\n      const created = await api(\"/api/discounts\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n      \r\n      setDiscounts(prev => [\r\n        ...prev,\r\n        {\r\n          label: created.discount_name || newDesc,\r\n          value: created.discount_percentage,\r\n          discount_id: created.discount_id,\r\n          type: \"percentage\"\r\n        }\r\n      ]);\r\n      \r\n      setNewDesc(\"\");\r\n      setNewValue(\"\");\r\n    } catch (e) {\r\n      console.error(\"Failed to add discount:\", e);\r\n      setError(\"Failed to add discount. Please try again.\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * REFACTORED: This function now only sets the state to open the custom confirmation modal.\r\n   * It no longer uses window.confirm.\r\n   */\r\n  const handleRemove = async (discountId) => {\r\n    if (!discountId) return;\r\n    \r\n    const id = Number(discountId);\r\n    if (isNaN(id)) {\r\n      setError(\"Invalid discount ID\");\r\n      return;\r\n    }\r\n    \r\n    const discountToDelete = discounts.find(d => Number(d.discount_id) === id);\r\n    if (!discountToDelete) {\r\n      setError(\"Discount not found in the list\");\r\n      return;\r\n    }\r\n    \r\n    // Open custom confirmation modal\r\n    setDeleteConfirmation({ isOpen: true, id: id, label: discountToDelete.label });\r\n  };\r\n\r\n  const cancelDelete = useCallback(() => {\r\n    setDeleteConfirmation({ isOpen: false, id: null, label: '' });\r\n  }, []);\r\n\r\n  const confirmDelete = async () => {\r\n    const id = deleteConfirmation.id;\r\n    if (!id) return;\r\n\r\n    try {\r\n      setSaving(true);\r\n      setError(\"\");\r\n      \r\n      // Make the API call to delete the discount\r\n      await api(`/api/discounts/${id}`, {\r\n        method: \"DELETE\",\r\n      });\r\n      \r\n      // Update local state to remove the deleted discount\r\n      setDiscounts(prev => {\r\n        const deletedIndex = prev.findIndex(d => Number(d.discount_id) === id);\r\n        const newDiscounts = prev.filter(d => Number(d.discount_id) !== id);\r\n        \r\n        // Adjust selected indices if needed\r\n        if (deletedIndex !== -1) {\r\n          setSelectedIdx(prevIdx => {\r\n            if (prevIdx === deletedIndex) return Math.max(0, deletedIndex - 1);\r\n            if (prevIdx > deletedIndex) return prevIdx - 1;\r\n            return prevIdx;\r\n          });\r\n          \r\n          setSettingsSelectedIdx(prevIdx => {\r\n            if (prevIdx === deletedIndex) return Math.max(0, deletedIndex - 1);\r\n            if (prevIdx > deletedIndex) return prevIdx - 1;\r\n            return prevIdx;\r\n          });\r\n        }\r\n        \r\n        return newDiscounts;\r\n      });\r\n      \r\n      cancelDelete(); // Close the confirmation modal\r\n      \r\n    } catch (error) {\r\n      console.error(\"Failed to remove discount:\", error);\r\n      \r\n      // Handle 404 - discount not found\r\n      if (error.message && error.message.includes(\"not found\")) {\r\n        // Refresh the discount list from the server\r\n        try {\r\n          const token = sessionStorage.getItem(\"auth_token\");\r\n          const data = await api(\"/api/discounts\", {\r\n            headers: { Authorization: `Bearer ${token}` },\r\n          });\r\n          setDiscounts((data || []).map(d => ({\r\n            label: d.discount_name || `${d.discount_percentage}% off`,\r\n            value: d.discount_percentage,\r\n            discount_id: d.discount_id,\r\n            type: \"percentage\"\r\n          })));\r\n          setError(\"Discount not found. List has been refreshed.\");\r\n          cancelDelete(); // Close the confirmation modal even on 404\r\n        } catch (refreshError) {\r\n          console.error(\"Failed to refresh discounts:\", refreshError);\r\n          setError(\"Discount not found. Could not refresh list.\");\r\n        }\r\n      } else {\r\n        // For other errors\r\n        setError(error.message || \"Failed to remove discount. Please try again.\");\r\n      }\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleSaveSettings = () => {\r\n    setShowSettings(false);\r\n  };\r\n\r\n  const handleApplyDiscount = () => {\r\n    if (selectedIdx == null) return;\r\n    const discount = discounts[selectedIdx];\r\n    if (!discount) return;\r\n    onApplyDiscount({\r\n      type: discount.type,\r\n      value: discount.value,\r\n      label: discount.label,\r\n      discount_id: discount.discount_id,\r\n    });\r\n    onClose();\r\n  };\r\n\r\n  const applyDiscountByIndex = (idx) => {\r\n    const discount = discounts[idx];\r\n    if (!discount) return;\r\n    setSelectedIdx(idx);\r\n    onApplyDiscount({\r\n      type: discount.type,\r\n      value: discount.value,\r\n      label: discount.label,\r\n      discount_id: discount.discount_id,\r\n    });\r\n    onClose();\r\n  };\r\n\r\n  // Settings Footer\r\n  const settingsFooterContent = (\r\n    <Button\r\n      label={\r\n        <div className=\"w-full flex items-center justify-between\">\r\n          <span>Save Settings</span>\r\n          <span className=\"text-xs font-mono bg-white/20 px-2 py-0.5 rounded\">\r\n            Enter\r\n          </span>\r\n        </div>\r\n      }\r\n      variant=\"primary\"\r\n      onClick={handleSaveSettings}\r\n      className=\"w-full\"\r\n    />\r\n  );\r\n\r\n  // Main Footer\r\n  const mainFooterContent = (\r\n    <div className=\"w-full space-y-2\">\r\n      <Button\r\n        label={\r\n          <div className=\"w-full flex items-center justify-between\">\r\n            <span>Apply Discount</span>\r\n            <span className=\"text-xs font-mono bg-white/20 px-2 py-0.5 rounded\">\r\n              Enter\r\n            </span>\r\n          </div>\r\n        }\r\n        variant=\"primary\"\r\n        onClick={handleApplyDiscount}\r\n        disabled={selectedIdx === null}\r\n        className=\"w-full\"\r\n      />\r\n      <Button\r\n        label={\r\n          <div className=\"w-full flex items-center justify-between\">\r\n            <span>Manage Discounts</span>\r\n            <span className=\"text-xs font-mono bg-gray-100 px-2 py-0.5 rounded text-gray-700\">\r\n              M\r\n            </span>\r\n          </div>\r\n        }\r\n        variant=\"secondary\"\r\n        onClick={() => setShowSettings(true)}\r\n        className=\"w-full\"\r\n      />\r\n    </div>\r\n  );\r\n\r\n\r\n  // Scroll selected discount into view\r\n  useEffect(() => {\r\n    if (showSettings && discountListRef.current && settingsSelectedIdx !== null) {\r\n      const container = discountListRef.current;\r\n      const selectedElement = container.querySelector(`[data-discount-idx=\"${settingsSelectedIdx}\"]`);\r\n      if (selectedElement) {\r\n        selectedElement.scrollIntoView({\r\n          behavior: 'smooth',\r\n          block: 'nearest',\r\n          inline: 'nearest'\r\n        });\r\n      }\r\n    }\r\n  }, [settingsSelectedIdx, showSettings]);\r\n\r\n  // Auto-clear error messages after 5 seconds\r\n  useEffect(() => {\r\n    if (error) {\r\n      const timer = setTimeout(() => setError(\"\"), 5000);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [error]);\r\n\r\n  // Handle keyboard shortcuts\r\n  useKeyboardShortcuts(\r\n    [\r\n      // Escape key - close modal or confirmation modal\r\n      {\r\n        key: \"escape\",\r\n        action: (e) => {\r\n          if (deleteConfirmation.isOpen) {\r\n            cancelDelete();\r\n            return;\r\n          }\r\n          if (isTypingTarget(e?.target)) {\r\n            e.target.blur?.();\r\n            return;\r\n          }\r\n          onClose();\r\n        },\r\n        enabled: isOpen,\r\n        allowWhileTyping: true,\r\n        stopPropagation: true,\r\n        preventDefault: true\r\n      },\r\n      // Enter key - apply, save settings, or add discount depending on context\r\n      {\r\n        key: \"enter\",\r\n        action: (e) => {\r\n          // If confirmation modal is open, confirm deletion\r\n          if (deleteConfirmation.isOpen) {\r\n            e.preventDefault();\r\n            confirmDelete();\r\n            return;\r\n          }\r\n          \r\n          // If we're in an input field, let the default behavior happen (but check for add discount)\r\n          if (isTypingTarget(e?.target)) {\r\n            // If we're in settings view and both fields have content, add a new discount\r\n            if (showSettings && newDesc && newValue) {\r\n              e.preventDefault();\r\n              handleAddDiscount();\r\n            }\r\n            return;\r\n          }\r\n          \r\n          // In settings view, save settings\r\n          if (showSettings) {\r\n            e.preventDefault();\r\n            handleSaveSettings();\r\n            return;\r\n          }\r\n          \r\n          // In main view, apply the selected discount\r\n          handleApplyDiscount();\r\n        },\r\n        enabled: isOpen,\r\n        allowWhileTyping: true,\r\n        stopPropagation: true,\r\n        preventDefault: true\r\n      },\r\n      // M key - toggle manage discounts\r\n      {\r\n        key: \"m\",\r\n        action: (e) => {\r\n          if (isTypingTarget(e?.target) || deleteConfirmation.isOpen) return;\r\n          setShowSettings((prev) => !prev);\r\n        },\r\n        enabled: isOpen,\r\n        allowWhileTyping: false,\r\n        stopPropagation: true,\r\n        preventDefault: true\r\n      },\r\n      // Number keys 1-9 - select and apply discount (only when not typing)\r\n      ...Array.from({ length: 9 }).map((_, i) => ({\r\n        key: String(i + 1),\r\n        action: (e) => {\r\n          if (isTypingTarget(e?.target) || deleteConfirmation.isOpen) return;\r\n          if (!showSettings && discounts[i]) {\r\n            applyDiscountByIndex(i);\r\n          }\r\n        },\r\n        enabled: isOpen && !showSettings && discounts[i],\r\n        allowWhileTyping: false,\r\n        stopPropagation: true,\r\n        preventDefault: true\r\n      })),\r\n      // Arrow navigation for main list (ignore while typing)\r\n      {\r\n        key: \"arrowup\",\r\n        action: (e) => {\r\n          if (isTypingTarget(e?.target) || deleteConfirmation.isOpen) return;\r\n          if (showSettings || discounts.length === 0) return;\r\n          setSelectedIdx((prev) => {\r\n            if (prev == null) return 0;\r\n            return prev > 0 ? prev - 1 : 0;\r\n          });\r\n        },\r\n        enabled: isOpen && !showSettings,\r\n        allowWhileTyping: false,\r\n        stopPropagation: true,\r\n        preventDefault: true,\r\n      },\r\n      {\r\n        key: \"arrowdown\",\r\n        action: (e) => {\r\n          if (isTypingTarget(e?.target) || deleteConfirmation.isOpen) return;\r\n          if (showSettings || discounts.length === 0) return;\r\n          setSelectedIdx((prev) => {\r\n            if (prev == null) return 0;\r\n            return Math.min(prev + 1, discounts.length - 1);\r\n          });\r\n        },\r\n        enabled: isOpen && !showSettings,\r\n        allowWhileTyping: false,\r\n        stopPropagation: true,\r\n        preventDefault: true,\r\n      },\r\n      // Focus description field\r\n      {\r\n        key: \"n\",\r\n        action: (e) => {\r\n          if (isTypingTarget(e?.target) && e.target !== descInputRef.current) return;\r\n          if (!showSettings || deleteConfirmation.isOpen) return;\r\n          setTimeout(() => {\r\n            descInputRef.current?.focus();\r\n            descInputRef.current?.select?.();\r\n          }, 0);\r\n        },\r\n        enabled: isOpen && showSettings,\r\n        allowWhileTyping: true,\r\n        stopPropagation: false,\r\n        preventDefault: false,\r\n      },\r\n      // Focus value field\r\n      {\r\n        key: \"v\",\r\n        action: (e) => {\r\n          if (isTypingTarget(e?.target) && e.target !== valueInputRef.current) return;\r\n          if (!showSettings || deleteConfirmation.isOpen) return;\r\n          setTimeout(() => {\r\n            valueInputRef.current?.focus();\r\n            valueInputRef.current?.select?.();\r\n          }, 0);\r\n        },\r\n        enabled: isOpen && showSettings,\r\n        allowWhileTyping: true,\r\n        stopPropagation: false,\r\n        preventDefault: false,\r\n      },\r\n      // Manage: navigate rows (ignore while typing in inputs)\r\n      {\r\n        key: \"arrowup\",\r\n        action: (e) => {\r\n          if (isTypingTarget(e?.target) || deleteConfirmation.isOpen) return;\r\n          if (!showSettings || discounts.length === 0) return;\r\n          setSettingsSelectedIdx((prev) => Math.max(0, prev - 1));\r\n        },\r\n        enabled: isOpen && showSettings,\r\n        allowWhileTyping: false,\r\n        stopPropagation: true,\r\n        preventDefault: true,\r\n      },\r\n      {\r\n        key: \"arrowdown\",\r\n        action: (e) => {\r\n          if (isTypingTarget(e?.target) || deleteConfirmation.isOpen) return;\r\n          if (!showSettings || discounts.length === 0) return;\r\n          setSettingsSelectedIdx((prev) =>\r\n            Math.min(discounts.length - 1, (prev ?? 0) + 1)\r\n          );\r\n        },\r\n        enabled: isOpen && showSettings,\r\n        allowWhileTyping: false,\r\n        stopPropagation: true,\r\n        preventDefault: true,\r\n      },\r\n      // Manage: delete focused row (ignore while typing)\r\n      {\r\n        key: \"delete\",\r\n        action: (e) => {\r\n          if (isTypingTarget(e?.target) || deleteConfirmation.isOpen) return;\r\n          if (!showSettings || discounts.length === 0) return;\r\n          const target = discounts[settingsSelectedIdx];\r\n          if (target?.discount_id) handleRemove(target.discount_id);\r\n        },\r\n        enabled: isOpen && showSettings,\r\n        allowWhileTyping: false,\r\n        stopPropagation: true,\r\n        preventDefault: true,\r\n      },\r\n    ],\r\n    [\r\n      isOpen,\r\n      showSettings,\r\n      discounts,\r\n      selectedIdx,\r\n      handleApplyDiscount,\r\n      handleSaveSettings,\r\n      onClose,\r\n      settingsSelectedIdx,\r\n      handleAddDiscount,\r\n      deleteConfirmation.isOpen,\r\n      confirmDelete,\r\n      cancelDelete,\r\n    ]\r\n  );\r\n\r\n  // Main Discount Modal\r\n  const renderMain = () => {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h3 className=\"text-lg font-medium\">Select Discount</h3>\r\n          <span className=\"text-sm text-gray-500\">Press 1-9 or ↑/↓, Enter to apply</span>\r\n        </div>\r\n        <div className=\"grid grid-cols-3 gap-2 mb-4 max-h-64 overflow-y-auto\">\r\n          {discounts.map((d, idx) => (\r\n            <button\r\n              key={`${d.type}-${idx}`}\r\n              className={`p-3 border rounded text-center ${\r\n                selectedIdx === idx\r\n                  ? \"border-blue-500 bg-blue-50\"\r\n                  : \"border-gray-200 hover:bg-gray-50\"\r\n              } relative group`}\r\n              onClick={() => setSelectedIdx(idx)}\r\n            >\r\n              <div className=\"font-medium\">{d.label}</div>\r\n              <div className=\"text-sm text-gray-500\">{d.value}%</div>\r\n              {selectedIdx === idx && (\r\n                <div className=\"absolute bottom-1 right-1 text-xs text-blue-500\">\r\n                  Press Enter to apply\r\n                </div>\r\n              )}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Settings Modal Content\r\n  const renderSettings = () => (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"flex gap-2\">\r\n        <button\r\n          className={`flex-1 px-4 py-2 rounded-lg font-semibold text-sm transition-all ${\r\n            settingsTab === \"PERCENTAGE\" ? \"bg-blue-600 text-white\" : \"bg-gray-200 text-gray-700\"\r\n          }`}\r\n          onClick={() => setSettingsTab(\"PERCENTAGE\")}\r\n        >\r\n          Percentage\r\n        </button>\r\n      </div>\r\n\r\n      {/* Discount List */}\r\n      <div \r\n        ref={discountListRef}\r\n        className=\"space-y-2 max-h-60 overflow-y-auto pr-2 -mr-2\"\r\n      >\r\n        {discounts.map((d, idx) => (\r\n          <div\r\n            key={idx}\r\n            data-discount-idx={idx}\r\n            className={`flex gap-2 items-center bg-gray-50 p-3 rounded-lg transition-all ${\r\n              settingsSelectedIdx === idx ? \"ring-2 ring-blue-400 bg-blue-50\" : \"hover:bg-gray-100\"\r\n            }`}\r\n          >\r\n            <input\r\n              className=\"flex-1 bg-transparent outline-none text-sm font-medium\"\r\n              value={d.label}\r\n              readOnly\r\n            />\r\n            <input\r\n              className=\"w-20 bg-transparent text-center outline-none text-sm font-medium\"\r\n              value={d.value}\r\n              readOnly\r\n            />\r\n            <button\r\n              className=\"text-red-500 hover:text-red-700 transition-colors p-1\"\r\n              onClick={() => handleRemove(d.discount_id)}\r\n              title=\"Remove (Del)\"\r\n              type=\"button\"\r\n            >\r\n              <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                className=\"w-5 h-5\"\r\n                fill=\"none\"\r\n                viewBox=\"0 0 24 24\"\r\n                stroke=\"currentColor\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M6 18L18 6M6 6l12 12\"\r\n                />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Add new discount */}\r\n      <div\r\n        className=\"space-y-2 p-4 bg-blue-50 rounded-lg border border-blue-200\"\r\n        onKeyDown={(e) => {\r\n          if (e.key === \"Enter\") {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            handleAddDiscount();\r\n          }\r\n        }}\r\n      >\r\n        <div className=\"text-sm font-semibold text-blue-900 mb-2\">\r\n          Add New Discount (N=Name, V=Value, Enter=Add)\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <input\r\n            className=\"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            placeholder=\"Description\"\r\n            value={newDesc}\r\n            ref={descInputRef}\r\n            onKeyDown={(e) => handleInputKeyDown(e, 'desc')}\r\n            onFocus={() => setShowSettings(true)} // Ensure we're in settings mode when focused\r\n            onChange={(e) => setNewDesc(e.target.value)}\r\n          />\r\n          <input\r\n            className=\"w-24 border border-gray-300 rounded-lg px-3 py-2 text-sm text-center focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            placeholder={settingsTab === \"PERCENTAGE\" ? \"0%\" : \"0.00\"}\r\n            inputMode={settingsTab === \"PERCENTAGE\" ? \"numeric\" : \"decimal\"}\r\n            value={newValue}\r\n            ref={valueInputRef}\r\n            onKeyDown={(e) => handleInputKeyDown(e, 'value')}\r\n            onFocus={() => setShowSettings(true)} // Ensure we're in settings mode when focused\r\n            onChange={(e) => setNewValue(e.target.value)}\r\n            type=\"number\"\r\n            min=\"0\"\r\n          />\r\n          <button\r\n            className=\"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-bold\"\r\n            onClick={handleAddDiscount}\r\n            title=\"Add (Enter)\"\r\n            type=\"button\"\r\n            disabled={saving}\r\n          >\r\n            {saving ? \"...\" : \"+\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <>\r\n      {/* Primary Discount Modal */}\r\n      <BaseModal\r\n        isOpen={isOpen && !deleteConfirmation.isOpen} // Only open if delete modal is not open\r\n        onClose={onClose}\r\n        title={showSettings ? \"Manage Discounts\" : \"Select Discount\"}\r\n        subtitle={\r\n          showSettings\r\n            ? \"Add or remove discount options\"\r\n            : \"Choose a discount to apply\"\r\n        }\r\n        icon={\r\n          <svg\r\n            className=\"w-5 h-5 text-white\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z\"\r\n            />\r\n          </svg>\r\n        }\r\n        footer={showSettings ? settingsFooterContent : mainFooterContent}\r\n        size=\"md\"\r\n        contentClassName=\"space-y-4\"\r\n      >\r\n        {error && (\r\n          <div className=\"text-sm text-red-700 bg-red-50 border border-red-200 rounded-lg px-3 py-2\">\r\n            {error}\r\n          </div>\r\n        )}\r\n        {showSettings ? renderSettings() : renderMain()}\r\n        \r\n        {/* Keyboard Shortcuts Guide */}\r\n        <div className=\"mt-4 pt-3 border-t border-gray-200\">\r\n          <div className=\"text-xs text-gray-500 space-y-1\">\r\n            {showSettings ? (\r\n              <>\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span>Move selection:</span>\r\n                  <span className=\"font-mono bg-gray-100 px-2 py-0.5 rounded\">↑ ↓</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span>Delete selected:</span>\r\n                  <span className=\"font-mono bg-gray-100 px-2 py-0.5 rounded\">Del</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span>Focus name / value:</span>\r\n                  <span className=\"font-mono bg-gray-100 px-2 py-0.5 rounded\">N / V</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span>Add/Save:</span>\r\n                  <span className=\"font-mono bg-gray-100 px-2 py-0.5 rounded\">Enter</span>\r\n                </div>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span>Select discount:</span>\r\n                  <span className=\"font-mono bg-gray-100 px-2 py-0.5 rounded\">1-9 / ↑↓</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span>Apply selected:</span>\r\n                  <span className=\"font-mono bg-gray-100 px-2 py-0.5 rounded\">Enter</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span>Manage discounts:</span>\r\n                  <span className=\"font-mono bg-gray-100 px-2 py-0.5 rounded\">M</span>\r\n                </div>\r\n              </>\r\n            )}\r\n            <div className=\"flex items-center justify-between pt-1 border-t border-gray-100 mt-1\">\r\n              <span>Close modal:</span>\r\n              <span className=\"font-mono bg-gray-100 px-2 py-0.5 rounded\">Esc</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </BaseModal>\r\n\r\n      {/* Custom Delete Confirmation Modal */}\r\n      <BaseModal\r\n        isOpen={deleteConfirmation.isOpen}\r\n        onClose={cancelDelete}\r\n        title=\"Confirm Discount Deletion\"\r\n        subtitle=\"This action cannot be undone.\"\r\n        size=\"sm\"\r\n        footer={\r\n          <div className=\"flex justify-end space-x-2 w-full\">\r\n            <Button \r\n              label=\"Cancel\" \r\n              variant=\"secondary\" \r\n              onClick={cancelDelete} \r\n              disabled={saving}\r\n            />\r\n            <Button \r\n              label={saving ? \"Deleting...\" : \"Delete Discount\"} \r\n              variant=\"danger\" \r\n              onClick={confirmDelete} \r\n              disabled={saving}\r\n            />\r\n          </div>\r\n        }\r\n      >\r\n        <div className=\"p-4 bg-red-50 border border-red-200 rounded-lg\">\r\n          <p className=\"text-sm text-red-700\">\r\n            Are you sure you want to permanently delete the discount: \r\n            <strong className=\"block mt-1 text-base font-semibold\">{deleteConfirmation.label}</strong>\r\n          </p>\r\n        </div>\r\n      </BaseModal>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default DiscountModal;","import React, { useState, useEffect } from \"react\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport Button from \"../common/Button\";\r\nimport { api } from \"../../lib/api\";\r\nimport {\r\n  MdAccountBalanceWallet,\r\n  MdSwapHoriz,\r\n  MdDescription,\r\n  MdChevronRight,\r\n} from \"react-icons/md\";\r\nimport { useKeyboardShortcuts } from \"../../hooks/useKeyboardShortcuts\";\r\n\r\nfunction CashLedgerModal({ isOpen, onClose }) {\r\n  // Tab state: \"SUMMARY\" or \"TRANSACTIONS\"\r\n  const [tab, setTab] = useState(\"SUMMARY\");\r\n  // Track which payment type is selected for filtered transactions view\r\n  const [selectedPaymentType, setSelectedPaymentType] = useState(null);\r\n\r\n  // Live data from backend\r\n  const [ledger, setLedger] = useState([]); // [{ name, balance }]\r\n  const [transactions, setTransactions] = useState([]);\r\n  const [loadingSummary, setLoadingSummary] = useState(false);\r\n  const [loadingTx, setLoadingTx] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n\r\n\r\n  // Fetch summary balances\r\n  const fetchLedger = async () => {\r\n    setLoadingSummary(true);\r\n    try {\r\n      setError(\"\");\r\n      const data = await api('/stats/cash-ledger');\r\n      // Expecting [{ name, balance }]\r\n      setLedger(Array.isArray(data) ? data : []);\r\n    } catch (err) {\r\n      setError(err.message || 'Failed to load cash ledger');\r\n    } finally {\r\n      setLoadingSummary(false);\r\n    }\r\n  };\r\n\r\n  // Fetch transactions (optionally filtered)\r\n  const fetchTransactions = async (paymentType = null) => {\r\n    setLoadingTx(true);\r\n    try {\r\n      setError(\"\");\r\n      const q = paymentType ? `/stats/cash-transactions?payment_type=${encodeURIComponent(paymentType)}&limit=100` : `/stats/cash-transactions?limit=100`;\r\n      const data = await api(q);\r\n      setTransactions(Array.isArray(data) ? data : []);\r\n    } catch (err) {\r\n      setError(err.message || 'Failed to load transactions');\r\n    } finally {\r\n      setLoadingTx(false);\r\n    }\r\n  };\r\n\r\n  // Load when modal opens\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n    fetchLedger();\r\n    fetchTransactions();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [isOpen]);\r\n\r\n  useKeyboardShortcuts(\r\n    [\r\n      {\r\n        key: \"escape\",\r\n        action: onClose,\r\n        enabled: isOpen,\r\n        allowWhileTyping: true,\r\n      },\r\n      {\r\n        key: \"1\",\r\n        action: () => {\r\n          setTab(\"SUMMARY\");\r\n          setSelectedPaymentType(null);\r\n        },\r\n        enabled: isOpen,\r\n      },\r\n      {\r\n        key: \"2\",\r\n        action: () => {\r\n          setTab(\"TRANSACTIONS\");\r\n          setSelectedPaymentType(null);\r\n        },\r\n        enabled: isOpen,\r\n      },\r\n    ],\r\n    [isOpen, tab]\r\n  );\r\n\r\n  // Summary Page Component\r\n  const renderSummary = () => {\r\n    const totalCash = ledger.reduce((sum, type) => sum + (Number(type.balance) || 0), 0);\r\n\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        {/* Total Cash Display */}\r\n        <div className=\"bg-gradient-to-br from-blue-500 via-blue-600 to-indigo-700 text-white rounded-lg shadow-xl px-8 py-8 text-center\">\r\n          <p className=\"text-sm font-semibold text-blue-100 mb-2\">Total Cash on Hand</p>\r\n          <div className=\"text-5xl font-bold flex items-center justify-center gap-2\">\r\n            <span className=\"text-4xl\">₱</span>\r\n            {totalCash.toFixed(2)}\r\n          </div>\r\n          <p className=\"text-blue-100 text-sm mt-3\">\r\n            {new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}\r\n          </p>\r\n        </div>\r\n\r\n        {/* Payment Types Section */}\r\n        <div>\r\n          <div className=\"flex items-center gap-2 mb-4\">\r\n            <div className=\"w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center\">\r\n              <MdAccountBalanceWallet className=\"w-5 h-5 text-white\" />\r\n            </div>\r\n            <h3 className=\"font-semibold text-gray-900\">Payment Methods</h3>\r\n          </div>\r\n          <div className=\"space-y-3\">\r\n            {loadingSummary ? (\r\n              <div className=\"text-sm text-gray-500\">Loading...</div>\r\n            ) : ledger.length === 0 ? (\r\n              <div className=\"text-sm text-gray-500\">No balances available</div>\r\n            ) : (\r\n              ledger.map((type) => (\r\n                <button\r\n                  key={type.name}\r\n                  onClick={async () => {\r\n                    setSelectedPaymentType(type.name);\r\n                    setTab('TRANSACTIONS');\r\n                    await fetchTransactions(type.name);\r\n                  }}\r\n                  className=\"w-full bg-gradient-to-r from-gray-50 to-gray-100/50 hover:from-blue-50 hover:to-indigo-50/50 rounded-2xl p-4 border border-gray-200/50 hover:border-blue-300 transition-all duration-200 group\"\r\n                >\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-3 flex-1\">\r\n                      <div className=\"w-10 h-10 bg-white rounded-lg flex items-center justify-center border border-gray-200 group-hover:border-blue-300 group-hover:bg-blue-50 transition-all\">\r\n                        <svg className=\"w-5 h-5 text-gray-600 group-hover:text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                        </svg>\r\n                      </div>\r\n                      <div className=\"text-left\">\r\n                        <p className=\"font-semibold text-gray-900\">{type.name}</p>\r\n                        <p className=\"text-xs text-gray-500\">View transactions</p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className=\"text-right\">\r\n                        <p className=\"text-lg font-bold text-blue-600\">₱{(Number(type.balance) || 0).toFixed(2)}</p>\r\n                      </div>\r\n                      <MdChevronRight className=\"w-5 h-5 text-gray-400 group-hover:text-blue-600 transition-colors\" />\r\n                    </div>\r\n                  </div>\r\n                </button>\r\n              ))\r\n            )}\r\n          </div>\r\n        </div>\r\n        {error && (\r\n          <div className=\"text-sm text-red-600\">\r\n            {error.includes('Server returned an HTML error page') || error.includes('Cannot GET')\r\n              ? 'Unable to reach backend API. Check backend server and proxy configuration.'\r\n              : error}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Transactions Page\r\n  const renderTransactions = () => {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        {/* Transactions Title */}\r\n        <div className=\"bg-gradient-to-r from-indigo-50 to-blue-50 rounded-2xl p-4 border border-indigo-100/50\">\r\n          <h3 className=\"font-bold text-lg text-gray-900\">{selectedPaymentType ? `${selectedPaymentType} Transactions` : 'All Transactions'}</h3>\r\n          <p className=\"text-sm text-gray-600 mt-1\">{loadingTx ? 'Loading...' : `${transactions.length} transaction${transactions.length !== 1 ? 's' : ''} found`}</p>\r\n        </div>\r\n\r\n        {/* Transactions Table */}\r\n        <div className=\"bg-white rounded-2xl border border-gray-200/50 overflow-hidden\">\r\n          {loadingTx ? (\r\n            <div className=\"text-center py-12 text-sm text-gray-500\">Loading transactions...</div>\r\n          ) : transactions.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <svg className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\r\n              </svg>\r\n              <p className=\"text-gray-500 font-medium\">No transactions found</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full\">\r\n                <thead>\r\n                  <tr className=\"bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200/50\">\r\n                    <th className=\"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider\">Date & Time</th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider\">Type</th>\r\n                    <th className=\"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider\">Amount</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"divide-y divide-gray-100\">\r\n                  {transactions.map((tx) => (\r\n                    <tr key={String(tx.transaction_id)} className=\"hover:bg-blue-50/50 transition-colors duration-150\">\r\n                      <td className=\"px-6 py-4 text-sm text-gray-600 font-medium\">{new Date(tx.created_at).toLocaleString()}</td>\r\n                      <td className=\"px-6 py-4 text-sm\"><span className=\"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-800 border border-blue-200\">{tx.payment_type}</span></td>\r\n                      <td className=\"px-6 py-4 text-sm text-right font-bold text-green-600\">₱{(Number(tx.total) || 0).toFixed(2)}</td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Tab button content\r\n  const tabContent = (\r\n    <div className=\"flex gap-2 border-t border-gray-200/50 pt-4 mt-4\">\r\n      <button\r\n        onClick={() => {\r\n          setTab(\"SUMMARY\");\r\n          setSelectedPaymentType(null);\r\n        }}\r\n        className={`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl font-semibold transition-all ${\r\n          tab === \"SUMMARY\"\r\n            ? \"bg-blue-600 text-white shadow-md\"\r\n            : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\r\n        }`}\r\n      >\r\n        <MdDescription className=\"w-5 h-5\" />\r\n        <span>Summary (1)</span>\r\n      </button>\r\n      <button\r\n        onClick={() => {\r\n          setTab(\"TRANSACTIONS\");\r\n          setSelectedPaymentType(null);\r\n        }}\r\n        className={`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl font-semibold transition-all ${\r\n          tab === \"TRANSACTIONS\"\r\n            ? \"bg-blue-600 text-white shadow-md\"\r\n            : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\r\n        }`}\r\n      >\r\n        <MdSwapHoriz className=\"w-5 h-5\" />\r\n        <span>Transactions (2)</span>\r\n      </button>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Cash Ledger\"\r\n      subtitle=\"View cash balance and payment methods\"\r\n      icon={<MdAccountBalanceWallet className=\"w-6 h-6 text-white\" />}\r\n      size=\"lg\"\r\n      contentClassName=\"space-y-4\"\r\n    >\r\n      <div className=\"space-y-6\">\r\n        {tab === \"SUMMARY\" ? renderSummary() : renderTransactions()}\r\n        {tabContent}\r\n        <div className=\"text-xs text-gray-600 bg-gray-50 border border-gray-200 rounded-lg px-3 py-2\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <span>Summary view:</span>\r\n            <span className=\"font-mono bg-white px-2 py-0.5 rounded\">1</span>\r\n          </div>\r\n          <div className=\"flex items-center justify-between\">\r\n            <span>Transactions view:</span>\r\n            <span className=\"font-mono bg-white px-2 py-0.5 rounded\">2</span>\r\n          </div>\r\n          <div className=\"flex items-center justify-between\">\r\n            <span>Close:</span>\r\n            <span className=\"font-mono bg-white px-2 py-0.5 rounded\">Esc</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </BaseModal>\r\n  );\r\n}\r\n\r\nexport default CashLedgerModal;\r\n","import React from \"react\";\r\nimport Button from \"../common/Button\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport { useKeyboardShortcuts } from \"../../hooks/useKeyboardShortcuts\";\r\n\r\nfunction CheckoutModal({ isOpen, onClose, total, onSelectPayment }) {\r\n  useKeyboardShortcuts(\r\n    [\r\n      { key: \"1\", action: () => onSelectPayment(\"cash\"), enabled: isOpen },\r\n      { key: \"2\", action: () => onSelectPayment(\"gcash\"), enabled: isOpen },\r\n      { key: \"3\", action: () => onSelectPayment(\"maya\"), enabled: isOpen },\r\n      { key: \"enter\", action: () => onSelectPayment(\"cash\"), enabled: isOpen },\r\n      { key: \"escape\", action: onClose, enabled: isOpen },\r\n    ],\r\n    [isOpen]\r\n  );\r\n\r\n  const footerContent = (\r\n    <div className=\"w-full flex flex-col gap-3\">\r\n      <Button\r\n        label=\"CASH (1 / Enter)\"\r\n        className=\"w-full h-12 text-base font-bold\"\r\n        onClick={() => onSelectPayment(\"cash\")}\r\n      />\r\n      <Button\r\n        label=\"GCASH (2)\"\r\n        className=\"w-full h-12 text-base font-bold\"\r\n        onClick={() => onSelectPayment(\"gcash\")}\r\n      />\r\n      <Button\r\n        label=\"MAYA (3)\"\r\n        className=\"w-full h-12 text-base font-bold\"\r\n        onClick={() => onSelectPayment(\"maya\")}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Checkout\"\r\n      subtitle=\"Select payment method\"\r\n      icon={\r\n        <svg\r\n          className=\"w-5 h-5 text-white\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\"\r\n          />\r\n        </svg>\r\n      }\r\n      footer={footerContent}\r\n      size=\"sm\"\r\n      contentClassName=\"text-center\"\r\n    >\r\n      <div className=\"bg-blue-500 text-white rounded-2xl py-6 px-4 text-center mb-4\">\r\n        <div className=\"text-sm opacity-90 mb-2\">Total Amount</div>\r\n        <div className=\"text-4xl font-bold\">₱{total.toFixed(2)}</div>\r\n      </div>\r\n      <p className=\"text-gray-600 text-sm mb-4\">\r\n        Choose your preferred payment method\r\n      </p>\r\n      <div className=\"text-xs text-gray-600 bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 space-y-1\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <span>Cash:</span>\r\n          <span className=\"font-mono bg-white px-2 py-0.5 rounded\">1 / Enter</span>\r\n        </div>\r\n        <div className=\"flex items-center justify-between\">\r\n          <span>GCash:</span>\r\n          <span className=\"font-mono bg-white px-2 py-0.5 rounded\">2</span>\r\n        </div>\r\n        <div className=\"flex items-center justify-between\">\r\n          <span>Maya:</span>\r\n          <span className=\"font-mono bg-white px-2 py-0.5 rounded\">3</span>\r\n        </div>\r\n        <div className=\"flex items-center justify-between\">\r\n          <span>Close:</span>\r\n          <span className=\"font-mono bg-white px-2 py-0.5 rounded\">Esc</span>\r\n        </div>\r\n      </div>\r\n    </BaseModal>\r\n  );\r\n}\r\n\r\nexport default CheckoutModal;\r\n","import React from \"react\";\r\nimport Button from \"../common/Button\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport { useKeyboardShortcuts } from \"../../hooks/useKeyboardShortcuts\";\r\n\r\nfunction CashPaymentCompleteModal({\r\n  isOpen,\r\n  onClose,\r\n  change = 0,\r\n  payable = 0,\r\n  onReceipt,\r\n  onNewEntry,\r\n}) {\r\n  useKeyboardShortcuts(\r\n    [\r\n      {\r\n        key: \"escape\",\r\n        action: onClose,\r\n        enabled: isOpen,\r\n        allowWhileTyping: true,\r\n      },\r\n      {\r\n        key: \"enter\",\r\n        action: () => {\r\n          if (onReceipt) onReceipt();\r\n        },\r\n        enabled: isOpen,\r\n        allowWhileTyping: true,\r\n      },\r\n    ],\r\n    [isOpen]\r\n  );\r\n\r\n  const footerContent = (\r\n    <div className=\"w-full flex flex-col gap-3\">\r\n      <Button\r\n        label=\"RECEIPT (Enter)\"\r\n        className=\"w-full h-11 text-sm font-semibold bg-blue-700 hover:bg-blue-800 text-white\"\r\n        onClick={() => {\r\n          if (onReceipt) onReceipt();\r\n          else alert(\"Receipt\");\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Payment Complete\"\r\n      icon={\r\n        <svg\r\n          className=\"w-5 h-5 text-white\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M5 13l4 4L19 7\"\r\n          />\r\n        </svg>\r\n      }\r\n      footer={footerContent}\r\n      size=\"sm\"\r\n      contentClassName=\"text-center space-y-4\"\r\n    >\r\n      {/* Success Check Icon */}\r\n      <div className=\"flex justify-center mb-2\">\r\n        <div className=\"w-14 h-14 rounded-full bg-green-100 flex items-center justify-center\">\r\n          <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            className=\"h-7 w-7 text-green-600\"\r\n            fill=\"none\"\r\n            viewBox=\"0 0 24 24\"\r\n            stroke=\"currentColor\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M5 13l4 4L19 7\"\r\n            />\r\n          </svg>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Change Amount */}\r\n      <div className=\"bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl p-5 text-white\">\r\n        <div className=\"text-xs uppercase tracking-wide opacity-90 mb-2\">\r\n          Change\r\n        </div>\r\n\r\n        <div className=\"inline-flex items-baseline gap-2 bg-white text-blue-700 rounded-lg px-4 py-3 shadow-md\">\r\n          <span className=\"text-lg font-bold\">₱</span>\r\n          <span className=\"text-2xl font-bold\">\r\n            {Number(change).toFixed(2)}\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"mt-4 text-sm opacity-90\">Payable</div>\r\n        <div className=\"text-sm font-semibold\">\r\n          ₱{Number(payable).toFixed(2)}\r\n        </div>\r\n      </div>\r\n      <div className=\"text-xs text-gray-600 bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 space-y-1\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <span>Print / open receipt:</span>\r\n          <span className=\"font-mono bg-white px-2 py-0.5 rounded\">Enter</span>\r\n        </div>\r\n        <div className=\"flex items-center justify-between\">\r\n          <span>Close:</span>\r\n          <span className=\"font-mono bg-white px-2 py-0.5 rounded\">Esc</span>\r\n        </div>\r\n      </div>\r\n    </BaseModal>\r\n  );\r\n}\r\n\r\nexport default CashPaymentCompleteModal;\r\n","import React, { useState, useRef } from \"react\";\r\nimport Button from \"../common/Button\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport CashPaymentCompleteModal from \"./CashPaymentCompleteModal\";\r\nimport { useKeyboardShortcuts } from \"../../hooks/useKeyboardShortcuts\";\r\n\r\nfunction CashPaymentModal({ isOpen, onClose, total, onConfirm }) {\r\n  const [amountReceived, setAmountReceived] = useState(\"\");\r\n  const [showComplete, setShowComplete] = useState(false);\r\n  const [completeData, setCompleteData] = useState(null);\r\n  const [showErrorModal, setShowErrorModal] = useState(false);\r\n  const [errorMessage, setErrorMessage] = useState(\"\");\r\n  const amountInputRef = useRef(null);\r\n  const justSetExactAmount = useRef(false);\r\n\r\n  const handleQuickAmount = (val) => setAmountReceived(Number(val).toString());\r\n\r\n  const handleExactAmount = (e) => {\r\n    if (e) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n    // Set as a number to avoid string formatting issues\r\n    const exactAmount = Number(total).toFixed(2);\r\n    setAmountReceived(exactAmount);\r\n    justSetExactAmount.current = true;\r\n    // Reset the flag after a short delay\r\n    setTimeout(() => {\r\n      justSetExactAmount.current = false;\r\n    }, 200);\r\n  };\r\n\r\n  const handleProceed = (e) => {\r\n    if (e) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n    \r\n    // Get the current value from the input element directly (more reliable than state)\r\n    const inputValue = amountInputRef.current?.value || amountReceived;\r\n    \r\n    // If we just set exact amount, use the total directly\r\n    let amountToUse = inputValue;\r\n    if (justSetExactAmount.current) {\r\n      amountToUse = Number(total).toFixed(2);\r\n    }\r\n    \r\n    // Trim and parse the input value\r\n    const trimmedAmount = (amountToUse?.toString() || \"\").trim();\r\n    if (!trimmedAmount) {\r\n      alert(\"Please enter an amount.\");\r\n      return;\r\n    }\r\n    const received = Number(trimmedAmount);\r\n    if (isNaN(received) || received <= 0) {\r\n      alert(\"Please enter a valid amount.\");\r\n      return;\r\n    }\r\n    // Round both values to 2 decimal places to avoid floating-point precision issues\r\n    const receivedRounded = Math.round(received * 100) / 100;\r\n    const totalRounded = Math.round(total * 100) / 100;\r\n    if (receivedRounded < totalRounded) {\r\n      setErrorMessage(`Amount received (₱${receivedRounded.toFixed(2)}) must be greater than or equal to total (₱${totalRounded.toFixed(2)}).`);\r\n      setShowErrorModal(true);\r\n      return;\r\n    }\r\n    // compute change and show completion modal; delay calling parent onConfirm\r\n    // so cashier can view the completion screen before the app navigates\r\n    const change = Math.max(0, receivedRounded - totalRounded);\r\n    setCompleteData({ change, payable: totalRounded, received: receivedRounded });\r\n    setShowComplete(true);\r\n  };\r\n  \r\n  // Handle completion modal close\r\n  const handleCompleteClose = () => {\r\n    setShowComplete(false);\r\n    if (onClose) onClose();\r\n  };\r\n  \r\n  // Handle new entry from completion modal\r\n  const handleNewEntry = () => {\r\n    setShowComplete(false);\r\n    setAmountReceived(\"\");\r\n    if (onClose) onClose();\r\n  };\r\n  \r\n  // Handle receipt printing from completion modal\r\n  const handleReceipt = () => {\r\n    if (onConfirm && completeData?.received != null) {\r\n      onConfirm(Number(completeData.received));\r\n    }\r\n  };\r\n\r\n  // Error modal shortcuts\r\n  useKeyboardShortcuts(\r\n    [\r\n      {\r\n        key: \"escape\",\r\n        action: () => setShowErrorModal(false),\r\n        enabled: showErrorModal,\r\n        allowWhileTyping: true,\r\n      },\r\n      {\r\n        key: \"enter\",\r\n        action: (e) => {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          setShowErrorModal(false);\r\n        },\r\n        enabled: showErrorModal,\r\n        allowWhileTyping: true,\r\n      },\r\n    ],\r\n    [showErrorModal]\r\n  );\r\n\r\n  // Only set up keyboard shortcuts when not showing completion modal\r\n  // Hooks must be called before any early returns\r\n  useKeyboardShortcuts(\r\n    [\r\n      {\r\n        key: \"escape\",\r\n        action: onClose,\r\n        enabled: isOpen && !showComplete && !showErrorModal,\r\n        allowWhileTyping: true,\r\n      },\r\n      {\r\n        key: \"enter\",\r\n        action: (e) => {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          handleProceed(e);\r\n        },\r\n        enabled: isOpen && !showComplete && !showErrorModal,\r\n        allowWhileTyping: true,\r\n      },\r\n      {\r\n        key: \"e\",\r\n        action: handleExactAmount,\r\n        enabled: isOpen && !showComplete && !showErrorModal,\r\n        allowWhileTyping: true,\r\n      },\r\n    ],\r\n    [isOpen, amountReceived, total, showComplete, showErrorModal]\r\n  );\r\n  \r\n  // Early return if not open and not showing completion modal\r\n  if (!isOpen && !showComplete) return null;\r\n  \r\n  // Render completion modal if needed\r\n  if (showComplete) {\r\n    return (\r\n      <CashPaymentCompleteModal\r\n        isOpen={showComplete}\r\n        onClose={handleCompleteClose}\r\n        change={completeData?.change}\r\n        payable={completeData?.payable}\r\n        onNewEntry={handleNewEntry}\r\n        onReceipt={handleReceipt}\r\n      />\r\n    );\r\n  }\r\n\r\n  const footerContent = (\r\n    <>\r\n      <Button\r\n        label=\"Cancel (Esc)\"\r\n        variant=\"secondary\"\r\n        onClick={onClose}\r\n        type=\"button\"\r\n        className=\"flex-1\"\r\n      />\r\n      <Button\r\n        label=\"Proceed (Enter)\"\r\n        variant=\"primary\"\r\n        type=\"button\"\r\n        onClick={handleProceed}\r\n        className=\"flex-1\"\r\n      />\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <>\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Cash Payment\"\r\n      subtitle=\"Enter amount received\"\r\n      icon={\r\n        <svg\r\n          className=\"w-5 h-5 text-white\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n          />\r\n        </svg>\r\n      }\r\n      footer={footerContent}\r\n      size=\"md\"\r\n      contentClassName=\"space-y-4\"\r\n    >\r\n      {/* Total Amount */}\r\n      <div className=\"bg-gradient-to-br from-blue-500 to-indigo-600 text-white rounded-2xl py-6 px-4 text-center\">\r\n        <div className=\"text-sm opacity-90 mb-2\">Total Amount</div>\r\n        <div className=\"text-4xl font-bold\">₱{total.toFixed(2)}</div>\r\n      </div>\r\n\r\n      {/* Input */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n          Amount Received\r\n        </label>\r\n        <input\r\n          ref={amountInputRef}\r\n          type=\"number\"\r\n          step=\"0.01\"\r\n          className=\"w-full border border-gray-300 rounded-lg px-3 py-2 text-center text-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n          placeholder=\"₱0.00\"\r\n          value={amountReceived}\r\n          onChange={(e) => {\r\n            // Allow empty string or valid numbers\r\n            const value = e.target.value;\r\n            if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\r\n              setAmountReceived(value);\r\n            }\r\n          }}\r\n        />\r\n      </div>\r\n\r\n      {/* Quick Select Buttons */}\r\n      <div>\r\n        <p className=\"text-xs text-gray-600 mb-2\">Quick amounts:</p>\r\n        <div className=\"grid grid-cols-3 gap-2\">\r\n          {[100, 200, 300, 400, 500, 600, 700, 800, 900].map((val) => (\r\n            <button\r\n              key={val}\r\n              className=\"bg-blue-100 hover:bg-blue-200 text-blue-700 font-bold py-2 rounded-lg transition-colors text-sm\"\r\n              onClick={() => handleQuickAmount(val)}\r\n            >\r\n              {val}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Exact Amount Button */}\r\n      <Button\r\n        label=\"Use Exact Amount (E)\"\r\n        className=\"w-full h-10 text-sm font-bold bg-slate-600 hover:bg-slate-700 text-white\"\r\n        onClick={handleExactAmount}\r\n      />\r\n      <div className=\"text-xs text-gray-600 bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 space-y-1\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <span>Use exact total:</span>\r\n          <span className=\"font-mono bg-white px-2 py-0.5 rounded\">E</span>\r\n        </div>\r\n        <div className=\"flex items-center justify-between\">\r\n          <span>Proceed:</span>\r\n          <span className=\"font-mono bg-white px-2 py-0.5 rounded\">Enter</span>\r\n        </div>\r\n        <div className=\"flex items-center justify-between\">\r\n          <span>Close:</span>\r\n          <span className=\"font-mono bg-white px-2 py-0.5 rounded\">Esc</span>\r\n        </div>\r\n      </div>\r\n    </BaseModal>\r\n\r\n    {/* Error Modal */}\r\n    <BaseModal\r\n        isOpen={showErrorModal}\r\n        onClose={() => setShowErrorModal(false)}\r\n        title=\"Insufficient Amount\"\r\n        size=\"sm\"\r\n        headerIconBgClassName=\"bg-red-500\"\r\n        icon={\r\n          <svg className=\"w-5 h-5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n          </svg>\r\n        }\r\n        footer={\r\n          <Button\r\n            label=\"OK (Enter)\"\r\n            variant=\"primary\"\r\n            onClick={() => setShowErrorModal(false)}\r\n            className=\"w-full bg-red-600 hover:bg-red-700\"\r\n          />\r\n        }\r\n      >\r\n        <div className=\"text-center py-4\">\r\n          <p className=\"text-gray-700 text-lg font-medium\">{errorMessage}</p>\r\n          <p className=\"text-gray-500 text-sm mt-2\">Please enter a valid amount.</p>\r\n        </div>\r\n      </BaseModal>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default CashPaymentModal;\r\n","import React, { useState } from \"react\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport ScannerCard from \"../ui/POS/ScannerCard\";\r\nimport Button from \"../common/Button\";\r\nimport { api } from \"../../lib/api\";\r\nimport { useKeyboardShortcuts } from \"../../hooks/useKeyboardShortcuts\";\r\n\r\nexport default function ScanCustomerCartModal({ isOpen, onClose, onImport }) {\r\n  const [scannerPaused, setScannerPaused] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const token = sessionStorage.getItem(\"auth_token\");\r\n\r\n  const user = JSON.parse(sessionStorage.getItem(\"user\") || \"{}\");\r\n\r\n  const handleScan = async (result) => {\r\n    const code = result?.[0]?.rawValue;\r\n    if (!code) return;\r\n    setScannerPaused(true);\r\n    setError(\"\");\r\n    try {\r\n      let payload;\r\n      try {\r\n        payload = JSON.parse(code);\r\n      } catch (e) {\r\n        throw new Error(\"Invalid QR payload\");\r\n      }\r\n      \r\n      // Check if this is a cart QR code with transaction ID\r\n      if (payload.t === 'cart' && payload.transaction_id) {\r\n        const { transaction_id, business_id: businessId } = payload;\r\n        \r\n        // Verify business ID matches if provided\r\n        const cashierBusinessId = user?.businessId || user?.business_id;\r\n        if (businessId && cashierBusinessId && Number(businessId) !== Number(cashierBusinessId)) {\r\n          throw new Error(\"This QR code is not valid for this store.\");\r\n        }\r\n\r\n        // Complete the existing transaction instead of creating a new one\r\n        try {\r\n          const response = await api(`/api/sales/${transaction_id}/complete`, {\r\n            method: 'POST',\r\n            headers: { Authorization: `Bearer ${token}` },\r\n          });\r\n          \r\n          if (response.transaction_id) {\r\n            // Transaction completed successfully - navigate to receipt\r\n            onClose();\r\n            // Navigate to receipt page for cashier\r\n            window.location.href = `/receipt?tn=${response.transaction_number}`;\r\n            return;\r\n          } else {\r\n            throw new Error(\"Failed to complete transaction\");\r\n          }\r\n        } catch (err) {\r\n          console.error('Error completing transaction:', err);\r\n          throw new Error(err.message || \"Failed to complete customer transaction\");\r\n        }\r\n      }\r\n      // Existing cart import logic for backward compatibility\r\n      else if (payload.t === 'cart' && Array.isArray(payload.items)) {\r\n        const { items: compactItems, b: businessId } = payload;\r\n        const cashierBusinessId = user?.businessId || user?.business_id;\r\n\r\n        if (businessId && cashierBusinessId && Number(businessId) !== Number(cashierBusinessId)) {\r\n          throw new Error(\"This QR code is not valid for this store.\");\r\n        }\r\n\r\n        const fullItems = [];\r\n        for (const it of compactItems) {\r\n          if (!it?.p || !it?.q) continue;\r\n          const product = await api(`/api/products/${encodeURIComponent(it.p)}`, {\r\n            headers: { Authorization: `Bearer ${token}` },\r\n          });\r\n          fullItems.push({\r\n            product_id: product.product_id,\r\n            sku: product.sku,\r\n            name: product.product_name,\r\n            quantity: Number(it.q),\r\n            price: Number(product.selling_price || 0)\r\n          });\r\n        }\r\n        if (fullItems.length === 0) throw new Error(\"No items to import\");\r\n        onImport(fullItems);\r\n        onClose();\r\n      } else {\r\n        throw new Error(\"Unsupported QR code format\");\r\n      }\r\n    } catch (e) {\r\n      setError(e.message || \"Failed to process QR code\");\r\n      console.error('Scan error:', e);\r\n    } finally {\r\n      // Resume scanner after a delay to allow error message to be visible\r\n      setTimeout(() => {\r\n        setScannerPaused(false);\r\n      }, 500);\r\n    }\r\n  };\r\n\r\n  const footerContent = (\r\n    <Button\r\n      label=\"Close (Esc)\"\r\n      variant=\"secondary\"\r\n      onClick={onClose}\r\n      className=\"w-full\"\r\n    />\r\n  );\r\n\r\n  useKeyboardShortcuts(\r\n    [{ key: \"escape\", action: onClose, enabled: isOpen }],\r\n    [isOpen]\r\n  );\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Scan Customer Cart\"\r\n      subtitle=\"Ask customer to show their QR\"\r\n      icon={\r\n        <svg\r\n          className=\"w-5 h-5 text-white\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M12 4v16m8-8H4\"\r\n          />\r\n        </svg>\r\n      }\r\n      footer={footerContent}\r\n      size=\"lg\"\r\n      contentClassName=\"space-y-3\"\r\n    >\r\n      <div className=\"text-blue-800 text-sm font-medium\">\r\n        Ask the customer to show their cart QR code\r\n      </div>\r\n      <div className=\"h-[50vh]\">\r\n        <ScannerCard\r\n          onScan={handleScan}\r\n          paused={scannerPaused}\r\n          onResume={() => setScannerPaused(false)}\r\n          className=\"w-full h-full\"\r\n        />\r\n      </div>\r\n      {error && (\r\n        <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm\">\r\n          {error}\r\n        </div>\r\n      )}\r\n      <div className=\"text-xs text-gray-600 bg-gray-50 border border-gray-200 rounded-lg px-3 py-2\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <span>Close:</span>\r\n          <span className=\"font-mono bg-white px-2 py-0.5 rounded\">Esc</span>\r\n        </div>\r\n      </div>\r\n    </BaseModal>\r\n  );\r\n}\r\n"],"names":["SkuFormCard","React","forwardRef","sku","setSku","quantity","setQuantity","handleAddToCart","quantityInputRef","className","ref","jsx","Card","variant","children","jsxs","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","type","name","value","onChange","e","target","onKeyPress","key","trim","placeholder","onClick","Math","max","min","Number","Button","label","size","microinteraction","icon","iconPosition","CartTableCard","cart","handleRemove","handleEditQuantity","total","selectedIdx","onSelectRow","appliedDiscount","editingIdx","editQty","onEditQtyChange","onEditComplete","onStartEdit","handleRowClick","handleQtyChange","test","parseInt","handleSaveQuantity","idx","qty","EditIcon","width","height","DeleteIcon","CheckIcon","XIcon","length","colSpan","map","item","tagName","inputMode","pattern","onKeyDown","onBlur","autoFocus","onFocus","select","title","price","toFixed","stopPropagation","reduce","sum","PriceCheckModal","isOpen","onClose","product","setProduct","useState","handleCheck","async","businessId","localStorage","getItem","query","encodeURIComponent","res","api","product_name","selling_price","_","useEffect","t","setTimeout","clearTimeout","footerContent","useKeyboardShortcuts","action","enabled","allowWhileTyping","BaseModal","subtitle","footer","contentClassName","ScannerCard","onScan","result","code","rawValue","paused","onResume","textMain","DiscountModal","onApplyDiscount","showSettings","setShowSettings","discounts","setDiscounts","newDesc","setNewDesc","newValue","setNewValue","setSelectedIdx","settingsSelectedIdx","setSettingsSelectedIdx","loading","setLoading","error","setError","saving","setSaving","settingsTab","setSettingsTab","deleteConfirmation","setDeleteConfirmation","id","descInputRef","useRef","valueInputRef","discountListRef","isTypingTarget","el","tag","toLowerCase","isContentEditable","getAttribute","handleInputKeyDown","field","preventDefault","blur","handleAddDiscount","includes","keyCode","ctrlKey","shiftKey","requestAnimationFrame","current","focus","token","sessionStorage","discountList","headers","Authorization","discount_name","discount_percentage","discount_id","fetchDiscounts","payload","created","method","body","JSON","stringify","prev","discountId","isNaN","discountToDelete","find","cancelDelete","useCallback","confirmDelete","deletedIndex","findIndex","newDiscounts","filter","prevIdx","message","data","refreshError","handleSaveSettings","handleApplyDiscount","discount","settingsFooterContent","mainFooterContent","disabled","selectedElement","querySelector","scrollIntoView","behavior","block","inline","timer","Array","from","i","String","applyDiscountByIndex","Fragment","readOnly","xmlns","CashLedgerModal","tab","setTab","selectedPaymentType","setSelectedPaymentType","ledger","setLedger","transactions","setTransactions","loadingSummary","setLoadingSummary","loadingTx","setLoadingTx","fetchTransactions","paymentType","q","isArray","err","fetchLedger","tabContent","MdDescription","MdSwapHoriz","MdAccountBalanceWallet","renderSummary","totalCash","balance","Date","toLocaleDateString","weekday","year","month","day","MdChevronRight","tx","created_at","toLocaleString","payment_type","transaction_id","CheckoutModal","onSelectPayment","CashPaymentCompleteModal","change","payable","onReceipt","onNewEntry","CashPaymentModal","onConfirm","amountReceived","setAmountReceived","showComplete","setShowComplete","completeData","setCompleteData","showErrorModal","setShowErrorModal","errorMessage","setErrorMessage","amountInputRef","justSetExactAmount","handleExactAmount","exactAmount","handleProceed","amountToUse","trimmedAmount","toString","alert","received","receivedRounded","round","totalRounded","handleCompleteClose","handleNewEntry","handleReceipt","step","val","handleQuickAmount","headerIconBgClassName","ScanCustomerCartModal","onImport","scannerPaused","setScannerPaused","user","parse","Error","business_id","cashierBusinessId","response","window","location","href","transaction_number","items","compactItems","b","fullItems","it","p","push","product_id"],"mappings":"kXAUA,MAAAA,EAAeC,EAAMC,WACnB,EAEIC,MACAC,SACAC,WACAC,cACAC,kBACAC,mBACAC,YAAY,IAEdC,IAGEC,EAAAA,IAACC,EACC,CAAAH,UAAW,4HAA4HA,IACvII,QAAQ,QAERC,SAAAC,OAAC,MAAI,CAAAN,UAAU,iCACbK,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,iCACbK,SAAA,CAACH,EAAAA,IAAA,MAAA,CAAIF,UAAU,kEACbK,SAACH,EAAAA,IAAA,MAAA,CACCF,UAAU,wBACVO,KAAK,OACLC,OAAO,eACPC,QAAQ,YAERJ,SAACH,EAAAA,IAAA,OAAA,CACCQ,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,4CAIPX,EAAAA,IAAA,OAAA,CAAKF,UAAU,kCAAkCK,SAElD,sBAGFC,EAAAA,KAAC,MAAI,CAAAN,UAAU,YACbK,SAAA,CAAAC,OAAC,MACC,CAAAD,SAAA,CAACC,EAAAA,KAAA,QAAA,CAAMN,UAAU,mEACfK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAQ,aACbH,EAAAA,IAAA,OAAA,CAAKF,UAAU,kHAAkHK,SAElI,SAEFH,EAAAA,IAAC,OAAIF,UAAU,WACbK,eAAC,QACC,CAAAJ,MACAa,KAAK,OACLC,KAAK,MACLC,MAAOtB,EACPuB,SAAiBtB,GAAAA,EAAOuB,EAAEC,OAAOH,OACjCI,WAAmBF,IACH,UAAVA,EAAEG,KAAmB3B,EAAI4B,QACXxB,KAGpByB,YAAY,4CACZvB,UAAU,0NAKhBM,EAAAA,KAAC,MAAI,CAAAN,UAAU,0BACbK,SAAA,CAACH,EAAAA,IAAA,QAAA,CAAMF,UAAU,wDAAwDK,SAEzE,cACAC,EAAAA,KAAC,MAAI,CAAAN,UAAU,iCACbK,SAAA,CAAAH,EAAAA,IAAC,SACC,CAAAsB,QAAS,IAAM3B,EAAY4B,KAAKC,IAAI,EAAG9B,EAAW,IAClDI,UAAU,2IACXK,SAED,MACAH,EAAAA,IAAC,QACC,CAAAY,KAAK,SACLC,KAAK,WACLC,MAAOpB,EACP+B,IAAK,EACL1B,IAAKF,EACLkB,SACEpB,GAAAA,EAAY4B,KAAKC,IAAI,EAAGE,OAAOV,EAAEC,OAAOH,QAAU,IAEpDhB,UAAU,uMAEZE,EAAAA,IAAC,SACC,CAAAsB,QAAS,IAAM3B,EAAYD,EAAW,GACtCI,UAAU,2IACXK,SAED,eAEDwB,EACC,CAAAC,MACGxB,EAAAA,KAAA,MAAA,CAAIN,UAAU,0BACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAW,gBAChBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,+GAA+GK,SAE/H,UAGJmB,QAAS1B,EACTM,QAAQ,UACR2B,KAAK,KACLC,kBAAgB,EAChBC,KACE/B,EAAAA,IAAC,MACC,CAAAF,UAAU,UACVO,KAAK,OACLC,OAAO,eACPC,QAAQ,YAERJ,SAACH,EAAAA,IAAA,OAAA,CACCQ,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,qBAIRqB,aAAa,qBC7H7B,SAASC,GAAcC,KACrBA,EAAAA,aACAC,EAAAA,mBACAC,EAAAA,MACAC,EAAAA,UACAvC,EAAY,GAAAwC,YACZA,GAAc,EAAAC,YACdA,EAAAA,gBACAC,EAAAA,WACAC,EAAa,KAAAC,QACbA,EAAU,EAAAC,gBACVA,EAAAA,eACAC,EAAAA,YACAC,IAIMC,MAOAC,EAAyB/B,IACvBF,MAAAA,EAAQE,EAAEC,OAAOH,OAET,KAAVA,GAAgB,QAAQkC,KAAKlC,KAC/B6B,IAA4B,KAAV7B,EAAe,GAAKmC,SAASnC,EAAO,MAKpDoC,EAA8BC,IAClC,MAAMC,EAAkB,KAAZV,EAAiB,EAAInB,KAAKC,IAAI,EAAGkB,GAC7CN,EAAmBe,EAAKC,GACPR,OAGbS,EAAWA,IACdrD,MAAA,MAAA,CACCsD,MAAM,KACNC,OAAO,KACPlD,KAAK,OACLC,OAAO,eACPI,YAAY,IACZH,QAAQ,YAERJ,eAAC,OAAK,CAAAQ,EAAE,wJAIN6C,EAAaA,IAChBxD,MAAA,MAAA,CACCsD,MAAM,KACNC,OAAO,KACPlD,KAAK,OACLC,OAAO,eACPI,YAAY,IACZH,QAAQ,YAERJ,eAAC,OAAK,CAAAQ,EAAE,mFAIN8C,EAAYA,IACfzD,MAAA,MAAA,CACCsD,MAAM,KACNC,OAAO,KACPlD,KAAK,OACLC,OAAO,eACPI,YAAY,IACZH,QAAQ,YAERJ,eAAC,OAAK,CAAAQ,EAAE,qBAIN+C,EAAQA,IACX1D,MAAA,MAAA,CACCsD,MAAM,KACNC,OAAO,KACPlD,KAAK,OACLC,OAAO,eACPI,YAAY,IACZH,QAAQ,YAERJ,eAAC,OAAK,CAAAQ,EAAE,2BAKV,OAAAX,EAAAA,IAACC,EACC,CAAAH,UAAW,iJAAiJA,IAC5JI,QAAQ,QAERC,SAAAC,OAAC,MAAI,CAAAN,UAAU,0CAEbK,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,uEACbK,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,0BACbK,SAAA,CAACH,EAAAA,IAAA,MAAA,CAAIF,UAAU,kEACbK,SAACH,EAAAA,IAAA,MAAA,CACCF,UAAU,wBACVO,KAAK,OACLC,OAAO,eACPC,QAAQ,YAERJ,SAACH,EAAAA,IAAA,OAAA,CACCQ,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,6JAIPX,EAAAA,IAAA,KAAA,CAAGF,UAAU,+CAA+CK,SAE7D,qBAEFC,EAAAA,KAAC,OAAK,CAAAN,UAAU,2EACboC,SAAAA,CAAKyB,EAAAA,OAAO,IAAkB,IAAhBzB,EAAKyB,OAAe,OAAS,oBAK/C,MAAI,CAAA7D,UAAU,0CACbK,SAACC,EAAAA,KAAA,QAAA,CAAMN,UAAU,SACfK,SAAA,CAAAH,MAAC,QAAM,CAAAF,UAAU,+GACfK,SAAAC,EAAAA,KAAC,KACC,CAAAD,SAAA,CAACH,EAAAA,IAAA,KAAA,CAAGF,UAAU,gGAAgGK,SAE9G,YACCH,EAAAA,IAAA,KAAA,CAAGF,UAAU,kGAAkGK,SAEhH,QACCH,EAAAA,IAAA,KAAA,CAAGF,UAAU,iGAAiGK,SAE/G,UACCH,EAAAA,IAAA,KAAA,CAAGF,UAAU,iGAAiGK,SAE/G,UACCH,EAAAA,IAAA,KAAA,CAAGF,UAAU,kGAAkGK,SAEhH,uBAGH,QAAM,CAAAL,UAAU,2BACdoC,SAAgB,IAAXyB,EAAAA,OACH3D,MAAA,KAAA,CACCG,SAACH,MAAA,KAAA,CAAG4D,QAAS,EAAG9D,UAAU,mBACxBK,SAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,4CACbK,SAAA,CAACH,EAAAA,IAAA,MAAA,CAAIF,UAAU,2EACbK,SAACH,EAAAA,IAAA,MAAA,CACCF,UAAU,wBACVO,KAAK,OACLC,OAAO,eACPC,QAAQ,YAERJ,SAACH,EAAAA,IAAA,OAAA,CACCQ,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,6JAIPX,EAAAA,IAAA,IAAA,CAAEF,UAAU,sCAAsCK,SAEnD,kBACCH,EAAAA,IAAA,IAAA,CAAEF,UAAU,6BAA6BK,SAE1C,kCAKN+B,EAAK2B,IAAI,CAACC,EAAMX,IACd/C,EAAAA,KAAC,KAEC,CAAAN,UAAW,6DAA4DwC,IAAgBa,EAAM,sCAAwC,IACrI7B,QAAgBwB,GAnKXA,EAACK,EAAKnC,KACF,UAArBA,EAAEC,OAAO8C,SACXxB,IAAcY,IAiKgBL,CAAeK,EAAKnC,GAEpCb,SAAA,CAAAH,EAAAA,IAAC,MAAGF,UAAU,cACZK,SAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,gBACbK,SAAA,CAAAH,EAAAA,IAAC,OAAK,CAAAF,UAAU,sGACbgE,SAAAA,EAAKjD,OAERT,EAAAA,KAAC,OAAK,CAAAN,UAAU,qCAAqCK,SAAA,CAAA,QAC7C2D,EAAKtE,KAAO,cAIxBQ,EAAAA,IAAC,MAAGF,UAAU,0BACX2C,aAAeU,EACd/C,EAAAA,KAAC,MAAI,CAAAN,UAAU,yCACbK,SAAA,CAAAH,EAAAA,IAAC,QACC,CAAAY,KAAK,OACLoD,UAAU,UACVC,QAAQ,SACRnD,MAAO4B,EACP3B,SAAUgC,EACVmB,UAAkBlD,IACF,UAAVA,EAAEG,IACJ+B,EAAmBC,GACA,WAAVnC,EAAEG,KACMyB,OAGrBuB,OAAQ,IAAMjB,EAAmBC,GACjCrD,UAAU,4HACVsE,WAAS,EACTC,QAAUrD,GAAMA,EAAEC,OAAOqD,WAE1BtE,EAAAA,IAAA,SAAA,CACCY,KAAK,SACLU,QAAS,IAAM4B,EAAmBC,GAClCrD,UAAU,gDACVyE,MAAM,OAENpE,SAAAH,EAAAA,IAACyD,GAAY,KAEdzD,EAAAA,IAAA,SAAA,CACCsB,QAAS,IAAMsB,IACf9C,UAAU,4CACVyE,MAAM,SAENpE,SAACH,EAAAA,IAAA0D,EAAA,CAAQ,QAIb1D,EAAAA,IAAC,MAAI,CAAAF,UAAU,yCACbK,SAAAH,EAAAA,IAAC,OAAK,CAAAF,UAAU,yGACbgE,SAAAA,EAAKpE,qBAKb,KAAG,CAAAI,UAAU,yBACZK,SAACC,EAAAA,KAAA,OAAA,CAAKN,UAAU,+CAA+CK,SAAA,CAAA,IAC3D2D,EAAKU,MAAMC,QAAQ,cAGxB,KAAG,CAAA3E,UAAU,yBACZK,SAACC,EAAAA,KAAA,OAAA,CAAKN,UAAU,6CAA6CK,SAAA,CAAA,KAGzD2D,EAAKU,OACJ/B,IAAeU,EAAMT,EAAUoB,EAAKpE,WACrC+E,QAAQ,cAGb,KAAG,CAAA3E,UAAU,cACZK,SAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,yCACbK,SAAA,CAACH,EAAAA,IAAA,SAAA,CACCsB,QAAgBN,IACdA,EAAE0D,kBACFnC,IAAcY,GACdR,IAAkBmB,EAAKpE,UACvBmD,IAAcM,IAEhBrD,UAAW,gDAAgDwC,IAAgBa,EAAM,4CAA8C,sEAC/HoB,MAAM,YAGNpE,SAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,0BAEXK,SAAA,CAACH,EAAAA,IAAA,OAAA,CAAKF,UAAU,sHAAsHK,SAAE,aAEzIkD,EAAW,CAAA,QAGhBrD,EAAAA,IAAC,SACC,CAAAsB,QAAgBN,IACdA,EAAE0D,kBACFnC,IAAcY,GACdhB,EAAagB,IAEfrD,UAAW,gDAAgDwC,IAAgBa,EAAM,yCAA2C,kEAC5HoB,MAAM,cAENpE,SAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,0BAEXK,SAAA,CAACH,EAAAA,IAAA,OAAA,CAAKF,UAAU,mHAAmHK,SAAE,aAEtIqD,EAAa,CAAA,eA1GjBL,iBAuHhB,MAAI,CAAArD,UAAU,qCACbK,SAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,sBACZ0C,SAAAA,CACCA,GAAApC,EAAAA,KAAC,MAAI,CAAAN,UAAU,0DACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAS,cACfC,EAAAA,KAAC,OAAK,CAAAN,UAAU,eAAeK,SAAA,CAAA,IAE5B+B,EACEyC,OACC,CAACC,EAAKd,EAAMX,IACVyB,EACAd,EAAKU,OAAS/B,IAAeU,EAAMT,EAAUoB,EAAKpE,UACpD,GAED+E,QAAQ,SAIjBrE,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAACH,EAAAA,IAAA,OAAA,CAAKF,UAAU,mDAAmDK,SAEnE,WACAC,EAAAA,KAAC,OAAK,CAAAN,UAAU,kDAAkDK,SAAA,CAAA,IAC9DkC,EAAMoC,QAAQ,kBAQhC,CCzUA,SAASI,GAAgBC,OAAEA,EAAAA,QAAQC,EAAAA,IAASvF,EAAAA,OAAKC,IAC/C,MAAOuF,EAASC,GAAcC,EAAAA,SAAS,MAEjCC,EAAcC,UAClB,GAAK5F,EACD,IACI6F,MAAAA,EAAaC,aAAaC,QAAQ,eAClCC,EAAQH,EACV,gBAAgBI,mBAAmBJ,KACnC,GACEK,QAAYC,EAChB,4BAA4BF,mBAAmBjG,KAAOgG,KAG3CP,EADTS,EACS,CACT7E,KAAM6E,EAAIE,aACVpB,MAAO9C,OAAOgE,EAAIG,eAAiB,GACnCrG,IAAKkG,EAAIlG,KAGA,YAENsG,GACPb,EAAW,KAAI,GAKnB3F,EAAMyG,UAAU,KACd,IAAKvG,EAEH,YADAyF,EAAW,MAGPe,MAAAA,EAAIC,WAAW,KACPd,KACX,KACI,MAAA,IAAMe,aAAaF,IACzB,CAACxG,IAEE2G,MAAAA,EACHnG,EAAAA,IAAA2B,EAAA,CACCC,MAAM,cACN1B,QAAQ,YACRoB,QAASyD,EACTjF,UAAU,WAsBd,OAlBAsG,EACE,CACE,CACEjF,IAAK,SACLkF,OAAQtB,EACRuB,QAASxB,EACTyB,kBAAkB,GAEpB,CACEpF,IAAK,QACLkF,OAAQlB,EACRmB,QAASxB,EACTyB,kBAAkB,IAGtB,CAACzB,EAAQtF,WAIRgH,EACC,CAAA1B,SACAC,UACAR,MAAM,cACNkC,SAAS,4BACT1E,KACE/B,EAAAA,IAAC,OACCF,UAAU,qBACVO,KAAK,OACLC,OAAO,eACPC,QAAQ,YAERJ,SAAAH,EAAAA,IAAC,QACCQ,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,oDAIR+F,OAAQP,EACRtE,KAAK,KACL8E,iBAAiB,YAGjBxG,SAAA,CAAAH,EAAAA,IAAC,OAAIF,UAAU,SACbK,SAACH,EAAAA,IAAA4G,EAAA,CACCC,OAAoBC,IACZC,MAAAA,EAAOD,IAAS,IAAIE,SACtBD,GACFtH,EAAOsH,IAGXE,QAAQ,EACRC,SAAU,OACVpH,UAAU,SACVqH,SAAS,oBAKb/G,EAAAA,KAAC,MAAI,CAAAN,UAAU,SACbK,SAAA,CAACH,EAAAA,IAAA,QAAA,CAAMF,UAAU,+CAA+CK,SAEhE,+BACC,QACC,CAAAS,KAAK,OACLE,MAAOtB,EACPuB,SAAWC,GAAMvB,EAAOuB,EAAEC,OAAOH,OACjChB,UAAU,uIACVuB,YAAY,iCAIhBjB,EAAAA,KAAC,MAAI,CAAAN,UAAU,+EACbK,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAY,iBACjBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAK,aAEhEC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAM,WACXH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAG,cAK/D6E,EACC5E,EAAAA,KAAC,MAAI,CAAAN,UAAU,8FACbK,SAAA,CAAAH,EAAAA,IAAC,MAAI,CAAAF,UAAU,2CACZkF,SAAAA,EAAQnE,OAEXT,EAAAA,KAAC,MAAI,CAAAN,UAAU,wCAAwCK,SAAA,CAAA,IACnD6E,EAAQR,MAAMC,QAAQ,MAE1BrE,EAAAA,KAAC,MAAI,CAAAN,UAAU,wBAAwBK,SAAA,CAAA,QAAM6E,EAAQxF,UAErDA,EACFQ,EAAAA,IAAC,OAAIF,UAAU,wCAAwCK,+BAGrD,OAGV,CCvJA,SAASiH,GAActC,OAAEA,EAAAA,QAAQC,EAAAA,gBAASsC,IACxC,MAAOC,EAAcC,GAAmBrC,EAAAA,UAAS,IAC1CsC,EAAWC,GAAgBvC,EAAAA,SAAS,KAEpCwC,EAASC,GAAczC,EAAAA,SAAS,KAChC0C,EAAUC,GAAe3C,EAAAA,SAAS,KAClC5C,EAAawF,GAAkB5C,EAAAA,SAAS,OACxC6C,EAAqBC,GAA0B9C,EAAAA,SAAS,IACxD+C,EAASC,GAAchD,EAAAA,UAAS,IAChCiD,EAAOC,GAAYlD,EAAAA,SAAS,KAC5BmD,EAAQC,GAAapD,EAAAA,UAAS,IAC9BqD,EAAaC,GAAkBtD,EAAAA,SAAS,eAGxCuD,EAAoBC,GAAyBxD,WAAS,CAC3DJ,QAAQ,EACR6D,GAAI,KACJ/G,MAAO,KAGHgH,EAAetJ,EAAMuJ,OAAO,MAC5BC,EAAgBxJ,EAAMuJ,OAAO,MAC7BE,EAAkBzJ,EAAMuJ,OAAO,MAG/BG,EAAyBC,IACzB,IAACA,EAAW,OAAA,EACVC,MAAAA,EAAMD,EAAGlF,SAASoF,cAEtBF,OAAAA,EAAGG,mBACK,UAARF,GACQ,aAARA,GAC8B,YAA9BD,EAAGI,eAAe,SAIhBC,EAAqBA,CAACtI,EAAGuI,KAEzBvI,GAAU,WAAVA,EAAEG,IAIJ,OAHAH,EAAEwI,iBACFxI,EAAE0D,uBACF1D,EAAEC,OAAOwI,OAKPzI,GAAU,UAAVA,EAAEG,KAAmBmG,GACnBI,GAAWE,EAIb,OAHA5G,EAAEwI,iBACFxI,EAAE0D,uBACgBgF,IAMtB,GAAc,UAAVH,EAAmB,CAErB,GAAI,CAAC,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,IAAII,SAAS3I,EAAE4I,UAErD5I,EAAE6I,SAAW,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IAAIF,SAAS3I,EAAE4I,UAEjD5I,EAAE4I,SAAW,IAAM5I,EAAE4I,SAAW,IAChC5I,EAAE4I,SAAW,IAAM5I,EAAE4I,SAAW,IAEnC,QAGG5I,EAAE8I,UAAa9I,EAAE4I,QAAU,IAAM5I,EAAE4I,QAAU,MAAS5I,EAAE4I,QAAU,IAAM5I,EAAE4I,QAAU,MACvF5I,EAAEwI,gBACJ,GAKJzD,EAAAA,UAAU,KACJjB,GAAUwC,GACZyC,sBAAsB,KACpBnB,EAAaoB,SAASC,QACtBrB,EAAaoB,SAAS1F,cAGzB,CAACQ,EAAQwC,IAEZvB,EAAAA,UAAU,KACR,IAAKjB,EAAQ,OACUM,WACrB8C,GAAW,GACXE,EAAS,IACL,IACI8B,MAAAA,EAAQC,eAAe5E,QAAQ,cAI/B6E,SAHazE,EAAI,iBAAkB,CACvC0E,QAAS,CAAEC,cAAe,UAAUJ,QAER,IAAIrG,IAAUlD,IAAA,CAC1CiB,MAAOjB,EAAE4J,eAAiB,GAAG5J,EAAE6J,2BAC/B1J,MAAOH,EAAE6J,oBACTC,YAAa9J,EAAE8J,YACf7J,KAAM,gBAGR6G,EAAa2C,SACNpJ,GACPoH,EAAS,2BAA0B,CAC3B,QACRF,GAAW,EAAK,GAGLwC,IACd,CAAC5F,IAEJ,MAAM4E,EAAoBtE,UACpB,GAACsC,GAAYE,EAAb,CACJU,GAAU,GACN,IACI4B,MAAAA,EAAQC,eAAe5E,QAAQ,cAC/BoF,EAAU,CACdJ,cAAe7C,EACf8C,oBAAqB9I,OAAOkG,IAGxBgD,QAAgBjF,EAAI,iBAAkB,CAC1CkF,OAAQ,OACRR,QAAS,CACPC,cAAe,UAAUJ,IACzB,eAAgB,oBAElBY,KAAMC,KAAKC,UAAUL,KAGVM,EAAAA,GAAQ,IAChBA,EACH,CACErJ,MAAOgJ,EAAQL,eAAiB7C,EAChC5G,MAAO8J,EAAQJ,oBACfC,YAAaG,EAAQH,YACrB7J,KAAM,gBAIV+G,EAAW,IACXE,EAAY,UACL7G,GACCmH,QAAAA,MAAM,0BAA2BnH,GACzCoH,EAAS,4CAA2C,CAC5C,QACRE,GAAU,EAAK,CAlCU,GA0CvBnG,EAAeiD,MAAO8F,IAC1B,IAAKA,EAAY,OAEXvC,MAAAA,EAAKjH,OAAOwJ,GACdC,GAAAA,MAAMxC,GAER,YADAP,EAAS,uBAILgD,MAAAA,EAAmB5D,EAAU6D,KAAK1K,GAAKe,OAAOf,EAAE8J,eAAiB9B,GAClEyC,EAMiB1C,EAAA,CAAE5D,QAAQ,EAAM6D,KAAQ/G,MAAOwJ,EAAiBxJ,QALpEwG,EAAS,mCAQPkD,EAAeC,EAAAA,YAAY,KACT7C,EAAA,CAAE5D,QAAQ,EAAO6D,GAAI,KAAM/G,MAAO,MACvD,IAEG4J,EAAgBpG,UACpB,MAAMuD,EAAKF,EAAmBE,GAC9B,GAAKA,EAED,IACFL,GAAU,GACVF,EAAS,UAGHzC,EAAI,kBAAkBgD,IAAM,CAChCkC,OAAQ,WAIVpD,EAAqBwD,IACbQ,MAAAA,EAAeR,EAAKS,UAAU/K,GAAKe,OAAOf,EAAE8J,eAAiB9B,GAC7DgD,EAAeV,EAAKW,OAAOjL,GAAKe,OAAOf,EAAE8J,eAAiB9B,GAiBzDgD,OAdkB,IAArBF,IACF3D,EAA0B+D,GACpBA,IAAYJ,EAAqBlK,KAAKC,IAAI,EAAGiK,EAAe,GAC5DI,EAAUJ,EAAqBI,EAAU,EACtCA,GAGT7D,EAAkC6D,GAC5BA,IAAYJ,EAAqBlK,KAAKC,IAAI,EAAGiK,EAAe,GAC5DI,EAAUJ,EAAqBI,EAAU,EACtCA,IAIJF,IAGIL,UAENnD,GAIP,GAHQA,QAAAA,MAAM,6BAA8BA,GAGxCA,EAAM2D,SAAW3D,EAAM2D,QAAQnC,SAAS,aAEtC,IACIO,MAAAA,EAAQC,eAAe5E,QAAQ,cAC/BwG,QAAapG,EAAI,iBAAkB,CACvC0E,QAAS,CAAEC,cAAe,UAAUJ,OAEtCzC,GAAcsE,GAAQ,IAAIlI,IAAUlD,IAAA,CAClCiB,MAAOjB,EAAE4J,eAAiB,GAAG5J,EAAE6J,2BAC/B1J,MAAOH,EAAE6J,oBACTC,YAAa9J,EAAE8J,YACf7J,KAAM,iBAERwH,EAAS,gDACIkD,UACNU,GACC7D,QAAAA,MAAM,+BAAgC6D,GAC9C5D,EAAS,8CAA6C,MAI/CD,EAAAA,EAAM2D,SAAW,+CAC5B,CACQ,QACRxD,GAAU,EAAK,GAIb2D,EAAqBA,KACzB1E,GAAgB,IAGZ2E,EAAsBA,KAC1B,GAAmB,MAAf5J,EAAqB,OACnB6J,MAAAA,EAAW3E,EAAUlF,GACtB6J,IACW9E,EAAA,CACdzG,KAAMuL,EAASvL,KACfE,MAAOqL,EAASrL,MAChBc,MAAOuK,EAASvK,MAChB6I,YAAa0B,EAAS1B,cAEhB1F,MAiBJqH,EACHpM,EAAAA,IAAA2B,EAAA,CACCC,MACGxB,OAAA,MAAA,CAAIN,UAAU,2CACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAa,kBAClBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,oDAAoDK,SAEpE,aAGJD,QAAQ,UACRoB,QAAS2K,EACTnM,UAAU,WAKRuM,EACJjM,EAAAA,KAAC,MAAI,CAAAN,UAAU,mBACbK,SAAA,CAAAH,MAAC2B,EACC,CAAAC,MACGxB,EAAAA,KAAA,MAAA,CAAIN,UAAU,2CACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAc,mBACnBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,oDAAoDK,SAEpE,aAGJD,QAAQ,UACRoB,QAAS4K,EACTI,SAA0B,OAAhBhK,EACVxC,UAAU,iBAEX6B,EACC,CAAAC,MACGxB,EAAAA,KAAA,MAAA,CAAIN,UAAU,2CACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAgB,qBACrBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,kEAAkEK,SAElF,SAGJD,QAAQ,YACRoB,QAAS,IAAMiG,GAAgB,GAC/BzH,UAAU,cAOhBiG,EAAAA,UAAU,KACR,GAAIuB,GAAgByB,EAAgBiB,SAAmC,OAAxBjC,EAA8B,CAC3E,MACMwE,EADYxD,EAAgBiB,QACAwC,cAAc,uBAAuBzE,OACnEwE,GACFA,EAAgBE,eAAe,CAC7BC,SAAU,SACVC,MAAO,UACPC,OAAQ,WAEZ,GAED,CAAC7E,EAAqBT,IAGzBvB,EAAAA,UAAU,KACR,GAAIoC,EAAO,CACT,MAAM0E,EAAQ5G,WAAW,IAAMmC,EAAS,IAAK,KACtC,MAAA,IAAMlC,aAAa2G,EAAK,GAEhC,CAAC1E,IAIF/B,EAAA,CAEE,CACEjF,IAAK,SACLkF,OAAerF,IACTyH,EAAmB3D,OACRwG,IAGXtC,EAAehI,GAAGC,QACpBD,EAAEC,OAAOwI,SAGH1E,KAEVuB,QAASxB,EACTyB,kBAAkB,EAClB7B,iBAAiB,EACjB8E,gBAAgB,GAGlB,CACErI,IAAK,QACLkF,OAAerF,GAETyH,EAAmB3D,QACrB9D,EAAEwI,sBACYgC,KAKZxC,EAAehI,GAAGC,aAEhBqG,GAAgBI,GAAWE,IAC7B5G,EAAEwI,iBACgBE,MAMlBpC,GACFtG,EAAEwI,sBACiByC,UAKDC,IAEtB5F,QAASxB,EACTyB,kBAAkB,EAClB7B,iBAAiB,EACjB8E,gBAAgB,GAGlB,CACErI,IAAK,IACLkF,OAAerF,IACTgI,EAAehI,GAAGC,SAAWwH,EAAmB3D,QACnCmG,EAAAA,IAAUA,IAE7B3E,QAASxB,EACTyB,kBAAkB,EAClB7B,iBAAiB,EACjB8E,gBAAgB,MAGfsD,MAAMC,KAAK,CAAEpJ,OAAQ,IAAKE,IAAI,CAACiC,EAAGkH,KAAO,CAC1C7L,IAAK8L,OAAOD,EAAI,GAChB3G,OAAerF,IACTgI,EAAehI,GAAGC,SAAWwH,EAAmB3D,SAC/CwC,GAAgBE,EAAUwF,IAlKT7J,CAAQA,IAC9BgJ,MAAAA,EAAW3E,EAAUrE,GACtBgJ,IACLrE,EAAe3E,GACCkE,EAAA,CACdzG,KAAMuL,EAASvL,KACfE,MAAOqL,EAASrL,MAChBc,MAAOuK,EAASvK,MAChB6I,YAAa0B,EAAS1B,cAEhB1F,MAyJAmI,CAAqBF,IAGzB1G,QAASxB,IAAWwC,GAAgBE,EAAUwF,GAC9CzG,kBAAkB,EAClB7B,iBAAiB,EACjB8E,gBAAgB,KAGlB,CACErI,IAAK,UACLkF,OAAerF,IACTgI,EAAehI,GAAGC,SAAWwH,EAAmB3D,QAChDwC,GAAqC,IAArBE,EAAU7D,QAC9BmE,EAAyBmD,GACX,MAARA,EAAqB,EAClBA,EAAO,EAAIA,EAAO,EAAI,IAGjC3E,QAASxB,IAAWwC,EACpBf,kBAAkB,EAClB7B,iBAAiB,EACjB8E,gBAAgB,GAElB,CACErI,IAAK,YACLkF,OAAerF,IACTgI,EAAehI,GAAGC,SAAWwH,EAAmB3D,QAChDwC,GAAqC,IAArBE,EAAU7D,QAC9BmE,EAAyBmD,GACX,MAARA,EAAqB,EAClB1J,KAAKE,IAAIwJ,EAAO,EAAGzD,EAAU7D,OAAS,KAGjD2C,QAASxB,IAAWwC,EACpBf,kBAAkB,EAClB7B,iBAAiB,EACjB8E,gBAAgB,GAGlB,CACErI,IAAK,IACLkF,OAAerF,IACTgI,EAAehI,GAAGC,SAAWD,EAAEC,SAAW2H,EAAaoB,SACtD1C,IAAgBmB,EAAmB3D,QACxCmB,WAAW,KACT2C,EAAaoB,SAASC,QACtBrB,EAAaoB,SAAS1F,YACrB,IAELgC,QAASxB,GAAUwC,EACnBf,kBAAkB,EAClB7B,iBAAiB,EACjB8E,gBAAgB,GAGlB,CACErI,IAAK,IACLkF,OAAerF,IACTgI,EAAehI,GAAGC,SAAWD,EAAEC,SAAW6H,EAAckB,SACvD1C,IAAgBmB,EAAmB3D,QACxCmB,WAAW,KACT6C,EAAckB,SAASC,QACvBnB,EAAckB,SAAS1F,YACtB,IAELgC,QAASxB,GAAUwC,EACnBf,kBAAkB,EAClB7B,iBAAiB,EACjB8E,gBAAgB,GAGlB,CACErI,IAAK,UACLkF,OAAerF,IACTgI,EAAehI,GAAGC,SAAWwH,EAAmB3D,QAC/CwC,GAAqC,IAArBE,EAAU7D,QAC/BqE,KAAiCzG,KAAKC,IAAI,EAAGyJ,EAAO,KAEtD3E,QAASxB,GAAUwC,EACnBf,kBAAkB,EAClB7B,iBAAiB,EACjB8E,gBAAgB,GAElB,CACErI,IAAK,YACLkF,OAAerF,IACTgI,EAAehI,GAAGC,SAAWwH,EAAmB3D,QAC/CwC,GAAqC,IAArBE,EAAU7D,QACPsH,EAAAA,GACtB1J,KAAKE,IAAI+F,EAAU7D,OAAS,GAAIsH,GAAQ,GAAK,KAGjD3E,QAASxB,GAAUwC,EACnBf,kBAAkB,EAClB7B,iBAAiB,EACjB8E,gBAAgB,GAGlB,CACErI,IAAK,SACLkF,OAAerF,IACb,GAAIgI,EAAehI,GAAGC,SAAWwH,EAAmB3D,OAAQ,OAC5D,IAAKwC,GAAqC,IAArBE,EAAU7D,OAAc,OACvC1C,MAAAA,EAASuG,EAAUO,GACrB9G,GAAQwJ,aAA0BxJ,EAAAA,EAAOwJ,cAE/CnE,QAASxB,GAAUwC,EACnBf,kBAAkB,EAClB7B,iBAAiB,EACjB8E,gBAAgB,IAGpB,CACE1E,EACAwC,EACAE,EACAlF,EACA4J,EACAD,EACAlH,EACAgD,EACA2B,EACAjB,EAAmB3D,OACnB0G,EACAF,IAqJJ,OAGIlL,EAAAA,KAAA+M,WAAA,CAAAhN,SAAA,CAAAC,EAAAA,KAACoG,EAAA,CACC1B,OAAQA,IAAW2D,EAAmB3D,OACtCC,UACAR,MAAO+C,EAAe,mBAAqB,kBAC3Cb,SACEa,EACI,iCACA,6BAENvF,WACG,MACC,CAAAjC,UAAU,qBACVO,KAAK,OACLC,OAAO,eACPC,QAAQ,YAERJ,SAACH,EAAAA,IAAA,OAAA,CACCQ,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,mIAIR+F,OAAQY,EAAe8E,EAAwBC,EAC/CxK,KAAK,KACL8E,iBAAiB,YAEhBwB,SAAAA,CAAAA,GACEnI,EAAAA,IAAA,MAAA,CAAIF,UAAU,4EACZqI,SACHA,IAEDb,EAlJJlH,OAAA,MAAA,CAAIN,UAAU,YACbK,SAAA,CAAAH,EAAAA,IAAC,OAAIF,UAAU,aACbK,eAAC,SACC,CAAAL,UAAW,qEACO,eAAhByI,EAA+B,yBAA2B,6BAE5DjH,QAAS,IAAMkH,EAAe,cAC/BrI,0BAMHH,EAAAA,IAAC,OACCD,IAAKgJ,EACLjJ,UAAU,gDAET0H,SAAAA,EAAU3D,IAAI,CAAClD,EAAGwC,IAChB/C,OAAA,MAAA,CAEC,oBAAmB+C,EACnBrD,UAAW,qEACTiI,IAAwB5E,EAAM,kCAAoC,qBAGpEhD,SAAA,CAAAH,MAAC,SACCF,UAAU,yDACVgB,MAAOH,EAAEiB,MACTwL,UAAQ,IAEVpN,MAAC,SACCF,UAAU,mEACVgB,MAAOH,EAAEG,MACTsM,UAAQ,UAET,SACC,CAAAtN,UAAU,wDACVwB,QAAS,IAAMa,EAAaxB,EAAE8J,aAC9BlG,MAAM,eACN3D,KAAK,SAELT,SAAAH,EAAAA,IAAC,OACCqN,MAAM,6BACNvN,UAAU,UACVO,KAAK,OACLE,QAAQ,YACRD,OAAO,eAEPH,SAACH,EAAAA,IAAA,OAAA,CACCQ,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,+BAjCHwC,MA0CV/C,EAAAA,KAAA,MAAA,CACCN,UAAU,6DACVoE,UAAkBlD,IACF,UAAVA,EAAEG,MACJH,EAAEwI,iBACFxI,EAAE0D,kBACgBgF,MAItBvJ,SAAA,CAACH,EAAAA,IAAA,MAAA,CAAIF,UAAU,2CAA2CK,SAE1D,kDACAC,EAAAA,KAAC,MAAI,CAAAN,UAAU,aACbK,SAAA,CAAAH,EAAAA,IAAC,QAAA,CACCF,UAAU,iHACVuB,YAAY,cACZP,MAAO4G,EACP3H,IAAK6I,EACL1E,UAAYlD,GAAMsI,EAAmBtI,EAAG,QACxCqD,QAAS,IAAMkD,GAAgB,GAC/BxG,SAAWC,GAAM2G,EAAW3G,EAAEC,OAAOH,SAEvCd,EAAAA,IAAC,QAAA,CACCF,UAAU,2HACVuB,YAA6B,eAAhBkH,EAA+B,KAAO,OACnDvE,UAA2B,eAAhBuE,EAA+B,UAAY,UACtDzH,MAAO8G,EACP7H,IAAK+I,EACL5E,UAAYlD,GAAMsI,EAAmBtI,EAAG,SACxCqD,QAAS,IAAMkD,GAAgB,GAC/BxG,SAAWC,GAAM6G,EAAY7G,EAAEC,OAAOH,OACtCF,KAAK,SACLa,IAAI,MAELzB,EAAAA,IAAA,SAAA,CACCF,UAAU,4FACVwB,QAASoI,EACTnF,MAAM,cACN3D,KAAK,SACL0L,SAAUjE,EAETA,SAAAA,EAAS,MAAQ,eAvIxBjI,EAAAA,KAAC,MAAI,CAAAN,UAAU,YACbK,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,yCACbK,SAAA,CAACH,EAAAA,IAAA,KAAA,CAAGF,UAAU,sBAAsBK,SAAe,oBAClDH,EAAAA,IAAA,OAAA,CAAKF,UAAU,wBAAwBK,SAAgC,wCAE1EH,EAAAA,IAAC,OAAIF,UAAU,uDACZ0H,WAAU3D,IAAI,CAAClD,EAAGwC,IAChB/C,EAAAA,KAAA,SAAA,CAECN,UAAW,kCACTwC,IAAgBa,EACZ,6BACA,oDAEN7B,QAAS,IAAMwG,EAAe3E,GAE9BhD,SAAA,CAAAH,EAAAA,IAAC,MAAI,CAAAF,UAAU,cAAea,SAAAA,EAAEiB,QAChCxB,EAAAA,KAAC,MAAI,CAAAN,UAAU,wBAAyBa,SAAAA,CAAEG,EAAAA,MAAM,OAC/CwB,IAAgBa,GACfnD,EAAAA,IAAC,MAAI,CAAAF,UAAU,kDAAkDK,SAEjE,2BAbG,GAAGQ,EAAEC,QAAQuC,iBA6KvB,MAAI,CAAArD,UAAU,qCACbK,SAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,kCACZwH,SAAAA,CAAAA,EAEGlH,EAAAA,KAAA+M,WAAA,CAAAhN,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAe,oBACpBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,4CAA4CK,SAAG,WAEjEC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAgB,qBACrBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,4CAA4CK,SAAG,WAEjEC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAmB,wBACxBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,4CAA4CK,SAAK,aAEnEC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAS,cACdH,EAAAA,IAAA,OAAA,CAAKF,UAAU,4CAA4CK,SAAK,gBAKnEC,EAAAA,KAAA+M,EAAAA,SAAA,CAAAhN,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAgB,qBACrBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,4CAA4CK,SAAQ,gBAEtEC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAe,oBACpBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,4CAA4CK,SAAK,aAEnEC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAiB,sBACtBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,4CAA4CK,SAAC,YAInEC,EAAAA,KAAC,MAAI,CAAAN,UAAU,uEACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAY,iBACjBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,4CAA4CK,SAAG,yBAOtEqG,EACC,CAAA1B,OAAQ2D,EAAmB3D,OAC3BC,QAASuG,EACT/G,MAAM,4BACNkC,SAAS,gCACT5E,KAAK,KACL6E,OACGtG,EAAAA,KAAA,MAAA,CAAIN,UAAU,oCACbK,SAAA,CAACH,EAAAA,IAAA2B,EAAA,CACCC,MAAM,SACN1B,QAAQ,YACRoB,QAASgK,EACTgB,SAAUjE,IAEZrI,EAAAA,IAAC2B,EACC,CAAAC,MAAOyG,EAAS,cAAgB,kBAChCnI,QAAQ,SACRoB,QAASkK,EACTc,SAAUjE,OAKhBlI,eAAC,MAAI,CAAAL,UAAU,iDACbK,SAACC,EAAAA,KAAA,IAAA,CAAEN,UAAU,uBAAuBK,SAAA,CAAA,4DAEjCH,EAAAA,IAAA,SAAA,CAAOF,UAAU,qCAAsC2I,WAAmB7G,iBAMvF,CC5yBA,SAAS0L,GAAgBxI,OAAEA,EAAAA,QAAQC,IAEjC,MAAOwI,EAAKC,GAAUtI,EAAAA,SAAS,YAExBuI,EAAqBC,GAA0BxI,EAAAA,SAAS,OAGxDyI,EAAQC,GAAa1I,EAAAA,SAAS,KAC9B2I,EAAcC,GAAmB5I,EAAAA,SAAS,KAC1C6I,EAAgBC,GAAqB9I,EAAAA,UAAS,IAC9C+I,EAAWC,GAAgBhJ,EAAAA,UAAS,IACpCiD,EAAOC,GAAYlD,EAAAA,SAAS,IAmB7BiJ,EAAoB/I,MAAOgJ,EAAc,QAC7CF,GAAa,GACT,IACF9F,EAAS,IACT,MAAMiG,EAAID,EAAc,yCAAyC3I,mBAAmB2I,eAA2B,qCACzGrC,QAAapG,EAAI0I,GACvBP,EAAgBhB,MAAMwB,QAAQvC,GAAQA,EAAO,UACtCwC,GACEA,EAAAA,EAAIzC,SAAW,8BAA6B,CAC7C,QACRoC,GAAa,EAAK,GAKtBnI,EAAAA,UAAU,KACHjB,IA/BaM,WAClB4I,GAAkB,GACd,IACF5F,EAAS,IACH2D,MAAAA,QAAapG,EAAI,sBAEvBiI,EAAUd,MAAMwB,QAAQvC,GAAQA,EAAO,UAChCwC,GACEA,EAAAA,EAAIzC,SAAW,6BAA4B,CAC5C,QACRkC,GAAkB,EAAK,GAsBbQ,GACML,MAEjB,CAACrJ,IAEJsB,EACE,CACE,CACEjF,IAAK,SACLkF,OAAQtB,EACRuB,QAASxB,EACTyB,kBAAkB,GAEpB,CACEpF,IAAK,IACLkF,OAAQA,KACNmH,EAAO,WACPE,EAAuB,OAEzBpH,QAASxB,GAEX,CACE3D,IAAK,IACLkF,OAAQA,KACNmH,EAAO,gBACPE,EAAuB,OAEzBpH,QAASxB,IAGb,CAACA,EAAQyI,IAIX,MA6HMkB,EACJrO,EAAAA,KAAC,MAAI,CAAAN,UAAU,mDACbK,SAAA,CAACC,OAAA,SAAA,CACCkB,QAAS,KACPkM,EAAO,WACPE,EAAuB,OAEzB5N,UAAW,+FACD,YAARyN,EACI,mCACA,+CAGNpN,SAAA,CAACH,EAAAA,IAAA0O,EAAA,CAAc5O,UAAU,YACzBE,EAAAA,IAAC,QAAKG,SAAW,mBAEnBC,OAAC,SACC,CAAAkB,QAAS,KACPkM,EAAO,gBACPE,EAAuB,OAEzB5N,UAAW,+FACD,iBAARyN,EACI,mCACA,+CAGNpN,SAAA,CAACH,EAAAA,IAAA2O,EAAA,CAAY7O,UAAU,YACvBE,EAAAA,IAAC,QAAKG,SAAgB,2BAM1B,OAAAH,MAACwG,GACC1B,SACAC,UACAR,MAAM,cACNkC,SAAS,wCACT1E,KAAM/B,EAAAA,IAAC4O,GAAuB9O,UAAU,uBACxC+B,KAAK,KACL8E,iBAAiB,YAEjBxG,SAAAC,EAAAA,KAAC,MAAI,CAAAN,UAAU,YACZyN,SAAAA,CAAQ,YAAAA,EAzKOsB,MACpB,MAAMC,EAAYnB,EAAOhJ,OAAO,CAACC,EAAKhE,IAASgE,GAAOlD,OAAOd,EAAKmO,UAAY,GAAI,GAGhF,OAAA3O,EAAAA,KAAC,MAAI,CAAAN,UAAU,YAEbK,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,mHACbK,SAAA,CAACH,EAAAA,IAAA,IAAA,CAAEF,UAAU,2CAA2CK,SAAkB,uBAC1EC,EAAAA,KAAC,MAAI,CAAAN,UAAU,4DACbK,SAAA,CAACH,EAAAA,IAAA,OAAA,CAAKF,UAAU,WAAWK,SAAC,MAC3B2O,EAAUrK,QAAQ,MAErBzE,MAAC,KAAEF,UAAU,6BACVK,cAAI6O,MAAOC,mBAAmB,QAAS,CAAEC,QAAS,OAAQC,KAAM,UAAWC,MAAO,OAAQC,IAAK,wBAKnG,MACC,CAAAlP,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,+BACbK,SAAA,CAAAH,EAAAA,IAAC,OAAIF,UAAU,sGACbK,eAACyO,EAAuB,CAAA9O,UAAU,yBAEnCE,EAAAA,IAAA,KAAA,CAAGF,UAAU,8BAA8BK,SAAe,uBAE7DH,EAAAA,IAAC,MAAI,CAAAF,UAAU,YACZiO,SAAAA,EACE/N,EAAAA,IAAA,MAAA,CAAIF,UAAU,wBAAwBK,SAAU,eAC7B,IAAlBwN,EAAOhK,OACR3D,EAAAA,IAAA,MAAA,CAAIF,UAAU,wBAAwBK,SAAqB,0BAE5DwN,EAAO9J,IACLjD,GAAAZ,EAAAA,IAAC,SAEC,CAAAsB,QAAS8D,UACPsI,EAAuB9M,EAAKC,MAC5B2M,EAAO,sBACDW,EAAkBvN,EAAKC,OAE/Bf,UAAU,iMAEVK,SAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,oCACbK,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,iCACbK,SAAA,CAACH,EAAAA,IAAA,MAAA,CAAIF,UAAU,0JACbK,SAACH,EAAAA,IAAA,MAAA,CAAIF,UAAU,kDAAkDO,KAAK,OAAOC,OAAO,eAAeC,QAAQ,YACzGJ,SAACH,EAAAA,IAAA,OAAA,CAAKQ,cAAc,QAAQC,eAAe,QAAQC,YAAa,EAAGC,EAAE,oLAGzEP,EAAAA,KAAC,MAAI,CAAAN,UAAU,YACbK,SAAA,CAAAH,EAAAA,IAAC,IAAE,CAAAF,UAAU,8BAA+Bc,SAAAA,EAAKC,OAChDb,EAAAA,IAAA,IAAA,CAAEF,UAAU,wBAAwBK,SAAiB,4BAG1DC,EAAAA,KAAC,MAAI,CAAAN,UAAU,0BACbK,SAAA,CAAAH,EAAAA,IAAC,OAAIF,UAAU,aACbK,SAACC,EAAAA,KAAA,IAAA,CAAEN,UAAU,kCAAkCK,SAAA,CAAA,KAAGuB,OAAOd,EAAKmO,UAAY,GAAGtK,QAAQ,QAEvFzE,EAAAA,IAACsP,EAAe,CAAAxP,UAAU,6EAxBzBc,EAAKC,YAgCnBsH,GACCnI,EAAAA,IAAC,MAAI,CAAAF,UAAU,uBACZqI,SAAMwB,EAAAA,SAAS,uCAAyCxB,EAAMwB,SAAS,cACpE,6EACAxB,QAoGa0G,GA1FvBzO,EAAAA,KAAC,MAAI,CAAAN,UAAU,YAEbK,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,yFACbK,SAAA,CAAAH,EAAAA,IAAC,MAAGF,UAAU,kCAAmC2N,WAAsB,GAAGA,iBAAqC,qBAC9GzN,EAAAA,IAAA,IAAA,CAAEF,UAAU,6BAA8BmO,WAAY,aAAe,GAAGJ,EAAalK,qBAA6C,IAAxBkK,EAAalK,OAAe,IAAM,sBAI9I,MAAI,CAAA7D,UAAU,iEACZmO,SAAAA,QACE,MAAI,CAAAnO,UAAU,0CAA0CK,SAAA,4BAC/B,IAAxB0N,EAAalK,OACdvD,OAAA,MAAA,CAAIN,UAAU,oBACbK,SAAA,CAAAH,EAAAA,IAAC,OAAIF,UAAU,uCAAuCO,KAAK,OAAOC,OAAO,eAAeC,QAAQ,YAC9FJ,eAAC,OAAK,CAAAK,cAAc,QAAQC,eAAe,QAAQC,YAAa,IAAKC,EAAE,2HAExEX,EAAAA,IAAA,IAAA,CAAEF,UAAU,4BAA4BK,SAAqB,mCAG/D,MAAI,CAAAL,UAAU,kBACbK,SAACC,EAAAA,KAAA,QAAA,CAAMN,UAAU,SACfK,SAAA,CAAAH,MAAC,QACC,CAAAG,SAAAC,EAAAA,KAAC,KAAG,CAAAN,UAAU,wEACZK,SAAA,CAACH,EAAAA,IAAA,KAAA,CAAGF,UAAU,+EAA+EK,SAAW,gBACvGH,EAAAA,IAAA,KAAA,CAAGF,UAAU,+EAA+EK,SAAI,SAChGH,EAAAA,IAAA,KAAA,CAAGF,UAAU,gFAAgFK,SAAM,gBAGxGH,EAAAA,IAAC,QAAM,CAAAF,UAAU,2BACd+N,SAAAA,EAAahK,IACZ0L,GAAAnP,EAAAA,KAAC,KAAmC,CAAAN,UAAU,qDAC5CK,SAAA,CAACH,EAAAA,IAAA,KAAA,CAAGF,UAAU,8CAA+CK,SAAA,IAAI6O,KAAKO,EAAGC,YAAYC,mBACrFzP,EAAAA,IAAC,KAAG,CAAAF,UAAU,oBAAoBK,SAAAH,EAAAA,IAAC,QAAKF,UAAU,yHAA0HyP,SAAGG,EAAAA,iBAC/KtP,EAAAA,KAAC,KAAG,CAAAN,UAAU,wDAAwDK,SAAA,CAAA,KAAGuB,OAAO6N,EAAGlN,QAAU,GAAGoC,QAAQ,QAHjGwI,OAAOsC,EAAGI,8BA6D9BlB,EACDrO,EAAAA,KAAC,MAAI,CAAAN,UAAU,+EACbK,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAa,kBAClBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAC,SAE5DC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAkB,uBACvBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAC,SAE5DC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAM,WACXH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAG,kBAMxE,CCpRA,SAASyP,GAAc9K,OAAEA,EAAAA,QAAQC,EAAAA,MAAS1C,EAAAA,gBAAOwN,IAC/CzJ,EACE,CACE,CAAEjF,IAAK,IAAKkF,OAAQA,IAAMwJ,EAAgB,QAASvJ,QAASxB,GAC5D,CAAE3D,IAAK,IAAKkF,OAAQA,IAAMwJ,EAAgB,SAAUvJ,QAASxB,GAC7D,CAAE3D,IAAK,IAAKkF,OAAQA,IAAMwJ,EAAgB,QAASvJ,QAASxB,GAC5D,CAAE3D,IAAK,QAASkF,OAAQA,IAAMwJ,EAAgB,QAASvJ,QAASxB,GAChE,CAAE3D,IAAK,SAAUkF,OAAQtB,EAASuB,QAASxB,IAE7C,CAACA,IAGH,MAAMqB,EACJ/F,EAAAA,KAAC,MAAI,CAAAN,UAAU,6BACbK,SAAA,CAACH,EAAAA,IAAA2B,EAAA,CACCC,MAAM,mBACN9B,UAAU,kCACVwB,QAAS,IAAMuO,EAAgB,UAEjC7P,EAAAA,IAAC2B,EACC,CAAAC,MAAM,YACN9B,UAAU,kCACVwB,QAAS,IAAMuO,EAAgB,WAEjC7P,EAAAA,IAAC2B,EACC,CAAAC,MAAM,WACN9B,UAAU,kCACVwB,QAAS,IAAMuO,EAAgB,aAKrC,cACGrJ,EACC,CAAA1B,SACAC,UACAR,MAAM,WACNkC,SAAS,wBACT1E,KACE/B,EAAAA,IAAC,OACCF,UAAU,qBACVO,KAAK,OACLC,OAAO,eACPC,QAAQ,YAERJ,SAAAH,EAAAA,IAAC,QACCQ,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,2JAIR+F,OAAQP,EACRtE,KAAK,KACL8E,iBAAiB,cAEjBxG,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,gEACbK,SAAA,CAACH,EAAAA,IAAA,MAAA,CAAIF,UAAU,0BAA0BK,SAAY,iBACrDC,EAAAA,KAAC,MAAI,CAAAN,UAAU,qBAAqBK,SAAA,CAAA,IAAEkC,EAAMoC,QAAQ,SAErDzE,EAAAA,IAAA,IAAA,CAAEF,UAAU,6BAA6BK,SAE1C,yCACAC,EAAAA,KAAC,MAAI,CAAAN,UAAU,yFACbK,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAK,UACVH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAS,iBAEpEC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAM,WACXH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAC,SAE5DC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAK,UACVH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAC,SAE5DC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAM,WACXH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAG,gBAKtE,CCpFA,SAAS2P,GAAyBhL,OAChCA,EAAAA,QACAC,EAAAA,OACAgL,EAAS,EAAAC,QACTA,EAAU,EAAAC,UACVA,EAAAA,WACAC,IAEA9J,EACE,CACE,CACEjF,IAAK,SACLkF,OAAQtB,EACRuB,QAASxB,EACTyB,kBAAkB,GAEpB,CACEpF,IAAK,QACLkF,OAAQA,KACF4J,GAAqBA,KAE3B3J,QAASxB,EACTyB,kBAAkB,IAGtB,CAACzB,IAGH,MAAMqB,EACJnG,EAAAA,IAAC,MAAI,CAAAF,UAAU,6BACbK,SAAAH,EAAAA,IAAC2B,EACC,CAAAC,MAAM,kBACN9B,UAAU,6EACVwB,QAAS,KACH2O,EAAqBA,UACd,gBAMnB,OACG7P,EAAAA,KAAAoG,EAAA,CACC1B,SACAC,UACAR,MAAM,mBACNxC,KACG/B,EAAAA,IAAA,MAAA,CACCF,UAAU,qBACVO,KAAK,OACLC,OAAO,eACPC,QAAQ,YAERJ,SAACH,EAAAA,IAAA,OAAA,CACCQ,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,qBAIR+F,OAAQP,EACRtE,KAAK,KACL8E,iBAAiB,wBAGjBxG,SAAA,CAAAH,MAAC,MAAI,CAAAF,UAAU,2BACbK,SAAAH,EAAAA,IAAC,MAAI,CAAAF,UAAU,uEACbK,SAAAH,EAAAA,IAAC,MACC,CAAAqN,MAAM,6BACNvN,UAAU,yBACVO,KAAK,OACLE,QAAQ,YACRD,OAAO,eAEPH,SAACH,EAAAA,IAAA,OAAA,CACCQ,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,yBAOVP,EAAAA,KAAC,MAAI,CAAAN,UAAU,2EACbK,SAAA,CAACH,EAAAA,IAAA,MAAA,CAAIF,UAAU,kDAAkDK,SAEjE,WAEAC,EAAAA,KAAC,MAAI,CAAAN,UAAU,yFACbK,SAAA,CAACH,EAAAA,IAAA,OAAA,CAAKF,UAAU,oBAAoBK,SAAC,MACrCH,EAAAA,IAAC,QAAKF,UAAU,qBACb4B,gBAAOqO,GAAQtL,QAAQ,QAI3BzE,EAAAA,IAAA,MAAA,CAAIF,UAAU,0BAA0BK,SAAO,YAChDC,EAAAA,KAAC,MAAI,CAAAN,UAAU,wBAAwBK,SAAA,CAAA,IACnCuB,OAAOsO,GAASvL,QAAQ,SAG9BrE,EAAAA,KAAC,MAAI,CAAAN,UAAU,yFACbK,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAqB,0BAC1BH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAK,aAEhEC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAM,WACXH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAG,gBAKtE,CClHA,SAASgQ,GAAiBrL,OAAEA,EAAAA,QAAQC,EAAAA,MAAS1C,EAAAA,UAAO+N,IAClD,MAAOC,EAAgBC,GAAqBpL,EAAAA,SAAS,KAC9CqL,EAAcC,GAAmBtL,EAAAA,UAAS,IAC1CuL,EAAcC,GAAmBxL,EAAAA,SAAS,OAC1CyL,EAAgBC,GAAqB1L,EAAAA,UAAS,IAC9C2L,EAAcC,GAAmB5L,EAAAA,SAAS,IAC3C6L,EAAiBlI,SAAO,MACxBmI,EAAqBnI,UAAO,GAI5BoI,EAA2BjQ,IAC3BA,IACFA,EAAEwI,iBACFxI,EAAE0D,mBAGJ,MAAMwM,EAAcxP,OAAOW,GAAOoC,QAAQ,GAC1C6L,EAAkBY,GAClBF,EAAmBhH,SAAU,EAE7B/D,WAAW,KACT+K,EAAmBhH,SAAU,GAC5B,MAGCmH,EAAuBnQ,IACvBA,IACFA,EAAEwI,iBACFxI,EAAE0D,mBAOJ,IAAI0M,EAHeL,EAAe/G,SAASlJ,OAASuP,EAIhDW,EAAmBhH,UACrBoH,EAAc1P,OAAOW,GAAOoC,QAAQ,IAItC,MAAM4M,GAAiBD,GAAaE,YAAc,IAAIlQ,OACtD,IAAKiQ,EAEH,YADAE,MAAM,2BAGFC,MAAAA,EAAW9P,OAAO2P,GACxB,GAAIlG,MAAMqG,IAAaA,GAAY,EAEjC,YADAD,MAAM,gCAIR,MAAME,EAAkBlQ,KAAKmQ,MAAiB,IAAXF,GAAkB,IAC/CG,EAAepQ,KAAKmQ,MAAc,IAARrP,GAAe,IAC/C,GAAIoP,EAAkBE,EAGpB,OAFgBb,EAAA,qBAAqBW,EAAgBhN,QAAQ,gDAAgDkN,EAAalN,QAAQ,aAClImM,GAAkB,GAKpB,MAAMb,EAASxO,KAAKC,IAAI,EAAGiQ,EAAkBE,GAC7BjB,EAAA,CAAEX,SAAQC,QAAS2B,EAAcH,SAAUC,IAC3DjB,GAAgB,IAIZoB,EAAsBA,KAC1BpB,GAAgB,GACZzL,GAAiBA,KAIjB8M,EAAiBA,KACrBrB,GAAgB,GAChBF,EAAkB,IACdvL,GAAiBA,KAIjB+M,EAAgBA,KAChB1B,GAAuC,MAA1BK,GAAce,UACnB9P,EAAAA,OAAO+O,EAAae,YA0DlC,GArDApL,EACE,CACE,CACEjF,IAAK,SACLkF,OAAQA,IAAMuK,GAAkB,GAChCtK,QAASqK,EACTpK,kBAAkB,GAEpB,CACEpF,IAAK,QACLkF,OAAerF,IACbA,EAAEwI,iBACFxI,EAAE0D,kBACFkM,GAAkB,IAEpBtK,QAASqK,EACTpK,kBAAkB,IAGtB,CAACoK,IAKHvK,EACE,CACE,CACEjF,IAAK,SACLkF,OAAQtB,EACRuB,QAASxB,IAAWyL,IAAiBI,EACrCpK,kBAAkB,GAEpB,CACEpF,IAAK,QACLkF,OAAerF,IACbA,EAAEwI,iBACFxI,EAAE0D,kBACFyM,EAAcnQ,IAEhBsF,QAASxB,IAAWyL,IAAiBI,EACrCpK,kBAAkB,GAEpB,CACEpF,IAAK,IACLkF,OAAQ4K,EACR3K,QAASxB,IAAWyL,IAAiBI,EACrCpK,kBAAkB,IAGtB,CAACzB,EAAQuL,EAAgBhO,EAAOkO,EAAcI,KAI3C7L,IAAWyL,EAAqB,OAAA,KAGrC,GAAIA,EACF,OACGvQ,EAAAA,IAAA8P,EAAA,CACChL,OAAQyL,EACRxL,QAAS6M,EACT7B,OAAQU,GAAcV,OACtBC,QAASS,GAAcT,QACvBE,WAAY2B,EACZ5B,UAAW6B,IAKjB,MAAM3L,EAEF/F,EAAAA,KAAA+M,EAAAA,SAAA,CAAAhN,SAAA,CAACH,EAAAA,IAAA2B,EAAA,CACCC,MAAM,eACN1B,QAAQ,YACRoB,QAASyD,EACTnE,KAAK,SACLd,UAAU,WAEZE,EAAAA,IAAC2B,EACC,CAAAC,MAAM,kBACN1B,QAAQ,UACRU,KAAK,SACLU,QAAS6P,EACTrR,UAAU,cAKhB,OAEEM,EAAAA,KAAA+M,WAAA,CAAAhN,SAAA,CAAAC,OAACoG,EACC,CAAA1B,SACAC,UACAR,MAAM,eACNkC,SAAS,wBACT1E,KACE/B,EAAAA,IAAC,OACCF,UAAU,qBACVO,KAAK,OACLC,OAAO,eACPC,QAAQ,YAERJ,SAAAH,MAAC,QACCQ,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,kLAIR+F,OAAQP,EACRtE,KAAK,KACL8E,iBAAiB,YAGjBxG,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,6FACbK,SAAA,CAACH,EAAAA,IAAA,MAAA,CAAIF,UAAU,0BAA0BK,SAAY,iBACrDC,EAAAA,KAAC,MAAI,CAAAN,UAAU,qBAAqBK,SAAA,CAAA,IAAEkC,EAAMoC,QAAQ,gBAIrD,MACC,CAAAtE,SAAA,CAACH,EAAAA,IAAA,QAAA,CAAMF,UAAU,+CAA+CK,SAEhE,oBACCH,EAAAA,IAAA,QAAA,CACCD,IAAKgR,EACLnQ,KAAK,SACLmR,KAAK,OACLjS,UAAU,mJACVuB,YAAY,QACZP,MAAOuP,EACPtP,SAAiBC,IAETF,MAAAA,EAAQE,EAAEC,OAAOH,OACT,KAAVA,GAAgB,cAAckC,KAAKlC,KACrCwP,EAAkBxP,gBAOzB,MACC,CAAAX,SAAA,CAACH,EAAAA,IAAA,IAAA,CAAEF,UAAU,6BAA6BK,SAAc,mBACvDH,EAAAA,IAAA,MAAA,CAAIF,UAAU,yBACZK,SAAC,CAAA,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAAK0D,IAC7CmO,GAAAhS,EAAAA,IAAC,SAEC,CAAAF,UAAU,kGACVwB,QAAS,IArOM0Q,CAAQ1B,GAAAA,EAAkB5O,OAAOsQ,GAAKV,YAqOtCW,CAAkBD,GAEhCA,SAJIA,GAAAA,eAWZrQ,EACC,CAAAC,MAAM,uBACN9B,UAAU,2EACVwB,QAAS2P,IAEX7Q,EAAAA,KAAC,MAAI,CAAAN,UAAU,yFACbK,SAAA,CAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAgB,qBACrBH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAC,SAE5DC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAQ,aACbH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAK,aAEhEC,EAAAA,KAAC,MAAI,CAAAN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAM,WACXH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAG,iBAMlEH,EAAAA,IAACwG,EACG,CAAA1B,OAAQ6L,EACR5L,QAAS,IAAM6L,GAAkB,GACjCrM,MAAM,sBACN1C,KAAK,KACLqQ,sBAAsB,aACtBnQ,KACG/B,EAAAA,IAAA,MAAA,CAAIF,UAAU,qBAAqBO,KAAK,OAAOC,OAAO,eAAeC,QAAQ,YAC5EJ,SAACH,EAAAA,IAAA,OAAA,CAAKQ,cAAc,QAAQC,eAAe,QAAQC,YAAa,EAAGC,EAAE,gJAGzE+F,OACG1G,EAAAA,IAAA2B,EAAA,CACCC,MAAM,aACN1B,QAAQ,UACRoB,QAAS,IAAMsP,GAAkB,GACjC9Q,UAAU,uCAIdK,SAAAC,EAAAA,KAAC,MAAI,CAAAN,UAAU,mBACbK,SAAA,CAACH,EAAAA,IAAA,IAAA,CAAEF,UAAU,oCAAqC+Q,SAAaA,IAC9D7Q,EAAAA,IAAA,IAAA,CAAEF,UAAU,6BAA6BK,SAA4B,wCAKhF,CCvSA,SAAwBgS,GAAsBrN,OAAEA,EAAAA,QAAQC,EAAAA,SAASqN,IAC/D,MAAOC,EAAeC,GAAoBpN,EAAAA,UAAS,IAC5CiD,EAAOC,GAAYlD,EAAAA,SAAS,IAC7BgF,EAAQC,eAAe5E,QAAQ,cAE/BgN,EAAOxH,KAAKyH,MAAMrI,eAAe5E,QAAQ,SAAW,MAsFpDY,EACHnG,EAAAA,IAAA2B,EAAA,CACCC,MAAM,cACN1B,QAAQ,YACRoB,QAASyD,EACTjF,UAAU,WASd,OALAsG,EACE,CAAC,CAAEjF,IAAK,SAAUkF,OAAQtB,EAASuB,QAASxB,IAC5C,CAACA,WAIA0B,EACC,CAAA1B,SACAC,UACAR,MAAM,qBACNkC,SAAS,gCACT1E,KACE/B,EAAAA,IAAC,OACCF,UAAU,qBACVO,KAAK,OACLC,OAAO,eACPC,QAAQ,YAERJ,SAAAH,EAAAA,IAAC,QACCQ,cAAc,QACdC,eAAe,QACfC,YAAa,EACbC,EAAE,qBAIR+F,OAAQP,EACRtE,KAAK,KACL8E,iBAAiB,YAEjBxG,SAAA,CAACH,EAAAA,IAAA,MAAA,CAAIF,UAAU,oCAAoCK,SAEnD,sDACC,MAAI,CAAAL,UAAU,WACbK,SAAAH,EAAAA,IAAC4G,GACCC,OAhIWzB,MAAO0B,IAClBC,MAAAA,EAAOD,IAAS,IAAIE,SAC1B,GAAKD,EAAL,CACAuL,GAAiB,GACjBlK,EAAS,IACL,IACEuC,IAAAA,EACA,IACQI,EAAAA,KAAKyH,MAAMzL,SACd/F,GACD,MAAA,IAAIyR,MAAM,qBAAoB,CAItC,GAAkB,SAAd9H,EAAQ3E,GAAgB2E,EAAQgF,eAAgB,CAC5C,MAAAA,eAAEA,EAAgB+C,YAAarN,GAAesF,EAG9CgI,EAAoBJ,GAAMlN,YAAckN,GAAMG,YACpD,GAAIrN,GAAcsN,GAAqBjR,OAAO2D,KAAgB3D,OAAOiR,GAC7D,MAAA,IAAIF,MAAM,6CAId,IACF,MAAMG,QAAiBjN,EAAI,cAAcgK,aAA2B,CAClE9E,OAAQ,OACRR,QAAS,CAAEC,cAAe,UAAUJ,OAGtC,GAAI0I,EAASjD,eAKX,OAHQ5K,SAER8N,OAAOC,SAASC,KAAO,eAAeH,EAASI,sBAGzC,MAAA,IAAIP,MAAM,wCAEXlE,GAEP,MADQpG,QAAAA,MAAM,gCAAiCoG,GACzC,IAAIkE,MAAMlE,EAAIzC,SAAW,0CAAyC,CAC1E,KACF,IAEuB,SAAdnB,EAAQ3E,IAAgB8G,MAAMwB,QAAQ3D,EAAQsI,OA0B/C,MAAA,IAAIR,MAAM,8BA1B6C,CACvD,MAAEQ,MAAOC,EAAcC,EAAG9N,GAAesF,EACzCgI,EAAoBJ,GAAMlN,YAAckN,GAAMG,YAEpD,GAAIrN,GAAcsN,GAAqBjR,OAAO2D,KAAgB3D,OAAOiR,GAC7D,MAAA,IAAIF,MAAM,6CAGlB,MAAMW,EAAY,GAClB,IAAA,MAAWC,KAAMH,EAAc,CAC7B,IAAKG,GAAIC,IAAMD,GAAIhF,EAAG,SAChBrJ,MAAAA,QAAgBW,EAAI,iBAAiBF,mBAAmB4N,EAAGC,KAAM,CACrEjJ,QAAS,CAAEC,cAAe,UAAUJ,OAEtCkJ,EAAUG,KAAK,CACbC,WAAYxO,EAAQwO,WACpBhU,IAAKwF,EAAQxF,IACbqB,KAAMmE,EAAQY,aACdlG,SAAUgC,OAAO2R,EAAGhF,GACpB7J,MAAO9C,OAAOsD,EAAQa,eAAiB,IACxC,CAEH,GAAyB,IAArBuN,EAAUzP,OAAoB,MAAA,IAAI8O,MAAM,sBAC5CL,EAASgB,GACDrO,GAAA,CAEoC,QAEvC/D,GACEA,EAAAA,EAAE8K,SAAW,6BACd3D,QAAAA,MAAM,cAAenH,EAAC,CACtB,QAERiF,WAAW,KACTqM,GAAiB,IAChB,IAAG,CA9EG,GA+HLrL,OAAQoL,EACRnL,SAAU,IAAMoL,GAAiB,GACjCxS,UAAU,oBAGbqI,GACCnI,EAAAA,IAAC,MAAI,CAAAF,UAAU,sEACZqI,SACHA,UAED,MAAI,CAAArI,UAAU,+EACbK,SAACC,EAAAA,KAAA,MAAA,CAAIN,UAAU,oCACbK,SAAA,CAAAH,EAAAA,IAAC,QAAKG,SAAM,WACXH,EAAAA,IAAA,OAAA,CAAKF,UAAU,yCAAyCK,SAAG,eAKtE"}