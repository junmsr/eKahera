import{j as e}from"./utils-L0j39QIW.js";import{a as s,L as a,R as t}from"./vendor-DPJ7iNYg.js";import{a as r,B as n,b as i,L as l}from"./index--918VUrQ.js";import{C as o}from"./Card-DXlcOk_J.js";import{S as c}from"./SectionHeader-jpTrkMUD.js";import{I as d}from"./Input-DoNyYXSI.js";import{P as m}from"./PasswordInput-B67VXabr.js";import{g as u,a as x,b as p,c as h}from"./locationApi-D8IA0i6v.js";import{T as g,P as b}from"./PrivacyPolicyModal-B6Yjfwo1.js";import"./BaseModal-Cy73DE2S.js";function y(){const e=[{label:"Account Info",icon:"ðŸ‘¤"},{label:"OTP Verification",icon:"ðŸ”’"},{label:"Business Details",icon:"ðŸ¢"},{label:"Document Upload",icon:"ðŸ“„"}],[a,t]=s.useState(0),[n,i]=s.useState({email:"",firstName:"",fullName:"",username:"",businessName:"",businessEmail:"",useAdminEmail:!1,businessType:"",customBusinessType:"",region:"",province:"",city:"",barangay:"",regionName:"",provinceName:"",cityName:"",barangayName:"",houseNumber:"",mobile:"",password:"",confirmPassword:"",otp:"",documents:[],documentTypes:[],acceptTerms:!1,acceptPrivacy:!1}),[l,o]=s.useState({}),[c,d]=s.useState(!1),[m,u]=s.useState(!1),[x,p]=s.useState(!1),h=s.useRef(null);s.useEffect(()=>{h.current&&h.current.focus()},[a]),s.useEffect(()=>{1===a&&x&&b()},[a,x]),s.useEffect(()=>{1!==a||4!==n.otp.length||x||c||b()},[n.otp,a,x,c]);const g=e=>{const s={};if(0===e){const e=(t=n.email)?/^\S+@\S+\.\S+$/.test(t)?null:"Invalid email address":"Required";e&&(s.email=e),n.firstName||(s.firstName="Required"),n.fullName||(s.fullName="Required");const r=(a=n.username)?/^[a-zA-Z0-9_]{3,20}$/.test(a)?null:"Username must be 3-20 characters (letters, numbers, underscores)":"Required";r&&(s.username=r),n.mobile?/^\d{11}$/.test(n.mobile)||(s.mobile="Mobile number must be exactly 11 digits"):s.mobile="Required",n.password?n.password.length<12?s.password="Password must be at least 12 characters long":/[A-Z]/.test(n.password)?/[a-z]/.test(n.password)?/\d/.test(n.password)?/[!@#$%^&*(),.?":{}|<>]/.test(n.password)||(s.password="Password must contain at least one special character"):s.password="Password must contain at least one number":s.password="Password must contain at least one lowercase letter":s.password="Password must contain at least one uppercase letter":s.password="Required",n.password!==n.confirmPassword&&(s.confirmPassword="Passwords do not match")}var a,t;if(1===e&&(n.otp?/^[A-Za-z0-9]{4}$/.test(n.otp)||(s.otp="Please enter a 4-character OTP"):s.otp="Required"),2===e&&(n.businessName||(s.businessName="Required"),n.useAdminEmail||n.businessEmail?n.useAdminEmail||!n.businessEmail||/^\S+@\S+\.\S+$/.test(n.businessEmail)||(s.businessEmail="Invalid email address"):s.businessEmail="Required",n.businessType||(s.businessType="Required"),"Others"!==n.businessType||n.customBusinessType||(s.customBusinessType="Please specify business type"),n.region||(s.region="Required"),n.province||(s.province="Required"),n.city||(s.city="Required"),n.barangay||(s.barangay="Required")),3===e){const e=["Business Registration Certificate (DTI/SEC/CDA)","Mayor's Permit / Business Permit","BIR Certificate of Registration (Form 2303)"];n.documents&&0!==n.documents.length||(s.documents="Please upload at least one business document"),n.documents.length!==n.documentTypes.length&&(s.documentTypes="Please specify document type for each uploaded file");const a=n.documentTypes.filter(e=>e),t=e.filter(e=>!a.includes(e));t.length>0&&(s.documents=`Missing required documents: ${t.join(", ")}`);const r={};n.documentTypes.forEach(e=>{e&&(r[e]=(r[e]||0)+1)});const i=Object.keys(r).filter(e=>r[e]>1);i.length>0&&(s.documentTypes=`Duplicate document types not allowed: ${i.join(", ")}`),n.acceptTerms?n.acceptPrivacy||(s.accept="You must acknowledge the Privacy Policy."):s.accept="You must accept the Terms and Conditions."}return o(s),0===Object.keys(s).length},b=async()=>{if(g())if(0===a){d(!0);try{const e=await(async(e,s)=>{try{return await r("/auth/check-existing",{method:"POST",body:JSON.stringify({email:e,username:s})})}catch(a){if(console.error("Error checking existing user:",a),a.data)throw a;throw new Error("Failed to check user availability. Please try again.")}})(n.email,n.username);if(e.exists){const s={};return"email"===e.field?s.email=e.message||"This email is already registered. Please use a different email or log in.":"username"===e.field?s.username=e.message||"This username is already taken. Please choose another one.":s.email=e.message||"This email or username is already registered.",void o(s)}await r("/otp/send",{method:"POST",body:JSON.stringify({email:n.email})}),t(e=>e+1)}catch(e){if(console.error("Error in handleNext:",e),409===e.status){const s=e.data||{},a={};"email"===s.field?a.email=s.message||"This email is already registered.":"username"===s.field?a.username=s.message||"This username is already taken.":a.email=s.message||"This email or username is already registered.",o(a)}else o({email:e.message||"Failed to verify account. Please try again."})}finally{d(!1)}}else if(1===a){if(x)return void t(e=>e+1);d(!0);try{await r("/otp/verify",{method:"POST",body:JSON.stringify({email:n.email,otp:n.otp})});p(!0),t(e=>e+1)}catch(e){console.error("OTP verification error:",e),o({otp:e.message||"Failed to verify OTP"}),i(e=>({...e,otp:""}))}finally{d(!1)}}else t(e=>e+1)};return{steps:e,step:a,setStep:t,form:n,setForm:i,errors:l,setErrors:o,loading:c,setLoading:d,success:m,isOtpVerified:x,setIsOtpVerified:p,inputRef:h,handleChange:e=>{const{name:s,value:a,type:t,checked:r}=e.target;i("useAdminEmail"===s?e=>({...e,[s]:r,businessEmail:r?e.email:""}):e=>({...e,[s]:"checkbox"===t?r:a}))},handleLocationChange:(e,s,a)=>{const t={};"region"===e?(t.province="",t.city="",t.barangay="",t.provinceName="",t.cityName="",t.barangayName=""):"province"===e?(t.city="",t.barangay="",t.cityName="",t.barangayName=""):"city"===e&&(t.barangay="",t.barangayName=""),i(r=>({...r,[e]:s,[`${e}Name`]:a,...t}))},validateStep:g,handleNext:b,handleBack:()=>t(e=>Math.max(0,e-1)),handleFinish:async()=>{if(g()){d(!0);try{const e=new FormData;e.append("email",n.email),e.append("firstName",n.firstName),e.append("fullName",n.fullName),e.append("username",n.username),e.append("businessName",n.businessName),e.append("businessType","Others"===n.businessType?n.customBusinessType:n.businessType),e.append("region",n.region),e.append("regionName",n.regionName),e.append("province",n.province),e.append("city",n.city),e.append("barangay",n.barangay),e.append("provinceName",n.provinceName),e.append("cityName",n.cityName),e.append("barangayName",n.barangayName),e.append("houseNumber",n.houseNumber),e.append("mobile",n.mobile),e.append("password",n.password),e.append("document_types",JSON.stringify(n.documentTypes)),n.documents.forEach(s=>{e.append("documents",s)});const s=await r("/business/register-with-documents",{method:"POST",body:e});localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify(s.user)),u(!0)}catch(e){o({general:e.message||"An error occurred."})}finally{d(!1)}}},progress:(a+1)/e.length*100}}function f({percent:s}){return e.jsx("div",{className:"w-full h-2.5 bg-blue-100/70 rounded-full overflow-hidden shadow-inner","aria-label":"Progress bar","aria-valuenow":s,"aria-valuemin":0,"aria-valuemax":100,role:"progressbar",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-600 via-blue-500 to-blue-400 transition-all duration-500 rounded-full shadow-md",style:{width:`${s}%`}})})}function j({steps:s,currentStep:a}){const t=s=>{switch(s){case 0:return e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]});case 1:return e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]});case 2:return e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"18"}),e.jsx("rect",{x:"14",y:"8",width:"7",height:"13"}),e.jsx("path",{d:"M7 6h2M7 10h2M7 14h2M18 11h2M18 15h2"})]});default:return e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),e.jsx("path",{d:"M14 2v6h6"}),e.jsx("path",{d:"M16 13H8M16 17H8M10 9H8"})]})}};return e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative flex items-center justify-between",children:[s.map((s,r)=>e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:`w-10 h-10 flex items-center justify-center rounded-full border-2 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white z-10\n                ${r<a?"border-green-600 text-green-600":r===a?"border-blue-600 text-blue-600 ring-2 ring-blue-200":"border-gray-300 text-gray-400"}\n              `,"aria-current":r===a?"step":void 0,tabIndex:0,title:s.label,children:t(r)}),e.jsx("span",{className:"mt-2 text-xs font-medium text-center max-w-[90px] "+(r<=a?"text-blue-700":"text-gray-500"),children:s.label})]},r)),e.jsx("div",{className:"absolute left-0 right-0 top-5 h-1 bg-gray-200 rounded","aria-hidden":!0}),e.jsx("div",{className:"absolute left-0 top-5 h-1 bg-gradient-to-r from-blue-600 to-blue-400 rounded transition-all duration-500",style:{width:a/(s.length-1)*100+"%"},"aria-hidden":!0})]})})}function v({step:s,steps:t,progress:r,loading:c,errors:d,form:m={},success:u=!1,onBack:x,onNext:p,onFinish:h,children:g}){const b=s>0&&!u,y=1===s,v=s<t.length-1&&!y&&!u,N=s===t.length-1&&!u,w=u;return e.jsx(n,{variant:"gradientBlue",pattern:"dots",overlay:!0,floatingElements:!0,children:e.jsx("div",{className:"flex justify-center px-4 py-10",children:e.jsx(o,{className:"w-full max-w-5xl overflow-hidden rounded-3xl p-0",children:e.jsxs("div",{className:"md:flex",children:[e.jsx("aside",{className:"hidden md:flex md:w-5/12 items-center justify-center bg-gradient-to-br from-blue-600 via-blue-400 to-blue-500 p-10 relative",children:e.jsxs("div",{className:"text-center max-w-sm",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/15 text-white text-xs font-semibold mb-5 border border-white/30",children:[e.jsx("span",{children:"Quick setup"}),e.jsx("span",{className:"opacity-80",children:"â€¢"}),e.jsx("span",{children:"Secure"})]}),e.jsx("h3",{className:"text-white text-2xl font-bold mb-3",children:"Welcome to your business journey"}),e.jsx("p",{className:"text-white/90 text-sm mb-6",children:"Create your account, verify your email, add business details and upload documents. You're minutes away from a modern POS."})]})}),e.jsxs("main",{className:"w-full md:w-7/12 p-6 md:p-10 flex flex-col",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(a,{to:"/",className:"inline-flex items-center gap-2 text-sm text-gray-600 hover:text-gray-800",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to home"]})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsx(f,{percent:r})})}),e.jsx("div",{className:"mt-4",children:e.jsx(j,{steps:t,currentStep:s})})]}),e.jsxs("div",{className:"flex-1",children:[d?.general&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:d.general}),e.jsx("div",{className:"max-w-lg",children:g})]}),(b||v||N||w)&&e.jsxs("div",{className:"mt-8 md:mt-6 flex items-center justify-center gap-4",children:[b&&e.jsx(i,{onClick:x,disabled:c,variant:"secondary",className:"w-32",children:"Back"}),v&&e.jsx(i,{onClick:p,disabled:c||!(0===s?m.email&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m.email)&&m.firstName&&m.fullName&&m.username&&11===m.mobile?.length&&m.password&&m.confirmPassword&&m.password===m.confirmPassword&&m.password.length>=12&&/[A-Z]/.test(m.password)&&/[a-z]/.test(m.password)&&/\d/.test(m.password)&&/[!@#$%^&*(),.?":{}|<>]/.test(m.password):2===s?m.businessName&&(m.useAdminEmail||m.businessEmail&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m.businessEmail))&&m.businessType&&("Others"!==m.businessType||m.customBusinessType)&&m.region&&m.province&&m.city&&m.barangay:3!==s||m.documents?.length>0&&m.acceptTerms&&m.acceptPrivacy&&["Business Registration Certificate (DTI/SEC/CDA)","Mayor's Permit / Business Permit","BIR Certificate of Registration (Form 2303)"].every(e=>m.documentTypes?.includes(e))&&m.documentTypes?.every(e=>e)),variant:"primary",className:"w-48",children:c?e.jsx(l,{size:"sm"}):"Continue"}),N&&e.jsx(i,{onClick:h,disabled:c||!m?.documents?.length||!m?.acceptTerms||!m?.acceptPrivacy||!["Business Registration Certificate (DTI/SEC/CDA)","Mayor's Permit / Business Permit","BIR Certificate of Registration (Form 2303)"].every(e=>m.documentTypes?.includes(e))||m.documentTypes?.some(e=>!e),variant:"primary",className:"w-48",children:c?e.jsx(l,{size:"sm"}):"Finish"}),w&&e.jsx(i,{onClick:()=>window.location.href="/",variant:"primary",className:"w-48",children:"Return to Home"})]}),e.jsx("div",{className:"mt-4 text-[11px] text-gray-500 text-center",children:"Your data is encrypted in transit and at rest."})]})]})})})})}function N({form:a,errors:t,handleLocationChange:r}){const[n,i]=s.useState([]),[l,o]=s.useState([]),[c,d]=s.useState([]),[m,g]=s.useState([]),[b,y]=s.useState({regions:!1,provinces:!1,cities:!1,barangays:!1}),[f,j]=s.useState(null);s.useEffect(()=>{(async()=>{y(e=>({...e,regions:!0})),j(null);try{const e=await u();i(e)}catch(e){console.error(e),j("Failed to load regions. Please check your connection and try again.")}finally{y(e=>({...e,regions:!1}))}})()},[]),s.useEffect(()=>{if(a.region){(async()=>{y(e=>({...e,provinces:!0}));try{const e=await x(a.region);o(e)}catch(e){console.error(e)}finally{y(e=>({...e,provinces:!1}))}})()}},[a.region]),s.useEffect(()=>{if(a.province){(async()=>{y(e=>({...e,cities:!0}));try{const e=await p(a.province);d(e)}catch(e){console.error(e)}finally{y(e=>({...e,cities:!1}))}})()}},[a.province]),s.useEffect(()=>{if(a.city){(async()=>{y(e=>({...e,barangays:!0}));try{const e=await h(a.city);g(e)}catch(e){console.error(e)}finally{y(e=>({...e,barangays:!1}))}})()}},[a.city]);const v=e=>{const{name:s,value:a}=e.target,t=e.target.options[e.target.selectedIndex],n=t?t.text:"";r(s,a,n)};return e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:["Region ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"region",value:a.region,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",style:{borderColor:t.region?"#ef4444":""},disabled:b.regions,children:[e.jsx("option",{value:"",children:b.regions?"Loading...":"Select Region"}),n.map(s=>e.jsx("option",{value:s.code,children:s.name},s.code))]}),t.region&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.region}),f&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:f})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:["Province ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"province",value:a.province,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",style:{borderColor:t.province?"#ef4444":""},disabled:!a.region||b.provinces,children:[e.jsx("option",{value:"",children:b.provinces?"Loading...":"Select Province"}),l.map(s=>e.jsx("option",{value:s.code,children:s.name},s.code))]}),t.province&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.province})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:["City/Municipality ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"city",value:a.city,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",style:{borderColor:t.city?"#ef4444":""},disabled:!a.province||b.cities,children:[e.jsx("option",{value:"",children:b.cities?"Loading...":"Select City/Municipality"}),c.map(s=>e.jsx("option",{value:s.code,children:s.name},s.code))]}),t.city&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.city})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:["Barangay ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"barangay",value:a.barangay,onChange:v,className:"w-full px-3 py-2 border border--gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",style:{borderColor:t.barangay?"#ef4444":""},disabled:!a.city||b.barangays,children:[e.jsx("option",{value:"",children:b.barangays?"Loading...":"Select Barangay"}),m.map(s=>e.jsx("option",{value:s.code,children:s.name},s.code))]}),t.barangay&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.barangay})]})]})}function w({documents:a,documentTypes:t,onDocumentsChange:r,error:n}){const[i,l]=s.useState([]),o=["Business Registration Certificate (DTI/SEC/CDA)","Mayor's Permit / Business Permit","BIR Certificate of Registration (Form 2303)"],c=["Barangay Business Clearance","Fire Safety Inspection Certificate (if applicable)","Sanitary Permit (for food businesses)"],d=[...o,...c,"Other Business Document"],m=t.filter((e,s)=>e&&a[s]),u=o.filter(e=>!m.includes(e)),x=a.length>0&&(t.length<a.length||t.some(e=>!e)),p=o.every(e=>t.some((s,t)=>s===e&&a[t]));return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-2 text-sm text-gray-700 font-medium",children:["Upload Business Documents ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:e.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Drag and drop files here, or click to browse"}),e.jsxs("label",{className:"cursor-pointer inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Browse Files",e.jsx("input",{type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png",onChange:e=>{const s=Array.from(e.target.files||[]);if(0===s.length)return;const n=["application/pdf","image/jpeg","image/jpg","image/png"],i=e=>`${e.name}|${e.size}|${e.lastModified||""}`,o=new Set(a.map(i)),c=[],d=[];if(s.forEach(e=>{const s=i(e);if(o.has(s))return void d.push({file:e,reason:"Duplicate file"});if(!n.includes(e.type))return void d.push({file:e,reason:"Unsupported file type. Only PDF, JPG, PNG allowed."});if(e.size>10485760)return void d.push({file:e,reason:"File too large. Maximum 10MB per file."});const a=e.name.split(".").pop()?.toLowerCase();["pdf","jpg","jpeg","png"].includes(a)?(c.push(e),o.add(s)):d.push({file:e,reason:"Invalid file extension."})}),c.length>0){const e=[...a,...c],s=[...t,...c.map(()=>"")];r(e,s),l([])}d.length>0&&l(d.map(({file:e,reason:s})=>`${e.name}: ${s}`)),e.target.value=""},className:"hidden"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Accepted formats: PDF, JPG, PNG. Maximum file size: 10MB per file. Secure uploads only."})]}),i.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Upload Errors:"}),e.jsx("ul",{className:"text-sm text-red-700 space-y-1",children:i.map((s,a)=>e.jsxs("li",{children:["â€¢ ",s]},a))})]}),a.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Uploaded Documents:"}),a.map((s,n)=>{const i=o.includes(t[n]),l=c.includes(t[n]);return e.jsxs("div",{className:"flex items-center space-x-3 p-3 rounded-lg border "+(i?"bg-green-50 border-green-200":l?"bg-blue-50 border-blue-200":"bg-gray-50 border-gray-200"),children:[e.jsx("div",{className:"flex-shrink-0",children:"application/pdf"===s.type?e.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}):e.jsx("svg",{className:"w-8 h-8 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(s.size/1024/1024).toFixed(2)," MB â€¢"," ",s.type||"unknown"]}),i&&e.jsx("span",{className:"inline-block mt-1 px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full",children:"Required"}),l&&e.jsx("span",{className:"inline-block mt-1 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:"Optional"})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{value:t[n]||"",onChange:e=>((e,s)=>{const n=[...t];n[e]=s,r(a,n)})(n,e.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select document type"}),d.map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsx("button",{type:"button",onClick:()=>(e=>{const s=a.filter((s,a)=>a!==e),n=t.filter((s,a)=>a!==e);r(s,n)})(n),className:"text-red-600 hover:text-red-800 text-sm p-1",title:"Remove document",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]},n)})]}),u.length>0&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:"Required Documents:"}),e.jsx("ul",{className:"text-sm text-green-700 space-y-1",children:u.map((s,a)=>e.jsxs("li",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2",children:"â€¢"}),e.jsx("span",{className:"flex-1",children:s}),e.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded-full",children:"Required"})]},a))})]}),x&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mt-4",children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Action Required:"}),e.jsx("p",{className:"text-sm text-red-700",children:"Please select a document type for all uploaded files."})]}),p&&!x&&a.length>0&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mt-4",children:e.jsxs("div",{className:"flex items-center text-green-800",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"font-medium",children:"All required documents are uploaded and typed."})]})}),n&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:n})]})}function C({hook:s,isOtpVerified:a,onOpenTerms:n,onOpenPrivacy:i}){const{step:o,form:u,errors:x,loading:p,inputRef:h,handleChange:g}=s;function b(){const[s,a]=t.useState([]),[n,i]=t.useState(null);return t.useEffect(()=>{const e=sessionStorage.getItem("auth_token");let s=null;try{const e=JSON.parse(sessionStorage.getItem("user")||"null");s=e?.businessId||e?.business_id||null}catch{}e&&s&&(async()=>{try{const t=await r(`/documents/business/${s}`,{headers:{Authorization:`Bearer ${e}`}});a(Array.isArray(t.documents)?t.documents:[]),i(t.verification||null)}catch{}})()},[]),s&&0!==s.length?e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Previously Uploaded"}),e.jsx("ul",{className:"space-y-2 text-sm",children:s.map(s=>e.jsxs("li",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-700",children:[s.document_type," â€” ",s.document_name]}),e.jsx("span",{className:"text-gray-500",children:(s.mime_type||"").split("/").pop()})]},s.document_id))}),n?.verification_status&&e.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:["Verification status: ",n.verification_status]})]}):null}switch(o){case 0:return e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{className:"text-2xl md:text-3xl text-gray-900",children:"Account Info"}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:"Email"}),e.jsx(d,{ref:h,name:"email",value:u.email,onChange:g,placeholder:"Enter your email address",type:"email",error:x.email,pattern:"[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,}$"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:"First Name"}),e.jsx(d,{name:"firstName",value:u.firstName,onChange:g,placeholder:"Enter your first name",type:"text",error:x.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:"Last Name"}),e.jsx(d,{name:"fullName",value:u.fullName,onChange:g,placeholder:"Enter your last name",type:"text",error:x.fullName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:"Username"}),e.jsx(d,{name:"username",value:u.username,onChange:g,placeholder:"Choose a username",type:"text",error:x.username,helpText:"3-20 characters, letters, numbers, and underscores only"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:"Mobile Number"}),e.jsx(d,{name:"mobile",value:u.mobile,onChange:g,placeholder:"09xxxxxxxxx",type:"tel",maxLength:11,error:x.mobile})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:"Password"}),e.jsx(m,{name:"password",value:u.password,onChange:g,placeholder:"Enter password",error:x.password}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"Password must contain:"}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 text-xs",children:[e.jsxs("div",{className:"flex items-center "+(u.password.length>=12?"text-green-600":"text-gray-500"),children:[e.jsx("span",{className:"mr-2 "+(u.password.length>=12?"âœ“":"â—‹")}),"At least 12 characters"]}),e.jsxs("div",{className:"flex items-center "+(/[A-Z]/.test(u.password)?"text-green-600":"text-gray-500"),children:[e.jsx("span",{className:"mr-2 "+(/[A-Z]/.test(u.password)?"âœ“":"â—‹")}),"One uppercase letter (A-Z)"]}),e.jsxs("div",{className:"flex items-center "+(/[a-z]/.test(u.password)?"text-green-600":"text-gray-500"),children:[e.jsx("span",{className:"mr-2 "+(/[a-z]/.test(u.password)?"âœ“":"â—‹")}),"One lowercase letter (a-z)"]}),e.jsxs("div",{className:"flex items-center "+(/\d/.test(u.password)?"text-green-600":"text-gray-500"),children:[e.jsx("span",{className:"mr-2 "+(/\d/.test(u.password)?"âœ“":"â—‹")}),"One number (0-9)"]}),e.jsxs("div",{className:"flex items-center "+(/[!@#$%^&*(),.?":{}|<>]/.test(u.password)?"text-green-600":"text-gray-500"),children:[e.jsx("span",{className:"mr-2 "+(/[!@#$%^&*(),.?":{}|<>]/.test(u.password)?"âœ“":"â—‹")}),'One special character (!@#$%^&*(),.?":',"|","<",">",")"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:"Password Confirmation"}),e.jsx(m,{name:"confirmPassword",value:u.confirmPassword,onChange:g,placeholder:"Re-enter password",error:x.confirmPassword})]})]}),e.jsxs("div",{className:"text-xs text-gray-600 text-center",children:["By continuing, you agree to our"," ",e.jsx("button",{type:"button",onClick:n,className:"text-blue-700 underline hover:text-blue-800",children:"Terms & Conditions"})," ","and"," ",e.jsx("button",{type:"button",onClick:i,className:"text-blue-700 underline hover:text-blue-800",children:"Privacy Policy"}),"."]})]});case 1:return e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{className:"text-2xl md:text-3xl text-gray-900",children:"OTP Verification"}),e.jsxs("p",{className:"text-gray-700 mb-2 text-sm",children:["We've sent a 4-character verification code to"," ",e.jsx("strong",{children:u.email}),"."]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:"Enter OTP"}),e.jsx(d,{ref:h,name:"otp",value:u.otp,onChange:e=>{const a=e.target.value.slice(0,4);g({target:{name:"otp",value:a}}),x.otp&&s.setErrors({...x,otp:null})},placeholder:"Enter 4-character code",type:"text",maxLength:4,error:x.otp,disabled:a}),4===u.otp.length&&!a&&!p&&e.jsxs("div",{className:"mt-2 text-blue-600 text-sm font-medium flex items-center",children:[e.jsx(l,{size:"sm",className:"mr-2"}),"Auto-verifying OTP..."]}),p&&e.jsxs("div",{className:"mt-2 text-gray-700 text-sm font-medium flex items-center",children:[e.jsx(l,{size:"sm",className:"mr-2"}),"Verifying OTP..."]}),a&&e.jsxs("div",{className:"mt-2 text-green-600 text-sm font-medium flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 20 20","aria-hidden":!0,children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"OTP verified successfully!"]})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:async()=>{s.setLoading(!0);try{await r("/otp/resend",{method:"POST",body:JSON.stringify({email:u.email})}),alert("New OTP sent successfully!")}catch(e){alert("Failed to resend OTP")}finally{s.setLoading(!1)}},className:"text-gray-700 hover:text-gray-900 text-sm underline",disabled:p,children:p?"Sending...":"Resend OTP"})})]});case 2:return e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{className:"text-2xl md:text-3xl text-gray-900",children:"Business Details"}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:["Business Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(d,{name:"businessName",value:u.businessName,onChange:g,placeholder:"Enter business name",error:x.businessName})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:["Business Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"useAdminEmail",name:"useAdminEmail",checked:u.useAdminEmail,onChange:g,className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("label",{htmlFor:"useAdminEmail",className:"text-sm text-gray-700",children:["Use admin email (",u.email,")"]})]}),!u.useAdminEmail&&e.jsx(d,{name:"businessEmail",value:u.businessEmail,onChange:g,placeholder:"Enter business email",type:"email",error:x.businessEmail,pattern:"[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,}$"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:["Business Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"businessType",value:u.businessType,onChange:g,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",style:{borderColor:x.businessType?"#ef4444":""},children:[e.jsx("option",{value:"",children:"Select business type"}),e.jsx("option",{value:"Grocery Store",children:"Grocery Store"}),e.jsx("option",{value:"Pharmacy",children:"Pharmacy"}),e.jsx("option",{value:"Clothing Store",children:"Clothing Store"}),e.jsx("option",{value:"Electronics Store",children:"Electronics Store"}),e.jsx("option",{value:"Bookstore",children:"Bookstore"}),e.jsx("option",{value:"Convenience Store",children:"Convenience Store"}),e.jsx("option",{value:"Others",children:"Others"})]}),x.businessType&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:x.businessType}),"Others"===u.businessType&&e.jsx("div",{className:"mt-2",children:e.jsx(d,{name:"customBusinessType",value:u.customBusinessType,onChange:g,placeholder:"Please specify your business type",error:x.customBusinessType})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 mt-4 font-semibold text-gray-900",children:"Business Location"}),e.jsx(N,{form:u,errors:x,handleLocationChange:s.handleLocationChange})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm text-gray-700 font-medium",children:"House no./ Street Name / Landmark (optional)"}),e.jsx(d,{name:"houseNumber",value:u.houseNumber,onChange:g,placeholder:"Enter house no., street, or landmark (optional)"})]})]})]});case 3:return e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{className:"text-2xl md:text-3xl text-gray-900",children:"Business Documents"}),e.jsx("p",{className:"text-gray-700 mb-4 text-sm",children:"Please upload your business documents for verification. These documents help us verify that your business is legitimate and complies with Philippine regulations."}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{documents:u.documents,documentTypes:u.documentTypes,onDocumentsChange:(e,s)=>{g({target:{name:"documents",value:e}}),g({target:{name:"documentTypes",value:s}})},error:x.documents||x.documentTypes}),e.jsx(b,{})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Additional Documents (Optional):"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"â€¢ Barangay Business Clearance"}),e.jsx("li",{children:"â€¢ Fire Safety Inspection Certificate (if applicable)"}),e.jsx("li",{children:"â€¢ Sanitary Permit (for food businesses)"})]})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{id:"acceptTerms",name:"acceptTerms",type:"checkbox",checked:u.acceptTerms,onChange:g,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),e.jsx("div",{className:"ml-3 text-sm",children:e.jsxs("label",{htmlFor:"acceptTerms",className:"text-gray-700",children:["I agree to the"," ",e.jsx("button",{type:"button",onClick:n,className:"text-blue-600 hover:text-blue-800 underline",children:"Terms and Conditions"})]})})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{id:"acceptPrivacy",name:"acceptPrivacy",type:"checkbox",checked:u.acceptPrivacy,onChange:g,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),e.jsx("div",{className:"ml-3 text-sm",children:e.jsxs("label",{htmlFor:"acceptPrivacy",className:"text-gray-700",children:["I have read the"," ",e.jsx("button",{type:"button",onClick:i,className:"text-blue-600 hover:text-blue-800 underline",children:"Privacy Policy"})]})})]}),x.accept&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:x.accept})]}),e.jsx("div",{className:"mt-8 pt-4 border-t border-gray-200"})]});default:return null}}function P({onOpenTerms:s,onOpenPrivacy:a}){const t=y(),{step:r,steps:n,progress:i,loading:l,errors:d,handleBack:m,handleNext:u,handleFinish:x,success:p,isOtpVerified:h}=t;return p?e.jsx(v,{step:r,steps:n,progress:100,loading:!1,errors:{},success:!0,children:e.jsx("div",{className:"flex flex-col items-center justify-center px-4 py-12",children:e.jsxs(o,{className:"rounded-3xl p-10 flex flex-col items-center max-w-2xl",children:[e.jsx(c,{className:"text-3xl md:text-4xl text-gray-900 mb-4",children:"Application Submitted!"}),e.jsx("p",{className:"text-gray-800 mb-6 text-base text-center max-w-md",children:"Your business application has been submitted successfully! Our verification team will review your documents."}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 w-full max-w-md",children:e.jsxs("p",{className:"text-sm text-yellow-800 text-center",children:[e.jsx("strong",{children:"Please wait 1-3 business days"})," for verification. You will receive an email notification once the review is complete."]})})]})})}):e.jsx(v,{step:r,steps:n,progress:i,loading:l,errors:d,form:t.form,onBack:m,onNext:u,onFinish:x,children:e.jsx(C,{hook:t,isOtpVerified:h,onOpenTerms:s,onOpenPrivacy:a})})}function k(){const[a,t]=s.useState(!1),[r,n]=s.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(P,{onOpenTerms:()=>t(!0),onOpenPrivacy:()=>n(!0)}),e.jsx(g,{open:a,onClose:()=>t(!1)}),e.jsx(b,{open:r,onClose:()=>n(!1)})]})}export{k as default};
//# sourceMappingURL=GetStarted-C-pZcK8u.js.map
