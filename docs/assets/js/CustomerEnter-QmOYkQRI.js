import{j as e,m as s}from"./utils-BnCj7yKo.js";import{a as t,u as a,L as r}from"./vendor-BZrj58oz.js";import{B as i,b as l}from"./index-CP1yjQpk.js";import{S as o}from"./ScannerCard-DnPwdYtD.js";import"./qr-DN-bNBye.js";function n(){const[n,d]=t.useState(!1),[c,m]=t.useState(!1),[x,h]=t.useState(null),[u,b]=t.useState(!1),p=a(),g={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}};return e.jsxs(i,{variant:"gradientBlue",pattern:"dots",floatingElements:!0,overlay:!0,children:[e.jsx(s.div,{className:"absolute -top-24 -left-24 w-[28rem] h-[28rem] rounded-full bg-gradient-to-br from-blue-400/15 to-cyan-400/10 blur-3xl",animate:{scale:[1,1.08,1],opacity:[.35,.5,.35]},transition:{duration:10,repeat:1/0,ease:"easeInOut"}}),e.jsx(s.div,{className:"absolute bottom-0 -right-24 w-[30rem] h-[30rem] rounded-full bg-gradient-to-bl from-indigo-400/15 to-purple-400/10 blur-3xl",animate:{scale:[1,1.12,1],opacity:[.3,.45,.3]},transition:{duration:12,repeat:1/0,ease:"easeInOut"}}),e.jsxs(s.div,{className:"min-h-screen flex flex-col items-center justify-center p-4 sm:p-6 pt-6 sm:pt-8 relative z-10",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.2,delayChildren:.1}}},initial:"hidden",animate:"visible",children:[e.jsx(s.div,{className:"absolute top-4 sm:top-6 left-4 sm:left-6 z-20",variants:g,children:e.jsxs(r,{to:"/",className:"inline-flex items-center gap-2 px-4 py-2.5 rounded-full bg-white/80 backdrop-blur-md border border-white/40 hover:bg-white/90 transition-all duration-300 shadow-lg hover:shadow-xl group",children:[e.jsx("svg",{className:"w-5 h-5 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{className:"font-semibold text-gray-700 hidden sm:inline",children:"Back Home"})]})}),e.jsxs("div",{className:"w-full max-w-4xl flex flex-col gap-6 sm:gap-8",children:[e.jsxs(s.div,{className:"text-center",variants:g,children:[e.jsx(s.div,{className:"inline-flex items-center justify-center gap-3 mb-6",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2,type:"spring",stiffness:180},children:e.jsxs(s.div,{className:"p-4 bg-gradient-to-br from-blue-500 via-blue-600 to-indigo-700 rounded-2xl shadow-2xl relative group",animate:{boxShadow:["0 10px 30px rgba(59, 130, 246, 0.3)","0 20px 40px rgba(59, 130, 246, 0.4)","0 10px 30px rgba(59, 130, 246, 0.3)"]},transition:{duration:2.5,repeat:1/0},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsx("svg",{className:"w-8 h-8 sm:w-9 sm:h-9 text-white relative z-10",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})})]})}),e.jsxs(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"space-y-3",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Welcome to the Store !!!"}),e.jsx("p",{className:"text-base sm:text-lg text-gray-600 max-w-xl mx-auto leading-relaxed",children:"Scan the store's QR code to access the self-checkout experience"})]})]}),e.jsx(s.div,{className:"",variants:g,children:e.jsx("div",{className:"bg-gradient-to-r from-blue-50/80 via-indigo-50/60 to-purple-50/80 backdrop-blur-md rounded-2xl border border-blue-200/40 p-6 sm:p-8",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(s.div,{className:"flex items-center justify-center h-12 w-12 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white shadow-lg",animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Need Help?"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Make sure your device has camera permissions enabled. The QR code is typically displayed at the store entrance."})]})]})})}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2 items-center",children:[e.jsx(s.div,{className:"flex items-center justify-center relative w-full",variants:{hidden:{opacity:0,scale:.95},visible:{opacity:1,scale:1,transition:{duration:.4,ease:"easeOut"}}},children:e.jsxs("div",{className:"w-full aspect-square relative max-w-sm lg:max-w-md",children:[e.jsx(s.div,{className:"absolute inset-0 bg-gradient-to-br from-blue-500/20 to-indigo-600/20 rounded-2xl sm:rounded-lg blur-2xl -z-10",animate:{scale:[1,1.1,1],opacity:[.4,.6,.4]},transition:{duration:4,repeat:1/0}}),e.jsx("div",{className:"relative h-full rounded-2xl sm:rounded-3xl overflow-hidden border-3 sm:border-4 border-white/60 shadow-lg sm:shadow-2xl bg-white/10 backdrop-blur-sm",children:u?e.jsxs(e.Fragment,{children:[c&&!x&&e.jsx(s.div,{className:"absolute inset-0 flex items-center justify-center z-30 bg-black/40 backdrop-blur-md",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx(s.div,{className:"bg-white/95 backdrop-blur-md rounded-xl sm:rounded-2xl p-6 sm:p-8 shadow-xl sm:shadow-2xl border border-white/20 mx-4",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:200},children:e.jsxs("div",{className:"flex flex-col items-center gap-3 sm:gap-4",children:[e.jsx(s.div,{className:"w-12 h-12 sm:w-14 sm:h-14 border-3 sm:border-4 border-blue-500 border-t-indigo-600 rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-900 font-semibold text-sm sm:text-base",children:"Recognizing store..."}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:"Please wait"})]})]})})}),x&&e.jsx(s.div,{className:"absolute inset-0 flex items-center justify-center z-30 bg-black/40 backdrop-blur-md",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx(s.div,{className:"bg-white/95 backdrop-blur-md rounded-xl sm:rounded-2xl p-6 sm:p-8 shadow-xl sm:shadow-2xl border border-white/20 mx-4",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:200},children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(s.div,{className:"w-12 h-12 sm:w-14 sm:h-14 flex items-center justify-center bg-red-100 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-900 font-semibold text-sm sm:text-base",children:"Invalid QR Code"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:x})]}),e.jsx(l,{label:"Try Again",variant:"primary",onClick:()=>{h(null),d(!1),m(!1)}})]})})}),e.jsx(o,{onScan:async e=>{const s=e?.[0]?.rawValue;if(s){d(!0),m(!0),h(null);try{const e=function(e){try{const s=new URL(e),t=s.searchParams.get("business_id")||s.searchParams.get("b")||s.searchParams.get("store");if(t)return t}catch(s){}try{const s=JSON.parse(e);if(s&&(s.business_id||s.businessId||s.storeId))return s.business_id||s.businessId||s.storeId}catch(s){}return e}(s);if(!e)return h("Invalid QR Code. Please scan a valid store QR code."),m(!1),void setTimeout(()=>{d(!1)},500);localStorage.setItem("business_id",String(e)),localStorage.removeItem("provisionalTransactionNumber"),localStorage.removeItem("customerCart");const a=(new Date).toISOString().replace(/[-:T.Z]/g,"").slice(0,14),r=Math.floor(1e3+9e3*Math.random()),i=`T-${String(e).padStart(2,"0")}-${a}-${r}`;localStorage.setItem("provisionalTransactionNumber",i);try{const s=await fetch("/api/sales/public/enter-store",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({business_id:e})});if(s.ok){const e=await s.json();e.user_id&&(localStorage.setItem("customer_user_id",String(e.user_id)),console.log("Customer user created:",e.user_id)),e.username&&localStorage.setItem("customer_username",e.username)}else{const e=await s.json().catch(()=>({error:"Failed to create customer"}));console.error("Failed to create customer user:",e)}}catch(t){console.error("Error creating customer user:",t)}setTimeout(()=>{p("/customer")},300)}catch(a){h("Invalid QR Code. Please scan a valid store QR code."),m(!1),setTimeout(()=>{d(!1)},500)}}},paused:n,onResume:()=>{d(!1),m(!1),h(null)},className:"w-full h-full"})]}):e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-900/95 z-40 p-6 text-center backdrop-blur-sm",children:e.jsxs(s.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-full flex items-center justify-center mb-4 backdrop-blur-sm ring-1 ring-white/20",children:e.jsxs("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})}),e.jsx("h3",{className:"text-white font-bold text-xl mb-2",children:"Camera Access"}),e.jsx("p",{className:"text-gray-300 text-sm mb-6 max-w-[240px]",children:"Permission to allow camera access to scan the store QR code."}),e.jsx(l,{label:"Allow Camera",variant:"primary",onClick:()=>b(!0),className:"w-full px-8 shadow-lg shadow-blue-500/25"})]})})}),e.jsx("div",{className:"absolute -top-1.5 -left-1.5 sm:-top-2 sm:-left-2 w-5 h-5 sm:w-8 sm:h-8 border-2 border-white/40 rounded-tl-lg sm:rounded-tl-2xl"}),e.jsx("div",{className:"absolute -top-1.5 -right-1.5 sm:-top-2 sm:-right-2 w-5 h-5 sm:w-8 sm:h-8 border-2 border-white/40 rounded-tr-lg sm:rounded-tr-2xl"}),e.jsx("div",{className:"absolute -bottom-1.5 -left-1.5 sm:-bottom-2 sm:-left-2 w-5 h-5 sm:w-8 sm:h-8 border-2 border-white/40 rounded-bl-lg sm:rounded-bl-2xl"}),e.jsx("div",{className:"absolute -bottom-1.5 -right-1.5 sm:-bottom-2 sm:-right-2 w-5 h-5 sm:w-8 sm:h-8 border-2 border-white/40 rounded-br-lg sm:rounded-br-2xl"}),e.jsx("div",{className:"absolute -top-2 -left-2 w-8 h-8 border-2 border-white/40 rounded-tl-2xl"}),e.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 border-2 border-white/40 rounded-tr-2xl"}),e.jsx("div",{className:"absolute -bottom-2 -left-2 w-8 h-8 border-2 border-white/40 rounded-bl-2xl"}),e.jsx("div",{className:"absolute -bottom-2 -right-2 w-8 h-8 border-2 border-white/40 rounded-br-2xl"})]})}),e.jsx(s.div,{className:"flex flex-col gap-4",variants:g,children:e.jsxs(s.div,{className:"bg-white/80 backdrop-blur-xl border border-white/60 rounded-lg shadow-2xl p-6 sm:p-8 hover:shadow-3xl transition-all duration-300 group overflow-hidden",whileTap:{scale:.98},children:[e.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/30 to-transparent"}),e.jsxs("div",{className:"relative z-10 space-y-5",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex items-center justify-center h-12 w-12 rounded-2xl bg-blue-600 text-white font-bold shadow-lg",children:"1"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"Point Your Camera"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Position your device to scan the QR code displayed in the store"})]})]}),e.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex items-center justify-center h-12 w-12 rounded-2xl bg-blue-600 text-white font-bold shadow-lg",children:"2"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"Scan the Code"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Allow camera access and keep the QR code in frame"})]})]}),e.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex items-center justify-center h-12 w-12 rounded-2xl bg-blue-600 to-pink-600 text-white font-bold shadow-lg",children:"3"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"Start Shopping"}),e.jsx("p",{className:"text-sm text-gray-600",children:"You'll be connected to the store's self-checkout system"})]})]})]})]})})]})]})]})]})}export{n as default};
//# sourceMappingURL=CustomerEnter-QmOYkQRI.js.map
