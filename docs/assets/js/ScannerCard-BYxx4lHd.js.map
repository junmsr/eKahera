{"version":3,"file":"ScannerCard-BYxx4lHd.js","sources":["../../../frontend/src/components/ui/POS/ScannerCard.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport Button from \"../../common/Button\";\r\nimport { Scanner } from \"@yudiel/react-qr-scanner\";\r\n\r\n/**\r\n * Scanner Card Component\r\n * Camera controls for flash and flip\r\n */\r\nfunction ScannerCard({\r\n  paused,\r\n  onResume,\r\n  textMain = \"text-blue-800\",\r\n  className = \"\",\r\n  modalContext = false,\r\n  ...props\r\n}) {\r\n  const [facingMode, setFacingMode] = useState(\"environment\");\r\n  const [error, setError] = useState(\"\");\r\n  const [isInitializing, setIsInitializing] = useState(!modalContext);\r\n  const [torchEnabled, setTorchEnabled] = useState(false);\r\n  const [isMobile, setIsMobile] = useState(false);\r\n  const [hasMultipleCameras, setHasMultipleCameras] = useState(false);\r\n  const [modalInitialized, setModalInitialized] = useState(false);\r\n\r\n  // Detect mobile device\r\n  useEffect(() => {\r\n    setIsMobile(\r\n      /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\r\n        navigator.userAgent\r\n      )\r\n    );\r\n  }, []);\r\n\r\n  // Check for multiple cameras\r\n  useEffect(() => {\r\n    const checkCameras = async () => {\r\n      try {\r\n        const devices = await navigator.mediaDevices.enumerateDevices();\r\n        const videoDevices = devices.filter(\r\n          (device) => device.kind === \"videoinput\"\r\n        );\r\n        setHasMultipleCameras(videoDevices.length > 1);\r\n        setIsInitializing(false);\r\n      } catch (err) {\r\n        console.error(\"Error checking cameras:\", err);\r\n        setIsInitializing(false);\r\n      }\r\n    };\r\n    checkCameras();\r\n  }, []);\r\n\r\n  const handleError = (err) => {\r\n    console.error(\"Camera error:\", err);\r\n    setError(\"Camera access failed. Please check permissions.\");\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`flex-shrink-0 bg-white/80 backdrop-blur-md border border-white/60 shadow-xl hover:shadow-2xl transition-all duration-300 overflow-hidden ${className}`}\r\n    >\r\n      <div className=\"flex flex-col h-full p-1 sm:p-2\">\r\n        <div\r\n          className={`w-full text-center mb-1 font-bold text-xs tracking-wide ${textMain} flex items-center justify-center gap-1`}\r\n        >\r\n          <svg\r\n            className=\"w-3 h-3\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z\"\r\n            />\r\n          </svg>\r\n          CAMERA CONTROLS\r\n        </div>\r\n        <div className=\"w-full flex-1 bg-gradient-to-br from-blue-50/80 via-indigo-50/60 to-blue-100/80 rounded-xl flex items-center justify-center border-2 border-blue-200/50 shadow-inner overflow-hidden relative z-0 group\">\r\n          {isInitializing ? (\r\n            <div className=\"flex items-center justify-center h-full text-gray-500\">\r\n              <div className=\"text-center\">\r\n                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2\"></div>\r\n                <p className=\"text-sm\">Initializing camera...</p>\r\n              </div>\r\n            </div>\r\n          ) : error ? (\r\n            <div className=\"flex items-center justify-center h-full text-red-500 p-4\">\r\n              <div className=\"text-center\">\r\n                <p className=\"text-sm font-medium mb-2\">Camera Error</p>\r\n                <p className=\"text-xs\">{error}</p>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <Scanner\r\n              onError={handleError}\r\n              paused={paused}\r\n              constraints={{\r\n                facingMode,\r\n                width: { ideal: 1920, min: 640 },\r\n                height: { ideal: 1080, min: 480 },\r\n                frameRate: { ideal: 30, min: 15 },\r\n              }}\r\n              torch={torchEnabled}\r\n              styles={{\r\n                container: {\r\n                  width: \"100%\",\r\n                  height: \"100%\",\r\n                  borderRadius: \"1rem\",\r\n                  overflow: \"visible\",\r\n                },\r\n                video: {\r\n                  width: \"100%\",\r\n                  height: \"100%\",\r\n                  objectFit: \"cover\",\r\n                  borderRadius: \"1rem\",\r\n                  backgroundColor: \"black\",\r\n                },\r\n              }}\r\n              classNames={{ container: \"w-full h-full\" }}\r\n            />\r\n          )}\r\n          {!error && !isInitializing && (\r\n            <div className=\"absolute bottom-2 right-2 z-10 flex gap-2\">\r\n              {isMobile && hasMultipleCameras && (\r\n                <Button\r\n                  label={\r\n                    <svg\r\n                      className=\"w-4 h-4\"\r\n                      fill=\"none\"\r\n                      stroke=\"currentColor\"\r\n                      viewBox=\"0 0 24 24\"\r\n                    >\r\n                      <path\r\n                        strokeLinecap=\"round\"\r\n                        strokeLinejoin=\"round\"\r\n                        strokeWidth={2}\r\n                        d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\r\n                      />\r\n                    </svg>\r\n                  }\r\n                  size=\"sm\"\r\n                  variant=\"secondary\"\r\n                  onClick={() => {\r\n                    setFacingMode((prev) =>\r\n                      prev === \"user\" ? \"environment\" : \"user\"\r\n                    );\r\n                  }}\r\n                  microinteraction\r\n                  title={\r\n                    facingMode === \"user\"\r\n                      ? \"Switch to back camera\"\r\n                      : \"Switch to front camera\"\r\n                  }\r\n                />\r\n              )}\r\n              {isMobile && (\r\n                <Button\r\n                  label={\r\n                    <svg\r\n                      className=\"w-4 h-4\"\r\n                      fill=\"none\"\r\n                      stroke=\"currentColor\"\r\n                      viewBox=\"0 0 24 24\"\r\n                    >\r\n                      <path\r\n                        strokeLinecap=\"round\"\r\n                        strokeLinejoin=\"round\"\r\n                        strokeWidth={2}\r\n                        d=\"M13 10V3L4 14h7v7l9-11h-7z\"\r\n                      />\r\n                    </svg>\r\n                  }\r\n                  size=\"sm\"\r\n                  variant=\"secondary\"\r\n                  onClick={() => setTorchEnabled(!torchEnabled)}\r\n                  microinteraction\r\n                  title={\r\n                    torchEnabled ? \"Turn off flashlight\" : \"Turn on flashlight\"\r\n                  }\r\n                />\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ScannerCard;\r\n"],"names":["ScannerCard","paused","onResume","textMain","className","modalContext","props","facingMode","setFacingMode","useState","error","setError","isInitializing","setIsInitializing","torchEnabled","setTorchEnabled","isMobile","setIsMobile","hasMultipleCameras","setHasMultipleCameras","modalInitialized","setModalInitialized","useEffect","test","navigator","userAgent","async","videoDevices","mediaDevices","enumerateDevices","filter","device","kind","length","err","checkCameras","jsx","children","jsxs","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","Scanner","onError","constraints","width","ideal","min","height","frameRate","torch","styles","container","borderRadius","overflow","video","objectFit","backgroundColor","classNames","Button","label","size","variant","onClick","prev","microinteraction","title"],"mappings":"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"}