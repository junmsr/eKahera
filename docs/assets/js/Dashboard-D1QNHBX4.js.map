{"version":3,"file":"Dashboard-D1QNHBX4.js","sources":["../../../frontend/src/components/ui/Dashboard/ChartCard.jsx","../../../frontend/src/components/ui/Dashboard/DashboardStatsCard.jsx","../../../frontend/src/components/ui/Dashboard/DashboardBusinessReport.jsx","../../../frontend/src/pages/Dashboard.jsx"],"sourcesContent":["import React from \"react\";\r\nimport Card from \"../../common/Card\";\r\nimport SectionHeader from \"../../layout/SectionHeader\";\r\n\r\n/**\r\n * ChartCard Component\r\n * Provides a consistent layout for dashboard chart sections\r\n */\r\nfunction ChartCard({ title, children, className = \"\", ...props }) {\r\n  return (\r\n    <Card\r\n      className={`bg-white/80 backdrop-blur-md border border-white/60 shadow-xl group ${className}`}\r\n      {...props}\r\n    >\r\n      {title && (\r\n        <SectionHeader\r\n          size=\"md\"\r\n          align=\"left\"\r\n          className=\"text-gray-900 mb-6 font-bold group-hover:text-blue-600 transition-colors duration-300\"\r\n        >\r\n          {title}\r\n        </SectionHeader>\r\n      )}\r\n      <div className=\"relative\">\r\n        {children}\r\n        {/* Subtle gradient overlay for depth */}\r\n        <div className=\"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-blue-50/20 rounded-lg pointer-events-none\"></div>\r\n      </div>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default ChartCard;\r\n","import React from \"react\";\r\nimport Card from \"../../common/Card\";\r\n\r\nfunction DashboardStatsCard({ stats, className = \"\", ...props }) {\r\n  return (\r\n    <Card\r\n      className={`bg-white backdrop-blur-sm border border-gray-100 shadow-sm rounded-2xl ${className}`}\r\n      {...props}\r\n    >\r\n      <div className=\"grid grid-cols-1 divide-y divide-gray-200/60 p-6 md:p-8 space-y-4\">\r\n        {/* Sales Metric */}\r\n        <div className=\"flex items-start gap-4 py-4\">\r\n          <div className=\"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 text-xl font-bold\">\r\n            ₱\r\n          </div>\r\n          <div className=\"flex flex-col\">\r\n            <span className=\"text-xs font-semibold text-gray-500 tracking-wide uppercase\">\r\n              Today's Sales\r\n            </span>\r\n            <span className=\"text-2xl md:text-xl font-bold text-gray-900 mt-0.5\">\r\n              ₱{Number(stats.sales || 0).toLocaleString()}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Transactions Metric */}\r\n        <div className=\"flex items-start gap-4 py-4\">\r\n          <div className=\"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 text-xl font-bold\">\r\n            ↻\r\n          </div>\r\n          <div className=\"flex flex-col\">\r\n            <span className=\"text-xs font-semibold text-gray-500 tracking-wide uppercase\">\r\n              Transactions\r\n            </span>\r\n            <span className=\"text-2xl md:text-xl font-bold text-gray-900 mt-0.5\">\r\n              {Number(stats.transactions || 0).toLocaleString()}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Top Product Metric */}\r\n        <div className=\"flex items-start gap-4 py-4\">\r\n          <div className=\"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 text-xl font-bold\">\r\n            ★\r\n          </div>\r\n          <div className=\"flex flex-col\">\r\n            <span className=\"text-xs font-semibold text-gray-500 tracking-wide uppercase\">\r\n              Top Product\r\n            </span>\r\n            <span className=\"text-xl md:text-lg font-bold text-gray-900 mt-0.5 leading-tight line-clamp-2\">\r\n              {stats.topProduct || \"-\"}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Total Items Sold Metric */}\r\n        <div className=\"flex items-start gap-4 py-4\">\r\n          <div className=\"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 text-xl font-bold\">\r\n            #\r\n          </div>\r\n          <div className=\"flex flex-col\">\r\n            <span className=\"text-xs font-semibold text-gray-500 tracking-wide uppercase\">\r\n              Total Items Sold\r\n            </span>\r\n            <span className=\"text-2xl md:text-xl font-bold text-gray-900 mt-0.5\">\r\n              {Number(stats.totalItemsSold || 0).toLocaleString()}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default DashboardStatsCard;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n  LineChart,\r\n  Line,\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n} from \"recharts\";\r\nimport { api } from \"../../../lib/api\";\r\n\r\nconst TrendIcon = ({ trend }) => {\r\n  if (trend === \"up\")\r\n    return <span className=\"text-blue-600 font-semibold text-xl\">↗</span>;\r\n  if (trend === \"down\")\r\n    return <span className=\"text-blue-400 font-semibold text-xl\">↘</span>;\r\n  return <span className=\"text-gray-400 font-semibold text-xl\">→</span>;\r\n};\r\n\r\nexport default function DashboardBusinessReport() {\r\n  const [salesByLocation, setSalesByLocation] = useState([]);\r\n  const [revenueVsExpenses, setRevenueVsExpenses] = useState([]);\r\n  const [profitTrend, setProfitTrend] = useState([]);\r\n  const [paymentMethods, setPaymentMethods] = useState([]);\r\n  const [productPerformance, setProductPerformance] = useState([]);\r\n  const [keyMetrics, setKeyMetrics] = useState({});\r\n  const [businessStats, setBusinessStats] = useState({\r\n    cashFlow: 0,\r\n    operatingCosts: 0,\r\n    profitGrowth: 0,\r\n  });\r\n\r\n  const blueShades = [\r\n    \"#3b82f6\",\r\n    \"#1d4ed8\",\r\n    \"#1e40af\",\r\n    \"#2563eb\",\r\n    \"#60a5fa\",\r\n    \"#93c5fd\",\r\n    \"#bfdbfe\",\r\n  ];\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const [\r\n          keyMetricsRes,\r\n          salesByLocationRes,\r\n          revenueVsExpensesRes,\r\n          profitTrendRes,\r\n          paymentMethodsRes,\r\n          productPerformanceRes,\r\n          businessStatsRes,\r\n        ] = await Promise.all([\r\n          api(\"/api/stats/key-metrics\"),\r\n          api(\"/api/stats/sales-by-location\"),\r\n          api(\"/api/stats/revenue-vs-expenses\"),\r\n          api(\"/api/stats/profit-trend\"),\r\n          api(\"/api/stats/payment-methods\"),\r\n          api(\"/api/stats/product-performance\"),\r\n          api(\"/api/stats/business-stats\"),\r\n        ]);\r\n\r\n        setKeyMetrics(keyMetricsRes || {});\r\n        setSalesByLocation(salesByLocationRes || []);\r\n        setRevenueVsExpenses(revenueVsExpensesRes || []);\r\n        setProfitTrend(profitTrendRes || []);\r\n        setPaymentMethods(paymentMethodsRes || []);\r\n        setProductPerformance(productPerformanceRes || []);\r\n        setBusinessStats(businessStatsRes || {});\r\n      } catch (error) {\r\n        console.error(\"Error fetching business report data:\", error);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  return (\r\n    <section className=\"w-full px-5 md:px-8 py-6 bg-gray-50\">\r\n      {/* Key Metrics */}\r\n      {/* Charts Row 1: Sales by Location and Revenue vs Expenses */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8 w-full min-h-[350px]\">\r\n        {/* Sales by Location */}\r\n        <div className=\"bg-white rounded-lg p-6 border border-blue-300 shadow-lg\">\r\n          <h3 className=\"text-xl font-extrabold text-blue-700 mb-5 select-none\">\r\n            Sales by Location\r\n          </h3>\r\n          <ResponsiveContainer width=\"100%\" height={280}>\r\n            <BarChart\r\n              data={salesByLocation}\r\n              margin={{ top: 10, right: 10, left: 0, bottom: 10 }}\r\n            >\r\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#cbd5e1\" />\r\n              <XAxis\r\n                dataKey=\"location\"\r\n                tick={{ fontSize: 13, fill: \"#1e40af\" }}\r\n                padding={{ left: 10, right: 10 }}\r\n              />\r\n              <YAxis tick={{ fontSize: 13, fill: \"#1e40af\" }} />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  background: \"#f0f9ff\",\r\n                  borderColor: \"#3b82f6\",\r\n                  borderRadius: 10,\r\n                  fontWeight: \"600\",\r\n                }}\r\n                labelStyle={{ fontWeight: \"700\", color: \"#1e3a8a\" }}\r\n              />\r\n              <Bar\r\n                dataKey=\"sales\"\r\n                fill=\"#3b82f6\"\r\n                radius={[10, 10, 0, 0]}\r\n                barSize={40}\r\n                background={{ fill: \"#c7d2fe\" }}\r\n              />\r\n            </BarChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n\r\n        {/* Revenue vs Expenses */}\r\n        <div className=\"bg-white rounded-lg p-6 border border-blue-300 shadow-lg\">\r\n          <h3 className=\"text-xl font-extrabold text-blue-700 mb-5 select-none\">\r\n            Revenue vs Expenses\r\n          </h3>\r\n          <ResponsiveContainer width=\"100%\" height={280}>\r\n            <BarChart\r\n              data={revenueVsExpenses}\r\n              margin={{ top: 10, right: 10, left: 0, bottom: 10 }}\r\n            >\r\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#cbd5e1\" />\r\n              <XAxis\r\n                dataKey=\"month\"\r\n                tick={{ fontSize: 13, fill: \"#1e40af\" }}\r\n                padding={{ left: 10, right: 10 }}\r\n              />\r\n              <YAxis tick={{ fontSize: 13, fill: \"#1e40af\" }} />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  background: \"#f0f9ff\",\r\n                  borderColor: \"#3b82f6\",\r\n                  borderRadius: 10,\r\n                  fontWeight: \"600\",\r\n                }}\r\n                labelStyle={{ fontWeight: \"700\", color: \"#1e3a8a\" }}\r\n              />\r\n              <Legend\r\n                verticalAlign=\"top\"\r\n                wrapperStyle={{ paddingBottom: 10 }}\r\n              />\r\n              <Bar\r\n                dataKey=\"revenue\"\r\n                fill=\"#2563eb\"\r\n                radius={[10, 10, 0, 0]}\r\n                barSize={32}\r\n                background={{ fill: \"#bfdbfe\" }}\r\n              />\r\n              <Bar\r\n                dataKey=\"expenses\"\r\n                fill=\"#93c5fd\"\r\n                radius={[10, 10, 0, 0]}\r\n                barSize={32}\r\n                background={{ fill: \"#dbeafe\" }}\r\n              />\r\n            </BarChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Charts Row 2: Profit Trend and Payment Methods */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8 w-full min-h-[350px]\">\r\n        {/* Profit Trends */}\r\n        <div className=\"bg-white rounded-lg p-6 border border-blue-300 shadow-lg\">\r\n          <h3 className=\"text-xl font-extrabold text-blue-700 mb-5 select-none\">\r\n            Profit Trends\r\n          </h3>\r\n          <ResponsiveContainer width=\"100%\" height={280}>\r\n            <LineChart\r\n              data={profitTrend}\r\n              margin={{ top: 10, right: 10, left: 0, bottom: 10 }}\r\n            >\r\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#cbd5e1\" />\r\n              <XAxis\r\n                dataKey=\"month\"\r\n                tick={{ fontSize: 13, fill: \"#1e40af\" }}\r\n                padding={{ left: 10, right: 10 }}\r\n              />\r\n              <YAxis tick={{ fontSize: 13, fill: \"#1e40af\" }} />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  background: \"#f0f9ff\",\r\n                  borderColor: \"#3b82f6\",\r\n                  borderRadius: 10,\r\n                  fontWeight: \"600\",\r\n                }}\r\n                labelStyle={{ fontWeight: \"700\", color: \"#1e3a8a\" }}\r\n              />\r\n              <Line\r\n                type=\"monotone\"\r\n                dataKey=\"profit\"\r\n                stroke=\"#2563eb\"\r\n                strokeWidth={3}\r\n                dot={{ fill: \"#2563eb\", r: 6 }}\r\n              />\r\n            </LineChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n\r\n        {/* Payment Methods */}\r\n        <div className=\"bg-white rounded-lg p-6 border border-blue-300 shadow-lg\">\r\n          <h3 className=\"text-xl font-extrabold text-blue-700 mb-5 select-none\">\r\n            Payment Methods\r\n          </h3>\r\n          <ResponsiveContainer width=\"100%\" height={280}>\r\n            <PieChart margin={{ top: 20, right: 20, left: 20, bottom: 20 }}>\r\n              <Pie\r\n                data={paymentMethods}\r\n                cx=\"50%\"\r\n                cy=\"50%\"\r\n                labelLine={false}\r\n                label={({ name, value }) => `${name} ${value}%`}\r\n                outerRadius={90}\r\n                dataKey=\"value\"\r\n              >\r\n                {paymentMethods.map((entry, index) => (\r\n                  <Cell\r\n                    key={`cell-${index}`}\r\n                    fill={blueShades[index % blueShades.length]}\r\n                  />\r\n                ))}\r\n              </Pie>\r\n              <Tooltip\r\n                formatter={(value, name, props) => [\r\n                  `${Number(value).toFixed(0)}%`,\r\n                  props?.payload?.name,\r\n                ]}\r\n                contentStyle={{\r\n                  background: \"#eff6ff\",\r\n                  borderColor: \"#3b82f6\",\r\n                  borderRadius: 10,\r\n                  fontWeight: \"600\",\r\n                }}\r\n                labelStyle={{ fontWeight: \"700\", color: \"#1e40af\" }}\r\n              />\r\n              <Legend verticalAlign=\"bottom\" height={36} />\r\n            </PieChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Product Performance */}\r\n      <div className=\"bg-white rounded-lg p-6 border border-gray-200 shadow-md mb-8 w-full\">\r\n        <h3 className=\"text-xl font-bold text-gray-800 mb-6 select-none\">\r\n          Product Performance\r\n        </h3>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n          {(() => {\r\n            const maxSales = Math.max(\r\n              ...productPerformance.map((p) => p.sales || 0)\r\n            );\r\n            return productPerformance.map((product) => {\r\n              const progressPercent = maxSales\r\n                ? Math.round((product.sales / maxSales) * 100)\r\n                : 0;\r\n              return (\r\n                <div\r\n                  key={product.name}\r\n                  className=\"bg-gray-50 rounded-lg p-4 border border-gray-150\"\r\n                >\r\n                  <div className=\"flex items-center justify-between mb-3\">\r\n                    <span className=\"font-semibold text-gray-800 text-sm\">\r\n                      {product.name}\r\n                    </span>\r\n                    <TrendIcon trend={product.trend} />\r\n                  </div>\r\n                  <div className=\"w-full bg-gray-200 rounded-full h-2 mb-2\">\r\n                    <div\r\n                      className=\"bg-blue-500 h-2 rounded-full transition-all duration-300\"\r\n                      role=\"progressbar\"\r\n                      aria-valuenow={progressPercent}\r\n                      aria-valuemin={0}\r\n                      aria-valuemax={100}\r\n                      aria-label={`Sales progress for ${product.name}`}\r\n                      style={{ width: `${progressPercent}%` }}\r\n                    ></div>\r\n                  </div>\r\n                  <p className=\"text-sm text-gray-600 font-semibold\">\r\n                    ₱{product.sales.toLocaleString()}\r\n                  </p>\r\n                </div>\r\n              );\r\n            });\r\n          })()}\r\n        </div>\r\n      </div>\r\n    </section>\r\n  );\r\n}\r\n","import React, { useState, useEffect, useMemo } from \"react\";\r\nimport { api, authHeaders } from \"../lib/api\";\r\nimport {\r\n  LineChart,\r\n  Line,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  Legend,\r\n} from \"recharts\";\r\n\r\nimport { useAuth } from \"../hooks/useAuth\";\r\n\r\n// Components\r\nimport PageLayout from \"../components/layout/PageLayout\";\r\nimport NavAdmin from \"../components/layout/Nav-Admin\";\r\nimport StatsCard from \"../components/ui/Dashboard/StatsCard\";\r\nimport ChartCard from \"../components/ui/Dashboard/ChartCard\";\r\nimport DashboardStatsCard from \"../components/ui/Dashboard/DashboardStatsCard\";\r\nimport DashboardBusinessReport from \"../components/ui/Dashboard/DashboardBusinessReport\";\r\nimport Button from \"../components/common/Button\";\r\nimport { BiBell, BiUser, BiRefresh } from \"react-icons/bi\";\r\nimport ProfileModal from \"../components/modals/ProfileModal\";\r\nimport NotificationDropdown from \"../components/common/NotificationDropdown\";\r\n\r\n// Constants\r\nconst BLUE_COLORS = [\"#2563eb\", \"#60a5fa\", \"#93c5fd\", \"#dbeafe\"];\r\n\r\nconst SOFT_BLUE = \"#93c5fd\";\r\nconst SOFT_GREEN = \"#1e2cecff\";\r\nconst SOFT_PURPLE = \"#3e209bff\";\r\n\r\nfunction VisitorsChart({ data, className = \"\", range = \"month\" }) {\r\n  const rangeLabels = {\r\n    week: \"this week\",\r\n    month: \"this month\",\r\n    year: \"this year\",\r\n  };\r\n\r\n  return (\r\n    <ChartCard\r\n      title={\r\n        <span className=\"text-blue-700\">Visitors for the {rangeLabels[range] || \"last 6 months\"}</span>\r\n      }\r\n      className={`bg-white/80 backdrop-blur-md border border-white/60 shadow-xl ${className}`}\r\n    >\r\n      <div className=\"h-72\">\r\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n          <LineChart\r\n            data={data}\r\n            margin={{ top: 20, right: 20, left: 0, bottom: 5 }}\r\n          >\r\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\r\n            <XAxis dataKey=\"name\" tick={{ fill: \"#374151\", fontSize: 14 }} />\r\n            <YAxis tick={{ fill: \"#374151\", fontSize: 14 }} />\r\n            <Tooltip\r\n              contentStyle={{\r\n                background: \"#fff\",\r\n                borderColor: \"#e5e7eb\",\r\n                borderRadius: 8,\r\n              }}\r\n            />\r\n            <Line\r\n              type=\"monotone\"\r\n              dataKey=\"value\"\r\n              stroke={SOFT_BLUE}\r\n              strokeWidth={3}\r\n              dot={{ r: 5, fill: SOFT_BLUE }}\r\n            />\r\n          </LineChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n    </ChartCard>\r\n  );\r\n}\r\n\r\nfunction SalesPieChart({ data, className = \"\" }) {\r\n  return (\r\n    <ChartCard\r\n      title={<span className=\"text-blue-700\">Sales by Product Category</span>}\r\n      className={`bg-white/80 backdrop-blur-md border border-white/60 shadow-xl ${className}`}\r\n    >\r\n      <div className=\"h-72\">\r\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n          <PieChart>\r\n            <Pie\r\n              data={data}\r\n              dataKey=\"percent\"\r\n              nameKey=\"name\"\r\n              cx=\"50%\"\r\n              cy=\"50%\"\r\n              outerRadius={80}\r\n              label={(entry) =>\r\n                `${entry.name} (${Number(entry.percent || 0).toFixed(1)}%)`\r\n              }\r\n              fill={SOFT_PURPLE}\r\n            >\r\n              {data.map((entry, idx) => {\r\n                const colors = [SOFT_BLUE, SOFT_GREEN, SOFT_PURPLE];\r\n                return (\r\n                  <Cell\r\n                    key={`cell-${idx}`}\r\n                    fill={colors[idx % colors.length]}\r\n                  />\r\n                );\r\n              })}\r\n            </Pie>\r\n            <Legend />\r\n            <Tooltip\r\n              formatter={(value, name, props) => [\r\n                `${Number(value).toFixed(1)}%`,\r\n                props?.payload?.name,\r\n              ]}\r\n              contentStyle={{\r\n                background: \"#fafafa\",\r\n                borderColor: SOFT_PURPLE,\r\n                borderRadius: 8,\r\n              }}\r\n            />\r\n          </PieChart>\r\n        </ResponsiveContainer>\r\n      </div>\r\n    </ChartCard>\r\n  );\r\n}\r\n\r\n// Main Dashboard Component\r\nexport default function Dashboard() {\r\n\r\n  const [keyMetrics, setKeyMetrics] = useState({\r\n    revenue: 0,\r\n    expenses: 0,\r\n    netProfit: 0,\r\n    grossMargin: 0,\r\n    totalTransactions: 0,\r\n    totalItemsSold: 0,\r\n  });\r\n\r\n  // State\r\n  const [stats, setStats] = useState([]);\r\n  const [range, setRange] = useState(\"month\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [chartData, setChartData] = useState([]);\r\n  const [pieData, setPieData] = useState([]);\r\n  const [lowStockProducts, setLowStockProducts] = useState([]);\r\n  const [showProfileModal, setShowProfileModal] = useState(false);\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const [showNotifications, setShowNotifications] = useState(false);\r\n  const notificationRef = React.useRef(null);\r\n  const { logout } = useAuth();\r\n  const [isSidebarOpen, setSidebarOpen] = useState(false);\r\n  const [todayHighlight, setTodayHighlight] = useState({\r\n    sales: 0,\r\n    transactions: 0,\r\n    topProduct: \"-\",\r\n    totalItemsSold: 0,\r\n  });\r\n\r\n  useEffect(() => {\r\n    const fetchTodayData = async () => {\r\n      try {\r\n        const token = sessionStorage.getItem(\"auth_token\");\r\n        const today = new Date();\r\n        const startDate = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;\r\n\r\n        const overview = await api(\"/api/dashboard/overview\", { \r\n          headers: authHeaders(token),\r\n          params: { startDate, endDate: startDate }\r\n        });\r\n\r\n        if (overview) {\r\n        setTodayHighlight({\r\n          sales: overview.totalSales,\r\n          transactions: overview.totalTransactions,\r\n          totalItemsSold: overview.totalItemsSold,\r\n          topProduct: (overview.topProducts?.[0]?.product_name) || \"-\",\r\n        });\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Failed to fetch today's data\", err);\r\n      }\r\n    };\r\n    fetchTodayData();\r\n  }, []);\r\n\r\n  const user = useMemo(() => {\r\n    try {\r\n      return JSON.parse(sessionStorage.getItem(\"user\") || \"{}\");\r\n    } catch (e) {\r\n      return {};\r\n    }\r\n  }, []);\r\n\r\n  // Close notification dropdown on outside click\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (\r\n        notificationRef.current &&\r\n        !notificationRef.current.contains(event.target)\r\n      ) {\r\n        setShowNotifications(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n  }, []);\r\n\r\n  // Data fetching\r\n  const fetchData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n      \r\n      // Calculate date range based on selected period\r\n      const now = new Date();\r\n      let startDate, endDate;\r\n\r\n      switch (range) {\r\n        case 'week':\r\n          // Start of current week (Sunday)\r\n          startDate = new Date(now);\r\n          const dayOfWeek = now.getDay(); // 0 = Sunday, 6 = Saturday\r\n          startDate.setDate(now.getDate() - dayOfWeek);\r\n          startDate.setHours(0, 0, 0, 0);\r\n          // End of current week (Saturday)\r\n          endDate = new Date(startDate);\r\n          endDate.setDate(startDate.getDate() + 6);\r\n          endDate.setHours(23, 59, 59, 999);\r\n          break;\r\n        case 'month':\r\n          // Start of current month\r\n          startDate = new Date(now.getFullYear(), now.getMonth(), 1);\r\n          startDate.setHours(0, 0, 0, 0);\r\n          // End of current month\r\n          endDate = new Date(now.getFullYear(), now.getMonth() + 1, 0);\r\n          endDate.setHours(23, 59, 59, 999);\r\n          break;\r\n        case 'year':\r\n          // Start of current year\r\n          startDate = new Date(now.getFullYear(), 0, 1);\r\n          startDate.setHours(0, 0, 0, 0);\r\n          // End of current year\r\n          endDate = new Date(now.getFullYear(), 11, 31);\r\n          endDate.setHours(23, 59, 59, 999);\r\n          break;\r\n        default:\r\n          startDate = new Date(now.getFullYear(), now.getMonth(), 1);\r\n          startDate.setHours(0, 0, 0, 0);\r\n          endDate = new Date(now.getFullYear(), now.getMonth() + 1, 0);\r\n          endDate.setHours(23, 59, 59, 999);\r\n          break;\r\n      }\r\n\r\n      // Format dates for API - use consistent format (YYYY-MM-DD) for all endpoints\r\n      const formatDate = (date) => {\r\n        const d = new Date(date);\r\n        const year = d.getFullYear();\r\n        const month = String(d.getMonth() + 1).padStart(2, '0');\r\n        const day = String(d.getDate()).padStart(2, '0');\r\n        return `${year}-${month}-${day}`;\r\n      };\r\n      \r\n      const startDateStr = formatDate(startDate);\r\n      const endDateStr = formatDate(endDate);\r\n      \r\n      console.log('Fetching data for date range:', { \r\n        range,\r\n        startDate: startDate.toISOString(),\r\n        endDate: endDate.toISOString(),\r\n        formattedStart: startDateStr,\r\n        formattedEnd: endDateStr\r\n      });\r\n\r\n      // Fetch data for the selected period\r\n      const [overview, timeseries, pie, inventoryMovement, oldLowStock] = await Promise.all([\r\n        api(\"/api/dashboard/overview\", { \r\n          headers: authHeaders(token),\r\n          params: { \r\n            startDate: startDateStr,\r\n            endDate: endDateStr\r\n          }\r\n        }),\r\n        api(`/api/stats/customers-timeseries`, { \r\n          headers: authHeaders(token),\r\n          params: {\r\n            startDate: startDateStr,\r\n            endDate: endDateStr\r\n          }\r\n        }),\r\n        api(\"/api/stats/sales-by-category\", { \r\n          headers: authHeaders(token),\r\n          params: {\r\n            startDate: startDateStr,\r\n            endDate: endDateStr\r\n          }\r\n        }),\r\n        api(\"/api/dashboard/inventory-movement\", {\r\n          headers: authHeaders(token),\r\n        }),\r\n        api(\"/api/products/low-stock\", { headers: authHeaders(token) }),\r\n      ]);\r\n\r\n      // Process the response data\r\n      const derived = (timeseries || []).map((d) => ({\r\n        ...d,\r\n        value: Number(d.customers || d.total || d.value || 0),\r\n      }));\r\n\r\n      // Process pie chart data\r\n      const pieTotal = (pie || []).reduce((s, p) => s + Number(p.value || 0), 0) || 1;\r\n      const piePercent = (pie || []).map((p) => ({\r\n        ...p,\r\n        percent: (Number(p.value || 0) / pieTotal) * 100,\r\n      }));\r\n\r\n          // If overview is available use it for KPIs\r\n      if (overview) {\r\n        console.log('Overview data received:', overview);\r\n        \r\n        // Get values from overview, defaulting to 0 if undefined\r\n        const revenue = Number(overview.totalSales || 0);\r\n        const expenses = Number(overview.totalExpenses || 0);\r\n        const netProfit = revenue - expenses; // Calculate net profit if not provided\r\n        const grossMargin = revenue > 0 ? ((revenue - expenses) / revenue) * 100 : 0;\r\n        const totalTransactions = Number(overview.totalTransactions || 0);\r\n        const totalItemsSold = Number(overview.totalItemsSold || 0);\r\n        // Removed avgTxValue calculation as it's no longer needed\r\n        const topProduct = (overview.topProducts?.[0]?.product_name) || \"-\";\r\n\r\n        console.log('Processed metrics:', {\r\n          revenue,\r\n          expenses,\r\n          netProfit,\r\n          grossMargin,\r\n          totalTransactions,\r\n          totalItemsSold,\r\n          topProduct\r\n        });\r\n\r\n        // Update key metrics with all values\r\n        setKeyMetrics({\r\n          revenue,\r\n          expenses,\r\n          netProfit,\r\n          grossMargin,\r\n          totalTransactions,\r\n          totalItemsSold\r\n        });\r\n\r\n        // Format date range for display\r\n        const formatDateRange = () => {\r\n          const now = new Date();\r\n          let startDate, endDate = now;\r\n          \r\n          switch (range) {\r\n            case 'week':\r\n              startDate = new Date(now);\r\n              startDate.setDate(now.getDate() - now.getDay());\r\n              return `${startDate.toLocaleDateString('en-PH', { month: 'short', day: 'numeric' })} - ${endDate.toLocaleDateString('en-PH', { month: 'short', day: 'numeric' })}`;\r\n            case 'month':\r\n              startDate = new Date(now.getFullYear(), now.getMonth(), 1);\r\n              return startDate.toLocaleDateString('en-PH', { month: 'long', year: 'numeric' });\r\n            case 'year':\r\n              return now.getFullYear().toString();\r\n            default:\r\n              return now.toLocaleDateString('en-PH');\r\n          }\r\n        };\r\n\r\n        const dateRangeText = formatDateRange();\r\n        \r\n        // Update stats for the stats cards based on selected range\r\n        setStats([\r\n          { \r\n            label: range === 'week' ? \"This Week's Sales\" : range === 'month' ? \"This Month's Sales\" : \"This Year's Sales\", \r\n            value: `₱${revenue.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`,\r\n            subtext: dateRangeText\r\n          },\r\n          { \r\n            label: range === 'week' ? \"Weekly Transactions\" : range === 'month' ? \"Monthly Transactions\" : \"Yearly Transactions\", \r\n            value: totalTransactions,\r\n            subtext: `${dateRangeText}`\r\n          },\r\n          { \r\n            label: range === 'week' ? \"Top Product\" : range === 'month' ? \"Top Product\" : \"Top Product\", \r\n            value: topProduct,\r\n            subtext: `Total: ${overview.topProducts?.[0]?.total_sold || 0} sold`\r\n          },\r\n          { \r\n            label: range === 'week' ? \"Items Sold\" : range === 'month' ? \"Items Sold\" : \"Items Sold\", \r\n            value: totalItemsSold,\r\n            subtext: `${totalTransactions} transactions`\r\n          },\r\n        ]);\r\n      }\r\n\r\n      // Update chart data\r\n      setChartData(derived);\r\n      setPieData(piePercent);\r\n      \r\n      // Update low stock products\r\n      const lowStock = (inventoryMovement || []).filter(\r\n        (p) => Number(p.quantity_in_stock || 0) <= 10\r\n      );\r\n      setLowStockProducts(lowStock.length ? lowStock : oldLowStock || []);\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch dashboard data\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchNotifications = async () => {\r\n    try {\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n      const resp = await api(\"/api/logs\", { headers: authHeaders(token) });\r\n      const readIds = new Set(\r\n        JSON.parse(sessionStorage.getItem(\"read_notif_ids\") || \"[]\")\r\n      );\r\n      const deletedIds = new Set(\r\n        JSON.parse(sessionStorage.getItem(\"deleted_notif_ids\") || \"[]\")\r\n      );\r\n      const mapped = (resp || [])\r\n        .filter((log) => !deletedIds.has(log.log_id))\r\n        .map((log) => ({\r\n          id: log.log_id,\r\n          title: log.action,\r\n          message: `${log.username} (${log.role}) did an action: ${log.action}`,\r\n          time: new Date(log.date_time).toLocaleString(),\r\n          isRead: readIds.has(log.log_id),\r\n        }));\r\n      setNotifications(mapped);\r\n      setUnreadCount(mapped.filter((n) => !n.isRead).length);\r\n    } catch (e) {\r\n      console.error(\"Failed to fetch notifications\", e);\r\n    }\r\n  };\r\n\r\n  const handleMarkAsRead = (id) => {\r\n    const readIds = JSON.parse(\r\n      sessionStorage.getItem(\"read_notif_ids\") || \"[]\"\r\n    );\r\n    if (!readIds.includes(id)) {\r\n      sessionStorage.setItem(\r\n        \"read_notif_ids\",\r\n        JSON.stringify([...readIds, id])\r\n      );\r\n    }\r\n    setNotifications((notifs) =>\r\n      notifs.map((n) => (n.id === id ? { ...n, isRead: true } : n))\r\n    );\r\n    setUnreadCount((c) => Math.max(0, c - 1));\r\n  };\r\n\r\n  const handleMarkAsUnread = (id) => {\r\n    const readIds = JSON.parse(\r\n      sessionStorage.getItem(\"read_notif_ids\") || \"[]\"\r\n    );\r\n    const filtered = readIds.filter((rid) => rid !== id);\r\n    sessionStorage.setItem(\"read_notif_ids\", JSON.stringify(filtered));\r\n    setNotifications((notifs) =>\r\n      notifs.map((n) => (n.id === id ? { ...n, isRead: false } : n))\r\n    );\r\n    setUnreadCount((c) => c + 1);\r\n  };\r\n\r\n  const handleDeleteNotification = (id) => {\r\n    const deletedIds = JSON.parse(\r\n      sessionStorage.getItem(\"deleted_notif_ids\") || \"[]\"\r\n    );\r\n    sessionStorage.setItem(\r\n      \"deleted_notif_ids\",\r\n      JSON.stringify([...deletedIds, id])\r\n    );\r\n    setNotifications((notifs) => notifs.filter((n) => n.id !== id));\r\n    // Update unread count if deleted notification was unread\r\n    const notif = notifications.find((n) => n.id === id);\r\n    if (notif && !notif.isRead) {\r\n      setUnreadCount((c) => Math.max(0, c - 1));\r\n    }\r\n  };\r\n\r\n  // Export to CSV\r\n  const exportToCSV = () => {\r\n    const headers = [\"Label\", \"Value\", \"Change\"];\r\n    const rows = stats.map((s) => [s.label, s.value, s.change]);\r\n    // Add low stock products\r\n    if (lowStockProducts.length > 0) {\r\n      rows.push([\"\", \"\", \"\"]); // separator\r\n      rows.push([\"Low Stock Products\", \"\", \"\"]);\r\n      rows.push([\"Product Name\", \"Quantity Left\", \"\"]);\r\n      lowStockProducts.forEach((p) =>\r\n        rows.push([p.product_name, p.quantity_in_stock, \"\"])\r\n      );\r\n    }\r\n    const csvContent = [headers, ...rows]\r\n      .map((row) => row.join(\",\"))\r\n      .join(\"\\n\");\r\n    const blob = new Blob([csvContent], { type: \"text/csv;charset=utf-8;\" });\r\n    const link = document.createElement(\"a\");\r\n    link.href = URL.createObjectURL(blob);\r\n    link.download = \"dashboard-data.csv\";\r\n    link.click();\r\n  };\r\n\r\n  // Fetch filtered data when range changes (affects stats cards and graphs)\r\n  // Note: todayHighlight is fetched separately and is NOT affected by the filter\r\n  useEffect(() => {\r\n    fetchData();\r\n    fetchNotifications();\r\n  }, [range]);\r\n\r\n  // Helper function to format currency values\r\n  const formatCurrency = (value) => {\r\n    return new Intl.NumberFormat('en-PH', {\r\n      style: 'currency',\r\n      currency: 'PHP',\r\n      minimumFractionDigits: 2,\r\n      maximumFractionDigits: 2\r\n    }).format(value);\r\n  };\r\n\r\n  // Header actions\r\n  const headerActions = (\r\n    <div className=\"flex items-center gap-2\">\r\n      <button\r\n        onClick={fetchData}\r\n        disabled={loading}\r\n        title=\"Refresh Data\"\r\n        className=\"bg-white/80 backdrop-blur-sm hover:bg-white text-gray-700 p-1.5 sm:p-2 rounded-lg border border-gray-200/80 text-sm font-medium transition-all duration-200 hover:shadow-md hover:scale-[1.02]\"\r\n      >\r\n        <BiRefresh\r\n          className={`w-4 h-4 sm:w-5 sm:h-5 ${loading ? \"animate-spin\" : \"\"}`}\r\n        />\r\n      </button>\r\n\r\n      <select\r\n        className=\"bg-white/80 backdrop-blur-sm hover:bg-white text-gray-700 px-1.5 sm:px-3 py-1.5 sm:py-2 rounded-lg border border-gray-200/80 text-xs sm:text-sm font-medium transition-all duration-200 outline-none cursor-pointer hover:shadow-md\"\r\n        value={range}\r\n        onChange={(e) => setRange(e.target.value)}\r\n        disabled={loading}\r\n      >\r\n        <option value=\"week\">Week</option>\r\n        <option value=\"month\">Month</option>\r\n        <option value=\"year\">Year</option>\r\n      </select>\r\n\r\n      <div className=\"-mt-2 -mb-3 py-8 px-8 pr-12 flex justify-end\">\r\n        <Button\r\n          onClick={exportToCSV}\r\n          size=\"sm\"\r\n          variant=\"secondary\"\r\n          className=\"flex items-center gap-2 w-full sm:w-auto shrink-0\"\r\n        >\r\n          <svg\r\n            className=\"w-5 h-5\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\r\n            />\r\n          </svg>\r\n          <span className=\"hidden sm:inline\">Export</span>\r\n          <span className=\"sm:hidden\">Export</span>\r\n        </Button>\r\n      </div>\r\n\r\n      <div className=\"relative\" ref={notificationRef}>\r\n        <NotificationDropdown\r\n          notifications={notifications}\r\n          unreadCount={unreadCount}\r\n          onMarkAsRead={handleMarkAsRead}\r\n          onMarkAsUnread={handleMarkAsUnread}\r\n          onDelete={handleDeleteNotification}\r\n          isOpen={showNotifications}\r\n          onToggle={() => setShowNotifications(!showNotifications)}\r\n          containerRef={notificationRef}\r\n        />\r\n      </div>\r\n\r\n      <button\r\n        onClick={() => setShowProfileModal(true)}\r\n        className=\"flex items-center gap-1 sm:gap-2 bg-white/80 backdrop-blur-sm p-1 sm:p-1.5 sm:px-2 sm:py-2 rounded-lg border border-gray-200/80 hover:bg-white transition-all duration-200 hover:shadow-md hover:scale-[1.02] shrink-0\"\r\n      >\r\n        <div className=\"w-7 h-7 sm:w-8 sm:h-8 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-full flex items-center justify-center text-sm font-medium shadow-lg\">\r\n          {user.username?.[0]?.toUpperCase() || \"A\"}\r\n        </div>\r\n        <span className=\"text-sm font-medium text-gray-700 hidden sm:inline\">\r\n          {user.username || \"Admin\"}\r\n        </span>\r\n      </button>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <PageLayout\r\n      title=\"DASHBOARD\"\r\n      subtitle=\"\"\r\n      sidebar={<NavAdmin />}\r\n      headerActions={headerActions}\r\n      isSidebarOpen={isSidebarOpen}\r\n      setSidebarOpen={setSidebarOpen}\r\n      className=\"bg-gray-50 min-h-screen\"\r\n    >\r\n      {/* Stats Cards - Mobile View */}\r\n      {/* <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 p-4 lg:hidden\">\r\n        {loading\r\n          ? Array.from({ length: 4 }).map((_, i) => (\r\n              <div\r\n                key={i}\r\n                className=\"bg-white p-4 rounded-xl shadow-sm border border-gray-200 animate-pulse\"\r\n              >\r\n                <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-2\"></div>\r\n                <div className=\"h-8 bg-gray-300 rounded w-1/2\"></div>\r\n              </div>\r\n            ))\r\n          : stats.map((stat, index) => (\r\n              <div\r\n                key={index}\r\n                className=\"bg-white p-4 rounded-xl shadow-sm border border-gray-200\"\r\n              >\r\n                <h4 className=\"text-sm font-medium text-gray-500\">\r\n                  {stat.label}\r\n                </h4>\r\n                <p className=\"text-2xl font-bold text-gray-900 mt-1\">\r\n                  {typeof stat.value === \"number\"\r\n                    ? stat.value.toLocaleString()\r\n                    : stat.value}\r\n                </p>\r\n                {stat.change ? (\r\n                  <p\r\n                    className={`text-xs font-medium mt-1 ${\r\n                      stat.change > 0 ? \"text-green-600\" : \"text-red-600\"\r\n                    }`}\r\n                  >\r\n                    {stat.change > 0 ? \"+\" : \"\"}\r\n                    {stat.change.toFixed(2)}%\r\n                  </p>\r\n                ) : null}\r\n              </div>\r\n            ))}\r\n      </div> */}\r\n\r\n      {/* Low Stock Products - Mobile View */}\r\n      <div className=\"p-4 lg:hidden\">\r\n        {loading ? (\r\n          <div className=\"bg-white p-6 rounded-xl shadow-md border border-gray-200 animate-pulse\">\r\n            <div className=\"h-6 bg-gray-200 rounded w-1/2 mb-6\"></div>\r\n            <div className=\"h-4 bg-gray-200 rounded w-full mb-3\"></div>\r\n            <div className=\"h-4 bg-gray-200 rounded w-full mb-3\"></div>\r\n            <div className=\"h-4 bg-gray-200 rounded w-4/5\"></div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"bg-white p-6 rounded-xl shadow-md\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n              <h3 className=\"text-lg font-bold text-gray-800\">\r\n                Low Stock Products\r\n              </h3>\r\n            </div>\r\n            <LowStockList lowStockProducts={lowStockProducts} />\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Main Content - Filtered Stats Cards (affected by week/month/year filter) */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 p-6 md:p-8\">\r\n        {stats.map((stat, index) => (\r\n          <div key={index} className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-200 hover:shadow-md transition-shadow\">\r\n            <div className=\"flex items-start gap-4\">\r\n              <div className=\"w-12 h-12 rounded-xl bg-blue-50 flex items-center justify-center text-blue-600 text-xl font-bold flex-shrink-0\">\r\n                {index === 0 ? '₱' : index === 1 ? '↻' : index === 2 ? '★' : '#'}\r\n              </div>\r\n              <div className=\"min-w-0\">\r\n                <h3 className=\"text-xs font-semibold text-gray-500 tracking-wide uppercase truncate\">{stat.label}</h3>\r\n                <p className=\"text-2xl font-bold text-gray-900 mt-1 truncate\">{stat.value}</p>\r\n                {stat.subtext && (\r\n                  <p className=\"text-xs text-gray-500 mt-1 truncate\">\r\n                    {stat.subtext}\r\n                  </p>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-6 p-6 pb-10 lg:pb-6 pt-0\">\r\n        {/* Main Chart Area - Filtered Charts (affected by week/month/year filter) */}\r\n        <div className=\"lg:col-span-8 flex flex-col gap-6\">\r\n          {loading ? (\r\n            <>\r\n              <div className=\"bg-white p-6 rounded-xl shadow-md border border-gray-200 h-[336px] animate-pulse flex items-center justify-center\">\r\n                <div className=\"w-full h-64 bg-gray-200 rounded-lg\"></div>\r\n              </div>\r\n              <div className=\"bg-white p-6 rounded-xl shadow-md border border-gray-200 h-[336px] animate-pulse flex items-center justify-center\">\r\n                <div className=\"w-64 h-64 bg-gray-200 rounded-full\"></div>\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <VisitorsChart data={chartData} range={range} />\r\n              <SalesPieChart data={pieData} />\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {/* Sidebar with Today's Stats (NOT affected by filter) and Low Stock */}\r\n        <div className=\"lg:col-span-4 flex flex-col gap-6\">\r\n          {loading ? (\r\n            <div className=\"bg-white p-6 rounded-xl shadow-md border border-gray-200 animate-pulse\">\r\n              <div className=\"h-6 bg-gray-200 rounded w-1/3 mb-4\"></div>\r\n              <div className=\"h-8 bg-gray-300 rounded w-1/2 mb-6\"></div>\r\n              <div className=\"h-6 bg-gray-200 rounded w-1/3 mb-4\"></div>\r\n              <div className=\"h-8 bg-gray-300 rounded w-1/2 mb-6\"></div>\r\n              <div className=\"h-6 bg-gray-200 rounded w-1/3 mb-4\"></div>\r\n              <div className=\"h-8 bg-gray-300 rounded w-1/2\"></div>\r\n            </div>\r\n          ) : (\r\n            <DashboardStatsCard stats={todayHighlight} />\r\n          )}\r\n          {loading ? (\r\n            <div className=\"bg-white p-6 rounded-xl shadow-md border border-gray-200 animate-pulse hidden lg:block\">\r\n              <div className=\"h-6 bg-gray-200 rounded w-1/2 mb-6\"></div>\r\n              <div className=\"h-4 bg-gray-200 rounded w-full mb-3\"></div>\r\n              <div className=\"h-4 bg-gray-200 rounded w-full mb-3\"></div>\r\n              <div className=\"h-4 bg-gray-200 rounded w-4/5\"></div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"bg-white p-6 rounded-lg shadow-md hidden lg:block\">\r\n              <div className=\"flex justify-between items-center mb-4\">\r\n                <h3 className=\"text-lg font-bold text-gray-800\">\r\n                  Low Stock Products\r\n                </h3>\r\n              </div>\r\n              {lowStockProducts.length > 0 ? (\r\n                <ul className=\"divide-y divide-gray-200\">\r\n                  {lowStockProducts.map((product) => (\r\n                    <li\r\n                      key={product.product_id}\r\n                      className=\"py-3 flex justify-between items-center\"\r\n                    >\r\n                      <span className=\"text-sm font-medium text-gray-800\">\r\n                        {product.product_name}\r\n                      </span>\r\n                      <span className=\"text-sm font-bold text-red-600\">\r\n                        {product.quantity_in_stock} left\r\n                      </span>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              ) : (\r\n                <p className=\"text-sm text-gray-500\">\r\n                  No products with low stock.\r\n                </p>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n      <div className=\"max-w-10lx mx-auto w-full\">\r\n        <DashboardBusinessReport />\r\n      </div>\r\n      <ProfileModal\r\n        isOpen={showProfileModal}\r\n        onClose={() => setShowProfileModal(false)}\r\n        userData={user}\r\n      />\r\n    </PageLayout>\r\n  );\r\n}\r\n\r\nfunction LowStockList({ lowStockProducts }) {\r\n  if (lowStockProducts.length === 0) {\r\n    return <p className=\"text-sm text-gray-500\">No products with low stock.</p>;\r\n  }\r\n\r\n  return (\r\n    <ul className=\"divide-y divide-gray-200\">\r\n      {lowStockProducts.map((product) => (\r\n        <li\r\n          key={product.product_id}\r\n          className=\"py-3 flex justify-between items-center\"\r\n        >\r\n          <span className=\"text-sm font-medium text-gray-800\">\r\n            {product.product_name}\r\n          </span>\r\n          <span className=\"text-sm font-bold text-red-600\">\r\n            {product.quantity_in_stock} left\r\n          </span>\r\n        </li>\r\n      ))}\r\n    </ul>\r\n  );\r\n}\r\n"],"names":["ChartCard","title","children","className","props","Card","jsx","SectionHeader","size","align","jsxs","DashboardStatsCard","stats","Number","sales","toLocaleString","transactions","topProduct","totalItemsSold","TrendIcon","trend","DashboardBusinessReport","salesByLocation","setSalesByLocation","useState","revenueVsExpenses","setRevenueVsExpenses","profitTrend","setProfitTrend","paymentMethods","setPaymentMethods","productPerformance","setProductPerformance","keyMetrics","setKeyMetrics","businessStats","setBusinessStats","cashFlow","operatingCosts","profitGrowth","blueShades","useEffect","async","keyMetricsRes","salesByLocationRes","revenueVsExpensesRes","profitTrendRes","paymentMethodsRes","productPerformanceRes","businessStatsRes","Promise","all","api","error","fetchData","ResponsiveContainer","width","height","BarChart","data","margin","top","right","left","bottom","CartesianGrid","strokeDasharray","stroke","XAxis","dataKey","tick","fontSize","fill","padding","YAxis","Tooltip","contentStyle","background","borderColor","borderRadius","fontWeight","labelStyle","color","Bar","radius","barSize","Legend","verticalAlign","wrapperStyle","paddingBottom","LineChart","Line","type","strokeWidth","dot","r","PieChart","Pie","cx","cy","labelLine","label","name","value","outerRadius","map","entry","index","Cell","length","formatter","toFixed","payload","maxSales","Math","max","p","product","progressPercent","round","role","style","SOFT_BLUE","SOFT_PURPLE","VisitorsChart","range","week","month","year","SalesPieChart","nameKey","percent","idx","colors","Dashboard","revenue","expenses","netProfit","grossMargin","totalTransactions","setStats","setRange","loading","setLoading","chartData","setChartData","pieData","setPieData","lowStockProducts","setLowStockProducts","showProfileModal","setShowProfileModal","notifications","setNotifications","unreadCount","setUnreadCount","showNotifications","setShowNotifications","notificationRef","React","useRef","useAuth","isSidebarOpen","setSidebarOpen","todayHighlight","setTodayHighlight","token","sessionStorage","getItem","today","Date","startDate","getFullYear","String","getMonth","padStart","getDate","overview","headers","authHeaders","params","endDate","totalSales","topProducts","product_name","err","fetchTodayData","user","useMemo","JSON","parse","e","handleClickOutside","event","current","contains","target","addEventListener","document","removeEventListener","now","dayOfWeek","getDay","setDate","setHours","formatDate","date","d","startDateStr","endDateStr","console","log","toISOString","formattedStart","formattedEnd","timeseries","pie","inventoryMovement","oldLowStock","derived","customers","total","pieTotal","reduce","s","piePercent","totalExpenses","dateRangeText","formatDateRange","toLocaleDateString","day","toString","undefined","minimumFractionDigits","maximumFractionDigits","subtext","total_sold","lowStock","filter","quantity_in_stock","resp","readIds","Set","deletedIds","mapped","has","log_id","id","action","message","username","time","date_time","isRead","n","fetchNotifications","headerActions","onClick","disabled","BiRefresh","onChange","Button","exportToCSV","rows","change","push","forEach","csvContent","row","join","blob","Blob","link","createElement","href","URL","createObjectURL","download","click","variant","viewBox","strokeLinecap","strokeLinejoin","ref","NotificationDropdown","onMarkAsRead","includes","setItem","stringify","notifs","c","onMarkAsUnread","filtered","rid","onDelete","notif","find","isOpen","onToggle","containerRef","toUpperCase","PageLayout","subtitle","sidebar","NavAdmin","LowStockList","stat","Fragment","product_id","ProfileModal","onClose","userData"],"mappings":"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"}