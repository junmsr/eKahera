{"version":3,"file":"ScanCustomerCartModal-B_-0vNkw.js","sources":["../../../frontend/src/components/ui/POS/SkuFormCard.jsx","../../../frontend/src/components/ui/POS/CartTableCard.jsx","../../../frontend/src/components/modals/PriceCheckModal.jsx","../../../frontend/src/components/modals/DiscountModal.jsx","../../../frontend/src/components/modals/CashLedgerModal.jsx","../../../frontend/src/components/modals/CheckoutModal.jsx","../../../frontend/src/components/modals/CashPaymentCompleteModal.jsx","../../../frontend/src/components/modals/CashPaymentModal.jsx","../../../frontend/src/components/modals/ScanCustomerCartModal.jsx"],"sourcesContent":["import React from \"react\";\r\nimport Card from \"../../common/Card\";\r\nimport Button from \"../../common/Button\";\r\n\r\n/**\r\n * SKU Form Card Component\r\n * Form for entering SKU codes and quantities\r\n */\r\nexport default React.forwardRef(\r\n  (\r\n    {\r\n      sku,\r\n      setSku,\r\n      quantity,\r\n      setQuantity,\r\n      handleAddToCart,\r\n      quantityInputRef,\r\n      className = \"\",\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    return (\r\n      <Card\r\n        className={`flex-shrink-0 bg-white/80 backdrop-blur-md border border-white/60 shadow-xl hover:shadow-2xl transition-all duration-300 ${className}`}\r\n        variant=\"glass\"\r\n        {...props}\r\n      >\r\n        <div className=\"flex flex-col gap-1 p-1 sm:p-2\">\r\n          <div className=\"flex items-center gap-2 mb-0.5\">\r\n            <div className=\"w-6 h-6 bg-blue-100 rounded-xl flex items-center justify-center\">\r\n              <svg\r\n                className=\"w-3 h-3 text-blue-600\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M7 20l4-16m2 16l4-16M6 9h14M4 15h14\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <span className=\"font-bold text-sm text-gray-900\">\r\n              Enter SKU Code\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <div>\r\n              <label className=\"block text-sm font-semibold text-gray-700 mb-1\">\r\n                SKU Code\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  ref={ref}\r\n                  type=\"text\"\r\n                  name=\"sku\"\r\n                  value={sku}\r\n                  onChange={(e) => setSku(e.target.value)}\r\n                  onKeyPress={(e) => {\r\n                    if (e.key === \"Enter\" && sku.trim()) {\r\n                      handleAddToCart();\r\n                    }\r\n                  }}\r\n                  placeholder=\"Scan or enter SKU code\"\r\n                  className=\"w-full pl-3 pr-3 py-2 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 placeholder-gray-400 font-medium\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-2\">\r\n              <label className=\"text-sm font-semibold text-gray-700 whitespace-nowrap\">\r\n                Quantity:\r\n              </label>\r\n              <div className=\"flex items-center gap-1 flex-1\">\r\n                <button\r\n                  onClick={() => setQuantity(Math.max(1, quantity - 1))}\r\n                  className=\"w-8 h-8 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold transition-colors duration-200 flex items-center justify-center\"\r\n                >\r\n                  −\r\n                </button>\r\n                <input\r\n                  ref={quantityInputRef}\r\n                  type=\"number\"\r\n                  name=\"quantity\"\r\n                  value={quantity}\r\n                  min={1}\r\n                  onChange={(e) =>\r\n                    setQuantity(Math.max(1, Number(e.target.value) || 1))\r\n                  }\r\n                  className=\"w-16 px-2 py-1 bg-white/80 backdrop-blur-sm border border-gray-200 rounded-xl text-center text-sm font-semibold focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200\"\r\n                />\r\n                <button\r\n                  onClick={() => setQuantity(quantity + 1)}\r\n                  className=\"w-8 h-8 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold transition-colors duration-200 flex items-center justify-center\"\r\n                >\r\n                  +\r\n                </button>\r\n              </div>\r\n              <Button\r\n                label=\"Add to Cart\"\r\n                onClick={handleAddToCart}\r\n                variant=\"primary\"\r\n                size=\"sm\"\r\n                microinteraction\r\n                icon={\r\n                  <svg\r\n                    className=\"w-3 h-3\"\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    viewBox=\"0 0 24 24\"\r\n                  >\r\n                    <path\r\n                      strokeLinecap=\"round\"\r\n                      strokeLinejoin=\"round\"\r\n                      strokeWidth={2}\r\n                      d=\"M12 4v16m8-8H4\"\r\n                    />\r\n                  </svg>\r\n                }\r\n                iconPosition=\"left\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    );\r\n  }\r\n);\r\n","import React, { useState, useEffect } from \"react\";\r\nimport Card from \"../../common/Card\";\r\nimport Button from \"../../common/Button\";\r\n\r\n/**\r\n * Cart Table Card Component\r\n * Displays cart items in a table format with totals\r\n */\r\nfunction CartTableCard({\r\n  cart,\r\n  handleRemove,\r\n  handleEditQuantity,\r\n  subtotal,\r\n  total,\r\n  appliedDiscount,\r\n  selectedIdx,\r\n  onSelectRow,\r\n  className = \"\",\r\n  ...props\r\n}) {\r\n  const [editingIdx, setEditingIdx] = useState(null);\r\n  const [editQty, setEditQty] = useState(1);\r\n\r\n  // Keyboard shortcuts: F1 for edit, F2 for remove\r\n  useEffect(() => {\r\n    const handleKeyDown = (event) => {\r\n      if (event.key === \"F1\" && cart.length > 0) {\r\n        event.preventDefault();\r\n        const firstItemIdx = 0;\r\n        setEditingIdx(firstItemIdx);\r\n        setEditQty(cart[firstItemIdx].quantity);\r\n      } else if (event.key === \"F2\" && cart.length > 0) {\r\n        event.preventDefault();\r\n        const firstItemIdx = 0;\r\n        handleRemove(firstItemIdx);\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"keydown\", handleKeyDown);\r\n    return () => {\r\n      document.removeEventListener(\"keydown\", handleKeyDown);\r\n    };\r\n  }, [cart, handleRemove]);\r\n\r\n  const EditIcon = () => (\r\n    <svg\r\n      width=\"16\"\r\n      height=\"16\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path d=\"M15.232 5.232l3.536 3.536M9 13l6.586-6.586a2 2 0 1 1 2.828 2.828L11.828 15.828a4 4 0 0 1-1.414.828l-4.243 1.414 1.414-4.243a4 4 0 0 1 .828-1.414z\" />\r\n    </svg>\r\n  );\r\n\r\n  const DeleteIcon = () => (\r\n    <svg\r\n      width=\"16\"\r\n      height=\"16\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      strokeWidth=\"2\"\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path d=\"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\" />\r\n    </svg>\r\n  );\r\n\r\n  return (\r\n    <Card\r\n      className={`flex-1 flex flex-col bg-white/80 backdrop-blur-md border border-white/60 shadow-xl transition-all duration-300 h-full min-h-0 overflow-hidden ${className}`}\r\n      variant=\"glass\"\r\n      {...props}\r\n    >\r\n      <div className=\"flex-1 min-h-0 flex flex-col p-2 sm:p-3\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between mb-2 pb-2 border-b border-gray-200\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <div className=\"w-7 h-7 bg-blue-100 rounded-lg flex items-center justify-center\">\r\n              <svg\r\n                className=\"w-4 h-4 text-blue-600\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <h3 className=\"text-sm sm:text-base font-bold text-gray-900\">\r\n              Shopping Cart\r\n            </h3>\r\n          </div>\r\n          <span className=\"text-xs font-semibold text-gray-600 bg-gray-100 px-2 py-0.5 rounded-full\">\r\n            {cart.length} {cart.length === 1 ? \"item\" : \"items\"}\r\n          </span>\r\n        </div>\r\n\r\n        {/* Table Container */}\r\n        <div className=\"flex-1 overflow-auto min-h-0 rounded-lg\">\r\n          <table className=\"w-full\">\r\n            <thead className=\"sticky top-0 z-10 bg-gradient-to-r from-blue-50/90 to-indigo-50/90 backdrop-blur-sm border-b border-blue-100\">\r\n              <tr>\r\n                <th className=\"py-1.5 px-2 text-left text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider\">\r\n                  Product\r\n                </th>\r\n                <th className=\"py-1.5 px-2 text-center text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider\">\r\n                  Qty\r\n                </th>\r\n                <th className=\"py-1.5 px-2 text-right text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider\">\r\n                  Price\r\n                </th>\r\n                <th className=\"py-1.5 px-2 text-right text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider\">\r\n                  Total\r\n                </th>\r\n                <th className=\"py-1.5 px-2 text-center text-[10px] sm:text-xs font-bold text-gray-700 uppercase tracking-wider\">\r\n                  Actions\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"divide-y divide-gray-100\">\r\n              {cart.length === 0 ? (\r\n                <tr>\r\n                  <td colSpan={5} className=\"text-center py-8\">\r\n                    <div className=\"flex flex-col items-center justify-center\">\r\n                      <div className=\"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-2\">\r\n                        <svg\r\n                          className=\"w-6 h-6 text-gray-400\"\r\n                          fill=\"none\"\r\n                          stroke=\"currentColor\"\r\n                          viewBox=\"0 0 24 24\"\r\n                        >\r\n                          <path\r\n                            strokeLinecap=\"round\"\r\n                            strokeLinejoin=\"round\"\r\n                            strokeWidth={2}\r\n                            d=\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\"\r\n                          />\r\n                        </svg>\r\n                      </div>\r\n                      <p className=\"text-gray-500 text-sm font-semibold\">\r\n                        Cart is empty\r\n                      </p>\r\n                      <p className=\"text-gray-400 text-xs mt-1\">\r\n                        Scan or enter products\r\n                      </p>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ) : (\r\n                cart.map((item, idx) => (\r\n                  <tr\r\n                    key={idx}\r\n                    className={`hover:bg-blue-50/50 transition-colors duration-200 group ${\r\n                      selectedIdx === idx ? \"ring-2 ring-blue-300 bg-blue-50/40\" : \"\"\r\n                    }`}\r\n                    onClick={() => onSelectRow?.(idx)}\r\n                  >\r\n                    <td className=\"py-1.5 px-2\">\r\n                      <div className=\"flex flex-col\">\r\n                        <span className=\"text-xs sm:text-sm font-semibold text-gray-900 group-hover:text-blue-600 transition-colors truncate\">\r\n                          {item.name}\r\n                        </span>\r\n                        <span className=\"text-[10px] text-gray-500 truncate\">\r\n                          SKU: {item.sku || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"py-1.5 px-2 text-center\">\r\n                      {editingIdx === idx ? (\r\n                        <input\r\n                          type=\"number\"\r\n                          min=\"1\"\r\n                          value={editQty}\r\n                          onChange={(e) =>\r\n                            setEditQty(\r\n                              Math.max(1, parseInt(e.target.value) || 1)\r\n                            )\r\n                          }\r\n                          onKeyDown={(e) => {\r\n                            if (e.key === \"Enter\") {\r\n                              handleEditQuantity(idx, editQty);\r\n                              setEditingIdx(null);\r\n                            } else if (e.key === \"Escape\") {\r\n                              setEditingIdx(null);\r\n                            }\r\n                          }}\r\n                          onBlur={() => {\r\n                            handleEditQuantity(idx, editQty);\r\n                            setEditingIdx(null);\r\n                          }}\r\n                          className=\"w-12 h-7 text-center text-xs font-bold border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                          autoFocus\r\n                        />\r\n                      ) : (\r\n                        <span className=\"inline-flex items-center justify-center w-7 h-7 rounded-md bg-blue-100 text-blue-700 font-bold text-xs\">\r\n                          {item.quantity}\r\n                        </span>\r\n                      )}\r\n                    </td>\r\n                    <td className=\"py-1.5 px-2 text-right\">\r\n                      <span className=\"text-xs sm:text-sm font-medium text-gray-700\">\r\n                        ₱{item.price.toFixed(2)}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"py-1.5 px-2 text-right\">\r\n                      <span className=\"text-xs sm:text-sm font-bold text-blue-600\">\r\n                        ₱\r\n                        {(\r\n                          item.price *\r\n                          (editingIdx === idx ? editQty : item.quantity)\r\n                        ).toFixed(2)}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"py-1.5 px-2\">\r\n                      <div className=\"flex items-center justify-center gap-1\">\r\n                        <button\r\n                          onClick={() => {\r\n                            setEditingIdx(idx);\r\n                            setEditQty(item.quantity);\r\n                          }}\r\n                          className=\"p-1.5 rounded-md bg-blue-50 text-blue-600 hover:bg-blue-100 border border-blue-200 transition-all duration-200\"\r\n                          title=\"Edit (F1)\"\r\n                        >\r\n                          <EditIcon />\r\n                        </button>\r\n                        <button\r\n                          onClick={() => handleRemove(idx)}\r\n                          className=\"p-1.5 rounded-md bg-red-50 text-red-600 hover:bg-red-100 border border-red-200 transition-all duration-200\"\r\n                          title=\"Remove (F2)\"\r\n                        >\r\n                          <DeleteIcon />\r\n                        </button>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        <div className=\"mt-2 pt-2 border-t border-gray-200 space-y-1\">\r\n          <div className=\"flex justify-between items-center text-sm text-gray-700\">\r\n            <span className=\"font-semibold\">Subtotal</span>\r\n            <span className=\"font-bold\">\r\n              ₱{Number(subtotal).toFixed(2)}\r\n            </span>\r\n          </div>\r\n          {appliedDiscount && (\r\n            <div className=\"flex justify-between items-center text-xs text-emerald-700\">\r\n              <span className=\"font-semibold\">\r\n                Discount ({appliedDiscount.label})\r\n              </span>\r\n              <span>\r\n                {appliedDiscount.type === \"percentage\"\r\n                  ? `-${appliedDiscount.value}%`\r\n                  : `-₱${Number(appliedDiscount.value).toFixed(2)}`}\r\n              </span>\r\n            </div>\r\n          )}\r\n          <div className=\"flex justify-between items-center\">\r\n            <span className=\"text-sm sm:text-base font-semibold text-gray-700\">\r\n              Total:\r\n            </span>\r\n            <span className=\"text-lg sm:text-xl font-extrabold text-blue-600\">\r\n              ₱{Number(total).toFixed(2)}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default CartTableCard;\r\n","import React, { useState } from \"react\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport Button from \"../common/Button\";\r\nimport { api } from \"../../lib/api\";\r\nimport ScannerCard from \"../ui/POS/ScannerCard\";\r\n\r\nfunction PriceCheckModal({ isOpen, onClose, sku, setSku }) {\r\n  const [product, setProduct] = useState(null);\r\n\r\n  const handleCheck = async () => {\r\n    if (!sku) return;\r\n    try {\r\n      const businessId = localStorage.getItem(\"business_id\");\r\n      const query = businessId\r\n        ? `?business_id=${encodeURIComponent(businessId)}`\r\n        : \"\";\r\n      const res = await api(\r\n        `/api/products/public/sku/${encodeURIComponent(sku)}${query}`\r\n      );\r\n      if (res) {\r\n        setProduct({\r\n          name: res.product_name,\r\n          price: Number(res.selling_price || 0),\r\n          sku: res.sku,\r\n        });\r\n      } else {\r\n        setProduct(null);\r\n      }\r\n    } catch (_) {\r\n      setProduct(null);\r\n    }\r\n  };\r\n\r\n  // Auto-fetch on SKU change\r\n  React.useEffect(() => {\r\n    if (!sku) {\r\n      setProduct(null);\r\n      return;\r\n    }\r\n    const t = setTimeout(() => {\r\n      handleCheck();\r\n    }, 200);\r\n    return () => clearTimeout(t);\r\n  }, [sku]);\r\n\r\n  const footerContent = (\r\n    <Button\r\n      label=\"Close\"\r\n      variant=\"secondary\"\r\n      onClick={onClose}\r\n      className=\"w-full\"\r\n    />\r\n  );\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Price Check\"\r\n      subtitle=\"Scan or enter SKU/barcode\"\r\n      icon={\r\n        <svg\r\n          className=\"w-5 h-5 text-white\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n          />\r\n        </svg>\r\n      }\r\n      footer={footerContent}\r\n      size=\"md\"\r\n      contentClassName=\"space-y-4\"\r\n    >\r\n      {/* Scanner */}\r\n      <div className=\"w-full\">\r\n        <ScannerCard\r\n          onScan={(result) => {\r\n            const code = result?.[0]?.rawValue;\r\n            if (code) {\r\n              setSku(code);\r\n            }\r\n          }}\r\n          paused={false}\r\n          onResume={() => {}}\r\n          className=\"w-full\"\r\n          textMain=\"text-blue-700\"\r\n        />\r\n      </div>\r\n\r\n      {/* Manual Input */}\r\n      <div className=\"w-full\">\r\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n          Enter SKU or Barcode\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          value={sku}\r\n          onChange={(e) => setSku(e.target.value)}\r\n          className=\"w-full border border-gray-300 rounded-lg px-4 py-2 text-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n          placeholder=\"Enter SKU or scan barcode\"\r\n        />\r\n      </div>\r\n\r\n      {/* Results */}\r\n      {product ? (\r\n        <div className=\"w-full bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200/50\">\r\n          <div className=\"text-lg font-semibold text-blue-900 mb-1\">\r\n            {product.name}\r\n          </div>\r\n          <div className=\"text-3xl font-bold text-blue-600 mb-2\">\r\n            ₱{product.price.toFixed(2)}\r\n          </div>\r\n          <div className=\"text-xs text-gray-500\">SKU: {product.sku}</div>\r\n        </div>\r\n      ) : sku ? (\r\n        <div className=\"text-red-500 text-sm text-center py-4\">\r\n          No product found.\r\n        </div>\r\n      ) : null}\r\n    </BaseModal>\r\n  );\r\n}\r\n\r\nexport default PriceCheckModal;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport Button from \"../common/Button\";\r\nimport { api } from \"../../lib/api\";\r\n\r\nfunction DiscountModal({ isOpen, onClose, onApplyDiscount }) {\r\n  const [showSettings, setShowSettings] = useState(false);\r\n  const [discounts, setDiscounts] = useState([]);\r\n\r\n  const [newDesc, setNewDesc] = useState(\"\");\r\n  const [newValue, setNewValue] = useState(\"\");\r\n  const [selectedIdx, setSelectedIdx] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const [saving, setSaving] = useState(false);\r\n  const [settingsTab, setSettingsTab] = useState(\"PERCENTAGE\");\r\n\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n    const fetchDiscounts = async () => {\r\n      setLoading(true);\r\n      setError(\"\");\r\n      try {\r\n        const token = sessionStorage.getItem(\"auth_token\");\r\n        const data = await api(\"/api/discounts\", {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        const discountList = (data || []).map(d => ({\r\n          label: d.discount_name || `${d.discount_percentage}% off`,\r\n          value: d.discount_percentage,\r\n          discount_id: d.discount_id,\r\n          type: \"percentage\"\r\n        }));\r\n        \r\n        setDiscounts(discountList);\r\n      } catch (e) {\r\n        setError(\"Failed to load discounts\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchDiscounts();\r\n  }, [isOpen]);\r\n\r\n  const handleAddDiscount = async () => {\r\n    if (!newDesc || !newValue) return;\r\n    setSaving(true);\r\n    try {\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n      const payload = { \r\n        discount_name: newDesc, \r\n        discount_percentage: Number(newValue) \r\n      };\r\n      \r\n      const created = await api(\"/api/discounts\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n      \r\n      setDiscounts(prev => [\r\n        ...prev,\r\n        {\r\n          label: created.discount_name || newDesc,\r\n          value: created.discount_percentage,\r\n          discount_id: created.discount_id,\r\n          type: \"percentage\"\r\n        }\r\n      ]);\r\n      \r\n      setNewDesc(\"\");\r\n      setNewValue(\"\");\r\n    } catch (e) {\r\n      console.error(\"Failed to add discount:\", e);\r\n      setError(\"Failed to add discount. Please try again.\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleRemove = async (discountId) => {\r\n    if (!discountId) return;\r\n    \r\n    try {\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n      await api(`/api/discounts/${discountId}`, {\r\n        method: \"DELETE\",\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      \r\n      setDiscounts(prev => prev.filter(d => d.discount_id !== discountId));\r\n      setSelectedIdx(null); // Reset selected index if the deleted discount was selected\r\n    } catch (e) {\r\n      console.error(\"Failed to remove discount:\", e);\r\n      setError(\"Failed to remove discount. Please try again.\");\r\n    }\r\n  };\r\n\r\n  const handleSaveSettings = () => {\r\n    setShowSettings(false);\r\n  };\r\n\r\n  const handleApplyDiscount = () => {\r\n    if (selectedIdx == null) return;\r\n    const discount = discounts[selectedIdx];\r\n    if (!discount) return;\r\n    onApplyDiscount({\r\n      type: discount.type,\r\n      value: discount.value,\r\n      label: discount.label,\r\n      discount_id: discount.discount_id,\r\n    });\r\n    onClose();\r\n  };\r\n\r\n  // Settings Footer\r\n  const settingsFooterContent = (\r\n    <Button\r\n      label=\"Save Settings\"\r\n      variant=\"primary\"\r\n      onClick={handleSaveSettings}\r\n      className=\"w-full\"\r\n    />\r\n  );\r\n\r\n  // Main Footer\r\n  const mainFooterContent = (\r\n    <div className=\"w-full space-y-2\">\r\n      <Button\r\n        label=\"Apply Discount\"\r\n        variant=\"primary\"\r\n        onClick={handleApplyDiscount}\r\n        disabled={selectedIdx === null}\r\n        className=\"w-full\"\r\n      />\r\n      <Button\r\n        label=\"Manage Discounts\"\r\n        variant=\"secondary\"\r\n        onClick={() => setShowSettings(true)}\r\n        className=\"w-full\"\r\n      />\r\n    </div>\r\n  );\r\n\r\n  // Main Discount Modal\r\n  const renderMain = () => {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h3 className=\"text-lg font-medium\">Select Discount</h3>\r\n        </div>\r\n        <div className=\"grid grid-cols-3 gap-2 mb-4 max-h-64 overflow-y-auto\">\r\n          {discounts.map((d, idx) => (\r\n            <button\r\n              key={`${d.type}-${idx}`}\r\n              className={`p-3 border rounded text-center ${\r\n                selectedIdx === idx\r\n                  ? \"border-blue-500 bg-blue-50\"\r\n                  : \"border-gray-200 hover:bg-gray-50\"\r\n              }`}\r\n              onClick={() => setSelectedIdx(idx)}\r\n            >\r\n              <div className=\"font-medium\">{d.label}</div>\r\n              <div className=\"text-sm text-gray-500\">{d.value}%</div>\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Settings Modal Content\r\n  const renderSettings = () => (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"flex gap-2\">\r\n        <button\r\n          className={`flex-1 px-4 py-2 rounded-lg font-semibold text-sm transition-all ${\r\n            settingsTab === \"PERCENTAGE\" ? \"bg-blue-600 text-white\" : \"bg-gray-200 text-gray-700\"\r\n          }`}\r\n          onClick={() => setSettingsTab(\"PERCENTAGE\")}\r\n        >\r\n          Percentage\r\n        </button>\r\n      </div>\r\n\r\n      {/* Discount List */}\r\n      <div className=\"space-y-2 max-h-60 overflow-y-auto\">\r\n        {discounts.map((d, idx) => (\r\n          <div\r\n            key={idx}\r\n            className=\"flex gap-2 items-center bg-gray-50 p-3 rounded-lg\"\r\n          >\r\n            <input\r\n              className=\"flex-1 bg-transparent outline-none text-sm font-medium\"\r\n              value={d.label}\r\n              readOnly\r\n            />\r\n            <input\r\n              className=\"w-20 bg-transparent text-center outline-none text-sm font-medium\"\r\n              value={d.value}\r\n              readOnly\r\n            />\r\n            <button\r\n              className=\"text-red-500 hover:text-red-700 transition-colors p-1\"\r\n              onClick={() => handleRemove(idx)}\r\n              title=\"Remove\"\r\n              type=\"button\"\r\n            >\r\n              <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                className=\"w-5 h-5\"\r\n                fill=\"none\"\r\n                viewBox=\"0 0 24 24\"\r\n                stroke=\"currentColor\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M6 18L18 6M6 6l12 12\"\r\n                />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Add new discount */}\r\n      <div className=\"space-y-2 p-4 bg-blue-50 rounded-lg border border-blue-200\">\r\n        <div className=\"text-sm font-semibold text-blue-900 mb-2\">\r\n          Add New Discount\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <input\r\n            className=\"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            placeholder=\"Description\"\r\n            value={newDesc}\r\n            onChange={(e) => setNewDesc(e.target.value)}\r\n          />\r\n          <input\r\n            className=\"w-24 border border-gray-300 rounded-lg px-3 py-2 text-sm text-center focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            placeholder={settingsTab === \"PERCENTAGE\" ? \"0%\" : \"0.00\"}\r\n            inputMode={settingsTab === \"PERCENTAGE\" ? \"numeric\" : \"decimal\"}\r\n            value={newValue}\r\n            onChange={(e) => setNewValue(e.target.value)}\r\n            type=\"number\"\r\n            min=\"0\"\r\n          />\r\n          <button\r\n            className=\"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-bold\"\r\n            onClick={handleAddDiscount}\r\n            title=\"Add\"\r\n            type=\"button\"\r\n            disabled={saving}\r\n          >\r\n            {saving ? \"...\" : \"+\"}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title={showSettings ? \"Manage Discounts\" : \"Select Discount\"}\r\n      subtitle={\r\n        showSettings\r\n          ? \"Add or remove discount options\"\r\n          : \"Choose a discount to apply\"\r\n      }\r\n      icon={\r\n        <svg\r\n          className=\"w-5 h-5 text-white\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z\"\r\n          />\r\n        </svg>\r\n      }\r\n      footer={showSettings ? settingsFooterContent : mainFooterContent}\r\n      size=\"md\"\r\n      contentClassName=\"space-y-4\"\r\n    >\r\n      {error && (\r\n        <div className=\"text-sm text-red-700 bg-red-50 border border-red-200 rounded-lg px-3 py-2\">\r\n          {error}\r\n        </div>\r\n      )}\r\n      {showSettings ? renderSettings() : renderMain()}\r\n    </BaseModal>\r\n  );\r\n}\r\n\r\nexport default DiscountModal;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport Button from \"../common/Button\";\r\nimport { api } from \"../../lib/api\";\r\nimport {\r\n  MdAccountBalanceWallet,\r\n  MdSwapHoriz,\r\n  MdDescription,\r\n  MdChevronRight,\r\n} from \"react-icons/md\";\r\n\r\nfunction CashLedgerModal({ isOpen, onClose }) {\r\n  // Tab state: \"SUMMARY\" or \"TRANSACTIONS\"\r\n  const [tab, setTab] = useState(\"SUMMARY\");\r\n  // Track which payment type is selected for filtered transactions view\r\n  const [selectedPaymentType, setSelectedPaymentType] = useState(null);\r\n\r\n  // Live data from backend\r\n  const [ledger, setLedger] = useState([]); // [{ name, balance }]\r\n  const [transactions, setTransactions] = useState([]);\r\n  const [loadingSummary, setLoadingSummary] = useState(false);\r\n  const [loadingTx, setLoadingTx] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n\r\n\r\n  // Fetch summary balances\r\n  const fetchLedger = async () => {\r\n    setLoadingSummary(true);\r\n    try {\r\n      setError(\"\");\r\n      const data = await api('/stats/cash-ledger');\r\n      // Expecting [{ name, balance }]\r\n      setLedger(Array.isArray(data) ? data : []);\r\n    } catch (err) {\r\n      setError(err.message || 'Failed to load cash ledger');\r\n    } finally {\r\n      setLoadingSummary(false);\r\n    }\r\n  };\r\n\r\n  // Fetch transactions (optionally filtered)\r\n  const fetchTransactions = async (paymentType = null) => {\r\n    setLoadingTx(true);\r\n    try {\r\n      setError(\"\");\r\n      const q = paymentType ? `/stats/cash-transactions?payment_type=${encodeURIComponent(paymentType)}&limit=100` : `/stats/cash-transactions?limit=100`;\r\n      const data = await api(q);\r\n      setTransactions(Array.isArray(data) ? data : []);\r\n    } catch (err) {\r\n      setError(err.message || 'Failed to load transactions');\r\n    } finally {\r\n      setLoadingTx(false);\r\n    }\r\n  };\r\n\r\n  // Load when modal opens\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n    fetchLedger();\r\n    fetchTransactions();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [isOpen]);\r\n\r\n  // Summary Page Component\r\n  const renderSummary = () => {\r\n    const totalCash = ledger.reduce((sum, type) => sum + (Number(type.balance) || 0), 0);\r\n\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        {/* Total Cash Display */}\r\n        <div className=\"bg-gradient-to-br from-blue-500 via-blue-600 to-indigo-700 text-white rounded-lg shadow-xl px-8 py-8 text-center\">\r\n          <p className=\"text-sm font-semibold text-blue-100 mb-2\">Total Cash on Hand</p>\r\n          <div className=\"text-5xl font-bold flex items-center justify-center gap-2\">\r\n            <span className=\"text-4xl\">₱</span>\r\n            {totalCash.toFixed(2)}\r\n          </div>\r\n          <p className=\"text-blue-100 text-sm mt-3\">\r\n            {new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}\r\n          </p>\r\n        </div>\r\n\r\n        {/* Payment Types Section */}\r\n        <div>\r\n          <div className=\"flex items-center gap-2 mb-4\">\r\n            <div className=\"w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center\">\r\n              <MdAccountBalanceWallet className=\"w-5 h-5 text-white\" />\r\n            </div>\r\n            <h3 className=\"font-semibold text-gray-900\">Payment Methods</h3>\r\n          </div>\r\n          <div className=\"space-y-3\">\r\n            {loadingSummary ? (\r\n              <div className=\"text-sm text-gray-500\">Loading...</div>\r\n            ) : ledger.length === 0 ? (\r\n              <div className=\"text-sm text-gray-500\">No balances available</div>\r\n            ) : (\r\n              ledger.map((type) => (\r\n                <button\r\n                  key={type.name}\r\n                  onClick={async () => {\r\n                    setSelectedPaymentType(type.name);\r\n                    setTab('TRANSACTIONS');\r\n                    await fetchTransactions(type.name);\r\n                  }}\r\n                  className=\"w-full bg-gradient-to-r from-gray-50 to-gray-100/50 hover:from-blue-50 hover:to-indigo-50/50 rounded-2xl p-4 border border-gray-200/50 hover:border-blue-300 transition-all duration-200 group\"\r\n                >\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-3 flex-1\">\r\n                      <div className=\"w-10 h-10 bg-white rounded-lg flex items-center justify-center border border-gray-200 group-hover:border-blue-300 group-hover:bg-blue-50 transition-all\">\r\n                        <svg className=\"w-5 h-5 text-gray-600 group-hover:text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                        </svg>\r\n                      </div>\r\n                      <div className=\"text-left\">\r\n                        <p className=\"font-semibold text-gray-900\">{type.name}</p>\r\n                        <p className=\"text-xs text-gray-500\">View transactions</p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className=\"text-right\">\r\n                        <p className=\"text-lg font-bold text-blue-600\">₱{(Number(type.balance) || 0).toFixed(2)}</p>\r\n                      </div>\r\n                      <MdChevronRight className=\"w-5 h-5 text-gray-400 group-hover:text-blue-600 transition-colors\" />\r\n                    </div>\r\n                  </div>\r\n                </button>\r\n              ))\r\n            )}\r\n          </div>\r\n        </div>\r\n        {error && (\r\n          <div className=\"text-sm text-red-600\">\r\n            {error.includes('Server returned an HTML error page') || error.includes('Cannot GET')\r\n              ? 'Unable to reach backend API. Check backend server and proxy configuration.'\r\n              : error}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Transactions Page\r\n  const renderTransactions = () => {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        {/* Transactions Title */}\r\n        <div className=\"bg-gradient-to-r from-indigo-50 to-blue-50 rounded-2xl p-4 border border-indigo-100/50\">\r\n          <h3 className=\"font-bold text-lg text-gray-900\">{selectedPaymentType ? `${selectedPaymentType} Transactions` : 'All Transactions'}</h3>\r\n          <p className=\"text-sm text-gray-600 mt-1\">{loadingTx ? 'Loading...' : `${transactions.length} transaction${transactions.length !== 1 ? 's' : ''} found`}</p>\r\n        </div>\r\n\r\n        {/* Transactions Table */}\r\n        <div className=\"bg-white rounded-2xl border border-gray-200/50 overflow-hidden\">\r\n          {loadingTx ? (\r\n            <div className=\"text-center py-12 text-sm text-gray-500\">Loading transactions...</div>\r\n          ) : transactions.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <svg className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\r\n              </svg>\r\n              <p className=\"text-gray-500 font-medium\">No transactions found</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full\">\r\n                <thead>\r\n                  <tr className=\"bg-gradient-to-r from-gray-50 to-gray-100 border-b border-gray-200/50\">\r\n                    <th className=\"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider\">Date & Time</th>\r\n                    <th className=\"px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider\">Type</th>\r\n                    <th className=\"px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider\">Amount</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"divide-y divide-gray-100\">\r\n                  {transactions.map((tx) => (\r\n                    <tr key={String(tx.transaction_id)} className=\"hover:bg-blue-50/50 transition-colors duration-150\">\r\n                      <td className=\"px-6 py-4 text-sm text-gray-600 font-medium\">{new Date(tx.created_at).toLocaleString()}</td>\r\n                      <td className=\"px-6 py-4 text-sm\"><span className=\"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-800 border border-blue-200\">{tx.payment_type}</span></td>\r\n                      <td className=\"px-6 py-4 text-sm text-right font-bold text-green-600\">₱{(Number(tx.total) || 0).toFixed(2)}</td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Tab button content\r\n  const tabContent = (\r\n    <div className=\"flex gap-2 border-t border-gray-200/50 pt-4 mt-4\">\r\n      <button\r\n        onClick={() => {\r\n          setTab(\"SUMMARY\");\r\n          setSelectedPaymentType(null);\r\n        }}\r\n        className={`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl font-semibold transition-all ${\r\n          tab === \"SUMMARY\"\r\n            ? \"bg-blue-600 text-white shadow-md\"\r\n            : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\r\n        }`}\r\n      >\r\n        <MdDescription className=\"w-5 h-5\" />\r\n        <span>Summary</span>\r\n      </button>\r\n      <button\r\n        onClick={() => {\r\n          setTab(\"TRANSACTIONS\");\r\n          setSelectedPaymentType(null);\r\n        }}\r\n        className={`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl font-semibold transition-all ${\r\n          tab === \"TRANSACTIONS\"\r\n            ? \"bg-blue-600 text-white shadow-md\"\r\n            : \"bg-gray-100 text-gray-700 hover:bg-gray-200\"\r\n        }`}\r\n      >\r\n        <MdSwapHoriz className=\"w-5 h-5\" />\r\n        <span>Transactions</span>\r\n      </button>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Cash Ledger\"\r\n      subtitle=\"View cash balance and payment methods\"\r\n      icon={<MdAccountBalanceWallet className=\"w-6 h-6 text-white\" />}\r\n      size=\"lg\"\r\n      contentClassName=\"space-y-4\"\r\n    >\r\n      <div className=\"space-y-6\">\r\n        {tab === \"SUMMARY\" ? renderSummary() : renderTransactions()}\r\n        {tabContent}\r\n      </div>\r\n    </BaseModal>\r\n  );\r\n}\r\n\r\nexport default CashLedgerModal;\r\n","import React from \"react\";\r\nimport Button from \"../common/Button\";\r\nimport BaseModal from \"./BaseModal\";\r\n\r\nfunction CheckoutModal({ isOpen, onClose, total, onSelectPayment }) {\r\n  const footerContent = (\r\n    <div className=\"w-full flex flex-col gap-3\">\r\n      <Button\r\n        label=\"CASH\"\r\n        className=\"w-full h-12 text-base font-bold\"\r\n        onClick={() => onSelectPayment(\"cash\")}\r\n      />\r\n      <Button\r\n        label=\"GCASH\"\r\n        className=\"w-full h-12 text-base font-bold\"\r\n        onClick={() => onSelectPayment(\"gcash\")}\r\n      />\r\n      <Button\r\n        label=\"MAYA\"\r\n        className=\"w-full h-12 text-base font-bold\"\r\n        onClick={() => onSelectPayment(\"maya\")}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Checkout\"\r\n      subtitle=\"Select payment method\"\r\n      icon={\r\n        <svg\r\n          className=\"w-5 h-5 text-white\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\"\r\n          />\r\n        </svg>\r\n      }\r\n      footer={footerContent}\r\n      size=\"sm\"\r\n      contentClassName=\"text-center\"\r\n    >\r\n      <div className=\"bg-blue-500 text-white rounded-2xl py-6 px-4 text-center mb-4\">\r\n        <div className=\"text-sm opacity-90 mb-2\">Total Amount</div>\r\n        <div className=\"text-4xl font-bold\">₱{total.toFixed(2)}</div>\r\n      </div>\r\n      <p className=\"text-gray-600 text-sm mb-4\">\r\n        Choose your preferred payment method\r\n      </p>\r\n    </BaseModal>\r\n  );\r\n}\r\n\r\nexport default CheckoutModal;\r\n","import React from \"react\";\r\nimport Button from \"../common/Button\";\r\nimport BaseModal from \"./BaseModal\";\r\n\r\nfunction CashPaymentCompleteModal({\r\n  isOpen,\r\n  onClose,\r\n  change = 0,\r\n  payable = 0,\r\n  onReceipt,\r\n  onNewEntry,\r\n}) {\r\n  const footerContent = (\r\n    <div className=\"w-full flex flex-col gap-3\">\r\n      <Button\r\n        label=\"RECEIPT\"\r\n        className=\"w-full h-11 text-sm font-semibold bg-blue-700 hover:bg-blue-800 text-white\"\r\n        onClick={() => {\r\n          if (onReceipt) onReceipt();\r\n          else alert(\"Receipt\");\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Payment Complete\"\r\n      icon={\r\n        <svg\r\n          className=\"w-5 h-5 text-white\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M5 13l4 4L19 7\"\r\n          />\r\n        </svg>\r\n      }\r\n      footer={footerContent}\r\n      size=\"sm\"\r\n      contentClassName=\"text-center space-y-4\"\r\n    >\r\n      {/* Success Check Icon */}\r\n      <div className=\"flex justify-center mb-2\">\r\n        <div className=\"w-14 h-14 rounded-full bg-green-100 flex items-center justify-center\">\r\n          <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            className=\"h-7 w-7 text-green-600\"\r\n            fill=\"none\"\r\n            viewBox=\"0 0 24 24\"\r\n            stroke=\"currentColor\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M5 13l4 4L19 7\"\r\n            />\r\n          </svg>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Change Amount */}\r\n      <div className=\"bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl p-5 text-white\">\r\n        <div className=\"text-xs uppercase tracking-wide opacity-90 mb-2\">\r\n          Change\r\n        </div>\r\n\r\n        <div className=\"inline-flex items-baseline gap-2 bg-white text-blue-700 rounded-lg px-4 py-3 shadow-md\">\r\n          <span className=\"text-lg font-bold\">₱</span>\r\n          <span className=\"text-2xl font-bold\">\r\n            {Number(change).toFixed(2)}\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"mt-4 text-sm opacity-90\">Payable</div>\r\n        <div className=\"text-sm font-semibold\">\r\n          ₱{Number(payable).toFixed(2)}\r\n        </div>\r\n      </div>\r\n    </BaseModal>\r\n  );\r\n}\r\n\r\nexport default CashPaymentCompleteModal;\r\n","import React, { useState } from \"react\";\r\nimport Button from \"../common/Button\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport CashPaymentCompleteModal from \"./CashPaymentCompleteModal\";\r\n\r\nfunction CashPaymentModal({ isOpen, onClose, total, onConfirm }) {\r\n  const [amountReceived, setAmountReceived] = useState(\"\");\r\n  const [showComplete, setShowComplete] = useState(false);\r\n  const [completeData, setCompleteData] = useState(null);\r\n\r\n  // Keep component mounted if completion modal should be shown even when parent closes isOpen\r\n  if (!isOpen && !showComplete) return null;\r\n\r\n  // When the payment is completed, replace this modal with the completion modal\r\n  if (showComplete) {\r\n    return (\r\n      <CashPaymentCompleteModal\r\n        isOpen={showComplete}\r\n        onClose={() => {\r\n          setShowComplete(false);\r\n          if (onClose) onClose();\r\n        }}\r\n        change={completeData?.change}\r\n        payable={completeData?.payable}\r\n        onNewEntry={() => {\r\n          setShowComplete(false);\r\n          if (onClose) onClose();\r\n        }}\r\n        onReceipt={() => {\r\n          // Call parent confirm (which performs checkout/navigation) when user\r\n          // explicitly requests the receipt. This prevents immediate navigation\r\n          // that would close the completion modal too soon.\r\n          if (onConfirm && completeData?.received != null) {\r\n            onConfirm(Number(completeData.received));\r\n          }\r\n        }}\r\n      />\r\n    );\r\n  }\r\n\r\n  const handleQuickAmount = (val) => setAmountReceived(val.toString());\r\n\r\n  const handleExactAmount = () => setAmountReceived(total.toString());\r\n\r\n  const handleProceed = () => {\r\n    if (!amountReceived || Number(amountReceived) < total) {\r\n      alert(\"Amount received must be greater than or equal to total.\");\r\n      return;\r\n    }\r\n    const received = Number(amountReceived);\r\n    // compute change and show completion modal; delay calling parent onConfirm\r\n    // so cashier can view the completion screen before the app navigates\r\n    const change = received - total;\r\n    setCompleteData({ change, payable: total, received });\r\n    setShowComplete(true);\r\n  };\r\n\r\n  const footerContent = (\r\n    <>\r\n      <Button\r\n        label=\"Cancel\"\r\n        variant=\"secondary\"\r\n        onClick={onClose}\r\n        type=\"button\"\r\n        className=\"flex-1\"\r\n      />\r\n      <Button\r\n        label=\"Proceed\"\r\n        variant=\"primary\"\r\n        type=\"button\"\r\n        onClick={handleProceed}\r\n        className=\"flex-1\"\r\n      />\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Cash Payment\"\r\n      subtitle=\"Enter amount received\"\r\n      icon={\r\n        <svg\r\n          className=\"w-5 h-5 text-white\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n          />\r\n        </svg>\r\n      }\r\n      footer={footerContent}\r\n      size=\"md\"\r\n      contentClassName=\"space-y-4\"\r\n    >\r\n      {/* Total Amount */}\r\n      <div className=\"bg-gradient-to-br from-blue-500 to-indigo-600 text-white rounded-2xl py-6 px-4 text-center\">\r\n        <div className=\"text-sm opacity-90 mb-2\">Total Amount</div>\r\n        <div className=\"text-4xl font-bold\">₱{total.toFixed(2)}</div>\r\n      </div>\r\n\r\n      {/* Input */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n          Amount Received\r\n        </label>\r\n        <input\r\n          type=\"number\"\r\n          className=\"w-full border border-gray-300 rounded-lg px-3 py-2 text-center text-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n          placeholder=\"₱0.00\"\r\n          value={amountReceived}\r\n          onChange={(e) => setAmountReceived(e.target.value)}\r\n        />\r\n      </div>\r\n\r\n      {/* Quick Select Buttons */}\r\n      <div>\r\n        <p className=\"text-xs text-gray-600 mb-2\">Quick amounts:</p>\r\n        <div className=\"grid grid-cols-3 gap-2\">\r\n          {[100, 200, 300, 400, 500, 600, 700, 800, 900].map((val) => (\r\n            <button\r\n              key={val}\r\n              className=\"bg-blue-100 hover:bg-blue-200 text-blue-700 font-bold py-2 rounded-lg transition-colors text-sm\"\r\n              onClick={() => handleQuickAmount(val)}\r\n            >\r\n              {val}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Exact Amount Button */}\r\n      <Button\r\n        label=\"Use Exact Amount\"\r\n        className=\"w-full h-10 text-sm font-bold bg-slate-600 hover:bg-slate-700 text-white\"\r\n        onClick={handleExactAmount}\r\n      />\r\n    </BaseModal>\r\n  );\r\n}\r\n\r\nexport default CashPaymentModal;\r\n","import React, { useState } from \"react\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport ScannerCard from \"../ui/POS/ScannerCard\";\r\nimport Button from \"../common/Button\";\r\nimport { api } from \"../../lib/api\";\r\n\r\nexport default function ScanCustomerCartModal({ isOpen, onClose, onImport }) {\r\n  const [scannerPaused, setScannerPaused] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const token = sessionStorage.getItem(\"auth_token\");\r\n\r\n  const user = JSON.parse(sessionStorage.getItem(\"user\") || \"{}\");\r\n\r\n  const handleScan = async (result) => {\r\n    const code = result?.[0]?.rawValue;\r\n    if (!code) return;\r\n    setScannerPaused(true);\r\n    setError(\"\");\r\n    try {\r\n      let payload;\r\n      try {\r\n        payload = JSON.parse(code);\r\n      } catch (e) {\r\n        throw new Error(\"Invalid QR payload\");\r\n      }\r\n      \r\n      // Check if this is a cart QR code with transaction ID\r\n      if (payload.t === 'cart' && payload.transaction_id) {\r\n        const { transaction_id, business_id: businessId } = payload;\r\n        \r\n        // Verify business ID matches if provided\r\n        const cashierBusinessId = user?.businessId || user?.business_id;\r\n        if (businessId && cashierBusinessId && Number(businessId) !== Number(cashierBusinessId)) {\r\n          throw new Error(\"This QR code is not valid for this store.\");\r\n        }\r\n\r\n        // Complete the existing transaction instead of creating a new one\r\n        try {\r\n          const response = await api(`/api/sales/${transaction_id}/complete`, {\r\n            method: 'POST',\r\n            headers: { Authorization: `Bearer ${token}` },\r\n          });\r\n          \r\n          if (response.transaction_id) {\r\n            // Transaction completed successfully - navigate to receipt\r\n            onClose();\r\n            // Navigate to receipt page for cashier\r\n            window.location.href = `/receipt?tn=${response.transaction_number}`;\r\n            return;\r\n          } else {\r\n            throw new Error(\"Failed to complete transaction\");\r\n          }\r\n        } catch (err) {\r\n          console.error('Error completing transaction:', err);\r\n          throw new Error(err.message || \"Failed to complete customer transaction\");\r\n        }\r\n      }\r\n      // Existing cart import logic for backward compatibility\r\n      else if (payload.t === 'cart' && Array.isArray(payload.items)) {\r\n        const { items: compactItems, b: businessId } = payload;\r\n        const cashierBusinessId = user?.businessId || user?.business_id;\r\n\r\n        if (businessId && cashierBusinessId && Number(businessId) !== Number(cashierBusinessId)) {\r\n          throw new Error(\"This QR code is not valid for this store.\");\r\n        }\r\n\r\n        const fullItems = [];\r\n        for (const it of compactItems) {\r\n          if (!it?.p || !it?.q) continue;\r\n          const product = await api(`/api/products/${encodeURIComponent(it.p)}`, {\r\n            headers: { Authorization: `Bearer ${token}` },\r\n          });\r\n          fullItems.push({\r\n            product_id: product.product_id,\r\n            sku: product.sku,\r\n            name: product.product_name,\r\n            quantity: Number(it.q),\r\n            price: Number(product.selling_price || 0)\r\n          });\r\n        }\r\n        if (fullItems.length === 0) throw new Error(\"No items to import\");\r\n        onImport(fullItems);\r\n        onClose();\r\n      } else {\r\n        throw new Error(\"Unsupported QR code format\");\r\n      }\r\n    } catch (e) {\r\n      setError(e.message || \"Failed to process QR code\");\r\n      console.error('Scan error:', e);\r\n    } finally {\r\n      setScannerPaused(false);\r\n    }\r\n  };\r\n\r\n  const footerContent = (\r\n    <Button\r\n      label=\"Close\"\r\n      variant=\"secondary\"\r\n      onClick={onClose}\r\n      className=\"w-full\"\r\n    />\r\n  );\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Scan Customer Cart\"\r\n      subtitle=\"Ask customer to show their QR\"\r\n      icon={\r\n        <svg\r\n          className=\"w-5 h-5 text-white\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n            strokeWidth={2}\r\n            d=\"M12 4v16m8-8H4\"\r\n          />\r\n        </svg>\r\n      }\r\n      footer={footerContent}\r\n      size=\"lg\"\r\n      contentClassName=\"space-y-3\"\r\n    >\r\n      <div className=\"text-blue-800 text-sm font-medium\">\r\n        Ask the customer to show their cart QR code\r\n      </div>\r\n      <div className=\"h-[50vh]\">\r\n        <ScannerCard\r\n          onScan={handleScan}\r\n          paused={scannerPaused}\r\n          onResume={() => setScannerPaused(false)}\r\n          className=\"w-full h-full\"\r\n        />\r\n      </div>\r\n      {error && (\r\n        <div className=\"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm\">\r\n          {error}\r\n        </div>\r\n      )}\r\n    </BaseModal>\r\n  );\r\n}\r\n"],"names":["SkuFormCard","React","forwardRef","sku","setSku","quantity","setQuantity","handleAddToCart","quantityInputRef","className","props","ref","jsx","Card","variant","children","jsxs","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","type","name","value","onChange","e","target","onKeyPress","key","trim","placeholder","onClick","Math","max","min","Number","Button","label","size","microinteraction","icon","iconPosition","CartTableCard","cart","handleRemove","handleEditQuantity","subtotal","total","appliedDiscount","selectedIdx","onSelectRow","editingIdx","setEditingIdx","useState","editQty","setEditQty","useEffect","handleKeyDown","event","length","preventDefault","firstItemIdx","addEventListener","removeEventListener","EditIcon","width","height","DeleteIcon","colSpan","map","item","idx","parseInt","onKeyDown","onBlur","autoFocus","price","toFixed","title","PriceCheckModal","isOpen","onClose","product","setProduct","t","setTimeout","async","businessId","localStorage","getItem","query","encodeURIComponent","res","api","product_name","selling_price","_","handleCheck","clearTimeout","footerContent","BaseModal","subtitle","footer","contentClassName","ScannerCard","onScan","result","code","rawValue","paused","onResume","textMain","DiscountModal","onApplyDiscount","showSettings","setShowSettings","discounts","setDiscounts","newDesc","setNewDesc","newValue","setNewValue","setSelectedIdx","loading","setLoading","error","setError","saving","setSaving","settingsTab","setSettingsTab","token","sessionStorage","discountList","headers","Authorization","discount_name","discount_percentage","discount_id","fetchDiscounts","handleAddDiscount","payload","created","method","body","JSON","stringify","prev","settingsFooterContent","handleSaveSettings","mainFooterContent","handleApplyDiscount","discount","disabled","readOnly","discountId","filter","xmlns","inputMode","CashLedgerModal","tab","setTab","selectedPaymentType","setSelectedPaymentType","ledger","setLedger","transactions","setTransactions","loadingSummary","setLoadingSummary","loadingTx","setLoadingTx","fetchTransactions","paymentType","q","data","Array","isArray","err","message","fetchLedger","tabContent","MdDescription","MdSwapHoriz","MdAccountBalanceWallet","renderSummary","totalCash","reduce","sum","balance","Date","toLocaleDateString","weekday","year","month","day","MdChevronRight","includes","tx","created_at","toLocaleString","payment_type","String","transaction_id","CheckoutModal","onSelectPayment","CashPaymentCompleteModal","change","payable","onReceipt","onNewEntry","CashPaymentModal","onConfirm","amountReceived","setAmountReceived","showComplete","setShowComplete","completeData","setCompleteData","received","Fragment","handleProceed","alert","val","toString","handleQuickAmount","handleExactAmount","ScanCustomerCartModal","onImport","scannerPaused","setScannerPaused","user","parse","Error","business_id","cashierBusinessId","response","window","location","href","transaction_number","items","compactItems","b","fullItems","it","p","push","product_id"],"mappings":"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"}