{"version":3,"file":"Profile-CkRvUkQA.js","sources":["../../../frontend/src/components/common/SelectDropdown.jsx","../../../frontend/src/components/modals/ProfileModal.jsx","../../../frontend/src/pages/Profile.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\r\nimport { BiChevronDown, BiChevronUp, BiSearch, BiCheck } from \"react-icons/bi\";\r\n\r\n/**\r\n * Modern SelectDropdown Component with enhanced UI/UX\r\n * Features:\r\n * - Custom styling with animations\r\n * - Search/filter functionality\r\n * - Keyboard navigation\r\n * - Error state handling\r\n * - Accessibility support\r\n */\r\nexport default function SelectDropdown({\r\n  name,\r\n  value,\r\n  options = [],\r\n  placeholder = \"Select an option\",\r\n  onChange,\r\n  error,\r\n  disabled = false,\r\n  searchable = true,\r\n  className = \"\",\r\n  required = false,\r\n}) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [highlightedIndex, setHighlightedIndex] = useState(-1);\r\n  const dropdownRef = useRef(null);\r\n  const inputRef = useRef(null);\r\n\r\n  // Filter options based on search term\r\n  const filteredOptions = options.filter((option) =>\r\n    option.label.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  // Handle click outside to close dropdown\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\r\n        setIsOpen(false);\r\n        setSearchTerm(\"\");\r\n        setHighlightedIndex(-1);\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n  }, []);\r\n\r\n  // Handle keyboard navigation\r\n  useEffect(() => {\r\n    const handleKeyDown = (event) => {\r\n      if (!isOpen) return;\r\n\r\n      switch (event.key) {\r\n        case \"ArrowDown\":\r\n          event.preventDefault();\r\n          setHighlightedIndex((prev) =>\r\n            prev < filteredOptions.length - 1 ? prev + 1 : 0\r\n          );\r\n          break;\r\n        case \"ArrowUp\":\r\n          event.preventDefault();\r\n          setHighlightedIndex((prev) =>\r\n            prev > 0 ? prev - 1 : filteredOptions.length - 1\r\n          );\r\n          break;\r\n        case \"Enter\":\r\n          event.preventDefault();\r\n          if (\r\n            highlightedIndex >= 0 &&\r\n            highlightedIndex < filteredOptions.length\r\n          ) {\r\n            handleSelect(filteredOptions[highlightedIndex]);\r\n          }\r\n          break;\r\n        case \"Escape\":\r\n          setIsOpen(false);\r\n          setSearchTerm(\"\");\r\n          setHighlightedIndex(-1);\r\n          break;\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"keydown\", handleKeyDown);\r\n    return () => document.removeEventListener(\"keydown\", handleKeyDown);\r\n  }, [isOpen, highlightedIndex, filteredOptions]);\r\n\r\n  const handleSelect = (option) => {\r\n    onChange({ target: { name, value: option.value } });\r\n    setIsOpen(false);\r\n    setSearchTerm(\"\");\r\n    setHighlightedIndex(-1);\r\n  };\r\n\r\n  const handleToggle = () => {\r\n    if (disabled) return;\r\n    setIsOpen(!isOpen);\r\n    if (!isOpen) {\r\n      setTimeout(() => inputRef.current?.focus(), 100);\r\n    } else {\r\n      setSearchTerm(\"\");\r\n      setHighlightedIndex(-1);\r\n    }\r\n  };\r\n\r\n  const selectedOption = options.find((option) => option.value === value);\r\n\r\n  return (\r\n    <div className={`relative ${className}`} ref={dropdownRef}>\r\n      {/* Trigger Button */}\r\n      <button\r\n        type=\"button\"\r\n        onClick={handleToggle}\r\n        disabled={disabled}\r\n        className={`\r\n          w-full px-4 py-3 text-left bg-white border rounded-lg shadow-sm transition-all duration-200\r\n          flex items-center justify-between\r\n          ${\r\n            error\r\n              ? \"border-red-300 focus:ring-red-500 focus:border-red-500\"\r\n              : \"border-gray-300 focus:ring-blue-500 focus:border-blue-500\"\r\n          }\r\n          ${\r\n            disabled\r\n              ? \"bg-gray-50 text-gray-400 cursor-not-allowed\"\r\n              : \"hover:border-gray-400 focus:ring-2 focus:outline-none\"\r\n          }\r\n          ${isOpen ? \"ring-2 ring-blue-500 border-blue-500\" : \"\"}\r\n        `}\r\n      >\r\n        <span\r\n          className={`truncate ${\r\n            selectedOption ? \"text-gray-900\" : \"text-gray-500\"\r\n          }`}\r\n        >\r\n          {selectedOption ? selectedOption.label : placeholder}\r\n        </span>\r\n        <div className=\"flex items-center gap-2\">\r\n          {selectedOption && (\r\n            <BiCheck className=\"w-4 h-4 text-blue-600 flex-shrink-0\" />\r\n          )}\r\n          {isOpen ? (\r\n            <BiChevronUp className=\"w-5 h-5 text-gray-400 flex-shrink-0\" />\r\n          ) : (\r\n            <BiChevronDown className=\"w-5 h-5 text-gray-400 flex-shrink-0\" />\r\n          )}\r\n        </div>\r\n      </button>\r\n\r\n      {/* Dropdown Menu */}\r\n      {isOpen && (\r\n        <div className=\"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg animate-in fade-in slide-in-from-top-2 duration-200\">\r\n          {/* Search Input */}\r\n          {searchable && options.length > 5 && (\r\n            <div className=\"p-3 border-b border-gray-100\">\r\n              <div className=\"relative\">\r\n                <BiSearch className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\r\n                <input\r\n                  ref={inputRef}\r\n                  type=\"text\"\r\n                  placeholder=\"Search options...\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => {\r\n                    setSearchTerm(e.target.value);\r\n                    setHighlightedIndex(-1);\r\n                  }}\r\n                  className=\"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:outline-none text-sm\"\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Options List */}\r\n          <div className=\"max-h-60 overflow-y-auto\">\r\n            {filteredOptions.length > 0 ? (\r\n              filteredOptions.map((option, index) => (\r\n                <button\r\n                  key={option.value}\r\n                  type=\"button\"\r\n                  onClick={() => handleSelect(option)}\r\n                  onMouseEnter={() => setHighlightedIndex(index)}\r\n                  className={`\r\n                    w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors duration-150\r\n                    flex items-center justify-between group\r\n                    ${highlightedIndex === index ? \"bg-blue-50\" : \"\"}\r\n                    ${\r\n                      option.value === value\r\n                        ? \"bg-blue-50 text-blue-700\"\r\n                        : \"text-gray-900\"\r\n                    }\r\n                  `}\r\n                >\r\n                  <span className=\"truncate\">{option.label}</span>\r\n                  {option.value === value && (\r\n                    <BiCheck className=\"w-4 h-4 text-blue-600 flex-shrink-0 ml-2\" />\r\n                  )}\r\n                </button>\r\n              ))\r\n            ) : (\r\n              <div className=\"px-4 py-8 text-center text-gray-500 text-sm\">\r\n                {searchTerm ? \"No options found\" : \"No options available\"}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer with selected count */}\r\n          {selectedOption && (\r\n            <div className=\"px-4 py-2 border-t border-gray-100 bg-gray-50 text-xs text-gray-500\">\r\n              Selected: {selectedOption.label}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Error Message */}\r\n      {error && (\r\n        <p className=\"mt-1 text-sm text-red-600 flex items-center\">\r\n          <svg\r\n            className=\"w-4 h-4 mr-1 flex-shrink-0\"\r\n            fill=\"currentColor\"\r\n            viewBox=\"0 0 20 20\"\r\n          >\r\n            <path\r\n              fillRule=\"evenodd\"\r\n              d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\"\r\n              clipRule=\"evenodd\"\r\n            />\r\n          </svg>\r\n          {error}\r\n        </p>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport Button from \"../common/Button\";\r\nimport FormField from \"../common/FormField\";\r\nimport SelectDropdown from \"../common/SelectDropdown\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport { useKeyboardShortcuts } from \"../../hooks/useKeyboardShortcuts\";\r\nimport { api } from \"../../lib/api\";\r\nimport {\r\n  getRegions,\r\n  getProvinces,\r\n  getCities,\r\n  getBarangays,\r\n} from \"../../lib/locationApi\";\r\n\r\n/**\r\n * ProfileModal Component\r\n * Modern, trending UI/UX design with glassmorphism and animations\r\n */\r\nconst ProfileModal = ({ isOpen, onClose, userData, businessData }) => {\r\n  const [profileData, setProfileData] = useState({\r\n    first_name: userData?.first_name || \"\",\r\n    last_name: userData?.last_name || \"\",\r\n    email: userData?.email || \"\",\r\n    contact_number: userData?.contact_number || \"\",\r\n    currentPassword: \"\",\r\n    newPassword: \"\",\r\n    confirmPassword: \"\",\r\n    // Business fields\r\n    business_name: businessData?.business_name || \"\",\r\n    business_email: businessData?.email || \"\",\r\n    business_type: businessData?.business_type || \"\",\r\n    region: businessData?.region || \"\",\r\n    province: businessData?.province || \"\",\r\n    city: businessData?.city || \"\",\r\n    barangay: businessData?.barangay || \"\",\r\n    house_street:\r\n      businessData?.house_number ||\r\n      businessData?.business_address ||\r\n      businessData?.address_line ||\r\n      \"\",\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [errors, setErrors] = useState({});\r\n  const [touched, setTouched] = useState({});\r\n  const [activeTab, setActiveTab] = useState(\"account\");\r\n  const [locationOptions, setLocationOptions] = useState({\r\n    regions: [],\r\n    provinces: [],\r\n    cities: [],\r\n    barangays: [],\r\n  });\r\n  const [locationLoading, setLocationLoading] = useState({\r\n    regions: false,\r\n    provinces: false,\r\n    cities: false,\r\n    barangays: false,\r\n  });\r\n  const initialLocationRef = useRef({\r\n    region: businessData?.region || \"\",\r\n    province: businessData?.province || \"\",\r\n    city: businessData?.city || \"\",\r\n    barangay: businessData?.barangay || \"\",\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (userData || businessData) {\r\n      setProfileData({\r\n        first_name: userData?.first_name || \"\",\r\n        last_name: userData?.last_name || \"\",\r\n        email: userData?.email || \"\",\r\n        contact_number: userData?.contact_number || \"\",\r\n        currentPassword: \"\",\r\n        newPassword: \"\",\r\n        confirmPassword: \"\",\r\n        // Business fields\r\n        business_name: businessData?.business_name || \"\",\r\n        business_email: businessData?.email || \"\",\r\n        business_type: businessData?.business_type || \"\",\r\n        region: businessData?.region || \"\",\r\n        province: businessData?.province || \"\",\r\n        city: businessData?.city || \"\",\r\n        barangay: businessData?.barangay || \"\",\r\n        house_street:\r\n          businessData?.house_number ||\r\n          businessData?.business_address ||\r\n          businessData?.address_line ||\r\n          \"\",\r\n      });\r\n      setMessage(\"\");\r\n      setError(\"\");\r\n      setErrors({});\r\n      setTouched({});\r\n      setActiveTab(\"account\");\r\n    }\r\n  }, [userData, businessData, isOpen]);\r\n\r\n  // Helpers\r\n  const findOptionByLabel = (options, label) => {\r\n    if (!label) return null;\r\n    const target = label.toLowerCase().trim();\r\n    return options.find((o) => o.label.toLowerCase() === target) || null;\r\n  };\r\n\r\n  const getLabel = (options, value, fallback) => {\r\n    const match = options.find((o) => o.value === value);\r\n    return match ? match.label : fallback || \"\";\r\n  };\r\n\r\n  // Fetch regions on open\r\n  useEffect(() => {\r\n    const fetchRegions = async () => {\r\n      try {\r\n        setLocationLoading((l) => ({ ...l, regions: true }));\r\n        const data = await getRegions();\r\n        const options = data.map((r) => ({ value: r.code, label: r.name }));\r\n        setLocationOptions((o) => ({ ...o, regions: options }));\r\n      } catch (err) {\r\n        console.error(\"Failed to load regions\", err);\r\n      } finally {\r\n        setLocationLoading((l) => ({ ...l, regions: false }));\r\n      }\r\n    };\r\n    if (isOpen) {\r\n      fetchRegions();\r\n    }\r\n  }, [isOpen]);\r\n\r\n  // When regions loaded, map existing region name to code\r\n  useEffect(() => {\r\n    if (\r\n      locationOptions.regions.length &&\r\n      initialLocationRef.current.region &&\r\n      !profileData.region\r\n    ) {\r\n      const match = findOptionByLabel(\r\n        locationOptions.regions,\r\n        initialLocationRef.current.region\r\n      );\r\n      if (match) {\r\n        setProfileData((p) => ({ ...p, region: match.value }));\r\n      }\r\n    }\r\n  }, [locationOptions.regions, profileData.region]);\r\n\r\n  // Fetch provinces when region changes\r\n  useEffect(() => {\r\n    const loadProvinces = async () => {\r\n      if (!profileData.region) {\r\n        setLocationOptions((o) => ({\r\n          ...o,\r\n          provinces: [],\r\n          cities: [],\r\n          barangays: [],\r\n        }));\r\n        return;\r\n      }\r\n      try {\r\n        setLocationLoading((l) => ({ ...l, provinces: true }));\r\n        const data = await getProvinces(profileData.region);\r\n        const options = data.map((p) => ({ value: p.code, label: p.name }));\r\n        setLocationOptions((o) => ({\r\n          ...o,\r\n          provinces: options,\r\n          cities: [],\r\n          barangays: [],\r\n        }));\r\n\r\n        // Preselect province if we have a name from initial data\r\n        if (initialLocationRef.current.province) {\r\n          const match = findOptionByLabel(\r\n            options,\r\n            initialLocationRef.current.province\r\n          );\r\n          if (match) {\r\n            setProfileData((p) => ({ ...p, province: match.value }));\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Failed to load provinces\", err);\r\n      } finally {\r\n        setLocationLoading((l) => ({ ...l, provinces: false }));\r\n      }\r\n    };\r\n    loadProvinces();\r\n  }, [profileData.region]);\r\n\r\n  // Fetch cities when province changes\r\n  useEffect(() => {\r\n    const loadCities = async () => {\r\n      if (!profileData.province) {\r\n        setLocationOptions((o) => ({ ...o, cities: [], barangays: [] }));\r\n        return;\r\n      }\r\n      try {\r\n        setLocationLoading((l) => ({ ...l, cities: true }));\r\n        const data = await getCities(profileData.province);\r\n        const options = data.map((c) => ({ value: c.code, label: c.name }));\r\n        setLocationOptions((o) => ({ ...o, cities: options, barangays: [] }));\r\n\r\n        // Preselect city\r\n        if (initialLocationRef.current.city) {\r\n          const match = findOptionByLabel(\r\n            options,\r\n            initialLocationRef.current.city\r\n          );\r\n          if (match) {\r\n            setProfileData((p) => ({ ...p, city: match.value }));\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Failed to load cities\", err);\r\n      } finally {\r\n        setLocationLoading((l) => ({ ...l, cities: false }));\r\n      }\r\n    };\r\n    loadCities();\r\n  }, [profileData.province]);\r\n\r\n  // Fetch barangays when city changes\r\n  useEffect(() => {\r\n    const loadBarangays = async () => {\r\n      if (!profileData.city) {\r\n        setLocationOptions((o) => ({ ...o, barangays: [] }));\r\n        return;\r\n      }\r\n      try {\r\n        setLocationLoading((l) => ({ ...l, barangays: true }));\r\n        const data = await getBarangays(profileData.city);\r\n        const options = data.map((b) => ({ value: b.code, label: b.name }));\r\n        setLocationOptions((o) => ({ ...o, barangays: options }));\r\n\r\n        // Preselect barangay\r\n        if (initialLocationRef.current.barangay) {\r\n          const match = findOptionByLabel(\r\n            options,\r\n            initialLocationRef.current.barangay\r\n          );\r\n          if (match) {\r\n            setProfileData((p) => ({ ...p, barangay: match.value }));\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Failed to load barangays\", err);\r\n      } finally {\r\n        setLocationLoading((l) => ({ ...l, barangays: false }));\r\n      }\r\n    };\r\n    loadBarangays();\r\n  }, [profileData.city]);\r\n\r\n  const validateField = (name, value) => {\r\n    const newErrors = { ...errors };\r\n\r\n    switch (name) {\r\n      case \"first_name\":\r\n        if (activeTab === \"account\" && !value.trim()) {\r\n          newErrors.first_name = \"First name is required\";\r\n        } else if (value.trim().length < 2) {\r\n          newErrors.first_name = \"First name must be at least 2 characters\";\r\n        } else {\r\n          delete newErrors.first_name;\r\n        }\r\n        break;\r\n\r\n      case \"last_name\":\r\n        if (activeTab === \"account\" && !value.trim()) {\r\n          newErrors.last_name = \"Last name is required\";\r\n        } else if (value.trim().length < 2) {\r\n          newErrors.last_name = \"Last name must be at least 2 characters\";\r\n        } else {\r\n          delete newErrors.last_name;\r\n        }\r\n        break;\r\n\r\n      case \"email\":\r\n        if (activeTab === \"account\" && !value.trim()) {\r\n          newErrors.email = \"Email is required\";\r\n        } else if (\r\n          value.trim() &&\r\n          !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value.trim())\r\n        ) {\r\n          newErrors.email = \"Please enter a valid email\";\r\n        } else {\r\n          delete newErrors.email;\r\n        }\r\n        break;\r\n\r\n      case \"contact_number\":\r\n        if (value && value.trim().length < 7) {\r\n          newErrors.contact_number = \"Phone number must be at least 7 digits\";\r\n        } else {\r\n          delete newErrors.contact_number;\r\n        }\r\n        break;\r\n\r\n      case \"business_email\":\r\n        if (value.trim() && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value.trim())) {\r\n          newErrors.business_email = \"Please enter a valid email\";\r\n        } else {\r\n          delete newErrors.business_email;\r\n        }\r\n        break;\r\n\r\n      case \"currentPassword\":\r\n        if (profileData.newPassword && !value) {\r\n          newErrors.currentPassword =\r\n            \"Current password is required to change password\";\r\n        } else {\r\n          delete newErrors.currentPassword;\r\n        }\r\n        break;\r\n\r\n      case \"newPassword\":\r\n        if (value && value.length < 6) {\r\n          newErrors.newPassword = \"Password must be at least 6 characters\";\r\n        } else {\r\n          delete newErrors.newPassword;\r\n        }\r\n        break;\r\n\r\n      case \"confirmPassword\":\r\n        if (value && value !== profileData.newPassword) {\r\n          newErrors.confirmPassword = \"Passwords do not match\";\r\n        } else {\r\n          delete newErrors.confirmPassword;\r\n        }\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n\r\n    setErrors(newErrors);\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    const { name, value } = e.target;\r\n    setProfileData((prev) => ({\r\n      ...prev,\r\n      [name]: value,\r\n    }));\r\n    if (touched[name]) {\r\n      validateField(name, value);\r\n    }\r\n  };\r\n\r\n  const handleBlur = (e) => {\r\n    const { name, value } = e.target;\r\n    setTouched((prev) => ({ ...prev, [name]: true }));\r\n    validateField(name, value);\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setMessage(\"\");\r\n    setError(\"\");\r\n\r\n    if (activeTab === \"security\") {\r\n      if (!profileData.currentPassword || !profileData.newPassword || !profileData.confirmPassword) {\r\n        setError(\"Please fill in all password fields.\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      if (profileData.newPassword !== profileData.confirmPassword) {\r\n        setError(\"New password and confirmation do not match.\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n    }\r\n\r\n    try {\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n\r\n      if (activeTab === \"account\" || activeTab === \"security\") {\r\n        const updateData = {\r\n          first_name: profileData.first_name,\r\n          last_name: profileData.last_name,\r\n          email: profileData.email,\r\n          contact_number: profileData.contact_number,\r\n        };\r\n\r\n        // Add password fields if user is changing password\r\n        if (profileData.newPassword) {\r\n          updateData.currentPassword = profileData.currentPassword;\r\n          updateData.newPassword = profileData.newPassword;\r\n        }\r\n\r\n        await api(\"/api/auth/update-profile\", {\r\n          method: \"PUT\",\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          body: JSON.stringify(updateData),\r\n        });\r\n      } else if (activeTab === \"business\") {\r\n        const regionLabel = getLabel(\r\n          locationOptions.regions,\r\n          profileData.region,\r\n          businessData?.region\r\n        );\r\n        const provinceLabel = getLabel(\r\n          locationOptions.provinces,\r\n          profileData.province,\r\n          businessData?.province\r\n        );\r\n        const cityLabel = getLabel(\r\n          locationOptions.cities,\r\n          profileData.city,\r\n          businessData?.city\r\n        );\r\n        const barangayLabel = getLabel(\r\n          locationOptions.barangays,\r\n          profileData.barangay,\r\n          businessData?.barangay\r\n        );\r\n\r\n        const businessUpdateData = {\r\n          businessName: profileData.business_name || undefined,\r\n          businessType: profileData.business_type || undefined,\r\n          businessAddress: [\r\n            profileData.house_street,\r\n            barangayLabel,\r\n            cityLabel,\r\n            provinceLabel,\r\n            regionLabel,\r\n            profileData.region || \"\",\r\n          ]\r\n            .filter(Boolean)\r\n            .join(\", \"),\r\n          houseNumber: profileData.house_street || undefined,\r\n          region: profileData.region || \"\",\r\n          business_email: profileData.business_email || undefined,\r\n        };\r\n\r\n        await api(\"/api/business/update-business\", {\r\n          method: \"PUT\",\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          body: JSON.stringify(businessUpdateData),\r\n        });\r\n      }\r\n\r\n      setMessage(\"Profile updated successfully!\");\r\n      setTimeout(() => {\r\n        onClose();\r\n        window.location.reload();\r\n      }, 2000);\r\n    } catch (err) {\r\n      console.error(\"Failed to update profile:\", err);\r\n      setError(err.message || \"Failed to update profile. Please try again.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Reset form when modal opens/closes\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setActiveTab(\"account\");\r\n      setProfileData({\r\n        first_name: userData?.first_name || \"\",\r\n        last_name: userData?.last_name || \"\",\r\n        email: userData?.email || \"\",\r\n        contact_number: userData?.contact_number || \"\",\r\n        currentPassword: \"\",\r\n        newPassword: \"\",\r\n        confirmPassword: \"\",\r\n        business_name: businessData?.business_name || \"\",\r\n        business_email: businessData?.email || \"\",\r\n        business_type: businessData?.business_type || \"\",\r\n        region: businessData?.region || \"\",\r\n        province: businessData?.province || \"\",\r\n        city: businessData?.city || \"\",\r\n        barangay: businessData?.barangay || \"\",\r\n        house_street:\r\n          businessData?.house_number ||\r\n          businessData?.business_address ||\r\n          businessData?.address_line ||\r\n          \"\",\r\n      });\r\n      setErrors({});\r\n      setTouched({});\r\n      setMessage(\"\");\r\n      setError(\"\");\r\n    }\r\n  }, [isOpen, userData, businessData]);\r\n\r\n  // Set up keyboard shortcuts\r\n  useKeyboardShortcuts(\r\n    [\r\n      {\r\n        key: \"escape\",\r\n        action: onClose,\r\n        enabled: isOpen,\r\n        allowWhileTyping: true,\r\n      },\r\n      {\r\n        key: \"enter\",\r\n        action: (e) => {\r\n          if (isOpen) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            handleSubmit(e);\r\n          }\r\n        },\r\n        enabled: isOpen && activeTab !== \"security\",\r\n      },\r\n    ],\r\n    [isOpen, onClose, handleSubmit, activeTab]\r\n  );\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const storeLabel =\r\n    userData?.store_name ||\r\n    userData?.storeName ||\r\n    userData?.businessName ||\r\n    \"your store\";\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Update Password\"\r\n      subtitle={\r\n        <div className=\"flex flex-col gap-2\">\r\n          <p>Cashiers can only change their password here</p>\r\n        </div>\r\n      }\r\n      footer={\r\n        <div className=\"w-full flex gap-2 justify-end\">\r\n          <Button\r\n            label=\"Cancel\"\r\n            variant=\"secondary\"\r\n            onClick={onClose}\r\n            disabled={loading}\r\n          />\r\n          <Button\r\n            label={\r\n              loading ? \"Saving...\" : \"Save Password (Enter)\"\r\n            }\r\n            variant=\"primary\"\r\n            onClick={handleSubmit}\r\n            disabled={loading}\r\n          />\r\n        </div>\r\n      }\r\n    >\r\n      {message && (\r\n        <div className=\"text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded-lg px-3 py-2 mb-3\">\r\n          {message}\r\n        </div>\r\n      )}\r\n      {error && (\r\n        <div className=\"text-sm text-red-700 bg-red-50 border border-red-200 rounded-lg px-3 py-2 mb-3\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {/* Tab Navigation */}\r\n      <div className=\"flex gap-1 border-b border-slate-200/10 -mx-6 px-6\">\r\n        <button\r\n          onClick={() => setActiveTab(\"account\")}\r\n          className={`px-4 py-2 rounded-t-xl font-medium transition-all duration-200 relative ${\r\n            activeTab === \"account\"\r\n              ? \"text-blue-600 bg-blue-50/30\"\r\n              : \"text-slate-500 hover:text-slate-700\"\r\n          }`}\r\n        >\r\n          <span className=\"flex items-center gap-2\">\r\n            <svg\r\n              className=\"w-4 h-4\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"\r\n              />\r\n            </svg>\r\n            Account\r\n          </span>\r\n          {activeTab === \"account\" && (\r\n            <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full\"></div>\r\n          )}\r\n        </button>\r\n        <button\r\n          onClick={() => setActiveTab(\"business\")}\r\n          className={`px-4 py-2 rounded-t-xl font-medium transition-all duration-200 relative ${\r\n            activeTab === \"business\"\r\n              ? \"text-blue-600 bg-blue-50/30\"\r\n              : \"text-slate-500 hover:text-slate-700\"\r\n          }`}\r\n        >\r\n          <span className=\"flex items-center gap-2\">\r\n            <svg\r\n              className=\"w-4 h-4\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\"\r\n              />\r\n            </svg>\r\n            Business\r\n          </span>\r\n          {activeTab === \"business\" && (\r\n            <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full\"></div>\r\n          )}\r\n        </button>\r\n        <button\r\n          onClick={() => setActiveTab(\"security\")}\r\n          className={`px-4 py-2 rounded-t-xl font-medium transition-all duration-200 relative ${\r\n            activeTab === \"security\"\r\n              ? \"text-blue-600 bg-blue-50/30\"\r\n              : \"text-slate-500 hover:text-slate-700\"\r\n          }`}\r\n        >\r\n          <span className=\"flex items-center gap-2\">\r\n            <svg\r\n              className=\"w-4 h-4\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"\r\n              />\r\n            </svg>\r\n            Security\r\n          </span>\r\n          {activeTab === \"security\" && (\r\n            <div className=\"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full\"></div>\r\n          )}\r\n        </button>\r\n      </div>\r\n\r\n      {/* Form Content */}\r\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n        {/* Account Tab */}\r\n        {activeTab === \"account\" && (\r\n          <div className=\"space-y-4 animate-in fade-in duration-300\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <h3 className=\"text-sm font-bold text-slate-900\">\r\n                Personal Information\r\n              </h3>\r\n              <div className=\"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent\"></div>\r\n            </div>\r\n\r\n            {/* First Name Field */}\r\n            <FormField\r\n              label=\"First Name\"\r\n              name=\"first_name\"\r\n              value={profileData.first_name}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter first name\"\r\n              error={\r\n                touched.first_name && errors.first_name\r\n                  ? errors.first_name\r\n                  : null\r\n              }\r\n              required\r\n            />\r\n\r\n            {/* Last Name Field */}\r\n            <FormField\r\n              label=\"Last Name\"\r\n              name=\"last_name\"\r\n              value={profileData.last_name}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter last name\"\r\n              error={\r\n                touched.last_name && errors.last_name ? errors.last_name : null\r\n              }\r\n              required\r\n            />\r\n\r\n            {/* Email Field */}\r\n            <FormField\r\n              label=\"Email Address\"\r\n              name=\"email\"\r\n              type=\"email\"\r\n              value={profileData.email}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter email address\"\r\n              error={touched.email && errors.email ? errors.email : null}\r\n              required\r\n            />\r\n\r\n            {/* Contact Number Field */}\r\n            <FormField\r\n              label=\"Contact Number\"\r\n              name=\"contact_number\"\r\n              type=\"tel\"\r\n              value={profileData.contact_number}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter phone number\"\r\n              error={\r\n                touched.contact_number && errors.contact_number\r\n                  ? errors.contact_number\r\n                  : null\r\n              }\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {/* Business Tab */}\r\n        {activeTab === \"business\" && (\r\n          <div className=\"space-y-4 animate-in fade-in duration-300\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <h3 className=\"text-sm font-bold text-slate-900\">\r\n                Business Information\r\n              </h3>\r\n              <div className=\"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent\"></div>\r\n            </div>\r\n\r\n            {/* Business Name */}\r\n            <FormField\r\n              label=\"Business Name\"\r\n              name=\"business_name\"\r\n              value={profileData.business_name}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter business name\"\r\n              error={\r\n                touched.business_name && errors.business_name\r\n                  ? errors.business_name\r\n                  : null\r\n              }\r\n            />\r\n\r\n            {/* Business Email Field */}\r\n            <FormField\r\n              label=\"Business Email\"\r\n              name=\"business_email\"\r\n              type=\"email\"\r\n              value={profileData.business_email}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter business email\"\r\n              error={\r\n                touched.business_email && errors.business_email\r\n                  ? errors.business_email\r\n                  : null\r\n              }\r\n            />\r\n\r\n            {/* Business Type */}\r\n            <div className=\"mb-5\">\r\n              <label className=\"block mb-1 font-medium text-blue-800\">\r\n                Business Type\r\n              </label>\r\n              <SelectDropdown\r\n                name=\"business_type\"\r\n                value={profileData.business_type}\r\n                onChange={(e) => handleInputChange(e)}\r\n                options={[\r\n                  { value: \"Grocery Store\", label: \"Grocery Store\" },\r\n                  { value: \"Retail\", label: \"Retail\" },\r\n                  { value: \"Restaurant\", label: \"Restaurant\" },\r\n                  { value: \"Cafe\", label: \"Cafe\" },\r\n                  { value: \"Pharmacy\", label: \"Pharmacy\" },\r\n                  { value: \"Services\", label: \"Services\" },\r\n                  ...(profileData.business_type &&\r\n                  ![\r\n                    \"Grocery Store\",\r\n                    \"Retail\",\r\n                    \"Restaurant\",\r\n                    \"Cafe\",\r\n                    \"Pharmacy\",\r\n                    \"Services\",\r\n                  ].includes(profileData.business_type)\r\n                    ? [\r\n                        {\r\n                          value: profileData.business_type,\r\n                          label: profileData.business_type,\r\n                        },\r\n                      ]\r\n                    : []),\r\n                ]}\r\n                placeholder=\"Select business type\"\r\n                error={\r\n                  touched.business_type && errors.business_type\r\n                    ? errors.business_type\r\n                    : null\r\n                }\r\n              />\r\n            </div>\r\n\r\n            <div className=\"flex items-center gap-2 mb-2 pt-2\">\r\n              <h3 className=\"text-sm font-bold text-slate-900\">\r\n                Business Location\r\n              </h3>\r\n              <div className=\"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent\"></div>\r\n            </div>\r\n\r\n            {/* Region */}\r\n            <div className=\"mb-5\">\r\n              <label className=\"block mb-1 font-medium text-blue-800\">\r\n                Region\r\n              </label>\r\n              <SelectDropdown\r\n                name=\"region\"\r\n                value={profileData.region}\r\n                options={locationOptions.regions}\r\n                onChange={(e) =>\r\n                  handleInputChange({\r\n                    target: { name: \"region\", value: e.target.value },\r\n                  })\r\n                }\r\n                placeholder={\r\n                  locationLoading.regions\r\n                    ? \"Loading regions...\"\r\n                    : \"Select Region\"\r\n                }\r\n                disabled={locationLoading.regions}\r\n                error={touched.region && errors.region ? errors.region : null}\r\n              />\r\n            </div>\r\n\r\n            {/* Province */}\r\n            <div className=\"mb-5\">\r\n              <label className=\"block mb-1 font-medium text-blue-800\">\r\n                Province\r\n              </label>\r\n              <SelectDropdown\r\n                name=\"province\"\r\n                value={profileData.province}\r\n                options={locationOptions.provinces}\r\n                onChange={(e) =>\r\n                  handleInputChange({\r\n                    target: { name: \"province\", value: e.target.value },\r\n                  })\r\n                }\r\n                placeholder={\r\n                  locationLoading.provinces\r\n                    ? \"Loading provinces...\"\r\n                    : \"Select Province\"\r\n                }\r\n                disabled={!profileData.region || locationLoading.provinces}\r\n                error={\r\n                  touched.province && errors.province ? errors.province : null\r\n                }\r\n              />\r\n            </div>\r\n\r\n            {/* City/Municipality */}\r\n            <div className=\"mb-5\">\r\n              <label className=\"block mb-1 font-medium text-blue-800\">\r\n                City/Municipality\r\n              </label>\r\n              <SelectDropdown\r\n                name=\"city\"\r\n                value={profileData.city}\r\n                options={locationOptions.cities}\r\n                onChange={(e) =>\r\n                  handleInputChange({\r\n                    target: { name: \"city\", value: e.target.value },\r\n                  })\r\n                }\r\n                placeholder={\r\n                  locationLoading.cities\r\n                    ? \"Loading cities...\"\r\n                    : \"Select City/Municipality\"\r\n                }\r\n                disabled={!profileData.province || locationLoading.cities}\r\n                error={touched.city && errors.city ? errors.city : null}\r\n              />\r\n            </div>\r\n\r\n            {/* Barangay */}\r\n            <div className=\"mb-5\">\r\n              <label className=\"block mb-1 font-medium text-blue-800\">\r\n                Barangay\r\n              </label>\r\n              <SelectDropdown\r\n                name=\"barangay\"\r\n                value={profileData.barangay}\r\n                options={locationOptions.barangays}\r\n                onChange={(e) =>\r\n                  handleInputChange({\r\n                    target: { name: \"barangay\", value: e.target.value },\r\n                  })\r\n                }\r\n                placeholder={\r\n                  locationLoading.barangays\r\n                    ? \"Loading barangays...\"\r\n                    : \"Select Barangay\"\r\n                }\r\n                disabled={!profileData.city || locationLoading.barangays}\r\n                error={\r\n                  touched.barangay && errors.barangay ? errors.barangay : null\r\n                }\r\n              />\r\n            </div>\r\n\r\n            {/* House / Street / Landmark */}\r\n            <FormField\r\n              label=\"House no./ Street Name / Landmark (optional)\"\r\n              name=\"house_street\"\r\n              value={profileData.house_street}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter house number, street, or landmark\"\r\n              error={\r\n                touched.house_street && errors.house_street\r\n                  ? errors.house_street\r\n                  : null\r\n              }\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        {/* Security Tab */}\r\n        {activeTab === \"security\" && (\r\n          <div className=\"space-y-4 animate-in fade-in duration-300\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <h3 className=\"text-sm font-bold text-slate-900\">\r\n                Change Password\r\n              </h3>\r\n              <div className=\"flex-1 h-px bg-gradient-to-r from-slate-200 to-transparent\"></div>\r\n            </div>\r\n            <p className=\"text-xs text-slate-500 bg-amber-50 border border-amber-100/50 rounded-xl px-3 py-2\">\r\n              Leave blank to keep your current password\r\n            </p>\r\n\r\n            {/* Current Password Field */}\r\n            <FormField\r\n              label=\"Current Password\"\r\n              name=\"currentPassword\"\r\n              type=\"password\"\r\n              value={profileData.currentPassword}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Enter current password\"\r\n              error={\r\n                touched.currentPassword && errors.currentPassword\r\n                  ? errors.currentPassword\r\n                  : null\r\n              }\r\n            />\r\n\r\n            {/* Password Strength Indicator */}\r\n            {profileData.newPassword && (\r\n              <div className=\"space-y-2\">\r\n                <div className=\"text-xs font-semibold text-slate-700\">\r\n                  Password Strength\r\n                </div>\r\n                <div className=\"w-full h-1.5 bg-slate-200 rounded-full overflow-hidden\">\r\n                  <div\r\n                    className={`h-full rounded-full transition-all duration-300 ${\r\n                      profileData.newPassword.length >= 12\r\n                        ? \"w-full bg-gradient-to-r from-green-500 to-emerald-500\"\r\n                        : profileData.newPassword.length >= 8\r\n                        ? \"w-2/3 bg-gradient-to-r from-yellow-500 to-amber-500\"\r\n                        : \"w-1/3 bg-gradient-to-r from-red-500 to-orange-500\"\r\n                    }`}\r\n                  ></div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* New Password Field */}\r\n            <FormField\r\n              label=\"New Password\"\r\n              name=\"newPassword\"\r\n              type=\"password\"\r\n              value={profileData.newPassword}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Min. 6 characters\"\r\n              error={\r\n                touched.newPassword && errors.newPassword\r\n                  ? errors.newPassword\r\n                  : null\r\n              }\r\n            />\r\n\r\n            {/* Confirm Password Field */}\r\n            <FormField\r\n              label=\"Confirm Password\"\r\n              name=\"confirmPassword\"\r\n              type=\"password\"\r\n              value={profileData.confirmPassword}\r\n              onChange={handleInputChange}\r\n              onBlur={handleBlur}\r\n              placeholder=\"Re-enter new password\"\r\n              error={\r\n                touched.confirmPassword && errors.confirmPassword\r\n                  ? errors.confirmPassword\r\n                  : null\r\n              }\r\n            />\r\n          </div>\r\n        )}\r\n        <div className=\"flex justify-end gap-2 pt-4 border-t border-gray-100 mt-6\">\r\n          <Button\r\n            label=\"Cancel\"\r\n            variant=\"secondary\"\r\n            onClick={onClose}\r\n            disabled={loading}\r\n            type=\"button\"\r\n          />\r\n          <Button\r\n            label={loading ? \"Saving...\" : \"Save Changes\"}\r\n            variant=\"primary\"\r\n            type=\"submit\"\r\n            disabled={loading}\r\n          />\r\n        </div>\r\n      </form>\r\n    </BaseModal>\r\n  );\r\n};\r\n\r\nexport default ProfileModal;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport PageLayout from \"../components/layout/PageLayout\";\r\nimport NavAdmin from \"../components/layout/Nav-Admin\";\r\nimport Card from \"../components/common/Card\";\r\nimport Loader from \"../components/common/Loader\";\r\nimport { api } from \"../lib/api\";\r\nimport Button from \"../components/common/Button\";\r\nimport ProfileModal from \"../components/modals/ProfileModal\";\r\nimport BaseModal from \"../components/modals/BaseModal\";\r\nimport ChangePasswordModal from \"../components/modals/ChangePasswordModal\";\r\n\r\n// Icon Components\r\nconst UserIcon = (props) => (\r\n  <svg\r\n    className={`w-5 h-5 ${props.className || \"\"}`}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst EmailIcon = (props) => (\r\n  <svg\r\n    className={`w-5 h-5 ${props.className || \"\"}`}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst PhoneIcon = (props) => (\r\n  <svg\r\n    className={`w-5 h-5 ${props.className || \"\"}`}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst CalendarIcon = (props) => (\r\n  <svg\r\n    className={`w-5 h-5 ${props.className || \"\"}`}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst StoreIcon = (props) => (\r\n  <svg\r\n    className={`w-5 h-5 ${props.className || \"\"}`}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst LocationIcon = (props) => (\r\n  <svg\r\n    className={`w-5 h-5 ${props.className || \"\"}`}\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\"\r\n    />\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M15 11a3 3 0 11-6 0 3 3 0 016 0z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst RefreshIcon = () => (\r\n  <svg\r\n    className=\"w-4 h-4\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst EditIcon = () => (\r\n  <svg\r\n    className=\"w-4 h-4\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst LockIcon = () => (\r\n  <svg\r\n    className=\"w-4 h-4\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\nconst DownloadIcon = () => (\r\n  <svg\r\n    className=\"w-4 h-4\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"\r\n    />\r\n  </svg>\r\n);\r\n\r\n// New QR Icon from the 'new-nigga-dave' branch\r\nconst QRIcon = () => (\r\n  <svg\r\n    className=\"w-5 h-5\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path\r\n      strokeLinecap=\"round\"\r\n      strokeLinejoin=\"round\"\r\n      strokeWidth={2}\r\n      d=\"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h4a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z\"\r\n    />\r\n  </svg>\r\n);\r\n\r\n// ---\r\n\r\n// QR Code Logic Utility (Consolidated)\r\nconst getQrCodeData = (profileData) => {\r\n  // 1. Get businessId, prioritizing profileData, then sessionStorage, then localStorage\r\n  const businessId =\r\n    profileData?.business?.business_id ||\r\n    profileData?.user?.businessId ||\r\n    JSON.parse(sessionStorage.getItem(\"user\") || \"{}\")?.businessId ||\r\n    JSON.parse(localStorage.getItem(\"user\") || \"{}\")?.businessId;\r\n\r\n  if (!businessId) return { url: \"N/A\", qrSrc: null, businessId: null };\r\n\r\n  const url = new URL(window.location.origin + \"/enter-store\");\r\n  url.searchParams.set(\"business_id\", String(businessId));\r\n  const urlString = url.toString();\r\n  const data = encodeURIComponent(urlString);\r\n\r\n  // Use a slightly larger size for better download quality, but display size remains 260x260\r\n  const qrSrc = `https://api.qrserver.com/v1/create-qr-code/?size=260x260&data=${data}&qzone=2&format=png&_=${Date.now()}`;\r\n  const downloadSrc = `https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${data}&qzone=2&format=png&_=${Date.now()}`;\r\n\r\n  return { url: urlString, qrSrc, downloadSrc, businessId };\r\n};\r\n\r\n// ---\r\n\r\n/**\r\n * Profile Page Component\r\n * Displays store and admin credentials information\r\n */\r\nconst Profile = () => {\r\n  const [profileData, setProfileData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(\"\");\r\n  const [isSidebarOpen, setSidebarOpen] = useState(false);\r\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\r\n  const [deleteState, setDeleteState] = useState({ status: \"none\" });\r\n  const [deleteMessage, setDeleteMessage] = useState(\"\");\r\n  const [deleteError, setDeleteError] = useState(\"\");\r\n  const [deleteLoading, setDeleteLoading] = useState(false);\r\n  const [downloadLoading, setDownloadLoading] = useState(false);\r\n  const [password, setPassword] = useState(\"\");\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n  const [showChangePasswordModal, setShowChangePasswordModal] = useState(false);\r\n  const [isEditingAccount, setIsEditingAccount] = useState(false);\r\n  const [editFormData, setEditFormData] = useState({\r\n    first_name: \"\",\r\n    last_name: \"\",\r\n    email: \"\",\r\n    contact_number: \"\",\r\n  });\r\n  const [saveWarningOpen, setSaveWarningOpen] = useState(false);\r\n  const [saving, setSaving] = useState(false);\r\n  const [saveError, setSaveError] = useState(\"\");\r\n  const [isEditingStore, setIsEditingStore] = useState(false);\r\n  const [editStoreFormData, setEditStoreFormData] = useState({\r\n    business_name: \"\",\r\n    business_type: \"\",\r\n    email: \"\",\r\n    region: \"\",\r\n    province: \"\",\r\n    city: \"\",\r\n    barangay: \"\",\r\n    house_number: \"\",\r\n  });\r\n  const [saveStoreWarningOpen, setSaveStoreWarningOpen] = useState(false);\r\n  const [savingStore, setSavingStore] = useState(false);\r\n  const [saveStoreError, setSaveStoreError] = useState(\"\");\r\n\r\n  const normalizeDeletion = (del) => {\r\n    if (!del) return { status: \"none\" };\r\n    if (del.status === \"cancelled\") return { status: \"none\" };\r\n    return del;\r\n  };\r\n\r\n  const fetchDeletionStatus = async () => {\r\n    try {\r\n      setDeleteLoading(true);\r\n      const res = await api(\"/api/business/delete-request\");\r\n      const normalized = normalizeDeletion(res?.deletion);\r\n      setDeleteState(normalized);\r\n      setDeleteMessage(\r\n        normalized.status === \"pending\" ? res?.message || \"\" : \"\"\r\n      );\r\n    } catch (e) {\r\n      setDeleteError(\r\n        e?.message || \"Could not load deletion status. Please try again.\"\r\n      );\r\n    } finally {\r\n      setDeleteLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchProfileData();\r\n    fetchDeletionStatus();\r\n  }, []);\r\n\r\n  const normalizeBusiness = (business) => {\r\n    if (!business) return null;\r\n\r\n    const parts = (business.business_address || \"\")\r\n      .split(\",\")\r\n      .map((p) => p.trim())\r\n      .filter(Boolean);\r\n\r\n    // Remove trailing country if present\r\n    while (parts.length && /philippines?/i.test(parts[parts.length - 1])) {\r\n      parts.pop();\r\n    }\r\n\r\n    // Stored format (after trimming country): \"<house>, <barangay>, <city>, <province>\"\r\n    const len = parts.length;\r\n    const province = len >= 1 ? parts[len - 1] : \"\";\r\n    const city = len >= 2 ? parts[len - 2] : \"\";\r\n    const barangay = len >= 3 ? parts[len - 3] : \"\";\r\n    const houseOrStreet =\r\n      len > 3 ? parts.slice(0, len - 3).join(\", \") : parts[0] || \"\";\r\n\r\n    return {\r\n      ...business,\r\n      address_line: business.address_line || business.business_address || \"\",\r\n      region:\r\n        business.region ||\r\n        business.regionName ||\r\n        business.region_name ||\r\n        business.region_name ||\r\n        \"\",\r\n      province: business.province || business.provinceName || province || \"\",\r\n      city: business.city || business.cityName || city || \"\",\r\n      barangay: business.barangay || business.barangayName || barangay || \"\",\r\n      house_number:\r\n        business.house_number || business.houseNumber || houseOrStreet || \"\",\r\n    };\r\n  };\r\n\r\n  const fetchProfileData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(\"\");\r\n\r\n      const token =\r\n        sessionStorage.getItem(\"auth_token\") ||\r\n        localStorage.getItem(\"auth_token\") ||\r\n        localStorage.getItem(\"token\");\r\n\r\n      // Sync token to sessionStorage so future requests stay authenticated\r\n      if (token && !sessionStorage.getItem(\"auth_token\")) {\r\n        sessionStorage.setItem(\"auth_token\", token);\r\n      }\r\n\r\n      console.log(\"Fetching profile data from /auth/profile\");\r\n\r\n      // Fetch user profile data\r\n      const response = await api(\"/auth/profile\");\r\n\r\n      const normalized = {\r\n        ...response,\r\n        business: normalizeBusiness(response.business),\r\n      };\r\n\r\n      // Derive region if missing using locations endpoint (province -> region)\r\n      if (normalized.business && !normalized.business.region) {\r\n        try {\r\n          if (!locationsCacheRef.current) {\r\n            const locations = await api(\"/location/locations\");\r\n            locationsCacheRef.current = locations;\r\n          }\r\n          const derivedRegion = deriveRegionFromLocations(\r\n            locationsCacheRef.current,\r\n            normalized.business.province,\r\n            normalized.business.city\r\n          );\r\n          if (derivedRegion) {\r\n            normalized.business.region = derivedRegion;\r\n          }\r\n        } catch (locErr) {\r\n          console.warn(\"Failed to derive region from locations:\", locErr);\r\n        }\r\n      }\r\n\r\n      console.log(\"Profile data received:\", normalized);\r\n      setProfileData(normalized);\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch profile data:\", err);\r\n      setError(\r\n        \"Failed to load profile information. Please check your connection and try again.\"\r\n      );\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const deriveRegionFromLocations = (locationsData, provinceName, cityName) => {\r\n    if (!locationsData || (!provinceName && !cityName)) return \"\";\r\n    // locationsData structure: { [regionName]: { code, provinces: { [provinceName]: { ... } } } }\r\n    const provinceLower = (provinceName || \"\").toLowerCase().trim();\r\n    const cityLower = (cityName || \"\").toLowerCase().trim();\r\n\r\n    for (const [regionName, regionData] of Object.entries(locationsData)) {\r\n      for (const provinceKey of Object.keys(regionData.provinces || {})) {\r\n        const provLower = provinceKey.toLowerCase();\r\n        if (provinceLower && provLower === provinceLower) {\r\n          return regionName;\r\n        }\r\n        // Some addresses might have city stored as \"Province\" due to parsing issues; try matching city against province names\r\n        if (cityLower && provLower === cityLower) {\r\n          return regionName;\r\n        }\r\n      }\r\n    }\r\n    return \"\";\r\n  };\r\n\r\n  const formatDate = (dateString) => {\r\n    if (!dateString) return \"N/A\";\r\n    return new Date(dateString).toLocaleDateString(\"en-US\", {\r\n      year: \"numeric\",\r\n      month: \"long\",\r\n      day: \"numeric\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n    });\r\n  };\r\n\r\n  const handleDownloadExport = async () => {\r\n    setDeleteError(\"\");\r\n    setDownloadLoading(true);\r\n    try {\r\n      // Use fetch directly to handle non-OK responses for file downloads\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n      // Use same API base logic as api.js\r\n      const LOCAL_DEFAULT = \"http://localhost:5000\";\r\n      const envUrl = import.meta.env.PROD ? import.meta.env.VITE_API_BASE_URL : '';\r\n      const isLocalHost =\r\n        typeof window !== \"undefined\" &&\r\n        (window.location.hostname === \"localhost\" ||\r\n          window.location.hostname === \"127.0.0.1\");\r\n      \r\n      let API_BASE = \"\";\r\n      if (envUrl) {\r\n        API_BASE = envUrl;\r\n      } else if (import.meta.env.DEV) {\r\n        API_BASE = LOCAL_DEFAULT;\r\n      } else {\r\n        API_BASE = isLocalHost ? LOCAL_DEFAULT : \"\";\r\n      }\r\n      \r\n      const res = await fetch(`${API_BASE}/api/business/delete-request/export`, {\r\n        method: \"GET\",\r\n        credentials: \"include\",\r\n        headers: {\r\n          \"Authorization\": token ? `Bearer ${token}` : \"\",\r\n        },\r\n      });\r\n\r\n      // Check if response is OK\r\n      if (!res.ok) {\r\n        // Try to parse error message\r\n        const errorText = await res.text();\r\n        let errorMessage = \"Failed to download export.\";\r\n        try {\r\n          const errorJson = JSON.parse(errorText);\r\n          errorMessage = errorJson.error || errorMessage;\r\n        } catch {\r\n          errorMessage = errorText || errorMessage;\r\n        }\r\n        setDeleteError(errorMessage);\r\n        return;\r\n      }\r\n\r\n      const blob = await res.blob();\r\n      const url = window.URL.createObjectURL(blob);\r\n      const link = document.createElement(\"a\");\r\n      link.href = url;\r\n      \r\n      // Determine file extension from content type or default to xlsx\r\n      let fileExtension = \"xlsx\";\r\n      if (blob.type.includes(\"gzip\")) {\r\n        fileExtension = \"gz\";\r\n      } else if (blob.type.includes(\"csv\")) {\r\n        fileExtension = \"csv\";\r\n      } else if (blob.type.includes(\"json\")) {\r\n        fileExtension = \"json\";\r\n      } else if (blob.type.includes(\"spreadsheet\") || blob.type.includes(\"excel\") || blob.type.includes(\"xlsx\")) {\r\n        fileExtension = \"xlsx\";\r\n      }\r\n      \r\n      // Try to get filename from Content-Disposition header\r\n      const contentDisposition = res.headers.get(\"Content-Disposition\");\r\n      let fileName = `transactions-export.${fileExtension}`;\r\n      if (contentDisposition) {\r\n        const fileNameMatch = contentDisposition.match(/filename=\"?([^\"]+)\"?/);\r\n        if (fileNameMatch && fileNameMatch[1]) {\r\n          fileName = decodeURIComponent(fileNameMatch[1]);\r\n        }\r\n      }\r\n      \r\n      link.download = fileName;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      link.remove();\r\n      window.URL.revokeObjectURL(url);\r\n    } catch (e) {\r\n      setDeleteError(\r\n        e?.message || \"Failed to download export. Please try again.\"\r\n      );\r\n    } finally {\r\n      setDownloadLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRequestDeletion = async () => {\r\n    setDeleteError(\"\");\r\n    setDeleteMessage(\"\");\r\n    if (!password) {\r\n      setDeleteError('Please enter your password to confirm deletion.');\r\n      return;\r\n    }\r\n    setDeleteLoading(true);\r\n    try {\r\n      const res = await api(\"/api/business/delete-request\", { \r\n        method: \"POST\",\r\n        body: JSON.stringify({ password })\r\n      });\r\n      setDeleteState(res?.deletion || { status: \"pending\" });\r\n      setDeleteMessage(\r\n        res?.message || \"Deletion request recorded with a 30-day grace period.\"\r\n      );\r\n      setShowDeleteConfirm(false);\r\n      setPassword(\"\");\r\n    } catch (e) {\r\n      setDeleteError(\r\n        e?.message || \"Could not request deletion. Please check your password and try again.\"\r\n      );\r\n    } finally {\r\n      setDeleteLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleCancelDeletion = async () => {\r\n    setDeleteError(\"\");\r\n    setDeleteMessage(\"\");\r\n    setDeleteLoading(true);\r\n    try {\r\n      const res = await api(\"/api/business/delete-request/cancel\", {\r\n        method: \"POST\",\r\n      });\r\n      const normalized = normalizeDeletion(res?.deletion);\r\n      setDeleteState(normalized);\r\n      setDeleteMessage(\"\");\r\n    } catch (e) {\r\n      setDeleteError(\r\n        e?.message || \"Could not cancel deletion. Please try again.\"\r\n      );\r\n    } finally {\r\n      setDeleteLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDownloadQr = async () => {\r\n    const { downloadSrc, businessId } = getQrCodeData(profileData);\r\n    if (!downloadSrc) {\r\n      alert(\"Business ID not found to generate QR code.\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Fetch the image as a blob to handle CORS\r\n      const response = await fetch(downloadSrc);\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch QR code image');\r\n      }\r\n      const blob = await response.blob();\r\n      const url = window.URL.createObjectURL(blob);\r\n      \r\n      const a = document.createElement(\"a\");\r\n      a.href = url;\r\n      a.download = `store-${businessId || \"qr\"}.png`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      \r\n      // Clean up the object URL\r\n      window.URL.revokeObjectURL(url);\r\n    } catch (error) {\r\n      console.error('Error downloading QR code:', error);\r\n      alert('Failed to download QR code. Please try again.');\r\n    }\r\n  };\r\n\r\n  const handleEditAccount = () => {\r\n    if (profileData?.user) {\r\n      setEditFormData({\r\n        first_name: profileData.user.first_name || \"\",\r\n        last_name: profileData.user.last_name || \"\",\r\n        email: profileData.user.email || \"\",\r\n        contact_number: profileData.user.contact_number || \"\",\r\n      });\r\n      setIsEditingAccount(true);\r\n      setSaveError(\"\");\r\n    }\r\n  };\r\n\r\n  const handleCancelEdit = () => {\r\n    setIsEditingAccount(false);\r\n    setEditFormData({\r\n      first_name: \"\",\r\n      last_name: \"\",\r\n      email: \"\",\r\n      contact_number: \"\",\r\n    });\r\n    setSaveError(\"\");\r\n  };\r\n\r\n  const handleSaveAccount = async () => {\r\n    setSaving(true);\r\n    setSaveError(\"\");\r\n    try {\r\n      await api(\"/auth/update-profile\", {\r\n        method: \"PUT\",\r\n        body: JSON.stringify(editFormData),\r\n      });\r\n      \r\n      // Refresh profile data\r\n      await fetchProfileData();\r\n      setIsEditingAccount(false);\r\n      setSaveWarningOpen(false);\r\n    } catch (err) {\r\n      console.error(\"Failed to update profile:\", err);\r\n      setSaveError(err.message || \"Failed to update profile. Please try again.\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleEditStore = () => {\r\n    if (profileData?.business) {\r\n      setEditStoreFormData({\r\n        business_name: profileData.business.business_name || \"\",\r\n        business_type: profileData.business.business_type || \"\",\r\n        email: profileData.business.email || \"\",\r\n        region: profileData.business.region || \"\",\r\n        province: profileData.business.province || \"\",\r\n        city: profileData.business.city || \"\",\r\n        barangay: profileData.business.barangay || \"\",\r\n        house_number: profileData.business.house_number || \"\",\r\n      });\r\n      setIsEditingStore(true);\r\n      setSaveStoreError(\"\");\r\n    }\r\n  };\r\n\r\n  const handleCancelEditStore = () => {\r\n    setIsEditingStore(false);\r\n    setEditStoreFormData({\r\n      business_name: \"\",\r\n      business_type: \"\",\r\n      email: \"\",\r\n      region: \"\",\r\n      province: \"\",\r\n      city: \"\",\r\n      barangay: \"\",\r\n      house_number: \"\",\r\n    });\r\n    setSaveStoreError(\"\");\r\n  };\r\n\r\n  const handleSaveStore = async () => {\r\n    setSavingStore(true);\r\n    setSaveStoreError(\"\");\r\n    try {\r\n      // Check if location fields have changed\r\n      const locationChanged = \r\n        editStoreFormData.house_number !== (profileData?.business?.house_number || \"\") ||\r\n        editStoreFormData.barangay !== (profileData?.business?.barangay || \"\") ||\r\n        editStoreFormData.city !== (profileData?.business?.city || \"\") ||\r\n        editStoreFormData.province !== (profileData?.business?.province || \"\");\r\n\r\n      // Only construct and send businessAddress if location fields changed\r\n      let businessAddress = undefined;\r\n      if (locationChanged) {\r\n        // Construct business address from location fields (without region)\r\n        // Format: house_number, barangay, city, province\r\n        const addressParts = [\r\n          editStoreFormData.house_number,\r\n          editStoreFormData.barangay,\r\n          editStoreFormData.city,\r\n          editStoreFormData.province,\r\n        ].filter(Boolean);\r\n        businessAddress = addressParts.join(\", \");\r\n      }\r\n\r\n      const updateData = {\r\n        businessName: editStoreFormData.business_name,\r\n        businessType: editStoreFormData.business_type,\r\n        email: editStoreFormData.email,\r\n        region: editStoreFormData.region,\r\n        houseNumber: editStoreFormData.house_number,\r\n      };\r\n\r\n      // Only include businessAddress if location fields changed\r\n      if (businessAddress !== undefined) {\r\n        updateData.businessAddress = businessAddress;\r\n      }\r\n\r\n      await api(\"/api/business/profile\", {\r\n        method: \"PUT\",\r\n        body: JSON.stringify(updateData),\r\n      });\r\n      \r\n      // Refresh profile data\r\n      await fetchProfileData();\r\n      setIsEditingStore(false);\r\n      setSaveStoreWarningOpen(false);\r\n    } catch (err) {\r\n      console.error(\"Failed to update store profile:\", err);\r\n      setSaveStoreError(err.message || \"Failed to update store profile. Please try again.\");\r\n    } finally {\r\n      setSavingStore(false);\r\n    }\r\n  };\r\n\r\n  // Header actions with modern styling\r\n  const headerActions = (\r\n    <div className=\"flex items-center justify-end gap-2 sm:gap-3\">\r\n      <Button\r\n        onClick={fetchProfileData}\r\n        variant=\"secondary\"\r\n        size=\"sm\"\r\n        icon={<RefreshIcon />}\r\n        iconPosition=\"left\"\r\n        className=\"whitespace-nowrap [&>span]:hidden sm:[&>span]:inline\"\r\n      >\r\n        <span>Refresh</span>\r\n      </Button>\r\n      <Button\r\n        onClick={() => setShowChangePasswordModal(true)}\r\n        variant=\"secondary\"\r\n        size=\"sm\"\r\n        icon={<LockIcon />}\r\n        iconPosition=\"left\"\r\n        className=\"whitespace-nowrap [&>span]:hidden sm:[&>span]:inline\"\r\n      >\r\n        <span>Change Password</span>\r\n      </Button>\r\n    </div>\r\n  );\r\n\r\n  if (loading) {\r\n    return (\r\n      <PageLayout\r\n        title=\"PROFILE\"\r\n        subtitle=\"Store and admin credentials\"\r\n        sidebar={<NavAdmin />}\r\n        isSidebarOpen={isSidebarOpen}\r\n        setSidebarOpen={setSidebarOpen}\r\n        className=\"bg-gray-50\"\r\n      >\r\n        <div className=\"flex justify-center items-center h-64\">\r\n          <Loader />\r\n        </div>\r\n      </PageLayout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <PageLayout\r\n      title=\"PROFILE\"\r\n      subtitle=\"\"\r\n      sidebar={<NavAdmin />}\r\n      headerActions={headerActions}\r\n      isSidebarOpen={isSidebarOpen}\r\n      setSidebarOpen={setSidebarOpen}\r\n      className=\"bg-gray-50\"\r\n    >\r\n      <ProfileModal\r\n        isOpen={isEditModalOpen}\r\n        onClose={() => setIsEditModalOpen(false)}\r\n        userData={profileData?.user}\r\n        businessData={profileData?.business}\r\n      />\r\n      <ChangePasswordModal\r\n        isOpen={showChangePasswordModal}\r\n        onClose={() => setShowChangePasswordModal(false)}\r\n      />\r\n      {/* Save Warning Modal for Account */}\r\n      <BaseModal\r\n        isOpen={saveWarningOpen}\r\n        onClose={() => setSaveWarningOpen(false)}\r\n        title=\"Confirm Save Changes\"\r\n      >\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-start gap-4\">\r\n            <div className=\"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0\">\r\n              <svg\r\n                className=\"w-6 h-6 text-yellow-600\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <div className=\"flex-1\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\r\n                Warning: This action cannot be undone\r\n              </h3>\r\n              <p className=\"text-sm text-gray-600\">\r\n                You are about to save changes to your account information. This action cannot be undone. \r\n                Are you sure you want to proceed?\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex gap-3 justify-end pt-4 border-t border-gray-200\">\r\n            <Button\r\n              onClick={() => setSaveWarningOpen(false)}\r\n              variant=\"secondary\"\r\n              size=\"md\"\r\n              disabled={saving}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={handleSaveAccount}\r\n              variant=\"primary\"\r\n              size=\"md\"\r\n              disabled={saving}\r\n            >\r\n              {saving ? \"Saving...\" : \"Yes, Save Changes\"}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </BaseModal>\r\n\r\n      {/* Save Warning Modal for Store */}\r\n      <BaseModal\r\n        isOpen={saveStoreWarningOpen}\r\n        onClose={() => setSaveStoreWarningOpen(false)}\r\n        title=\"Confirm Save Changes\"\r\n      >\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-start gap-4\">\r\n            <div className=\"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0\">\r\n              <svg\r\n                className=\"w-6 h-6 text-yellow-600\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <div className=\"flex-1\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\r\n                Warning: This action cannot be undone\r\n              </h3>\r\n              <p className=\"text-sm text-gray-600\">\r\n                You are about to save changes to your store information. This action cannot be undone. \r\n                Are you sure you want to proceed?\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex gap-3 justify-end pt-4 border-t border-gray-200\">\r\n            <Button\r\n              onClick={() => setSaveStoreWarningOpen(false)}\r\n              variant=\"secondary\"\r\n              size=\"md\"\r\n              disabled={savingStore}\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              onClick={handleSaveStore}\r\n              variant=\"primary\"\r\n              size=\"md\"\r\n              disabled={savingStore}\r\n            >\r\n              {savingStore ? \"Saving...\" : \"Yes, Save Changes\"}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </BaseModal>\r\n      {/* Background blur overlay when editing */}\r\n      {(isEditingAccount || isEditingStore) && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/30 backdrop-blur-sm z-40\" \r\n          onClick={() => {\r\n            if (isEditingAccount) handleCancelEdit();\r\n            if (isEditingStore) handleCancelEditStore();\r\n          }} \r\n        />\r\n      )}\r\n\r\n      <div className={`p-4 sm:p-6 space-y-4 sm:space-y-6 ${(isEditingAccount || isEditingStore) ? 'relative z-50' : ''}`}>\r\n        {error && (\r\n          <Card className=\"bg-gradient-to-br from-red-50 to-orange-50 border-red-200/50\">\r\n            <div className=\"flex items-start gap-4 p-4\">\r\n              <div className=\"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0\">\r\n                <svg\r\n                  className=\"w-5 h-5 text-red-600\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n                  />\r\n                </svg>\r\n              </div>\r\n              <div className=\"flex-1\">\r\n                <h3 className=\"text-sm font-semibold text-red-900 mb-1\">\r\n                  Error Loading Profile\r\n                </h3>\r\n                <p className=\"text-sm text-red-700\">{error}</p>\r\n              </div>\r\n            </div>\r\n          </Card>\r\n        )}\r\n\r\n        {!loading && !error && !profileData && (\r\n          <Card className=\"bg-gradient-to-br from-gray-50 to-blue-50/30 border-gray-200/50\">\r\n            <div className=\"p-8 md:p-12 text-center\">\r\n              <div className=\"w-20 h-20 bg-gradient-to-br from-gray-200 to-gray-300 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg\">\r\n                <svg\r\n                  className=\"w-10 h-10 text-gray-500\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"\r\n                  />\r\n                </svg>\r\n              </div>\r\n              <h3 className=\"text-xl font-bold text-gray-900 mb-2\">\r\n                No Profile Data Available\r\n              </h3>\r\n              <p className=\"text-gray-600 mb-6 max-w-md mx-auto\">\r\n                Unable to load your profile information. Please try refreshing\r\n                or check your connection.\r\n              </p>\r\n              <Button\r\n                onClick={fetchProfileData}\r\n                variant=\"primary\"\r\n                size=\"md\"\r\n                icon={<RefreshIcon />}\r\n                iconPosition=\"left\"\r\n              >\r\n                Try Again\r\n              </Button>\r\n            </div>\r\n          </Card>\r\n        )}\r\n\r\n        {/* Profile Content - Only show when data is available */}\r\n        {profileData && (\r\n          <React.Fragment>\r\n            {/* Modern Profile Header */}\r\n            <Card className=\"bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border-blue-200/50 overflow-hidden\">\r\n              <div className=\"p-6 md:p-8\">\r\n                <div className=\"flex flex-col lg:flex-row items-start lg:items-center gap-6 lg:gap-8\">\r\n                  {/* QR Code Section */}\r\n                  <div className=\"flex-shrink-0 w-full lg:w-auto\">\r\n                    <div className=\"bg-white/80 backdrop-blur-sm rounded-2xl p-5 border border-white/50 shadow-lg hover:shadow-xl transition-all duration-300\">\r\n                      <div className=\"flex flex-col items-center gap-4\">\r\n                        <div className=\"relative group\">\r\n                          <div className=\"absolute inset-0 bg-gradient-to-br from-blue-400 via-indigo-500 to-purple-500 rounded-2xl blur-xl opacity-30 group-hover:opacity-40 transition-opacity duration-300\"></div>\r\n                          <div className=\"relative bg-white p-3 rounded-xl shadow-md\">\r\n                            <img\r\n                              src={getQrCodeData(profileData).qrSrc}\r\n                              alt=\"Store Entry QR Code\"\r\n                              className=\"w-[180px] h-[180px] md:w-[200px] md:h-[200px] rounded-lg\"\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                        <Button\r\n                          variant=\"primary\"\r\n                          size=\"md\"\r\n                          icon={<DownloadIcon />}\r\n                          iconPosition=\"left\"\r\n                          onClick={handleDownloadQr}\r\n                          className=\"w-full min-w-[200px] shadow-md hover:shadow-lg transition-all duration-200\"\r\n                        >\r\n                          Download QR Code\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Store Information Section */}\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <h1 className=\"text-2xl md:text-3xl font-bold text-gray-900 mb-2\">\r\n                      {profileData?.business?.business_name || \"Admin User\"}\r\n                    </h1>\r\n                    <p className=\"text-gray-600 mb-4 flex items-center gap-2\">\r\n                      <EmailIcon />\r\n                      <span className=\"truncate\">\r\n                        {profileData?.user?.email || \"N/A\"}\r\n                      </span>\r\n                    </p>\r\n                    <div className=\"flex flex-wrap gap-3\">\r\n                      <span className=\"inline-flex items-center gap-2 px-4 py-1.5 rounded-full text-sm font-semibold bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-800 border border-blue-200\">\r\n                        <div className=\"w-5 h-5 bg-blue-100 rounded-full flex items-center justify-center\">\r\n                          <StoreIcon className=\"w-3 h-3 text-blue-600\" />\r\n                        </div>\r\n                        <span>\r\n                          {profileData?.user?.role?.replace(\"_\", \" \").toUpperCase() || \"ADMIN\"}\r\n                          {profileData?.business?.business_type && `  ${profileData.business.business_type}`}\r\n                        </span>\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n\r\n            {/* Admin Information */}\r\n            <Card className={`bg-white shadow-sm ${isEditingAccount ? 'relative z-50 shadow-2xl' : ''}`}>\r\n              <div className=\"p-6 md:p-8\" onClick={(e) => e.stopPropagation()}>\r\n                <div className=\"flex items-center justify-between mb-6 pb-4 border-b border-gray-200\">\r\n                  <div className=\"flex items-center\">\r\n                    <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-xl flex items-center justify-center mr-3\">\r\n                      <UserIcon />\r\n                    </div>\r\n                    <div>\r\n                      <h2 className=\"text-xl font-bold text-gray-900\">\r\n                        Account Information\r\n                      </h2>\r\n                      <p className=\"text-sm text-gray-500\">\r\n                        Personal details and credentials\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  {!isEditingAccount && (\r\n                    <button\r\n                      onClick={handleEditAccount}\r\n                      className=\"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors\"\r\n                      title=\"Edit Account Information\"\r\n                    >\r\n                      <EditIcon />\r\n                    </button>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  <div className=\"space-y-5\">\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        First Name\r\n                      </label>\r\n                      {isEditingAccount ? (\r\n                        <div className=\"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-blue-300\">\r\n                          <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <UserIcon className=\"text-blue-600\" />\r\n                          </div>\r\n                          <input\r\n                            type=\"text\"\r\n                            value={editFormData.first_name}\r\n                            onChange={(e) => setEditFormData({ ...editFormData, first_name: e.target.value })}\r\n                            className=\"text-gray-900 font-medium flex-1 outline-none bg-transparent\"\r\n                            placeholder=\"First Name\"\r\n                          />\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors\">\r\n                          <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <UserIcon className=\"text-blue-600\" />\r\n                          </div>\r\n                          <span className=\"text-gray-900 font-medium flex-1\">\r\n                            {profileData?.user?.first_name || \"N/A\"}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Last Name\r\n                      </label>\r\n                      {isEditingAccount ? (\r\n                        <div className=\"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-blue-300\">\r\n                          <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <UserIcon className=\"text-blue-600\" />\r\n                          </div>\r\n                          <input\r\n                            type=\"text\"\r\n                            value={editFormData.last_name}\r\n                            onChange={(e) => setEditFormData({ ...editFormData, last_name: e.target.value })}\r\n                            className=\"text-gray-900 font-medium flex-1 outline-none bg-transparent\"\r\n                            placeholder=\"Last Name\"\r\n                          />\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors\">\r\n                          <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <UserIcon className=\"text-blue-600\" />\r\n                          </div>\r\n                          <span className=\"text-gray-900 font-medium flex-1\">\r\n                            {profileData?.user?.last_name || \"N/A\"}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Email Address\r\n                      </label>\r\n                      {isEditingAccount ? (\r\n                        <div className=\"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-blue-300\">\r\n                          <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <EmailIcon className=\"text-blue-600\" />\r\n                          </div>\r\n                          <input\r\n                            type=\"email\"\r\n                            value={editFormData.email}\r\n                            onChange={(e) => setEditFormData({ ...editFormData, email: e.target.value })}\r\n                            className=\"text-gray-900 font-medium flex-1 outline-none bg-transparent\"\r\n                            placeholder=\"Email Address\"\r\n                          />\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors\">\r\n                          <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <EmailIcon className=\"text-blue-600\" />\r\n                          </div>\r\n                          <span className=\"text-gray-900 font-medium flex-1 truncate\">\r\n                            {profileData?.user?.email || \"N/A\"}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Role\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50\">\r\n                        <div className=\"w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <svg\r\n                            className=\"w-5 h-5 text-indigo-600\"\r\n                            fill=\"none\"\r\n                            stroke=\"currentColor\"\r\n                            viewBox=\"0 0 24 24\"\r\n                          >\r\n                            <path\r\n                              strokeLinecap=\"round\"\r\n                              strokeLinejoin=\"round\"\r\n                              strokeWidth={2}\r\n                              d=\"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z\"\r\n                            />\r\n                          </svg>\r\n                        </div>\r\n                        <span className=\"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-blue-100 text-blue-800 border border-blue-200 capitalize\">\r\n                          {profileData?.user?.role?.replace(\"_\", \" \") || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-5\">\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Contact Number\r\n                      </label>\r\n                      {isEditingAccount ? (\r\n                        <div className=\"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-blue-300\">\r\n                          <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <PhoneIcon className=\"text-green-600\" />\r\n                          </div>\r\n                          <input\r\n                            type=\"tel\"\r\n                            value={editFormData.contact_number}\r\n                            onChange={(e) => setEditFormData({ ...editFormData, contact_number: e.target.value })}\r\n                            className=\"text-gray-900 font-medium flex-1 outline-none bg-transparent\"\r\n                            placeholder=\"Contact Number\"\r\n                          />\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors\">\r\n                          <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <PhoneIcon className=\"text-green-600\" />\r\n                          </div>\r\n                          <span className=\"text-gray-900 font-medium flex-1\">\r\n                            {profileData?.user?.contact_number || \"N/A\"}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Account Created\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <CalendarIcon className=\"text-purple-600\" />\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1\">\r\n                          {formatDate(profileData?.user?.created_at)}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Last Updated\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-blue-300 transition-colors\">\r\n                        <div className=\"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <CalendarIcon className=\"text-orange-600\" />\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1\">\r\n                          {formatDate(profileData?.user?.updated_at)}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {isEditingAccount && (\r\n                  <div className=\"mt-6 pt-6 border-t border-gray-200\">\r\n                    {saveError && (\r\n                      <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700\">\r\n                        {saveError}\r\n                      </div>\r\n                    )}\r\n                    <div className=\"flex flex-wrap gap-3 justify-end\">\r\n                      <Button\r\n                        onClick={handleCancelEdit}\r\n                        variant=\"secondary\"\r\n                        size=\"md\"\r\n                        disabled={saving}\r\n                      >\r\n                        Cancel\r\n                      </Button>\r\n                      <Button\r\n                        onClick={() => setSaveWarningOpen(true)}\r\n                        variant=\"primary\"\r\n                        size=\"md\"\r\n                        disabled={saving}\r\n                      >\r\n                        {saving ? \"Saving...\" : \"Save Changes\"}\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </Card>\r\n\r\n            {/* Store Information */}\r\n            <Card className={`bg-white shadow-sm ${isEditingStore ? 'relative z-50 shadow-2xl' : ''}`}>\r\n              <div className=\"p-6 md:p-8\" onClick={(e) => e.stopPropagation()}>\r\n                <div className=\"flex items-center justify-between mb-6 pb-4 border-b border-gray-200\">\r\n                  <div className=\"flex items-center\">\r\n                    <div className=\"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 text-white rounded-xl flex items-center justify-center mr-3\">\r\n                      <StoreIcon />\r\n                    </div>\r\n                    <div>\r\n                      <h2 className=\"text-xl font-bold text-gray-900\">\r\n                        Store Information\r\n                      </h2>\r\n                      <p className=\"text-sm text-gray-500\">\r\n                        Business details and credentials\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  {!isEditingStore && (\r\n                    <button\r\n                      onClick={handleEditStore}\r\n                      className=\"p-2 text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors\"\r\n                      title=\"Edit Store Information\"\r\n                    >\r\n                      <EditIcon />\r\n                    </button>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                  <div className=\"space-y-5\">\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Business Name\r\n                      </label>\r\n                      {isEditingStore ? (\r\n                        <div className=\"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-green-300\">\r\n                          <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <StoreIcon className=\"text-green-600\" />\r\n                          </div>\r\n                          <input\r\n                            type=\"text\"\r\n                            value={editStoreFormData.business_name}\r\n                            onChange={(e) => setEditStoreFormData({ ...editStoreFormData, business_name: e.target.value })}\r\n                            className=\"text-gray-900 font-medium flex-1 outline-none bg-transparent\"\r\n                            placeholder=\"Business Name\"\r\n                          />\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors\">\r\n                          <div className=\"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <StoreIcon className=\"text-green-600\" />\r\n                          </div>\r\n                          <span className=\"text-gray-900 font-medium flex-1\">\r\n                            {profileData?.business?.business_name || \"N/A\"}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Business Email\r\n                      </label>\r\n                      {isEditingStore ? (\r\n                        <div className=\"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-green-300\">\r\n                          <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <EmailIcon className=\"text-blue-600\" />\r\n                          </div>\r\n                          <input\r\n                            type=\"email\"\r\n                            value={editStoreFormData.email}\r\n                            onChange={(e) => setEditStoreFormData({ ...editStoreFormData, email: e.target.value })}\r\n                            className=\"text-gray-900 font-medium flex-1 outline-none bg-transparent\"\r\n                            placeholder=\"Business Email\"\r\n                          />\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors\">\r\n                          <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <EmailIcon className=\"text-blue-600\" />\r\n                          </div>\r\n                          <span className=\"text-gray-900 font-medium flex-1 truncate\">\r\n                            {profileData?.business?.email || \"N/A\"}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Region\r\n                      </label>\r\n                      {isEditingStore ? (\r\n                        <div className=\"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-green-300\">\r\n                          <div className=\"w-8 h-8 bg-teal-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <LocationIcon className=\"text-teal-600\" />\r\n                          </div>\r\n                          <input\r\n                            type=\"text\"\r\n                            value={editStoreFormData.region}\r\n                            onChange={(e) => setEditStoreFormData({ ...editStoreFormData, region: e.target.value })}\r\n                            className=\"text-gray-900 font-medium flex-1 outline-none bg-transparent\"\r\n                            placeholder=\"Region\"\r\n                          />\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors\">\r\n                          <div className=\"w-8 h-8 bg-teal-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <LocationIcon className=\"text-teal-600\" />\r\n                          </div>\r\n                          <span className=\"text-gray-900 font-medium flex-1\">\r\n                            {profileData?.business?.region || \"N/A\"}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Province\r\n                      </label>\r\n                      {isEditingStore ? (\r\n                        <div className=\"flex items-center gap-3 bg-white px-4 py-3 rounded-xl border-2 border-green-300\">\r\n                          <div className=\"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <LocationIcon className=\"text-emerald-600\" />\r\n                          </div>\r\n                          <input\r\n                            type=\"text\"\r\n                            value={editStoreFormData.province}\r\n                            onChange={(e) => setEditStoreFormData({ ...editStoreFormData, province: e.target.value })}\r\n                            className=\"text-gray-900 font-medium flex-1 outline-none bg-transparent\"\r\n                            placeholder=\"Province\"\r\n                          />\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50 group-hover:border-green-300 transition-colors\">\r\n                          <div className=\"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                            <LocationIcon className=\"text-emerald-600\" />\r\n                          </div>\r\n                          <span className=\"text-gray-900 font-medium flex-1\">\r\n                            {profileData?.business?.province || \"N/A\"}\r\n                          </span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-5\">\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Business Type\r\n                      </label>\r\n                      <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50\">\r\n                        <div className=\"w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          <svg\r\n                            className=\"w-5 h-5 text-emerald-600\"\r\n                            fill=\"none\"\r\n                            stroke=\"currentColor\"\r\n                            viewBox=\"0 0 24 24\"\r\n                          >\r\n                            <path\r\n                              strokeLinecap=\"round\"\r\n                              strokeLinejoin=\"round\"\r\n                              strokeWidth={2}\r\n                              d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\"\r\n                            />\r\n                          </svg>\r\n                        </div>\r\n                        <span className=\"text-gray-900 font-medium flex-1\">\r\n                          {profileData?.business?.business_type || \"N/A\"}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"group\">\r\n                      <label className=\"block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2\">\r\n                        Business Location\r\n                      </label>\r\n                      {isEditingStore ? (\r\n                        <div className=\"bg-white px-4 py-3 rounded-xl border-2 border-green-300\">\r\n                          <div className=\"grid grid-cols-1 gap-4\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                              <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                                <LocationIcon className=\"text-blue-600\" />\r\n                              </div>\r\n                              <div className=\"flex-1\">\r\n                                <div className=\"text-xs text-gray-500 uppercase tracking-wide mb-1\">\r\n                                  City/Municipality\r\n                                </div>\r\n                                <input\r\n                                  type=\"text\"\r\n                                  value={editStoreFormData.city}\r\n                                  onChange={(e) => setEditStoreFormData({ ...editStoreFormData, city: e.target.value })}\r\n                                  className=\"text-gray-900 font-medium w-full outline-none bg-transparent border-b border-gray-300 focus:border-green-500\"\r\n                                  placeholder=\"City/Municipality\"\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-3\">\r\n                              <div className=\"w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                                <LocationIcon className=\"text-indigo-600\" />\r\n                              </div>\r\n                              <div className=\"flex-1\">\r\n                                <div className=\"text-xs text-gray-500 uppercase tracking-wide mb-1\">\r\n                                  Barangay\r\n                                </div>\r\n                                <input\r\n                                  type=\"text\"\r\n                                  value={editStoreFormData.barangay}\r\n                                  onChange={(e) => setEditStoreFormData({ ...editStoreFormData, barangay: e.target.value })}\r\n                                  className=\"text-gray-900 font-medium w-full outline-none bg-transparent border-b border-gray-300 focus:border-green-500\"\r\n                                  placeholder=\"Barangay\"\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"flex items-start gap-3\">\r\n                              <div className=\"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5\">\r\n                                <LocationIcon className=\"text-purple-600\" />\r\n                              </div>\r\n                              <div className=\"flex-1\">\r\n                                <div className=\"text-xs text-gray-500 uppercase tracking-wide mb-1\">\r\n                                  House no./ Street Name / Landmark (optional)\r\n                                </div>\r\n                                <input\r\n                                  type=\"text\"\r\n                                  value={editStoreFormData.house_number}\r\n                                  onChange={(e) => setEditStoreFormData({ ...editStoreFormData, house_number: e.target.value })}\r\n                                  className=\"text-gray-900 font-medium w-full outline-none bg-transparent border-b border-gray-300 focus:border-green-500\"\r\n                                  placeholder=\"House no./ Street Name / Landmark\"\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"bg-gradient-to-r from-gray-50 to-gray-100/50 px-4 py-3 rounded-xl border border-gray-200/50\">\r\n                          <div className=\"grid grid-cols-1 gap-4\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                              <div className=\"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                                <LocationIcon className=\"text-blue-600\" />\r\n                              </div>\r\n                              <div className=\"flex-1\">\r\n                                <div className=\"text-xs text-gray-500 uppercase tracking-wide\">\r\n                                  City/Municipality\r\n                                </div>\r\n                                <div className=\"text-gray-900 font-medium\">\r\n                                  {profileData?.business?.city || \"N/A\"}\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-3\">\r\n                              <div className=\"w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                                <LocationIcon className=\"text-indigo-600\" />\r\n                              </div>\r\n                              <div className=\"flex-1\">\r\n                                <div className=\"text-xs text-gray-500 uppercase tracking-wide\">\r\n                                  Barangay\r\n                                </div>\r\n                                <div className=\"text-gray-900 font-medium\">\r\n                                  {profileData?.business?.barangay || \"N/A\"}\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"flex items-start gap-3\">\r\n                              <div className=\"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5\">\r\n                                <LocationIcon className=\"text-purple-600\" />\r\n                              </div>\r\n                              <div className=\"flex-1\">\r\n                                <div className=\"text-xs text-gray-500 uppercase tracking-wide\">\r\n                                  House no./ Street Name / Landmark (optional)\r\n                                </div>\r\n                                <div className=\"text-gray-900 font-medium\">\r\n                                  {profileData?.business?.house_number || \"N/A\"}\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                {isEditingStore && (\r\n                  <div className=\"mt-6 pt-6 border-t border-gray-200\">\r\n                    {saveStoreError && (\r\n                      <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700\">\r\n                        {saveStoreError}\r\n                      </div>\r\n                    )}\r\n                    <div className=\"flex flex-wrap gap-3 justify-end\">\r\n                      <Button\r\n                        onClick={handleCancelEditStore}\r\n                        variant=\"secondary\"\r\n                        size=\"md\"\r\n                        disabled={savingStore}\r\n                      >\r\n                        Cancel\r\n                      </Button>\r\n                      <Button\r\n                        onClick={() => setSaveStoreWarningOpen(true)}\r\n                        variant=\"primary\"\r\n                        size=\"md\"\r\n                        disabled={savingStore}\r\n                      >\r\n                        {savingStore ? \"Saving...\" : \"Save Changes\"}\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </Card>\r\n\r\n            {/* Business Users */}\r\n            {profileData?.business?.users &&\r\n              profileData.business.users.length > 0 && (\r\n                <>\r\n                  {(() => {\r\n                    const filteredBusinessUsers =\r\n                      profileData.business.users.filter(\r\n                        (user) =>\r\n                          user.user_type_name === \"admin\" ||\r\n                          user.user_type_name === \"cashier\" ||\r\n                          user.role === \"admin\" ||\r\n                          user.role === \"cashier\" ||\r\n                          user.role === \"business_owner\"\r\n                      );\r\n                    return (\r\n                      <Card className=\"bg-white shadow-sm\">\r\n                        <div className=\"p-6 md:p-8\">\r\n                          <div className=\"flex items-center mb-6 pb-4 border-b border-gray-200\">\r\n                            <div className=\"w-10 h-10 bg-gradient-to-br bg-blue-500 text-white rounded-xl flex items-center justify-center mr-3\">\r\n                              <svg\r\n                                className=\"w-5 h-5\"\r\n                                fill=\"none\"\r\n                                stroke=\"currentColor\"\r\n                                viewBox=\"0 0 24 24\"\r\n                              >\r\n                                <path\r\n                                  strokeLinecap=\"round\"\r\n                                  strokeLinejoin=\"round\"\r\n                                  strokeWidth={2}\r\n                                  d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z\"\r\n                                />\r\n                              </svg>\r\n                            </div>\r\n                            <div>\r\n                              <h2 className=\"text-xl font-bold text-gray-900\">\r\n                                Business Team\r\n                              </h2>\r\n                              <p className=\"text-sm text-gray-500\">\r\n                                All users associated with this business (\r\n                                {filteredBusinessUsers.length} total)\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6\">\r\n                            {filteredBusinessUsers.map((user, index) => (\r\n                              <div\r\n                                key={user.user_id}\r\n                                className=\"group bg-gradient-to-br from-white to-gray-50/50 rounded-2xl p-5 border border-gray-200/50 hover:border-purple-300 hover:shadow-lg transition-all duration-300\"\r\n                              >\r\n                                <div className=\"flex items-center mb-4\">\r\n                                  <div className=\"relative\">\r\n                                    <div className=\"w-12 h-12 bg-gradient-to-br bg-blue-500 text-white rounded-xl flex items-center justify-center text-lg font-bold shadow-md ring-2 ring-white\">\r\n                                      {(user.first_name\r\n                                        ?.charAt(0)\r\n                                        ?.toUpperCase() || user.username?.charAt(0)?.toUpperCase()) || \"U\"}\r\n                                    </div>\r\n                                    <div className=\"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white\"></div>\r\n                                  </div>\r\n                                  <div className=\"ml-3 flex-1 min-w-0\">\r\n                                    <h4 className=\"font-bold text-gray-900 truncate\">\r\n                                      {user.first_name && user.last_name\r\n                                        ? `${user.first_name} ${user.last_name}`\r\n                                        : user.first_name || user.last_name || user.username || \"N/A\"}\r\n                                    </h4>\r\n                                    <span\r\n                                      className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold mt-1 ${\r\n                                        user.user_type_name === \"admin\" ||\r\n                                        user.role === \"business_owner\"\r\n                                          ? \"bg-red-100 text-red-800 border border-red-200\"\r\n                                          : user.user_type_name === \"cashier\" ||\r\n                                            user.role === \"cashier\"\r\n                                          ? \"bg-green-100 text-green-800 border border-green-200\"\r\n                                          : \"bg-gray-100 text-gray-800 border border-gray-200\"\r\n                                      }`}\r\n                                    >\r\n                                      {user.user_type_name || user.role}\r\n                                    </span>\r\n                                  </div>\r\n                                </div>\r\n\r\n                                <div className=\"space-y-3 text-sm\">\r\n                                  {user.username && (\r\n                                    <div className=\"flex items-start gap-2\">\r\n                                      <UserIcon className=\"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0\" />\r\n                                      <div className=\"min-w-0 flex-1\">\r\n                                        <div className=\"text-xs text-gray-500 mb-0.5\">\r\n                                          Username\r\n                                        </div>\r\n                                        <div className=\"font-medium text-gray-900 truncate\">\r\n                                          {user.username}\r\n                                        </div>\r\n                                      </div>\r\n                                    </div>\r\n                                  )}\r\n                                  <div className=\"flex items-start gap-2\">\r\n                                    <EmailIcon className=\"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0\" />\r\n                                    <div className=\"min-w-0 flex-1\">\r\n                                      <div className=\"text-xs text-gray-500 mb-0.5\">\r\n                                        Email\r\n                                      </div>\r\n                                      <div className=\"font-medium text-gray-900 truncate\">\r\n                                        {user.email}\r\n                                      </div>\r\n                                    </div>\r\n                                  </div>\r\n                                  {user.contact_number && (\r\n                                    <div className=\"flex items-start gap-2\">\r\n                                      <PhoneIcon className=\"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0\" />\r\n                                      <div className=\"min-w-0 flex-1\">\r\n                                        <div className=\"text-xs text-gray-500 mb-0.5\">\r\n                                          Contact\r\n                                        </div>\r\n                                        <div className=\"font-medium text-gray-900\">\r\n                                          {user.contact_number}\r\n                                        </div>\r\n                                      </div>\r\n                                    </div>\r\n                                  )}\r\n                                  <div className=\"flex items-start gap-2\">\r\n                                    <CalendarIcon className=\"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0\" />\r\n                                    <div className=\"min-w-0 flex-1\">\r\n                                      <div className=\"text-xs text-gray-500 mb-0.5\">\r\n                                        Joined\r\n                                      </div>\r\n                                      <div className=\"font-medium text-gray-900\">\r\n                                        {formatDate(user.created_at)}\r\n                                      </div>\r\n                                    </div>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n                      </Card>\r\n                    );\r\n                  })()}\r\n                </>\r\n              )}\r\n\r\n              {/* Store Deletion Section */}\r\n              <Card className=\"border-red-100 border-2 mt-6\">\r\n                <div className=\"p-6\">\r\n                  <div className=\"flex items-center mb-4\">\r\n                    <div className=\"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3\">\r\n                      <svg className=\"w-6 h-6 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                      </svg>\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"text-lg font-bold text-red-900\">Delete Your Store</h3>\r\n                      <p className=\"text-sm text-red-600\">This action cannot be undone after 30 days</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-4\">\r\n                    <p className=\"text-gray-700\">\r\n                      Download all transactions then schedule deletion with a 30-day recovery window.\r\n                    </p>\r\n\r\n                    {deleteMessage && (\r\n                      <div className=\"text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded-lg px-3 py-2\">\r\n                        {deleteMessage}\r\n                      </div>\r\n                    )}\r\n                    {deleteError && (\r\n                      <div className=\"text-sm text-red-700 bg-red-50 border border-red-200 rounded-lg px-3 py-2\">\r\n                        {deleteError}\r\n                      </div>\r\n                    )}\r\n\r\n                    {deleteState.status === \"pending\" && (\r\n                      <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs text-gray-700 p-4 bg-gray-50 rounded-lg\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <span className=\"font-semibold text-gray-800\">Status:</span>\r\n                          <span className=\"px-2 py-1 rounded-full border text-xs\">\r\n                            {deleteState.status || \"none\"}\r\n                          </span>\r\n                        </div>\r\n                        <div>\r\n                          <span className=\"font-semibold text-gray-800\">Scheduled:</span>{\" \"}\r\n                          {formatDate(deleteState.scheduledFor)}\r\n                        </div>\r\n                        <div>\r\n                          <span className=\"font-semibold text-gray-800\">Requested:</span>{\" \"}\r\n                          {formatDate(deleteState.requestedAt)}\r\n                        </div>\r\n                        <div>\r\n                          <span className=\"font-semibold text-gray-800\">Export ready:</span>{\" \"}\r\n                          {formatDate(deleteState.exportReadyAt) || \"N/A\"}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n\r\n                    <div className=\"space-y-4\">\r\n                      {!showDeleteConfirm ? (\r\n                        <div className=\"flex flex-wrap gap-3\">\r\n                          {deleteState.status === \"pending\" && (\r\n                            <Button\r\n                              label={\r\n                                downloadLoading ? \"Preparing...\" : \"Download transactions\"\r\n                              }\r\n                              variant=\"secondary\"\r\n                              onClick={handleDownloadExport}\r\n                              disabled={downloadLoading}\r\n                              icon={<DownloadIcon />}\r\n                            />\r\n                          )}\r\n                          <Button\r\n                            label=\"Delete store\"\r\n                            variant=\"danger\"\r\n                            onClick={() => setShowDeleteConfirm(true)}\r\n                            disabled={deleteLoading || deleteState.status === \"pending\"}\r\n                          />\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"space-y-4\">\r\n                          <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                              Enter your password to confirm\r\n                            </label>\r\n                            <input\r\n                              type=\"password\"\r\n                              className=\"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-red-500 focus:border-red-500\"\r\n                              placeholder=\"Your account password\"\r\n                              value={password}\r\n                              onChange={(e) => setPassword(e.target.value)}\r\n                              disabled={deleteLoading}\r\n                            />\r\n                          </div>\r\n                          <div className=\"flex flex-wrap gap-3\">\r\n                            <Button\r\n                              label=\"Cancel\"\r\n                              variant=\"secondary\"\r\n                              onClick={() => {\r\n                                setShowDeleteConfirm(false);\r\n                                setPassword(\"\");\r\n                                setDeleteError(\"\");\r\n                              }}\r\n                              disabled={deleteLoading}\r\n                            />\r\n                            <Button\r\n                              label={\r\n                                deleteLoading ? \"Processing...\" : \"Confirm Deletion\"\r\n                              }\r\n                              variant=\"danger\"\r\n                              onClick={handleRequestDeletion}\r\n                              disabled={deleteLoading || !password}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n\r\n                      {deleteState.status === \"pending\" && (\r\n                        <Button\r\n                          label=\"Cancel Deletion\"\r\n                          variant=\"secondary\"\r\n                          onClick={handleCancelDeletion}\r\n                          disabled={deleteLoading}\r\n                          className=\"mt-2\"\r\n                        />\r\n                      )}\r\n\r\n                      <p className=\"text-sm text-gray-500 mt-2\">\r\n                        You can recover the account within 30 days. After that, the store is permanently removed.\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n            </React.Fragment>\r\n          )}\r\n        </div>\r\n    </PageLayout>\r\n  );\r\n};\r\n\r\nexport default Profile;\r\n"],"names":["SelectDropdown","name","value","options","placeholder","onChange","error","disabled","searchable","className","required","isOpen","setIsOpen","useState","searchTerm","setSearchTerm","highlightedIndex","setHighlightedIndex","dropdownRef","useRef","inputRef","filteredOptions","filter","option","label","toLowerCase","includes","useEffect","handleClickOutside","event","current","contains","target","addEventListener","document","removeEventListener","handleKeyDown","key","preventDefault","prev","length","handleSelect","selectedOption","find","ref","children","jsxs","type","onClick","handleToggle","setTimeout","focus","jsx","BiCheck","BiChevronUp","BiChevronDown","BiSearch","e","map","index","onMouseEnter","fill","viewBox","fillRule","d","clipRule","ProfileModal","onClose","userData","businessData","profileData","setProfileData","first_name","last_name","email","contact_number","currentPassword","newPassword","confirmPassword","business_name","business_email","business_type","region","province","city","barangay","house_street","house_number","business_address","address_line","loading","setLoading","message","setMessage","setError","errors","setErrors","touched","setTouched","activeTab","setActiveTab","locationOptions","setLocationOptions","regions","provinces","cities","barangays","locationLoading","setLocationLoading","initialLocationRef","findOptionByLabel","trim","o","getLabel","fallback","match","async","l","data","getRegions","r","code","err","fetchRegions","p","getProvinces","loadProvinces","getCities","c","loadCities","getBarangays","b","loadBarangays","validateField","newErrors","test","handleInputChange","handleBlur","handleSubmit","token","sessionStorage","getItem","updateData","api","method","headers","Authorization","body","JSON","stringify","regionLabel","provinceLabel","cityLabel","barangayLabel","businessUpdateData","businessName","undefined","businessType","businessAddress","Boolean","join","houseNumber","window","location","reload","useKeyboardShortcuts","action","enabled","allowWhileTyping","stopPropagation","BaseModal","title","subtitle","footer","Button","variant","stroke","strokeLinecap","strokeLinejoin","strokeWidth","onSubmit","FormField","onBlur","UserIcon","props","EmailIcon","PhoneIcon","CalendarIcon","StoreIcon","LocationIcon","RefreshIcon","EditIcon","LockIcon","DownloadIcon","getQrCodeData","businessId","business","business_id","user","parse","localStorage","url","qrSrc","URL","origin","searchParams","set","String","urlString","toString","encodeURIComponent","Date","now","downloadSrc","Profile","isSidebarOpen","setSidebarOpen","isEditModalOpen","setIsEditModalOpen","deleteState","setDeleteState","status","deleteMessage","setDeleteMessage","deleteError","setDeleteError","deleteLoading","setDeleteLoading","downloadLoading","setDownloadLoading","password","setPassword","showDeleteConfirm","setShowDeleteConfirm","showChangePasswordModal","setShowChangePasswordModal","isEditingAccount","setIsEditingAccount","editFormData","setEditFormData","saveWarningOpen","setSaveWarningOpen","saving","setSaving","saveError","setSaveError","isEditingStore","setIsEditingStore","editStoreFormData","setEditStoreFormData","saveStoreWarningOpen","setSaveStoreWarningOpen","savingStore","setSavingStore","saveStoreError","setSaveStoreError","normalizeDeletion","del","fetchProfileData","res","normalized","deletion","fetchDeletionStatus","normalizeBusiness","parts","split","pop","len","houseOrStreet","slice","regionName","region_name","provinceName","cityName","barangayName","setItem","console","log","response","locationsCacheRef","locations","derivedRegion","deriveRegionFromLocations","locErr","warn","locationsData","provinceLower","cityLower","regionData","Object","entries","provinceKey","keys","provLower","formatDate","dateString","toLocaleDateString","year","month","day","hour","minute","handleCancelEdit","handleCancelEditStore","headerActions","size","icon","iconPosition","PageLayout","sidebar","NavAdmin","Loader","ChangePasswordModal","addressParts","Card","React","Fragment","src","alt","fetch","ok","Error","blob","createObjectURL","a","createElement","href","download","appendChild","click","removeChild","revokeObjectURL","alert","role","replace","toUpperCase","handleEditAccount","created_at","updated_at","handleEditStore","users","filteredBusinessUsers","user_type_name","charAt","username","user_id","scheduledFor","requestedAt","exportReadyAt","envUrl","import","hostname","API_BASE","credentials","errorText","text","errorMessage","link","fileExtension","contentDisposition","get","fileName","fileNameMatch","decodeURIComponent","remove"],"mappings":"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"}