{"version":3,"file":"ProfileModal-D2jBW2Zw.js","sources":["../../../frontend/src/components/modals/ProfileModal.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport Button from \"../common/Button\";\r\nimport BaseModal from \"./BaseModal\";\r\nimport { api } from \"../../lib/api\";\r\n\r\nconst ProfileModal = ({ isOpen, onClose, userData }) => {\r\n  const [form, setForm] = useState({\r\n    currentPassword: \"\",\r\n    newPassword: \"\",\r\n    confirmPassword: \"\",\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n    setForm({ currentPassword: \"\", newPassword: \"\", confirmPassword: \"\" });\r\n    setMessage(\"\");\r\n    setError(\"\");\r\n  }, [isOpen]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const handleSubmit = async () => {\r\n    setError(\"\");\r\n    setMessage(\"\");\r\n\r\n    if (!form.currentPassword || !form.newPassword || !form.confirmPassword) {\r\n      setError(\"Please fill in all password fields.\");\r\n      return;\r\n    }\r\n    if (form.newPassword !== form.confirmPassword) {\r\n      setError(\"New password and confirmation do not match.\");\r\n      return;\r\n    }\r\n    setLoading(true);\r\n    try {\r\n      const token = sessionStorage.getItem(\"auth_token\");\r\n      await api(\"/api/auth/password\", {\r\n        method: \"PUT\",\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          currentPassword: form.currentPassword,\r\n          newPassword: form.newPassword,\r\n        }),\r\n      });\r\n      setMessage(\"Password updated successfully.\");\r\n      setForm({ currentPassword: \"\", newPassword: \"\", confirmPassword: \"\" });\r\n    } catch (e) {\r\n      setError(\r\n        e?.error ||\r\n          e?.message ||\r\n          \"Failed to update password. Please check your current password.\"\r\n      );\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const storeLabel =\r\n    userData?.store_name ||\r\n    userData?.storeName ||\r\n    userData?.businessName ||\r\n    \"your store\";\r\n\r\n  return (\r\n    <BaseModal\r\n      isOpen={isOpen}\r\n      onClose={onClose}\r\n      title=\"Update Password\"\r\n      subtitle=\"Cashiers can only change their password here\"\r\n      footer={\r\n        <div className=\"w-full flex gap-2 justify-end\">\r\n          <Button\r\n            label=\"Cancel\"\r\n            variant=\"secondary\"\r\n            onClick={onClose}\r\n            disabled={loading}\r\n          />\r\n          <Button\r\n            label={loading ? \"Saving...\" : \"Save Password\"}\r\n            variant=\"primary\"\r\n            onClick={handleSubmit}\r\n            disabled={loading}\r\n          />\r\n        </div>\r\n      }\r\n    >\r\n      {message && (\r\n        <div className=\"text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded-lg px-3 py-2 mb-3\">\r\n          {message}\r\n        </div>\r\n      )}\r\n      {error && (\r\n        <div className=\"text-sm text-red-700 bg-red-50 border border-red-200 rounded-lg px-3 py-2 mb-3\">\r\n          {error}\r\n        </div>\r\n      )}\r\n      <div className=\"space-y-3\">\r\n        <div>\r\n          <label className=\"block text-sm font-semibold text-gray-800 mb-1\">\r\n            Current Password\r\n          </label>\r\n          <input\r\n            type=\"password\"\r\n            className=\"w-full border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n            value={form.currentPassword}\r\n            onChange={(e) =>\r\n              setForm((prev) => ({ ...prev, currentPassword: e.target.value }))\r\n            }\r\n          />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-semibold text-gray-800 mb-1\">\r\n            New Password\r\n          </label>\r\n          <input\r\n            type=\"password\"\r\n            className=\"w-full border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n            value={form.newPassword}\r\n            onChange={(e) =>\r\n              setForm((prev) => ({ ...prev, newPassword: e.target.value }))\r\n            }\r\n          />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-semibold text-gray-800 mb-1\">\r\n            Confirm New Password\r\n          </label>\r\n          <input\r\n            type=\"password\"\r\n            className=\"w-full border border-gray-200 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\r\n            value={form.confirmPassword}\r\n            onChange={(e) =>\r\n              setForm((prev) => ({ ...prev, confirmPassword: e.target.value }))\r\n            }\r\n          />\r\n        </div>\r\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg px-3 py-2 text-xs text-blue-800\">\r\n          Password must be at least 12 characters and include upper, lower,\r\n          number, and special characters.\r\n        </div>\r\n      </div>\r\n    </BaseModal>\r\n  );\r\n};\r\n\r\nexport default ProfileModal;\r\n"],"names":["ProfileModal","isOpen","onClose","userData","form","setForm","useState","currentPassword","newPassword","confirmPassword","loading","setLoading","message","setMessage","error","setError","useEffect","jsxs","BaseModal","title","subtitle","footer","className","children","jsx","Button","label","variant","onClick","disabled","async","token","sessionStorage","getItem","api","method","headers","Authorization","body","JSON","stringify","e","type","value","onChange","prev","target"],"mappings":"uKAKA,MAAMA,EAAeA,EAAGC,SAAQC,UAASC,eACvC,MAAOC,EAAMC,GAAWC,WAAS,CAC/BC,gBAAiB,GACjBC,YAAa,GACbC,gBAAiB,MAEZC,EAASC,GAAcL,EAAAA,UAAS,IAChCM,EAASC,GAAcP,EAAAA,SAAS,KAChCQ,EAAOC,GAAYT,EAAAA,SAAS,IAS/B,GAPJU,EAAAA,UAAU,KACHf,IACGI,EAAA,CAAEE,gBAAiB,GAAIC,YAAa,GAAIC,gBAAiB,KACjEI,EAAW,IACXE,EAAS,MACR,CAACd,KAECA,EAAe,OAAA,KA+CpB,OACGgB,EAAAA,KAAAC,EAAA,CACCjB,SACAC,UACAiB,MAAM,kBACNC,SAAS,+CACTC,OACEJ,EAAAA,KAAC,MAAI,CAAAK,UAAU,gCACbC,SAAA,CAACC,EAAAA,IAAAC,EAAA,CACCC,MAAM,SACNC,QAAQ,YACRC,QAAS1B,EACT2B,SAAUnB,IAEZc,EAAAA,IAACC,EACC,CAAAC,MAAOhB,EAAU,YAAc,gBAC/BiB,QAAQ,UACRC,QA9DWE,UAIf,GAHJf,EAAS,IACTF,EAAW,IAENT,EAAKG,iBAAoBH,EAAKI,aAAgBJ,EAAKK,gBAIpDL,GAAAA,EAAKI,cAAgBJ,EAAKK,gBAA1BL,CAIJO,GAAW,GACP,IACIoB,MAAAA,EAAQC,eAAeC,QAAQ,oBAC/BC,EAAI,qBAAsB,CAC9BC,OAAQ,MACRC,QAAS,CACPC,cAAe,UAAUN,IACzB,eAAgB,oBAElBO,KAAMC,KAAKC,UAAU,CACnBjC,gBAAiBH,EAAKG,gBACtBC,YAAaJ,EAAKI,gBAGtBK,EAAW,kCACHR,EAAA,CAAEE,gBAAiB,GAAIC,YAAa,GAAIC,gBAAiB,WAC1DgC,GACP1B,EACE0B,GAAG3B,OACD2B,GAAG7B,SACH,iEACJ,CACQ,QACRD,GAAW,EAAK,CAzBhB,MADAI,EAAS,oDAJTA,EAAS,wCA0DHc,SAAUnB,OAKfE,SAAAA,CAAAA,GACEY,EAAAA,IAAA,MAAA,CAAIF,UAAU,6FACZV,SACHA,IAEDE,GACCU,EAAAA,IAAC,MAAI,CAAAF,UAAU,iFACZR,SACHA,IAEFG,EAAAA,KAAC,MAAI,CAAAK,UAAU,YACbC,SAAA,CAAAN,OAAC,MACC,CAAAM,SAAA,CAACC,EAAAA,IAAA,QAAA,CAAMF,UAAU,iDAAiDC,SAElE,qBACCC,EAAAA,IAAA,QAAA,CACCkB,KAAK,WACLpB,UAAU,oHACVqB,MAAOvC,EAAKG,gBACZqC,SACEvC,GAAAA,EAAmBwC,IAAA,IAAKA,EAAMtC,gBAAiBkC,EAAEK,OAAOH,qBAI7D,MACC,CAAApB,SAAA,CAACC,EAAAA,IAAA,QAAA,CAAMF,UAAU,iDAAiDC,SAElE,iBACCC,EAAAA,IAAA,QAAA,CACCkB,KAAK,WACLpB,UAAU,oHACVqB,MAAOvC,EAAKI,YACZoC,SACEvC,GAAAA,EAAmBwC,IAAA,IAAKA,EAAMrC,YAAaiC,EAAEK,OAAOH,qBAIzD,MACC,CAAApB,SAAA,CAACC,EAAAA,IAAA,QAAA,CAAMF,UAAU,iDAAiDC,SAElE,yBACCC,EAAAA,IAAA,QAAA,CACCkB,KAAK,WACLpB,UAAU,oHACVqB,MAAOvC,EAAKK,gBACZmC,SACEvC,GAAAA,EAAmBwC,IAAA,IAAKA,EAAMpC,gBAAiBgC,EAAEK,OAAOH,cAI7DnB,EAAAA,IAAA,MAAA,CAAIF,UAAU,+EAA+EC,SAG9F"}